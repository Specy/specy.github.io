{"version":3,"sources":["appConfig.js","components/GenshinNoteBorder.js","pages/Main/Note.js","pages/Main/SongStore.js","lib/Utils.js","pages/Main/Keyboard.js","assets/images/mainpage.png","assets/images/composer.png","assets/images/songs.png","components/HelpTab/index.js","components/MenuItem.js","components/MenuPanel.js","components/MenuClose.js","components/SettingsRow.js","components/DonateButton.js","components/LibrarySearchedSong.js","pages/Main/Menu.js","lib/SettingsObj.js","lib/Instrument.js","lib/AudioRecorder.js","components/AsyncPrompts.js","pages/Main/index.js","assets/icons/addCell.svg","assets/icons/removeCell.svg","pages/Composer/useDebounce.js","pages/Composer/MidiParser.js","pages/Composer/ComposerTools.js","pages/Composer/ComposerNote.js","pages/Composer/MultiSwitch.js","pages/Composer/ComposerKeyboard.js","pages/Composer/ComposerCache.js","pages/Composer/ComposerCanvas.js","pages/Composer/Menu.js","pages/Composer/index.js","components/SimpleMenu.js","pages/ErrorPage/index.js","pages/Changelog/index.js","assets/images/partners/windsong-db.jpg","pages/Partners/index.js","pages/Home/index.js","pages/Help/index.js","serviceWorkerRegistration.js","components/FloatingMessage.js","assets/images/paypalme.png","assets/images/buymeacoffee.svg","pages/Donate/index.js","assets/images/kofi.png","assets/icons/rotate.svg","index.js"],"names":["appName","process","appVersion","console","log","updateMessage","trim","pages","cssClasses","noteComposer","note","noteAnimation","approachCircle","noteName","audioContext","window","AudioContext","webkitAudioContext","instruments","notesPerColumn","instrumentsData","Lyre","notes","Zither","effects","filter","clickColor","DunDun","Bells","Trumpet","Contrabass","Drum","Flute","Guitar","HandPan","ToyUkulele","Harp","Horn","Piano","Pipa","Kalimba","WinterPiano","Xylophone","Ocarina","layoutData","keyboardLayout","split","mobileLayout","keyboardCodes","keyNames","Sky","Genshin","speedChangers","map","e","name","value","pitchArr","composerNotePositions","reverse","importNotePositions","layoutImages","cacheData","noteData","background","border","center","horizontalLineBreak","standards","color","layersCombination","breakpoints","type","isTwa","JSON","parse","sessionStorage","getItem","NoteBorder","props","fill","className","width","height","viewBox","xmlns","style","d","getApproachCircleColor","index","numOfNotes","Math","floor","ApproachCircle","animation","approachRate","borderColor","parseBorderFill","status","Note","state","this","data","approachingNotes","outgoingAnimation","fadeTime","instrument","transition","parseClass","onPointerDown","preventDefault","handleClick","id","key","backgroundColor","draggable","alt","src","noteImage","noteText","Component","songStore","observable","song","eventType","start","Recording","init","Date","getTime","addNote","length","push","Song","version","bpm","pitch","isComposed","isComposedVersion","Object","entries","forEach","entry","LoggerEvent","title","text","timeout","trigger","dispatchEvent","event","undefined","CustomEvent","detail","FileDownloader","download","file","dataType","encodeURIComponent","el","document","createElement","body","appendChild","setAttribute","click","remove","TempoChangers","changer","ComposedSong","columns","selected","Array","column","Column","tempoChanger","NotesTable","ComposerSongDeSerialization","obj","columnObj","ColumnNote","ComposerToRecording","recordedSong","bpmPerMs","totalTime","ComposerSongSerialization","columnArr","layer","prepareSongDownload","finalSong","stringify","oldFormatNotes","convertedNotes","noteObj","time","l","composedToOldFormat","recordedToOldFormat","pitchLevel","indexOf","songNotes","bitsPerPage","isEncrypted","prepareSongImport","isArray","includes","getSongType","Error","result","self","findIndex","n","genshinLayout","Number","RecordingToComposed","oldSkyToNewFormat","newSkyFormatToGenshin","bpmToMs","composed","converted","grouped","threshold","row","shift","amount","i","splice","groupByNotes","combinations","columnNote","difference","paddingColumns","finalPadding","col","getPitchChanger","pow","toFixed","delayMs","ms","Promise","resolve","workerTimers","Keyboard","approachingSong","a","startDelay","speedChanger","setState","approachingScore","correct","wrong","score","combo","changeSliderState","approachingNotesList","tick","hasSong","sliderState","stateNotes","tickTime","hasChanges","removed","clicked","random","apNote","position","playSong","songTimestamp","timestamp","keyboard","applySpeedChange","previous","pastError","previousTime","delay","size","practiceSong","songLength","chunks","previousChunkDelay","chunk","startTime","j","firstChunk","nextChunkDelay","secondChunk","keyboardNote","functions","setHasSong","songToPractice","handleSpeedChanger","find","restartSong","override","lostReference","stopSong","setTimeout","isInteger","res","handleSliderEvent","target","handleKeyboard","repeat","activeElement","tagName","shiftKey","code","replace","getNoteFromCode","handleApproachClick","approachingNote","handlePracticeClick","indexClicked","nextChunk","nextNextChunk","onlySound","hasAnimation","approachStatus","playSound","propKeyboard","layout","playTimestamp","disposeStore","tickInterval","addEventListener","setInterval","observe","object","removeEventListener","clearInterval","keyboardSize","keyboardClass","Score","onClick","min","onChange","max","disabled","transform","marginBottom","isLoading","instrumentName","isAnimated","getNoteText","noteNameType","layoutLength","HelpTab","mainPageImg","isMobile","Key","songsImg","composerImg","children","MenuItem","action","MenuPanel","visible","MenuClose","SettingsRow","update","objKey","changeVolume","useState","valueHook","setter","volume","volumeHook","setterVolume","sendChangeSelect","options","placeholder","checked","onBlur","onPointerUp","DonateButton","SearchedSong","importSong","fetching","setFetching","cache","setCache","fetch","encodeURI","then","json","error","play","Menu","open","checkPersistentStorage","navigator","storage","persist","persisted","isPersisted","isPersistentStorage","handleSearchInput","searchInput","clearSearch","searchedSongs","searchStatus","searchSongs","fetchedSongs","toggleMenu","newState","selectSideMenu","selection","selectedMenu","changeSelectedSongType","selectedSongType","reader","FileReader","songsInput","addSong","fileName","readAsText","downloadSong","_id","songName","song1","toLowerCase","downloadAllSongs","toDownload","songs","fileDownloader","date","toISOString","sideClass","handleSettingChange","changePage","composedSongs","searchedSongFunctions","SongRow","marginTop","paddingTop","display","justifyContent","marginLeft","settings","onKeyDown","onInput","href","deleteSong","removeSong","ComposerSettings","settingVesion","songSetting","layer2","layer3","beatMarks","columnsPerCanvas","caveMode","autosave","backgroundImage","syncTabs","MainPageSettings","approachSpeed","Instrument","String","newVolume","volumeNode","gain","deleted","player","createBufferSource","buffer","buffers","connect","playbackRate","onended","stop","disconnect","load","emptyBuffer","createBuffer","sampleRate","requests","url","arrayBuffer","decodeAudioData","catch","all","loaded","node","delete","createGain","instrumentData","noteNames","mobile","NoteData","ArrayBuffer","AudioRecorder","createMediaStreamDestination","MediaRecorder","recorder","stream","MediaRecorderPolyfill","toUrl","URL","createObjectURL","once","urlBlob","anchor","toWav","blobToAudio","wav","blob","Blob","DataView","fileReader","onloadend","audioBuffer","readAsArrayBuffer","asyncPrompt","question","container","cancel","ok","input","innerText","append","disposed","inputListener","classList","add","cancelListener","dispose","okListener","focus","asyncConfirm","blur","App","loadInstrument","loadReverb","toggleReverbNodes","thereIsSong","toggleRecord","resetDrag","isDragging","handleDragOver","handleDrag","handleDrop","from","dataTransfer","files","hasReverb","mounted","reverbNode","destination","updateSettings","getSettings","storedSettings","localStorage","newInstrument","isLoadingInstrument","isRecording","handleRecording","setItem","setting","syncSongs","dbCol","toArray","songExists","findOne","insert","recording","askForSongName","promptString","toggleRecordAudio","isRecordingAudio","reverbVolumeNode","db","ZangoDb","Db","collection","r","b","impulse_response","convolver","createConvolver","gainNode","keyboardFunctions","keyboardData","menuFunctions","menuData","AppButton","active","isInTwa","referrer","setIfInTWA","useDebounce","debouncedValue","setDebouncedValue","useEffect","handler","clearTimeout","Track","editTrack","dataShown","setDataShown","textAlign","family","cursor","numberOfAccidentals","numberOfOutOfRange","MidiImport","handleFile","midi","Midi","header","tempos","keySignatures","tracks","track","offset","convertMidi","includeAccidentals","outOfRange","totalNotes","midiNote","convertedNote","isAccidental","convertMidiNote","sort","groupedNotes","elapsedTime","emptyColumns","noteColumn","number","numberToLayer","groupByIndex","group","final","join","mergeLayers","lastColumn","selectedColumn","loadSong","accidentals","command","changeOffset","parseInt","changePitch","toggleAccidentals","changeBpm","changeMidiVisibility","margin","maxWidth","textOverflow","overflow","marginRight","alignItems","NumberInput","changeValue","step","elementValue","setElementValue","debounced","ComposerTools","toggleTools","copyColumns","eraseColumns","pasteColumns","deleteColumns","copiedColumns","currentTarget","ComposerNote","next","prev","canRender","layers","clickAction","MultiSwitch","selectedColor","buttonsClass","onSelect","ComposerKeyboard","notesIndexes","currentColumn","hiddenSideMenu","isPlaying","changeLayer","handleTempoChanger","toString","ComposerCache","timelineHeight","destroy","app","generate","canvas","drawColumn","toDataURL","standardColumn","standard","standardLarger","roundNess","noteWidth","noteHeight","ctx","getContext","fillStyle","roundRect","strokeStyle","lineWidth","beginPath","ballHeight","arc","PI","columnsLarger","breakpoint","moveTo","lineTo","notesFigures","PIXI","borderWidth","fillRect","stroke","y","x","radius","tl","tr","br","bl","defaultRadius","side","quadraticCurveTo","closePath","NumOfColumnsPerCanvas","ComposerCanvas","resetPointerDown","stageSelected","sliderSelected","stagePreviousPositon","handleBreakpoints","handleWheel","deltaY","selectColumn","global","totalWidth","relativePos","handleStageSlide","throttleStage","isMovingLeft","ceil","abs","toAdd","finalPos","direction","v","handleSlide","sizes","getBoundingClientRect","parentWidth","nearestEven","screen","currentBreakpoint","canvasRef","React","createRef","current","_canvas","s","xPos","switcher","counter","counterLimit","relativeColumnWidth","stageSize","stagePosition","raf","renderOnComponentChange","ref","interactive","pointerdown","pointermove","pos","currentPos","boundaries","isVisible","tempoChangersCache","standardBg","backgroundCache","isToolsSelected","toolsColumns","isSelected","isBreakpoint","antialias","autoDensity","pointertap","pointerup","draw","g","clear","beginFill","drawRect","fillX","image","lineStyle","drawRoundedRect","drawStage","toggleBreakpoint","interactiveChildren","alpha","zIndex","num","round","toggleMenuVisible","updateSong","createNewSong","songFunctions","hasUnsaved","menuClass","menuOpen","currentSong","startRecordingAudio","Composer","promises","setupAudioDestination","handleAutoSave","changes","ins","togglePlay","letter","broadcastChannel","postMessage","nextLayer","removeColumns","addColumns","layerIndex","replaceAt","currentNote","askForSongUpdate","confirm","songColumns","msPerBPM","handleTick","newIndex","indexOfBreakpoint","validateBreakpoints","page","ignoreAudio","toolsVisible","copiedColums","copiedColumn","copiedNote","columnIndex","visibility","midiVisible","playbackInterval","BroadcastChannel","onmessage","location","hostname","returnValue","close","canvasFunctions","canvasData","toolsData","toolsFunctions","midiParserFunctions","midiParserData","addCell","removeCell","formatMillis","calculateLength","millis","minutes","seconds","end","totalLength","string","replacement","valueOf","substring","SimpleMenu","rel","ErrorPage","deleteAllSongs","resetSettings","removeItem","Changelogpage","changelogs","ChangelogRow","item","arr","Partners","Partner","description","Iframe","PartnerImg","img","WindsongDBImg","to","borderRadius","objectFit","frameBorder","allow","allowFullScreen","Home","askForStorage","hasVisited","homeClass","isInPosition","innerWidth","toggleHome","hasPersistentStorage","MainContentelement","icon","Separator","PageRedirect","setDontShowHome","canShow","readOnly","Help","fontSize","isLocalhost","Boolean","match","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","FloatingMessage","classes","Donate","paypalImg","buyMeACoffeeImg","Index","homeData","selectedPage","homeVisible","lastState","closeWelcomeScreen","hideMessage","floatingMessage","checkUpdate","updateChecked","storedVersion","logEvent","path","canShowHome","exact","rotateImg","ReactDOM","render","StrictMode","getElementById","origin","headers","response","contentType","get","ready","unregister","reload","checkValidServiceWorker","serviceWorkerRegistration"],"mappings":"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","file":"static/js/main.67a6f1d3.chunk.js","sourcesContent":["const appName = process.env.REACT_APP_NAME || [\"Sky\",\"Genshin\"][1]\r\nconst appVersion = '2.1.1'\r\nconsole.log(`${appName}-V${appVersion}`)\r\nconst updateMessage = appName === 'Genshin' \r\n    ? ` - Added help page\r\n        - Added note icons\r\n        - Added back practice animation\r\n        - Changed zither sounds\r\n        - Fixed bugs and UI issues\r\n    `.trim()\r\n    : ` - Added help page\r\n        - Added back practice animation\r\n        - Fixed bugs and UI issues\r\n    `.trim()\r\n\r\nconst pages = [\"\", \"Composer\", \"ErrorPage\", \"Changelog\",\"Donate\", \"Partners\",\"Home\",\"Help\"]\r\n\r\nconst cssClasses = {\r\n    noteComposer: appName === \"Genshin\" ? \"note-composer\" : \"note-composer-sky\",\r\n    note: appName === \"Genshin\" ? \"note\" : \"note-sky\",\r\n    noteAnimation: appName === 'Genshin' ? \"note-animation\" : \"note-animation-sky\",\r\n    approachCircle: appName === \"Genshin\" ? \"approach-circle\" : \"approach-circle-sky\",\r\n    noteName: appName === \"Genshin\" ? \"note-name\" : \"note-name-sky\"\r\n}\r\nconst audioContext = new (window.AudioContext || window.webkitAudioContext)()\r\n\r\nconst instruments = appName === \"Genshin\" \r\n    ? [\r\n        \"Lyre\",\r\n        \"Zither\",\r\n        \"Old-Zither\",\r\n        \"DunDun\"\r\n   ]:[\r\n        \"Piano\",\r\n        \"Contrabass\",\r\n        \"Guitar\",\r\n        \"Harp\",\r\n        \"Horn\",\r\n        \"Trumpet\",\r\n        \"Pipa\",\r\n        \"WinterPiano\",\r\n        \"Xylophone\",\r\n        \"Flute\",\r\n        \"Ocarina\",\r\n        \"Kalimba\",\r\n        \"ToyUkulele\",\r\n        \"Drum\",\r\n        \"Bells\",\r\n        \"DunDun\",\r\n        \"HandPan\"\r\n    ]\r\nconst notesPerColumn = appName === \"Genshin\" ? 21 : 15\r\nconst instrumentsData = {\r\n    Lyre: {\r\n        notes: 21\r\n    },\r\n    Zither:{\r\n        notes: 21,\r\n        effects: {\r\n            filter: 'sepia(100%)',\r\n        },\r\n        clickColor: '#ddcba8'\r\n    },\r\n    \"Old-Zither\":{\r\n        notes: 21,\r\n        effects: {\r\n            filter: 'sepia(100%)',\r\n        },\r\n        clickColor: '#ddcba8'\r\n    },\r\n    DunDun: {\r\n        notes: 8\r\n    },\r\n    Bells: {\r\n        notes: 8\r\n    },\r\n    Trumpet:{\r\n        notes: 15\r\n    },\r\n    Contrabass: {\r\n        notes: 15\r\n    },\r\n    Drum: {\r\n        notes: 8\r\n    },\r\n    Flute: {\r\n        notes: 15\r\n    },\r\n    Guitar: {\r\n        notes: 15\r\n    },\r\n    HandPan: {\r\n        notes: 8\r\n    },\r\n    ToyUkulele:{\r\n        notes:15\r\n    },\r\n    Harp: {\r\n        notes: 15\r\n    },\r\n    Horn: {\r\n        notes: 15\r\n    },\r\n    Piano: {\r\n        notes: 15\r\n    },\r\n    Pipa: {\r\n        notes: 15\r\n    },\r\n    Kalimba: {\r\n        notes: 15\r\n    },\r\n    WinterPiano: {\r\n        notes: 15\r\n    },\r\n    Xylophone: {\r\n        notes: 15\r\n    },\r\n    Ocarina:{\r\n        notes:15\r\n    }\r\n}\r\n\r\n\r\nconst layoutData = {\r\n    21: {\r\n        keyboardLayout: (\"Q W E R T Y U \" +\r\n            \"A S D F G H J \" +\r\n            \"Z X C V B N M\").split(\" \"),\r\n\r\n        mobileLayout: (\"do re mi fa so la ti \" +\r\n            \"do re mi fa so la ti \" +\r\n            \"do re mi fa so la ti\").split(\" \"),\r\n\r\n        keyboardCodes: (\"81 87 69 82 84 89 85 \" +\r\n            \"65 83 68 70 71 72 74 \" +\r\n            \"90 88 67 86 66 78 77\").split(\" \")\r\n    },\r\n    8: {\r\n        keyboardLayout: (\"Q W E R \" +\r\n            \"A S D F\").split(\" \"),\r\n\r\n        mobileLayout: (\"do re mi fa \" +\r\n            \"do re mi fa\").split(\" \"),\r\n\r\n        keyboardCodes: (\"81 87 69 82 \" +\r\n        \"65 83 68 70\").split(\" \")\r\n    },\r\n    15: {\r\n        keyboardLayout: (\"Q W E R T \" +\r\n            \"A S D F G \" +\r\n            \"Z X C V B\").split(\" \"),\r\n\r\n        mobileLayout: (\"do re mi fa so \" +\r\n            \"do re mi fa so \" +\r\n            \"do re mi fa so\").split(\" \"),\r\n\r\n        keyboardCodes: (\"81 87 69 82 84 \" +\r\n            \"65 83 68 70 71 \" +\r\n            \"90 88 67 86 66\").split(\" \")\r\n    }\r\n}\r\n\r\nconst keyNames = {\r\n    Sky: {\r\n        0: [\"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\", \"C\"],\r\n        1: [\"Db\", \"Eb\", \"F\", \"Gb\", \"Ab\", \"Bb\", \"C\", \"Db\", \"Eb\", \"F\", \"Gb\", \"Ab\", \"Bb\", \"C\", \"Db\"],\r\n        2: [\"D\", \"E\", \"F#\", \"G\", \"A\", \"B\", \"C#\", \"D\", \"E\", \"F#\", \"G\", \"A\", \"B\", \"C#\", \"D\"],\r\n        3: [\"Eb\", \"F\", \"G\", \"Ab\", \"Bb\", \"C\", \"D\", \"Eb\", \"F\", \"G\", \"Ab\", \"Bb\", \"C\", \"D\", \"Eb\"],\r\n        4: [\"E\", \"F#\", \"G#\", \"A\", \"B\", \"C#\", \"D#\", \"E\", \"F#\", \"G#\", \"A\", \"B\", \"C#\", \"D#\", \"E\"],\r\n        5: [\"F\", \"G\", \"A\", \"Bb\", \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"Bb\", \"C\", \"D\", \"E\", \"F\"],\r\n        6: [\"Gb\", \"Ab\", \"Bb\", \"Cb\", \"Db\", \"Eb\", \"F\", \"Gb\", \"Ab\", \"Bb\", \"Cb\", \"Db\", \"Eb\", \"F\", \"Gb\"],\r\n        7: [\"G\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F#\", \"G\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F#\", \"G\"],\r\n        8: [\"Ab\", \"Bb\", \"C\", \"Db\", \"Eb\", \"F\", \"G\", \"Ab\", \"Bb\", \"C\", \"Db\", \"Eb\", \"F\", \"G\", \"Ab\"],\r\n        9: [\"A\", \"B\", \"C#\", \"D\", \"E\", \"F#\", \"G#\", \"A\", \"B\", \"C#\", \"D\", \"E\", \"F#\", \"G#\", \"A\"],\r\n        10: [\"Bb\", \"C\", \"D\", \"Eb\", \"F\", \"G\", \"A\", \"Bb\", \"C\", \"D\", \"Eb\", \"F\", \"G\", \"A\", \"Bb\"],\r\n        11: [\"B\", \"C#\", \"D#\", \"E\", \"F#\", \"G#\", \"A#\", \"B\", \"C#\", \"D#\", \"E\", \"F#\", \"G#\", \"A#\", \"B\"]\r\n    },\r\n    Genshin:{\r\n        0: [\"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\"],\r\n        1: [\"Db\", \"Eb\", \"F\", \"Gb\", \"Ab\", \"Bb\", \"C\", \"Db\", \"Eb\", \"F\", \"Gb\", \"Ab\", \"Bb\", \"C\", \"Db\" , \"Eb\", \"F\", \"Gb\", \"Ab\", \"Bb\", \"C\", \"Db\"],\r\n        2: [\"D\", \"E\", \"F#\", \"G\", \"A\", \"B\", \"C#\", \"D\", \"E\", \"F#\", \"G\", \"A\", \"B\", \"C#\", \"D\", \"E\", \"F#\", \"G\", \"A\", \"B\", \"C#\", \"D\"],\r\n        3: [\"Eb\", \"F\", \"G\", \"Ab\", \"Bb\", \"C\", \"D\", \"Eb\", \"F\", \"G\", \"Ab\", \"Bb\", \"C\", \"D\", \"Eb\", \"F\", \"G\", \"Ab\", \"Bb\", \"C\", \"D\", \"Eb\"],\r\n        4: [\"E\", \"F#\", \"G#\", \"A\", \"B\", \"C#\", \"D#\", \"E\", \"F#\", \"G#\", \"A\", \"B\", \"C#\", \"D#\", \"E\", \"F#\", \"G#\", \"A\", \"B\", \"C#\", \"D#\", \"E\"],\r\n        5: [\"F\", \"G\", \"A\", \"Bb\", \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"Bb\", \"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"Bb\", \"C\", \"D\", \"E\", \"F\"],\r\n        6: [\"Gb\", \"Ab\", \"Bb\", \"Cb\", \"Db\", \"Eb\", \"F\", \"Gb\", \"Ab\", \"Bb\", \"Cb\", \"Db\", \"Eb\", \"F\", \"Gb\", \"Ab\", \"Bb\", \"Cb\", \"Db\", \"Eb\", \"F\", \"Gb\"],\r\n        7: [\"G\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F#\", \"G\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F#\", \"G\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F#\", \"G\"],\r\n        8: [\"Ab\", \"Bb\", \"C\", \"Db\", \"Eb\", \"F\", \"G\", \"Ab\", \"Bb\", \"C\", \"Db\", \"Eb\", \"F\", \"G\", \"Ab\", \"Bb\", \"C\", \"Db\", \"Eb\", \"F\", \"G\", \"Ab\"],\r\n        9: [\"A\", \"B\", \"C#\", \"D\", \"E\", \"F#\", \"G#\", \"A\", \"B\", \"C#\", \"D\", \"E\", \"F#\", \"G#\", \"A\", \"B\", \"C#\", \"D\", \"E\", \"F#\", \"G#\", \"A\"],\r\n        10: [\"Bb\", \"C\", \"D\", \"Eb\", \"F\", \"G\", \"A\", \"Bb\", \"C\", \"D\", \"Eb\", \"F\", \"G\", \"A\", \"Bb\", \"C\", \"D\", \"Eb\", \"F\", \"G\", \"A\", \"Bb\"],\r\n        11: [\"B\", \"C#\", \"D#\", \"E\", \"F#\", \"G#\", \"A#\", \"B\", \"C#\", \"D#\", \"E\", \"F#\", \"G#\", \"A#\", \"B\", \"C#\", \"D#\", \"E\", \"F#\", \"G#\", \"A#\", \"B\"]\r\n    }\r\n}\r\nconst speedChangers = [0.25,0.5,0.75,1,1.25,1.5,2].map(e => {\r\n    return {\r\n        name: `x${e}`,\r\n        value: e\r\n    }\r\n})\r\n\r\nconst pitchArr = [\"C\", \"Db\", \"D\", \"Eb\", \"E\", \"F\", \"Gb\", \"G\", \"Ab\", \"A\", \"Bb\", \"B\"] \r\n\r\nconst composerNotePositions =  appName === \"Genshin\" ? [14, 15, 16, 17, 18, 19, 20, 7, 8, 9, 10, 11, 12, 13, 0, 1, 2, 3, 4, 5, 6].reverse() : [15,16,17,18,19,20,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14].reverse()\r\n\r\nconst importNotePositions = appName === \"Genshin\" ? [14, 15, 16, 17, 18, 19, 20, 7, 8, 9, 10, 11, 12, 13, 0] :  [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]\r\n\r\nconst layoutImages = {\r\n    15: \"dmcr dm cr dm cr cr dm dmcr dm cr cr dm cr dm dmcr\".split(\" \"),\r\n    8: appName === \"Sky\"? \"cr dm cr dm cr dm cr dm\".split(\" \") : \"do re mi fa do re mi fa\".split(\" \"),\r\n    21: \"do re mi fa so la ti do re mi fa so la ti do re mi fa so la ti\".split(\" \")\r\n}\r\n\r\nconst cacheData = {\r\n    noteData: {\r\n        background: \"#d3bd8e\",\r\n        border: \"#de4545\",\r\n        center: \"#de4545\"\r\n    },\r\n    horizontalLineBreak: notesPerColumn / 3,\r\n    standards: [\r\n        {\r\n            color: 0x515c6f //lighter\r\n        },\r\n        {\r\n            color: 0x485363 //darker\r\n        },\r\n        {\r\n            color: 0x1a968b //selected\r\n        },\r\n        {\r\n            color: 0xd6722f\r\n        }\r\n    ],\r\n    layersCombination: [\"000\", \"001\", \"010\", \"011\", \"100\", \"101\", \"110\", \"111\"],\r\n    breakpoints: [\r\n        {\r\n            type: \"short\",\r\n            color: \"#282875\"\r\n        },\r\n        {\r\n            type: \"long\",\r\n            color: \"#282875\"\r\n        }\r\n    ]\r\n}\r\n\r\n\r\nfunction isTwa() {\r\n    let isTwa = JSON.parse(sessionStorage.getItem('isTwa'))\r\n    return isTwa\r\n}\r\nexport {\r\n    instruments,\r\n    instrumentsData,\r\n    composerNotePositions,\r\n    importNotePositions,\r\n    appName,\r\n    layoutData,\r\n    cssClasses,\r\n    notesPerColumn,\r\n    keyNames,\r\n    pitchArr,\r\n    layoutImages,\r\n    appVersion,\r\n    speedChangers,\r\n    audioContext,\r\n    pages,\r\n    isTwa,\r\n    cacheData,\r\n    updateMessage\r\n}","export default function NoteBorder(props) {\r\n    const { fill, className } = props\r\n    return <svg\r\n        width=\"156mm\"\r\n        height=\"156mm\"\r\n        className={className}\r\n        viewBox=\"0 0 156 156\"\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        style={{ fill: fill || '#eae5ce' }}\r\n    >\r\n        <path\r\n            d=\"M 78.00026,10.550111 C 51.476969,10.181626 25.897505,27.22936 15.85058,51.745551 5.361171,75.829889 10.788685,105.74811 29.175285,124.53663 46.865842,143.57562 76.01089,150.52219 100.41467,141.63611 125.70972,133.0432 144.35989,108.19482 145.36211,81.471209 147.04137,55.492614 131.98362,29.525813 108.70692,17.929174 99.25071,13.06968 88.62966,10.533948 78.00026,10.550111 Z m 0,0.140044 c 2.58037,3.675401 5.16075,7.3508 7.74113,11.026201 24.63414,2.976727 45.57649,23.919913 48.5469,48.555693 3.66955,2.57607 7.33909,5.15214 11.00864,7.72821 -3.6711,2.57728 -7.34219,5.15455 -11.01328,7.73183 -2.97314,24.642991 -23.92605,45.594011 -48.5712,48.558271 -2.57073,3.66162 -5.14146,7.32324 -7.71219,10.98486 -2.57073,-3.66162 -5.141461,-7.32324 -7.712192,-10.98486 -24.643357,-2.96412 -45.595396,-23.91214 -48.570678,-48.553111 -3.673332,-2.57899 -7.346667,-5.15799 -11.019999,-7.73699 3.677467,-2.58193 7.354932,-5.16386 11.0324,-7.74578 2.977996,-24.622822 23.903746,-45.560994 48.529337,-48.537607 2.580378,-3.675573 5.160752,-7.351144 7.741132,-11.026717 z\"\r\n        />\r\n    </svg>\r\n}","import React, { Component } from 'react'\r\nimport { cssClasses, appName, instrumentsData } from \"appConfig\"\r\nimport GenshinNoteBorder from 'components/GenshinNoteBorder'\r\nclass Note extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n        }\r\n        //TODO convert this into functional component\r\n    }\r\n    render() {\r\n        const { props } = this\r\n        const { data, approachingNotes,outgoingAnimation, fadeTime} = props\r\n        const { status , approachRate, instrument} = data\r\n        let animation = { \r\n            transition: `\r\n                    background-color ${props.fadeTime}ms \r\n                    ${fadeTime === (appName === 'Genshin' ? 100 : 200) ? 'ease' : 'linear'}\r\n                    , transform 0.15s\r\n                    border-color 100ms\r\n            ` \r\n        }\r\n        let className = parseClass(status)\r\n        let effects = instrumentsData[instrument]?.effects || {}\r\n        let clickColor = instrumentsData[instrument]?.clickColor \r\n        return <button\r\n            onPointerDown={(e) => {\r\n                e.preventDefault()\r\n                props.handleClick(data)\r\n            }}\r\n            className=\"button-hitbox-bigger\"\r\n        >\r\n            {approachingNotes.map((note) => {\r\n                return <ApproachCircle\r\n                    key={note.id}\r\n                    index={data.index}\r\n                    approachRate={approachRate}\r\n                />\r\n            })}\r\n            {outgoingAnimation.map(e => {\r\n                return <div \r\n                    key={e.key}\r\n                    className={cssClasses.noteAnimation}\r\n                />\r\n            })}\r\n            <div \r\n                className={className} \r\n                style={{\r\n                    ...animation,\r\n                    ...(clickColor && status === 'clicked' ? {backgroundColor: clickColor} : {})\r\n                }}\r\n            >\r\n                <img\r\n                    draggable=\"false\"\r\n                    alt=''\r\n                    src={props.noteImage}\r\n                    style={effects}\r\n                />\r\n                {appName === 'Genshin' && <GenshinNoteBorder\r\n                    className='genshin-border'\r\n                    fill={parseBorderFill(status)}\r\n                />}\r\n                <div className={cssClasses.noteName}>\r\n                    {props.noteText}\r\n                </div>\r\n            </div>\r\n        </button>\r\n    }\r\n}\r\nfunction getApproachCircleColor(index){\r\n    let numOfNotes = appName === \"Sky\" ? 5 : 7\r\n    let row = Math.floor(index / numOfNotes)\r\n    let colors = [\"#3da399\",\"#ffb347\",\"#3da399\"]\r\n    return colors[row]\r\n}\r\nfunction ApproachCircle(props) {\r\n    return <div\r\n        className={cssClasses.approachCircle}\r\n        style={{ \r\n            animation: `approach ${props.approachRate}ms linear`,\r\n            borderColor:getApproachCircleColor(props.index),\r\n        }}\r\n    >\r\n    </div>\r\n}\r\nfunction parseBorderFill(status){\r\n    let fill = '#eae5ce'\r\n    if(status === \"clicked\") fill = \"transparent\"\r\n    else if(status === 'toClickNext' || status === 'toClickAndNext') fill = '#63aea7'\r\n    return fill\r\n}\r\nfunction parseClass(status) {\r\n    let className = cssClasses.note\r\n    switch(status){\r\n    \tcase 'clicked': className += \" click-event\"; break;\r\n        case  'toClick': className += \" note-red\"; break;\r\n        case  'toClickNext': className += \" note-border-click\"; break;\r\n        case  'toClickAndNext': className += \" note-red note-border-click\"; break;\r\n        case 'approach-wrong': className += \" click-event approach-wrong\"; break;\r\n        case 'approach-correct': className += \" click-event approach-correct\"; break;\r\n        default: break;\r\n    }\r\n    return className\r\n}\r\nexport default Note","import { observable } from \"mobx\";\r\nexport const songStore = observable({\r\n    data: {\r\n        song: {},\r\n        eventType: '',\r\n        start: 0\r\n    }\r\n})","import { importNotePositions, appName, instruments, pitchArr } from \"appConfig\"\r\nimport * as workerTimers from 'worker-timers';\r\nclass Recording {\r\n\tconstructor() {\r\n\t\tthis.start = new Date().getTime()\r\n\t\tthis.notes = []\r\n\t}\r\n\tinit = () => {\r\n\t\tthis.start = new Date().getTime() - 100\r\n\t\tconsole.log(\"Started new recording\")\r\n\t}\r\n\taddNote = (index) => {\r\n\t\tif (this.notes.length === 0) this.init()\r\n\t\tlet currentTime = new Date().getTime()\r\n\t\tlet note = [index, currentTime - this.start]\r\n\t\tthis.notes.push(note)\r\n\t}\r\n}\r\n\r\nclass Song {\r\n\tconstructor(name, notes = [], data = {}) {\r\n\t\tthis.name = name\r\n\t\tthis.version = 1\r\n\t\tthis.notes = notes\r\n\t\tthis.bpm = 220\r\n\t\tthis.pitch = \"C\"\r\n\t\tthis.data = {\r\n\t\t\tisComposed: false,\r\n\t\t\tisComposedVersion: false,\r\n\t\t\tappName: appName\r\n\t\t}\r\n\t\tObject.entries(data).forEach((entry) => {\r\n\t\t\tthis.data[entry[0]] = entry[1]\r\n\t\t})\r\n\t}\r\n}\r\n\r\nclass LoggerEvent {\r\n\tconstructor(title, text, timeout) {\r\n\t\tthis.title = title\r\n\t\tthis.timeout = timeout\r\n\t\tthis.text = text\r\n\t\tif (timeout === undefined) this.timeout = 3000\r\n\t\tthis.event = new CustomEvent(\"logEvent\", {\r\n\t\t\tdetail: {\r\n\t\t\t\ttitle: this.title,\r\n\t\t\t\ttext: this.text,\r\n\t\t\t\ttimeout: this.timeout\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\ttrigger = () => {\r\n\t\twindow.dispatchEvent(this.event)\r\n\t}\r\n}\r\n\r\nclass NoteData {\r\n\tconstructor(index, noteNames, url) {\r\n\t\tthis.index = index\r\n\t\tthis.noteNames = noteNames\r\n\t\tthis.url = url\r\n\t\tthis.buffer = new ArrayBuffer(8)\r\n\t\tthis.clicked = false\r\n\t}\r\n}\r\n\r\nclass PlayingSong {\r\n\tconstructor(notes) {\r\n\t\tthis.timestamp = new Date().getTime()\r\n\t\tthis.notes = notes\r\n\t}\r\n}\r\n\r\nclass FileDownloader {\r\n\tconstructor(type) {\r\n\t\tif (type === undefined) type = \"text/json\"\r\n\t\tthis.dataType = \"data:\" + type + \";charset=utf-8,\"\r\n\t}\r\n\tdownload = (file, name) => {\r\n\t\tlet data = this.dataType + encodeURIComponent(file)\r\n\t\tvar el = document.createElement(\"a\")\r\n\t\tel.style = \"display:none\"\r\n\t\tdocument.body.appendChild(el)\r\n\t\tel.setAttribute(\"href\", data)\r\n\t\tel.setAttribute(\"download\", name)\r\n\t\tel.click();\r\n\t\tel.remove();\r\n\t}\r\n}\r\n\r\nconst TempoChangers = [\r\n\t{\r\n\t\tid: 0,\r\n\t\ttext: \"1\",\r\n\t\tchanger: 1,\r\n\t\tcolor: 0x515c6f\r\n\t}, {\r\n\t\tid: 1,\r\n\t\ttext: \"1/2\",\r\n\t\tchanger: 1 / 2,\r\n\t\tcolor: 0x517553\r\n\t}, {\r\n\t\tid: 2,\r\n\t\ttext: \"1/4\",\r\n\t\tchanger: 1 / 4,\r\n\t\tcolor: 0x434c7d\r\n\t}, {\r\n\t\tid: 3,\r\n\t\ttext: \"1/8\",\r\n\t\tchanger: 1 / 8,\r\n\t\tcolor: 0x774D6D\r\n\t}\r\n]\r\n\r\nclass ComposedSong {\r\n\tconstructor(name, notes = [], data = {}) {\r\n\t\tdata.isComposed = true\r\n\t\tdata.isComposedVersion = true\r\n\t\tthis.version = 1\r\n\t\tthis.data = data\r\n\t\tthis.name = name\r\n\t\tthis.bpm = 220\r\n\t\tthis.pitch = \"C\"\r\n\t\tthis.notes = notes\r\n\t\tthis.instruments = [instruments[0], instruments[0], instruments[0]]\r\n\t\tthis.breakpoints = [0]\r\n\t\tthis.columns = []\r\n\t\tthis.selected = 0\r\n\t\tnew Array(100).fill().forEach((e) => {\r\n\t\t\tlet column = new Column()\r\n\t\t\tcolumn.tempoChanger = 0\r\n\t\t\tthis.columns.push(column)\r\n\t\t})\r\n\t}\r\n}\r\n\r\nfunction NotesTable(length){\r\n\treturn new Array(length).fill().map(() => {return []})\r\n}\r\n\r\nfunction ComposerSongDeSerialization(song) {\r\n\tlet obj = {\r\n\t\tdata: song.data,\r\n\t\tname: song.name,\r\n\t\tbpm: song.bpm ?? 220,\r\n\t\tpitch: song.pitch ?? \"C\",\r\n\t\tinstruments: song.instruments || [instruments[0], instruments[0], instruments[0]],\r\n\t\tbreakpoints: song.breakpoints ?? [],\r\n\t\tnotes: [],\r\n\t\tselected: 0,\r\n\t\tcolumns: []\r\n\t}\r\n\tsong.columns.forEach(column => {\r\n\t\tlet columnObj = new Column()\r\n\t\tcolumnObj.tempoChanger = column[0]\r\n\t\tcolumn[1].forEach(note => {\r\n\t\t\tcolumnObj.notes.push(new ColumnNote(note[0], note[1]))\r\n\t\t})\r\n\t\tobj.columns.push(columnObj)\r\n\t})\r\n\treturn obj\r\n}\r\n\r\nfunction ComposerToRecording(song) {\r\n\tlet recordedSong = new Song(song.name)\r\n\tlet bpmPerMs = Math.floor(60000 / song.bpm)\r\n\tlet totalTime = 100\r\n\tsong.columns.forEach(column => {\r\n\t\tcolumn[1].forEach(note => {\r\n\t\t\trecordedSong.notes.push([note[0], totalTime])\r\n\t\t})\r\n\t\ttotalTime += Math.floor(bpmPerMs * TempoChangers[column[0]].changer)\r\n\t})\r\n\treturn recordedSong\r\n}\r\n\r\nfunction ComposerSongSerialization(song) {\r\n\tlet obj = {\r\n\t\tdata: song.data,\r\n\t\tname: song.name,\r\n\t\tbpm: song.bpm,\r\n\t\tpitch: song.pitch,\r\n\t\tbreakpoints: song.breakpoints,\r\n\t\tinstruments: song.instruments,\r\n\t\tcolumns: []\r\n\t}\r\n\tobj.data.appName = appName\r\n\t/*\r\n\t\tnotes = [tempoChanger,notes] ----> note = [index,layer]\r\n\t\ttempoChanger = Number\r\n\t*/\r\n\tsong.columns.forEach(column => {\r\n\t\tlet columnArr = [column.tempoChanger]\r\n\t\tlet notes = column.notes.map(note => {\r\n\t\t\treturn [note.index, note.layer]\r\n\t\t})\r\n\t\tcolumnArr[1] = notes\r\n\t\tobj.columns.push(columnArr)\r\n\t})\r\n\treturn obj\r\n}\r\n\r\nfunction prepareSongDownload(song) {\r\n\tlet finalSong = JSON.parse(JSON.stringify(song)) //lose reference\r\n\tlet oldFormatNotes = {}\r\n\tif (finalSong.data?.isComposedVersion) {\r\n\t\toldFormatNotes = composedToOldFormat(finalSong)\r\n\t} else {\r\n\t\toldFormatNotes = recordedToOldFormat(finalSong)\r\n\t}\r\n\tfinalSong.isComposed = finalSong.data.isComposedVersion\r\n\tfinalSong.pitchLevel = pitchArr.indexOf(finalSong.pitch)\r\n\tfinalSong.songNotes = oldFormatNotes\r\n\tfinalSong.bitsPerPage = 16\r\n\tfinalSong.isEncrypted = false\r\n\treturn [finalSong] //for compatibility, add back to an array, it will be ignored when importing\r\n}\r\n\r\nfunction prepareSongImport(song) {\r\n\tif (Array.isArray(song) && song.length > 0) song = song[0]\r\n\tlet type = getSongType(song)\r\n\tif (type === \"none\") {\r\n\t\tnew LoggerEvent(\"Error\", \"Invalid song\").trigger()\r\n\t\tthrow new Error(\"Error Invalid song\")\r\n\t}\r\n\tif (type === \"oldSky\") {\r\n\t\tsong = oldSkyToNewFormat(song)\r\n\t}\r\n\tif (appName === 'Sky' && song.data?.appName !== 'Sky') {\r\n\t\tnew LoggerEvent(\"Error\", \"Invalid song\").trigger()\r\n\t\tthrow new Error(\"Error Invalid song\")\r\n\t}\r\n\tif (appName === 'Genshin' && song.data?.appName === 'Sky') {\r\n\t\tsong = newSkyFormatToGenshin(song)\r\n\t}\r\n\treturn song\r\n}\r\n\r\nfunction composedToOldFormat(song) {\r\n\tlet convertedNotes = []\r\n\tlet bpmPerMs = Math.floor(60000 / song.bpm)\r\n\tlet totalTime = 100\r\n\tsong.columns.forEach(column => {\r\n\t\tcolumn[1].forEach(note => {\r\n\t\t\tlet layer = 1\r\n\t\t\tif (note[1] === '111') layer = 3\r\n\t\t\tif (note[1] === '011') layer = 2\r\n\t\t\tif (note[1] === '101') layer = 3\r\n\t\t\tif (note[1] === '001') layer = 2\r\n\t\t\tif (note[1] === '110') layer = 3\r\n\t\t\tif (note[1] === '010') layer = 2\r\n\t\t\tif (note[1] === '100') layer = 1\r\n\t\t\tlet noteObj = {\r\n\t\t\t\tkey: (layer > 2 ? 2 : layer) + 'Key' + note[0],\r\n\t\t\t\ttime: totalTime\r\n\t\t\t}\r\n\t\t\tif (layer > 2) noteObj.l = 3\r\n\t\t\tconvertedNotes.push(noteObj)\r\n\t\t})\r\n\t\ttotalTime += Math.floor(bpmPerMs * TempoChangers[column[0]].changer)\r\n\t})\r\n\treturn convertedNotes\r\n}\r\n\r\nfunction recordedToOldFormat(song) {\r\n\tlet convertedNotes = []\r\n\tsong.notes.forEach(note => {\r\n\t\tconvertedNotes.push({\r\n\t\t\ttime: note[1],\r\n\t\t\tkey: \"1Key\" + note[0]\r\n\t\t})\r\n\t})\r\n\treturn convertedNotes\r\n}\r\n\r\nfunction getSongType(song) {\r\n\ttry {\r\n\t\tif (song.data === undefined) {\r\n\t\t\t//oldSky format\r\n\t\t\tsong.pitchLevel = song.pitchLevel || 0\r\n\t\t\tif (song.songNotes !== undefined) {\r\n\t\t\t\treturn \"oldSky\"\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t//current format\r\n\t\t\tif (song.data.isComposedVersion) {\r\n\t\t\t\tif (typeof song.name !== \"string\") return \"none\"\r\n\t\t\t\tif (typeof song.bpm !== \"number\") return \"none\"\r\n\t\t\t\tif (!pitchArr.includes(song.pitch)) return \"none\"\r\n\t\t\t\tif (Array.isArray(song.breakpoints)) {\r\n\t\t\t\t\tif (song.breakpoints.length > 0) {\r\n\t\t\t\t\t\tif (typeof song.breakpoints[0] !== \"number\") return \"none\"\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \"none\"\r\n\t\t\t\t}\r\n\t\t\t\tif (Array.isArray(song.columns)) {\r\n\t\t\t\t\tif (song.columns.length > 0) {\r\n\t\t\t\t\t\tlet column = song.columns[0]\r\n\t\t\t\t\t\tif (typeof column[0] !== \"number\") return \"none\"\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \"none\"\r\n\t\t\t\t}\r\n\t\t\t\treturn \"newComposed\"\r\n\t\t\t} else {\r\n\t\t\t\tif (typeof song.name !== \"string\") return \"none\"\r\n\t\t\t\tif (typeof song.bpm !== \"number\") return \"none\"\r\n\t\t\t\tif (!pitchArr.includes(song.pitch)) return \"none\"\r\n\t\t\t\treturn \"newRecorded\"\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} catch (e) {\r\n\t\tconsole.log(e)\r\n\t\treturn \"none\"\r\n\t}\r\n\treturn \"none\"\r\n}\r\n\r\nconst genshinLayout = importNotePositions\r\n\r\nfunction newSkyFormatToGenshin(song) {\r\n\tif (song.data.isComposedVersion) {\r\n\t\tsong.instruments = song.instruments.map(instrument => 'Lyre')\r\n\t\tsong.columns.forEach(column => {\r\n\t\t\tcolumn[1] = column[1].map(note => {\r\n\t\t\t\treturn [genshinLayout[note[0]], note[1]]\r\n\t\t\t})\r\n\r\n\t\t})\r\n\t}\r\n\tif (!song.data.isComposedVersion) {\r\n\t\tsong.notes = song.notes.map(note => {\r\n\t\t\tnote[0] = genshinLayout[note[0]]\r\n\t\t\treturn note\r\n\t\t})\r\n\t}\r\n\treturn song\r\n}\r\n\r\nfunction oldSkyToNewFormat(song) {\r\n\tlet result = new Song(\"Error\")\r\n\ttry {\r\n\t\tresult = new Song(song.name)\r\n\t\tresult.bpm = song.bpm || 220\r\n\t\tresult.pitch = (pitchArr[song.pitchLevel || 0]) || \"C\"\r\n\t\t//remove duplicate notes\r\n\t\tsong.songNotes = song.songNotes.filter((note, index, self) =>\r\n\t\t\tindex === self.findIndex((n) => {\r\n\t\t\t\treturn n.key.split('Key')[1] === note.key.split('Key')[1] && n.time === note.time\r\n\t\t\t})\r\n\t\t)\r\n\t\tlet songNotes = song.songNotes\r\n\t\tsongNotes.forEach(note => {\r\n\t\t\tlet data = note.key.split(\"Key\")\r\n\t\t\tresult.notes.push([genshinLayout[data[1]], note.time, note.l ?? Number(data[0])])\r\n\t\t})\r\n\r\n\t\tif ([true, \"true\"].includes(song.isComposed)) {\r\n\t\t\tresult = ComposerSongSerialization(RecordingToComposed(result))\r\n\t\t} else {\r\n\t\t\tresult.notes = result.notes.map(e => [e[0], e[1]])\r\n\t\t}\r\n\r\n\r\n\t} catch (e) {\r\n\t\tconsole.log(e)\r\n\t\treturn new Song(\"Error importing song, invalid format\")\r\n\t}\r\n\treturn result\r\n}\r\n\r\nfunction RecordingToComposed(song) {\r\n\tlet bpmToMs = Math.floor(60000 / song.bpm)\r\n\tlet composed = new ComposedSong(song.name, [])\r\n\tcomposed.bpm = song.bpm\r\n\tcomposed.pitch = song.pitch\r\n\tlet notes = song.notes\r\n\t//remove duplicates\r\n\r\n\tlet converted = []\r\n\tlet grouped = groupByNotes(notes, bpmToMs / 9)\r\n\tlet combinations = [bpmToMs, Math.floor(bpmToMs / 2), Math.floor(bpmToMs / 4), Math.floor(bpmToMs / 8)]\r\n\tfor (let i = 0; i < grouped.length; i++) {\r\n\t\tlet column = new Column()\r\n\t\tcolumn.notes = grouped[i].map(note => {\r\n\t\t\tlet columnNote = new ColumnNote(note[0])\r\n\t\t\tif (note[2] === 0) columnNote.layer = \"100\"\r\n\t\t\tif (note[2] === 1) columnNote.layer = \"100\"\r\n\t\t\tif (note[2] === 2) columnNote.layer = \"010\"\r\n\t\t\tif (note[2] === 3) columnNote.layer = \"110\"\r\n\t\t\tif (note[2] === undefined) columnNote.layer = \"100\"\r\n\t\t\treturn columnNote\r\n\t\t})\r\n\t\tlet next = grouped[i + 1] || [[0, 0, 0]]\r\n\t\tlet difference = next[0][1] - grouped[i][0][1]\r\n\t\tlet paddingColumns = []\r\n\t\twhile (difference >= combinations[3]) {\r\n\t\t\tif (difference / combinations[0] >= 1) {\r\n\t\t\t\tdifference -= combinations[0]\r\n\t\t\t\tpaddingColumns.push(0)\r\n\t\t\t} else if (difference / combinations[1] >= 1) {\r\n\t\t\t\tdifference -= combinations[1]\r\n\t\t\t\tpaddingColumns.push(1)\r\n\t\t\t} else if (difference / combinations[2] >= 1) {\r\n\t\t\t\tdifference -= combinations[2]\r\n\t\t\t\tpaddingColumns.push(2)\r\n\t\t\t} else if (difference / combinations[3] >= 1) {\r\n\t\t\t\tdifference -= combinations[3]\r\n\t\t\t\tpaddingColumns.push(3)\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet finalPadding = []\r\n\t\tcolumn.tempoChanger = paddingColumns.shift() || 0\r\n\t\tpaddingColumns = paddingColumns.forEach((col, i) => {\r\n\t\t\tlet column = new Column()\r\n\t\t\tcolumn.tempoChanger = col\r\n\t\t\tfinalPadding.push(column)\r\n\t\t})\r\n\t\tconverted.push(column, ...finalPadding)\r\n\t}\r\n\tcomposed.columns = converted\r\n\treturn composed\r\n}\r\n\r\nclass Column {\r\n\tconstructor() {\r\n\t\tthis.notes = []\r\n\t\tthis.tempoChanger = 0\r\n\r\n\t}\r\n}\r\n\r\nfunction groupByNotes(notes, threshold) {\r\n\tlet result = []\r\n\twhile (notes.length > 0) {\r\n\t\tlet row = [notes.shift()]\r\n\t\tlet amount = 0\r\n\t\tfor (let i = 0; i < notes.length; i++) {\r\n\t\t\tif (row[0][1] > notes[i][1] - threshold) amount++\r\n\t\t}\r\n\t\tresult.push([...row, ...notes.splice(0, amount)])\r\n\t}\r\n\treturn result\r\n}\r\n\r\nclass ColumnNote {\r\n\tconstructor(index, layer = \"000\") {\r\n\t\tthis.index = index\r\n\t\tthis.layer = layer\r\n\t}\r\n}\r\n\r\nfunction getPitchChanger(pitch) {\r\n\tlet index = pitchArr.indexOf(pitch)\r\n\tif (index < 0) index = 0\r\n\treturn Number(Math.pow(2, index / 12).toFixed(4))\r\n}\r\n\r\nfunction numberToLayer(number) {\r\n\tlet layer = \"100\"\r\n\tif (number === 0) layer = \"100\"\r\n\tif (number === 1) layer = \"010\"\r\n\tif (number === 2) layer = \"001\"\r\n\treturn layer\r\n}\r\n\r\nfunction mergeLayers(notes) {\r\n\tlet final = \"000\".split(\"\")\r\n\tnotes.forEach(notes => {\r\n\t\tnotes.layer.split(\"\").forEach((e, i) => {\r\n\t\t\tif (e === \"1\") final[i] = \"1\"\r\n\t\t})\r\n\t})\r\n\treturn final.join(\"\")\r\n}\r\n\r\nfunction groupByIndex(column) {\r\n\tlet notes = []\r\n\tcolumn.notes.forEach(note => {\r\n\t\tif (notes[note.index]) {\r\n\t\t\tnotes[note.index].push(note)\r\n\t\t} else {\r\n\t\t\tnotes[note.index] = [note]\r\n\t\t}\r\n\t})\r\n\treturn notes.filter(e => Array.isArray(e))\r\n}\r\n\r\nfunction delayMs(ms) {\r\n    return new Promise(resolve => {\r\n        workerTimers.setTimeout(resolve, ms)\r\n    })\r\n}\r\n\r\nexport {\r\n\tRecording,\r\n\tSong,\r\n\tNoteData,\r\n\tFileDownloader,\r\n\tLoggerEvent,\r\n\tPlayingSong,\r\n\tComposedSong,\r\n\tColumnNote,\r\n\tColumn,\r\n\tTempoChangers,\r\n\tComposerSongSerialization,\r\n\tComposerSongDeSerialization,\r\n\tComposerToRecording,\r\n\tgetPitchChanger,\r\n\tgetSongType,\r\n\toldSkyToNewFormat,\r\n\tRecordingToComposed,\r\n\tprepareSongDownload,\r\n\tnewSkyFormatToGenshin,\r\n\tprepareSongImport,\r\n\tpitchArr,\r\n\tgroupByNotes,\r\n\tnumberToLayer,\r\n\tmergeLayers,\r\n\tgroupByIndex,\r\n\tdelayMs,\r\n\tNotesTable\r\n}","import React, { Component } from 'react'\r\nimport { observe } from 'mobx'\r\nimport { FaSyncAlt, FaStop } from 'react-icons/fa'\r\nimport { keyNames, pitchArr, layoutImages, appName, layoutData,speedChangers } from \"appConfig\"\r\nimport Note from \"./Note\"\r\nimport { songStore } from './SongStore'\r\nimport { delayMs, ComposerToRecording, NotesTable } from \"lib/Utils\"\r\nimport \"./Keyboard.css\"\r\n\r\nclass Keyboard extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        let propKeyboard = this.props.data.keyboard\r\n        propKeyboard.layout.forEach(note => { note.status = '' })\r\n        this.state = {\r\n            playTimestamp: new Date().getTime(),\r\n            songToPractice: [],\r\n            approachingNotes: NotesTable(appName === 'Sky' ? 15 : 21),\r\n            outgoingAnimation: NotesTable(appName === 'Sky' ? 15 : 21),\r\n            keyboard: propKeyboard.layout,\r\n            sliderState: {\r\n                position: 0,\r\n                size: 0\r\n            },\r\n            approachingScore: {\r\n                correct: 1,\r\n                wrong: 1,\r\n                score: 0,\r\n                combo: 0\r\n            },\r\n\t\t\tspeedChanger: speedChangers.find(e => e.name === 'x1'),\r\n        }\r\n        this.approachRate = 1500\r\n        this.approachingNotesList = []\r\n        this.songTimestamp = 0\r\n        this.nextChunkDelay = 0\r\n        this.disposeStore = () => { }\r\n        this.tickTime = 50\r\n        this.tickInterval = 0\r\n    }\r\n\r\n    componentDidMount() {\r\n        window.addEventListener('keydown', this.handleKeyboard)\r\n        this.tickInterval = setInterval(this.tick, this.tickTime)\r\n        this.disposeStore = observe(songStore, async (data) => {\r\n            let value = data.object.data\r\n            let type = value.eventType\r\n            let lostReference = JSON.parse(JSON.stringify(value.song))\r\n            if (lostReference.data?.isComposedVersion) {\r\n                lostReference = ComposerToRecording(lostReference)\r\n            }\r\n            lostReference.timestamp = new Date().getTime()\r\n            let hasSong = false\r\n            if (type === 'play') {\r\n                await this.stopSong()\r\n                this.playSong(lostReference, value.start)\r\n                hasSong = true\r\n            }\r\n            if (type === 'practice') {\r\n                await this.stopSong()\r\n                this.practiceSong(lostReference, value.start)\r\n                hasSong = true\r\n            }\r\n            if (type === 'approaching') {\r\n                await this.stopSong()\r\n                this.approachingSong(lostReference, value.start)\r\n                hasSong = true\r\n            }\r\n            if (type === 'stop') await this.stopSong()\r\n            this.props.functions.setHasSong(hasSong)\r\n        })\r\n    }\r\n    componentWillUnmount() {\r\n        window.removeEventListener('keydown', this.handleKeyboard)\r\n        this.disposeStore()\r\n        this.songTimestamp = 0\r\n        clearInterval(this.tickInterval)\r\n    }\r\n\r\n    approachingSong = async (song) => {\r\n        let notes = []\r\n        this.approachRate = this.props.data.approachRate || 1500 \r\n        let startDelay = this.approachRate\r\n        song.notes.forEach(note => {\r\n            let obj = {\r\n                time: Math.floor(note[1] / this.state.speedChanger.value + startDelay),\r\n                index: note[0]\r\n            }\r\n            notes.push(obj)\r\n        })\r\n        this.setState({\r\n            approachingNotes: NotesTable(appName === 'Sky' ? 15 : 21),\r\n            approachingScore: {\r\n                correct: 1,\r\n                wrong: 1,\r\n                score: 0,\r\n                combo: 0\r\n            }\r\n        })\r\n        this.changeSliderState(0, notes.length)\r\n        this.approachingNotesList = notes\r\n    }\r\n\r\n    tick = () => {\r\n        if (!this.props.data.hasSong) return\r\n        const { approachingNotes, sliderState, approachingScore , speedChanger} = this.state\r\n        let stateNotes = approachingNotes\r\n        let notes = this.approachingNotesList\r\n        notes.forEach(note => {\r\n            note.time -= this.tickTime\r\n        })\r\n        let hasChanges = false\r\n        let removed = 0\r\n        for (let i = 0; i < notes.length; i++) {\r\n            if (notes[i].time < this.approachRate) {\r\n                stateNotes[notes[i].index].push({\r\n                    clicked: false,\r\n                    time: this.approachRate,\r\n                    id: Math.floor(Math.random() * 10000)\r\n                })\r\n                notes.splice(i, 1)\r\n                i--\r\n                hasChanges = true\r\n            } else {\r\n                break\r\n            }\r\n        }\r\n        stateNotes.forEach(note => {\r\n            for (let i = 0; i < note.length; i++) {\r\n                let apNote = note[i]\r\n                apNote.time -= this.tickTime\r\n                if (apNote.clicked) {\r\n                    if (apNote.time < this.approachRate / 3) {\r\n                        approachingScore.correct++\r\n                        approachingScore.combo++\r\n                        approachingScore.score += approachingScore.combo * speedChanger.value\r\n                    } else {\r\n                        approachingScore.wrong++\r\n                        approachingScore.combo = 0\r\n                    }\r\n                    apNote.time = -1 //so that it can be removed after\r\n                }\r\n                if (apNote.time < 0) {\r\n                    if (!apNote.clicked) {\r\n                        approachingScore.wrong++\r\n                        approachingScore.combo = 0\r\n                    }\r\n                    note.splice(i, 1)\r\n                    i--\r\n                    hasChanges = true\r\n                    removed++\r\n                }\r\n            }\r\n        })\r\n        if (!hasChanges) return\r\n        this.changeSliderState(sliderState.position + removed)\r\n        this.setState({\r\n            approachingNotes: stateNotes,\r\n            approachingScore: approachingScore\r\n        })\r\n    }\r\n\r\n    playSong = async (song, start = 0) => {\r\n        this.songTimestamp = song.timestamp\r\n        const { keyboard } = this.state\r\n        let notes = this.applySpeedChange(song.notes)\r\n        if (notes.length === 0) return\r\n        let previous = notes[0][1]\r\n        let pastError = 0\r\n        let previousTime = new Date().getTime()\r\n        for (let i = start; i < notes.length; i++) {\r\n            let delay = notes[i][1] - previous\r\n            previous = notes[i][1]\r\n            let note = notes[i][0]\r\n            previousTime = new Date().getTime()\r\n            if (delay > 16) await delayMs(delay - pastError)\r\n            if (this.songTimestamp !== song.timestamp) return\r\n            keyboard[note].status = 'clicked'\r\n            this.handleClick(keyboard[note])\r\n            this.setState({\r\n                keyboard,\r\n                sliderState: {\r\n                    position: i+1,\r\n                    size: notes.length\r\n                }\r\n            })\r\n            pastError = new Date().getTime() - previousTime - delay\r\n        }\r\n\r\n    }\r\n    applySpeedChange = (notes) => {\r\n        return notes.map(note => {\r\n            note[1] = note[1] / this.state.speedChanger.value\r\n            return note\r\n        })\r\n    }\r\n    practiceSong = (song, start = 0) => {\r\n        const { keyboard } = this.state\r\n        let notes = this.applySpeedChange(song.notes)\r\n        let songLength = notes.length\r\n        notes.splice(0, start)\r\n        let chunks = []\r\n        let previousChunkDelay = 0\r\n        for (let i = 0; notes.length > 0; i++) {\r\n            let chunk = {\r\n                notes: [notes.shift()],\r\n                delay: 0\r\n            }\r\n            let startTime = chunk.notes.length > 0 ? chunk.notes[0][1] : 0\r\n            for (let j = 0; j < notes.length && j < 20; j++) {\r\n                let difference = notes[j][1] - chunk.notes[0][1] - 50 //TODO add threshold here\r\n                if (difference < 0) {\r\n                    chunk.notes.push(notes.shift())\r\n                    j--\r\n                }\r\n            }\r\n            chunk.delay = previousChunkDelay\r\n            previousChunkDelay = notes.length > 0 ? notes[0][1] - startTime : 0\r\n            chunks.push(chunk)\r\n        }\r\n        if (chunks.length === 0) return\r\n        let firstChunk = chunks[0]\r\n        this.nextChunkDelay = 0\r\n        let secondChunk = chunks[1]\r\n        firstChunk.notes.forEach(note => { \r\n            keyboard[note[0]].status = 'toClick' \r\n            keyboard[note[0]].delay = appName === 'Genshin' ? 100 : 200\r\n        })\r\n        secondChunk?.notes.forEach(note => {\r\n            let keyboardNote = keyboard[note[0]]\r\n            if (keyboardNote.status === 'toClick') return keyboardNote.status = 'toClickAndNext'\r\n            keyboardNote.status = 'toClickNext'\r\n        })\r\n        this.props.functions.setHasSong(true)\r\n        this.setState({\r\n            songToPractice: chunks,\r\n            keyboard,\r\n            sliderState: {\r\n                position: start,\r\n                size: songLength\r\n            }\r\n        })\r\n    }\r\n    handleSpeedChanger = (value) =>{\r\n        let changer = speedChangers.find(e => e.name === value)\r\n        this.setState({\r\n            speedChanger: changer\r\n        },this.restartSong)\r\n    }\r\n    restartSong =async (override) => {\r\n        let lostReference = JSON.parse(JSON.stringify(songStore.data))\r\n        const { sliderState } = this.state\r\n        await this.stopSong()\r\n        setTimeout(() => {\r\n            let start = songStore.data.start\r\n            if (songStore.data.eventType === 'practice'){\r\n                start = sliderState.position === sliderState.size ? 0 : sliderState.position\r\n            }\r\n            songStore.data = {\r\n                ...lostReference,\r\n                start: Number.isInteger(override) ? override : start\r\n            }\r\n        }, 200)\r\n    }\r\n    stopSong = () => {\r\n        return new Promise(res => {\r\n            this.songTimestamp = 0\r\n            const { keyboard } = this.state\r\n            keyboard.forEach(note => {\r\n                note.status = ''\r\n                note.delay = appName === 'Genshin' ? 100 : 200\r\n            })\r\n            this.approachingNotesList = []\r\n            this.setState({\r\n                keyboard,\r\n                songToPractice: [],\r\n                approachingNotes: NotesTable(appName === 'Sky' ? 15 : 21)\r\n            }, res)\r\n\r\n            this.props.functions.setHasSong(false)\r\n        })\r\n\r\n    }\r\n    handleSliderEvent = (event) => {\r\n        this.changeSliderState(Number(event.target.value))\r\n    }\r\n    changeSliderState = async (position, size = this.state.sliderState.size) => {\r\n        this.setState({\r\n            sliderState: {\r\n                position,\r\n                size\r\n            }\r\n        })\r\n    }\r\n    handleKeyboard =async (event) => {\r\n        const { keyboard } = this.state\r\n        if (event.repeat) return\r\n        if (document.activeElement.tagName === \"INPUT\") return\r\n        if(event.shiftKey){\r\n            switch(event.code){\r\n                case \"KeyR\" : {\r\n                    if(!this.props.data.hasSong) return\r\n                    if(['practice','playing','approaching'].includes(songStore.data.eventType)){\r\n                       return this.restartSong(0)\r\n                    }\r\n                    break;\r\n                }\r\n                case \"KeyS\" : {\r\n                    if(!this.props.data.hasSong) return\r\n                    await this.stopSong()\r\n                    return songStore.data = returnStopSong()\r\n                }\r\n                default: break;\r\n            }\r\n        }else{\r\n            let code = event.code?.replace(\"Key\", \"\")\r\n            let index = this.props.data.keyboard.getNoteFromCode(code)\r\n            let note = keyboard[index]\r\n            if (note) this.handleClick(note)\r\n        }\r\n\r\n    }\r\n\r\n    handleApproachClick = (note) => {\r\n        const { approachingNotes } = this.state\r\n        let approachingNote = approachingNotes[note.index][0]\r\n        if (approachingNote) {\r\n            approachingNote.clicked = true\r\n            if(approachingNote.time < this.approachRate / 3) return \"approach-correct\"\r\n        }\r\n        return \"approach-wrong\"\r\n    }\r\n    handlePracticeClick = (note) => {\r\n        const { keyboard, songToPractice, sliderState } = this.state\r\n        if (songToPractice.length > 0) {\r\n            let indexClicked = songToPractice[0]?.notes.findIndex(e => e[0] === note.index)\r\n            if (indexClicked !== -1) {\r\n                songToPractice[0].notes.splice(indexClicked, 1)\r\n                if (songToPractice[0].notes.length === 0) songToPractice.shift()\r\n                if (songToPractice.length > 0) {\r\n                    let nextChunk = songToPractice[0]\r\n                    let nextNextChunk = songToPractice[1]\r\n                    nextChunk.notes.forEach(note => {\r\n                        keyboard[note[0]].status = 'toClick'\r\n                        keyboard[note[0]].delay = nextChunk.delay\r\n                    })\r\n\r\n                    if(nextNextChunk){\r\n                        nextNextChunk?.notes.forEach(note => {\r\n                            let keyboardNote = keyboard[note[0]]\r\n                            if (keyboardNote.status === 'toClick') return keyboardNote.status = 'toClickAndNext'\r\n                            keyboardNote.status = 'toClickNext'\r\n                        })\r\n                    }\r\n                }\r\n                this.setState({\r\n                    songToPractice: songToPractice,\r\n                    sliderState: {\r\n                        size: sliderState.size,\r\n                        position: sliderState.position + 1\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    }\r\n    handleClick = (note, onlySound) => {\r\n        const { keyboard, outgoingAnimation} = this.state\r\n        const hasAnimation = this.props.data.hasAnimation\r\n        keyboard[note.index].status = 'clicked'\r\n        keyboard[note.index].delay = appName === 'Genshin' ? 100 : 200\r\n        this.handlePracticeClick(note)\r\n        let approachStatus = this.handleApproachClick(note)\r\n        if(songStore.data.eventType === 'approaching'){\r\n            keyboard[note.index].status = approachStatus\r\n        }\r\n        if(hasAnimation && songStore.data.eventType !=='approaching'){\r\n            let key = Math.floor(Math.random() * 10000) + new Date().getTime()\r\n            outgoingAnimation[note.index].push({key})\r\n        }\r\n        this.setState({ keyboard,\r\n            ...(hasAnimation? outgoingAnimation : {})\r\n        },() => {\r\n            setTimeout(() => {\r\n                if(!hasAnimation || songStore.data.eventType === 'approaching') return\r\n                const {outgoingAnimation} = this.state\r\n                outgoingAnimation[note.index].shift()\r\n                this.setState({outgoingAnimation})\r\n            },750)\r\n        })\r\n        setTimeout(() => {\r\n            if (!['clicked','approach-wrong','approach-correct'].includes(keyboard[note.index].status)) return\r\n            keyboard[note.index].status = ''\r\n            this.setState({ keyboard })\r\n        },appName === 'Sky' ? 200 : 100)\r\n        this.props.functions.playSound(note)\r\n    }\r\n    render() {\r\n        const { state, props } = this\r\n        const { data } = props\r\n        const { keyboard, approachingScore } = state\r\n        let size = data.keyboardSize / 100\r\n        if (size < 0.5) size = 0.5\r\n        if (size > 1.5) size = 1.5\r\n        let keyboardClass = \"keyboard\"\r\n        if (keyboard.length === 15) keyboardClass += \" keyboard-5\"\r\n        if (keyboard.length === 8) keyboardClass += \" keyboard-4\"\r\n        return <>\r\n            {data.hasSong &&\r\n                <div className=\"upper-right\">\r\n                    {songStore.data.eventType === 'approaching' &&\r\n                        <Score data={approachingScore} />\r\n                    }\r\n\r\n                    <div className=\"slider-wrapper\">\r\n                        <button className=\"song-button\" onClick={() => {\r\n                            this.stopSong()\r\n                            songStore.data = returnStopSong()\r\n                        }\r\n                        }>\r\n                            <FaStop />\r\n                        </button>\r\n                        <input\r\n                            type=\"range\"\r\n                            className=\"slider\"\r\n                            min={0}\r\n                            onChange={this.handleSliderEvent}\r\n                            max={state.sliderState.size}\r\n                            value={state.sliderState.position}\r\n                        ></input>\r\n                        <button className=\"song-button\" onClick={() => {\r\n                            this.restartSong()\r\n                        }}>\r\n                            <FaSyncAlt />\r\n                        </button>\r\n                        <select \r\n                            className='slider-select'\r\n                            onChange={(e) => this.handleSpeedChanger(e.target.value)}\r\n                            value={state.speedChanger.name}\r\n                        >\r\n                            <option disabled>Speed</option>\r\n                            {speedChangers.map(e => {\r\n                                return <option value={e.name} key={e.name}>\r\n                                    {e.name}\r\n                                </option>\r\n                            })}\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n            }\r\n            <div\r\n                className={keyboardClass}\r\n                style={{\r\n                    transform: `scale(${size})`,\r\n                    marginBottom: size * 30 - 15\r\n                }}\r\n            >\r\n                {data.isLoading \r\n                    ? <div className=\"loading\">Loading...</div> \r\n                    \r\n                    : keyboard.map(note => {\r\n                        let noteImage = layoutImages[keyboard.length][note.index]\r\n                        let noteData = {\r\n                            ...note,\r\n                            approachRate:this.approachRate,\r\n                            instrument: this.props.data.keyboard.instrumentName,\r\n                            isAnimated: songStore.data.eventType === 'approaching' ? false : this.props.data.hasAnimation\r\n                        }\r\n                        return <Note\r\n                            key={note.index}\r\n                            data={noteData}\r\n                            approachingNotes={state.approachingNotes[note.index]}\r\n                            outgoingAnimation={state.outgoingAnimation[note.index]}\r\n                            fadeTime={note.delay}\r\n                            handleClick={this.handleClick}\r\n                            noteText={getNoteText(data.noteNameType, note.index, data.pitch, keyboard.length)}\r\n                            noteImage={`./assets/icons/keys/${noteImage}.svg`}\r\n                        />\r\n    \r\n                    })\r\n                }\r\n\r\n            </div>\r\n        </>\r\n\r\n\r\n    }\r\n}\r\nfunction Score(props) {\r\n    const { combo, score, correct, wrong} = props.data\r\n    return <div className='approaching-accuracy'>\r\n        <table>\r\n            <tbody>\r\n                <tr>\r\n                    <td className='sc-2'>Accuracy</td>\r\n                    <td className='sc-1'>{(correct / (correct + wrong - 1) * 100 ).toFixed(1)}%</td>\r\n                </tr>\r\n                <tr>\r\n                    <td className='sc-2'>Score</td>\r\n                    <td className='sc-1'>{score}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td className='sc-2'>Combo</td>\r\n                    <td className='sc-1'>{combo}</td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n\r\n\r\n\r\n}\r\nfunction returnStopSong() {\r\n    return {\r\n        song: {},\r\n        eventType: 'stop',\r\n        start: 0\r\n    }\r\n}\r\n\r\nfunction getNoteText(noteNameType, index, pitch, layoutLength) {\r\n    try {\r\n        if (noteNameType === \"Note name\") return keyNames[appName][pitchArr.indexOf(pitch)][index]\r\n        if (noteNameType === \"Keyboard layout\") return layoutData[layoutLength].keyboardLayout[index]\r\n        if (noteNameType === \"Do Re Mi\") return layoutData[layoutLength].mobileLayout[index]\r\n    } catch (e) { }\r\n    return ''\r\n}\r\nexport default Keyboard","export default __webpack_public_path__ + \"static/media/mainpage.53c2a740.png\";","export default __webpack_public_path__ + \"static/media/composer.69d0b59e.png\";","export default __webpack_public_path__ + \"static/media/songs.4892a692.png\";","import mainPageImg from 'assets/images/mainpage.png'\r\nimport composerImg from 'assets/images/composer.png'\r\nimport songsImg from 'assets/images/songs.png'\r\nimport { FaCrosshairs, FaDownload } from 'react-icons/fa'\r\nimport { BsCircle } from 'react-icons/bs'\r\nimport isMobile from 'is-mobile'\r\nimport './HelpComponent.css'\r\nexport function HelpTab() {\r\n    return <>\r\n        <div className='help-title'>\r\n            Main page\r\n        </div>\r\n        <div>\r\n            <img src={mainPageImg} className='help-img' alt='tutorial for the main page' />\r\n            <ol>\r\n                <li>Record the keyboard as an audio file</li>\r\n                <li>Current note position, you can change it to reload</li>\r\n                <li>Playback speed</li>\r\n                <li>Approaching circles score</li>\r\n                <li>Approaching circle, click when it's close to the note</li>\r\n            </ol>\r\n        </div>\r\n        {\r\n            !isMobile() && <>\r\n                <div className='help-title'>\r\n                    Main page shortcuts\r\n                </div>\r\n                <div className='help-margin-left'>\r\n                    <div style={{ marginBottom: '0.5rem' }}>\r\n                        The main page has shortcuts for PC users:\r\n                    </div>\r\n                    <table className='keys-table'>\r\n                        <tbody>\r\n                            <tr>\r\n                                <td><Key>Shift + R</Key></td><td>reload song </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td><Key>Shift + R</Key></td><td>Start/Stop recording when there are no songs playing</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td><Key>Shift + M</Key></td><td>Open/Close the menu</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td><Key>Esc</Key></td><td> Close the menu </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td><Key>Shift + S</Key></td><td>stop song </td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n\r\n            </>\r\n        }\r\n\r\n        <div className='help-title'>\r\n            Songs menu\r\n        </div>\r\n        <div>\r\n            <img src={songsImg} className='help-img' alt='tutorial for songs page' />\r\n            <ol>\r\n                <li>Open composer to create a song</li>\r\n                <li>Import song (as json)</li>\r\n                <li>Play song (click the name)</li>\r\n                <li>Practice the song</li>\r\n                <li>Play with the approaching circles mode</li>\r\n                <li>Download the song (as json)</li>\r\n            </ol>\r\n            <div className=\"column\">\r\n                <div>\r\n                    <FaCrosshairs /> = practice the song\r\n                </div>\r\n                <div>\r\n                    <BsCircle /> = Approaching circles mode\r\n                </div>\r\n                <div>\r\n                    <FaDownload /> = download the song\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n\r\n        <div className='help-title'>\r\n            Composer\r\n        </div>\r\n        <div>\r\n            <img src={composerImg} className='help-img' alt=\"tutorial for composer\" />\r\n            <ol>\r\n                <li>Go to the next / previous breakpoint</li>\r\n                <li>Timeline of the breakpoints</li>\r\n                <li>Open the tools</li>\r\n                <li>Add 16 columns to the end</li>\r\n                <li>Remove the current selected column</li>\r\n                <li>Add column after the current one</li>\r\n                <li>Change layer (instrument)</li>\r\n                <li>Change column's duration</li>\r\n            </ol>\r\n        </div>\r\n\r\n        {\r\n            !isMobile() && <>\r\n                <div className='help-title'>\r\n                    Composer shortcuts\r\n                </div>\r\n                <div className='help-margin-left'>\r\n\r\n                    <div style={{ marginBottom: '0.5rem' }}>\r\n                        The composer has shortcuts for PC users:\r\n                    </div>\r\n                    <table>\r\n                        <tbody>\r\n                            <tr>\r\n                                <td><Key>A / D</Key></td><td>move left / right</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td><Key>1 / 2 / 3 / 4</Key></td><td>change tempo</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td><Key>Space bar</Key></td><td>play / pause song</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td><Key>Arrow Left</Key></td><td>go to previous breakpoint</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td><Key>Arrow Right</Key></td><td>go to next breakpoint</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td><Key>Arrow Up</Key></td><td>select previous layer</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td><Key>Arrow Down</Key></td><td>select next layer </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td><Key>Shift + Note</Key></td><td>Adds/remove a note in the column </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td><Key>Q</Key></td><td>remove current column</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td><Key>E</Key></td><td>add column </td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </table>\r\n                    When playing a song, you can press on the PC keyboard to add notes\r\n                    <div style={{ marginBottom: \"1rem\" }}>\r\n\r\n                    </div>\r\n                </div>\r\n\r\n            </>\r\n        }\r\n    </>\r\n}\r\n\r\n\r\nfunction Key(props) {\r\n    return <div className='keyboard-key'>\r\n        {props.children}\r\n    </div>\r\n}","export default function MenuItem(props) {\r\n    const { className, action, children, type } = props\r\n    return <div\r\n        className={className ? `menu-item ${className}` : \"menu-item\"}\r\n        onClick={() => action?.(type)}\r\n    >\r\n        {children}\r\n    </div>\r\n}","export default function MenuPanel(props) {\r\n    let className = props.visible === props.title ? \"menu-panel menu-panel-visible\" : \"menu-panel\"\r\n    return <div className={className}>\r\n        <div className=\"menu-title\">\r\n            {props.title}\r\n        </div>\r\n        <div className=\"panel-content-wrapper\">\r\n            {props.children}\r\n        </div>\r\n    </div>\r\n}","import { FaTimes } from 'react-icons/fa'\r\nexport default function MenuClose(props) {\r\n    return <div onClick={() => props.action(false)} className=\"close-menu menu-item\">\r\n        <FaTimes className=\"icon\" />\r\n    </div>\r\n}","import {useState } from 'react'\r\n\r\nexport default function SettingsRow(props) {\r\n    const { data, update, objKey, changeVolume } = props\r\n    const [valueHook, setter] = useState(data.value)\r\n    const [volumeHook, setterVolume] = useState(data.volume)\r\n    function handleChange(e) {\r\n        let el = e.target\r\n        let value = data.type === \"checkbox\" ? el.checked : el.value\r\n        if (data.type === \"number\") {\r\n            value = Number(value)\r\n            e.target.value = \"\" //have to do this to remove a react bug that adds a 0 at the start\r\n            if (value < data.threshold[0] || value > data.threshold[1]) {\r\n                return\r\n            }\r\n        }\r\n        if(el.type === 'checkbox'){\r\n            data.value = value\r\n            let obj = {\r\n                key: objKey,\r\n                data\r\n            }\r\n            update(obj)\r\n        }\r\n        setter(value)\r\n    }\r\n    function sendChange() {\r\n        if (data.value === valueHook) return\r\n        data.value = valueHook\r\n        let obj = {\r\n            key: objKey,\r\n            data: data\r\n        }\r\n        update(obj)\r\n    }\r\n    function sendChangeSelect(e) {\r\n        let value = e.target.value\r\n        data.value = value\r\n        let obj = {\r\n            key: objKey,\r\n            data: data\r\n        }\r\n        update(obj)\r\n    }\r\n    function handleVolume(e) {\r\n        setterVolume(Number(e.target.value))\r\n    }\r\n    function sendVolumeChange() {\r\n        changeVolume({\r\n            key: objKey,\r\n            value: volumeHook\r\n        })\r\n    }\r\n    if (objKey === \"settingVesion\") return null\r\n    return <div className=\"settings-row\">\r\n        <div>\r\n            {data.name}\r\n        </div>\r\n        {data.type === \"select\"\r\n            ? <select value={data.value}\r\n                onChange={sendChangeSelect}\r\n            >\r\n                {data.options.map(e => {\r\n                    return <option value={e} key={e}>{e}</option>\r\n                })}\r\n            </select>\r\n            : null\r\n        }\r\n        {[\"number\", \"text\", \"checkbox\"].includes(data.type) ?\r\n            <input\r\n                type={data.type}\r\n                value={valueHook}\r\n                placeholder={data.placeholder || \"\"}\r\n                checked={valueHook}\r\n                onChange={handleChange}\r\n                onBlur={sendChange}\r\n            />\r\n            : null\r\n        }\r\n        {data.type === \"instrument\"\r\n            ? <div className=\"instrument-picker\">\r\n                <select value={data.value}\r\n                    onChange={sendChangeSelect}\r\n                >\r\n                    {data.options.map(e => {\r\n                        return <option value={e} key={e}>{e}</option>\r\n                    })}\r\n                </select>\r\n\r\n                <input\r\n                    type=\"range\"\r\n                    min={1}\r\n                    max={100}\r\n                    value={volumeHook}\r\n                    onChange={handleVolume}\r\n                    onPointerUp={sendVolumeChange}\r\n                />\r\n            </div>\r\n            : null\r\n        }\r\n    </div>\r\n}","export default function DonateButton(props){\r\n    return <div className=\"donate-button\" onClick={() => props.onClick(\"Donate\")}>\r\n        Donate\r\n    </div>\r\n}","import { useState } from 'react'\r\nimport { FaDownload, FaSpinner } from 'react-icons/fa';\r\nimport { LoggerEvent, prepareSongImport } from \"lib/Utils\"\r\n\r\nexport default function SearchedSong(props) {\r\n    const { functions, data, songStore } = props\r\n    const { importSong } = functions\r\n    const [fetching, setFetching] = useState(false)\r\n    const [cache, setCache] = useState(undefined)\r\n    const download = async function () {\r\n        if (fetching) return\r\n        try {\r\n            if (cache) return importSong(cache)\r\n            setFetching(true)\r\n            let song = await fetch('https://sky-music.herokuapp.com/api/songs?get=' + encodeURI(data.file)).then(data => data.json())\r\n            setFetching(false)\r\n            song = prepareSongImport(song)\r\n            setCache(song)\r\n            importSong(song)\r\n        } catch (e) {\r\n            setFetching(false)\r\n            console.error(e)\r\n            new LoggerEvent(\"Error\", \"Error downloading song\").trigger()\r\n        }\r\n    }\r\n    const play = async function () {\r\n        if (fetching) return\r\n        try {\r\n            if (cache) {\r\n                return songStore.data = {\r\n                    eventType: 'play',\r\n                    song: cache,\r\n                    start: 0\r\n                }\r\n            }\r\n            setFetching(true)\r\n            let song = await fetch('https://sky-music.herokuapp.com/api/songs?get=' + encodeURI(data.file)).then(data => data.json())\r\n            setFetching(false)\r\n            song = prepareSongImport(song)\r\n            setCache(song)\r\n            songStore.data = {\r\n                eventType: 'play',\r\n                song: song,\r\n                start: 0\r\n            }\r\n        } catch (e) {\r\n            console.error(e)\r\n            setFetching(false)\r\n            new LoggerEvent(\"Error\", \"Error downloading song\").trigger()\r\n        }\r\n    }\r\n    return <div className=\"song-row\">\r\n        <div className=\"song-name\" onClick={() => {\r\n            play(data)\r\n        }}>\r\n            {data.name}\r\n        </div>\r\n        <div className=\"song-buttons-wrapper\">\r\n            <button className=\"song-button\" onClick={download}>\r\n                {fetching ? <FaSpinner /> : <FaDownload />}\r\n            </button>\r\n        </div>\r\n    </div>\r\n}","import { Component } from 'react'\r\nimport { FaMusic, FaTimes, FaCog, FaTrash, FaCrosshairs, FaDownload, FaInfo, FaSearch, FaHome } from 'react-icons/fa';\r\nimport { FaDiscord, FaGithub } from 'react-icons/fa';\r\nimport { BsCircle } from 'react-icons/bs'\r\nimport { RiPlayListFill } from 'react-icons/ri'\r\nimport { FileDownloader, LoggerEvent, prepareSongImport, prepareSongDownload } from \"lib/Utils\"\r\nimport { FilePicker } from \"react-file-picker\"\r\nimport { appName, isTwa } from \"appConfig\"\r\nimport { songStore } from './SongStore'\r\nimport { HelpTab } from 'components/HelpTab'\r\nimport MenuItem from 'components/MenuItem'\r\nimport MenuPanel from 'components/MenuPanel'\r\nimport MenuClose from 'components/MenuClose'\r\nimport SettingsRow from 'components/SettingsRow'\r\nimport DonateButton from 'components/DonateButton'\r\nimport LibrarySearchedSong from 'components/LibrarySearchedSong'\r\nimport \"./menu.css\"\r\nclass Menu extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            open: false,\r\n            selectedMenu: \"Songs\",\r\n            selectedSongType: \"recorded\",\r\n            searchInput: '',\r\n            searchedSongs: [],\r\n            searchStatus: 'Write a song name then search!',\r\n            isPersistentStorage: false\r\n        }\r\n    }\r\n    componentDidMount() {\r\n        this.checkPersistentStorage()\r\n        window.addEventListener(\"keydown\", this.handleKeyboard)\r\n    }\r\n    componentWillUnmount() {\r\n        window.removeEventListener(\"keydown\", this.handleKeyboard)\r\n    }\r\n    handleKeyboard = (event) => {\r\n        let key = event.code\r\n        if (document.activeElement.tagName === \"INPUT\") return\r\n        if (event.shiftKey) {\r\n            switch (key) {\r\n                case \"KeyM\": {\r\n                    this.setState({ open: !this.state.open })\r\n                    break\r\n                }\r\n                default: break;\r\n            }\r\n        } else {\r\n            switch (key) {\r\n                case \"Escape\": {\r\n                    this.setState({ open: false })\r\n                    break\r\n                }\r\n                default: break;\r\n            }\r\n        }\r\n\r\n    }\r\n    checkPersistentStorage = async () => {\r\n        if (navigator.storage && navigator.storage.persist) {\r\n            let isPersisted = await navigator.storage.persisted()\r\n            if (!isPersisted) isPersisted = await navigator.storage.persist()\r\n            this.setState({ isPersistentStorage: isPersisted })\r\n        }\r\n    }\r\n    handleSearchInput = (text) => {\r\n        this.setState({\r\n            searchInput: text\r\n        })\r\n    }\r\n    clearSearch = () => {\r\n        this.setState({\r\n            searchInput: '',\r\n            searchedSongs: [],\r\n            searchStatus: 'Write a song name then search!'\r\n        })\r\n    }\r\n    searchSongs = async () => {\r\n        const { searchInput, searchStatus } = this.state\r\n        if (searchStatus === \"Searching...\") return\r\n        if (searchInput.trim().length === 0) {\r\n            return this.setState({\r\n                searchStatus: 'Please write a non empty name'\r\n            })\r\n        }\r\n        this.setState({\r\n            searchStatus: 'Searching...'\r\n        })\r\n        let fetchedSongs = await fetch('https://sky-music.herokuapp.com/api/songs?search=' + encodeURI(searchInput)).then(data => data.json())\r\n        if (fetchedSongs.error) {\r\n            this.setState({\r\n                searchStatus: 'Please write a non empty name'\r\n            })\r\n            return new LoggerEvent(\"Error\", fetchedSongs.error).trigger()\r\n        }\r\n        this.setState({\r\n            searchedSongs: fetchedSongs,\r\n            searchStatus: 'success'\r\n        })\r\n    }\r\n    toggleMenu = (override) => {\r\n        if (typeof override !== \"boolean\") override = undefined\r\n        let newState = override !== undefined ? override : !this.state.open\r\n        this.setState({\r\n            open: newState,\r\n        })\r\n    }\r\n    selectSideMenu = (selection) => {\r\n        if (selection === this.state.selectedMenu && this.state.open) {\r\n            return this.setState({\r\n                open: false,\r\n            })\r\n        }\r\n        this.clearSearch()\r\n        this.setState({\r\n            selectedMenu: selection,\r\n            open: true\r\n        })\r\n    }\r\n    changeSelectedSongType = (name) => {\r\n        this.setState({\r\n            selectedSongType: name\r\n        })\r\n    }\r\n    importSong = (file) => {\r\n        const reader = new FileReader();\r\n        reader.addEventListener('load', async (event) => {\r\n            try {\r\n                let songsInput = JSON.parse(event.target.result)\r\n                if (!Array.isArray(songsInput)) songsInput = [songsInput]\r\n                for (let song of songsInput) {\r\n                    song = prepareSongImport(song)\r\n                    await this.props.functions.addSong(song)\r\n                }\r\n            } catch (e) {\r\n                let fileName = file.name\r\n                console.error(e)\r\n                if (fileName?.includes?.(\".mid\")) {\r\n                    return new LoggerEvent(\"Error\", \"Midi files should be imported in the composer\").trigger()\r\n                }\r\n                new LoggerEvent(\"Error\", \"Error importing song, invalid format\").trigger()\r\n\r\n            }\r\n        })\r\n        reader.readAsText(file)\r\n    }\r\n    downloadSong = (song) => {\r\n        if (song._id) delete song._id\r\n        let songName = song.name\r\n        if (appName === \"Sky\") {\r\n            //adds old format into the sheet\r\n            song = prepareSongDownload(song)\r\n        }\r\n        if (!Array.isArray(song)) song = [song]\r\n        song.forEach(song1 => {\r\n            song1.data.appName = appName\r\n        })\r\n        let json = JSON.stringify(song)\r\n        let fileDownloader = new FileDownloader()\r\n        fileDownloader.download(json, `${songName}.${appName.toLowerCase()}sheet.json`)\r\n        new LoggerEvent(\"Success\", \"Song downloaded\").trigger()\r\n    }\r\n\r\n    downloadAllSongs = () => {\r\n        let toDownload = []\r\n        this.props.data.songs.forEach(song => {\r\n            if (song._id) delete song._id\r\n            if (appName === \"Sky\") {\r\n                song = prepareSongDownload(song)\r\n            }\r\n            Array.isArray(song) ? toDownload.push(...song) : toDownload.push(song)\r\n        })\r\n        let fileDownloader = new FileDownloader()\r\n        let json = JSON.stringify(toDownload)\r\n        let date = new Date().toISOString().split('T')[0]\r\n        fileDownloader.download(json, `${appName}_Backup_${date}.json`)\r\n        new LoggerEvent(\"Success\", \"Song backup downloaded\").trigger()\r\n    }\r\n\r\n    render() {\r\n        let sideClass = this.state.open ? \"side-menu menu-open\" : \"side-menu\"\r\n        const { data, functions } = this.props\r\n        const { handleSettingChange } = functions\r\n        functions.toggleMenu = this.toggleMenu\r\n        functions.downloadSong = this.downloadSong\r\n        let changePage = this.props.functions.changePage\r\n        let songs = data.songs.filter(song => !song.data.isComposedVersion)\r\n        let composedSongs = data.songs.filter(song => song.data.isComposedVersion)\r\n        const { searchStatus, searchedSongs, selectedMenu } = this.state\r\n        let searchedSongFunctions = {\r\n            importSong: functions.addSong,\r\n        }\r\n        return <div className=\"menu-wrapper\">\r\n            <div className=\"menu menu-visible menu-main-page\">\r\n                {this.state.open && <MenuClose action={this.toggleMenu} />}\r\n                <MenuItem type=\"Help\" action={this.selectSideMenu} className=\"margin-top-auto\">\r\n                    <FaInfo className=\"icon\" />\r\n                </MenuItem>\r\n                <MenuItem type=\"Library\" action={this.selectSideMenu}>\r\n                    <RiPlayListFill className='icon' />\r\n                </MenuItem>\r\n                <MenuItem type=\"Songs\" action={this.selectSideMenu} >\r\n                    <FaMusic className=\"icon\" />\r\n                </MenuItem>\r\n                <MenuItem type=\"Settings\" action={this.selectSideMenu}>\r\n                    <FaCog className=\"icon\" />\r\n                </MenuItem>\r\n                <MenuItem type=\"Home\" action={() => changePage(\"home\")}>\r\n                    <FaHome className=\"icon\" />\r\n                </MenuItem>\r\n            </div>\r\n            <div className={sideClass}>\r\n                <MenuPanel title=\"No selection\" visible={selectedMenu}>\r\n                </MenuPanel>\r\n                <MenuPanel title=\"Songs\" visible={selectedMenu}>\r\n                    <div className=\"songs-buttons-wrapper\">\r\n                        <button className=\"genshin-button\"\r\n                            onClick={() => changePage(\"Composer\")}\r\n                        >\r\n                            Compose song\r\n                        </button>\r\n                        <FilePicker\r\n                            onChange={(file) => this.importSong(file)}\r\n                        >\r\n                            <button className=\"genshin-button\">\r\n                                Import song\r\n                            </button>\r\n                        </FilePicker>\r\n\r\n                    </div>\r\n                    <div className=\"tab-selector-wrapper\">\r\n                        <button\r\n                            className={this.state.selectedSongType === \"recorded\" ? \"tab-selector tab-selected\" : \"tab-selector\"}\r\n                            onClick={() => this.changeSelectedSongType(\"recorded\")}\r\n                        >\r\n                            Recorded\r\n                        </button>\r\n                        <button\r\n                            className={this.state.selectedSongType === \"composed\" ? \"tab-selector tab-selected\" : \"tab-selector\"}\r\n                            onClick={() => this.changeSelectedSongType(\"composed\")}\r\n                        >\r\n                            Composed\r\n                        </button>\r\n                    </div>\r\n                    <div className=\"songs-wrapper\">\r\n                        {this.state.selectedSongType === \"recorded\"\r\n                            ? songs.map(song => {\r\n                                return <SongRow\r\n                                    data={song}\r\n                                    key={song.name}\r\n                                    functions={functions}\r\n                                >\r\n                                </SongRow>\r\n                            })\r\n                            : composedSongs.map(song => {\r\n                                return <SongRow\r\n                                    data={song}\r\n                                    key={song.name}\r\n                                    functions={functions}\r\n                                >\r\n                                </SongRow>\r\n                            })\r\n                        }\r\n                    </div>\r\n                    <div style={{ marginTop: \"auto\", paddingTop: '0.5rem', width: '100%', display: 'flex', justifyContent: 'flex-end' }}>\r\n                        <button\r\n                            className='genshin-button'\r\n                            style={{ marginLeft: 'auto' }}\r\n                            onClick={this.downloadAllSongs}\r\n                        >\r\n                            Download all songs (backup)\r\n                        </button>\r\n                    </div>\r\n                </MenuPanel>\r\n\r\n                <MenuPanel title=\"Settings\" visible={selectedMenu}>\r\n                    {Object.entries(data.settings).map(([key, data]) => {\r\n                        return <SettingsRow\r\n                            key={key + data.value}\r\n                            objKey={key}\r\n                            data={data}\r\n                            changeVolume={functions.changeVolume}\r\n                            update={handleSettingChange}\r\n                        >\r\n\r\n                        </SettingsRow>\r\n                    })}\r\n                    <div style={{ marginTop: '1rem' }}>\r\n                        {this.state.isPersistentStorage ? \"Storage is persisted\" : \"Storage is not persisted\"}\r\n                    </div>\r\n                    {!isTwa() && <DonateButton onClick={changePage} />}\r\n\r\n                </MenuPanel>\r\n\r\n                <MenuPanel title=\"Library\" visible={selectedMenu}>\r\n                    <div>\r\n                        Here you can find songs to learn, they are provided by the sky-music library.\r\n                    </div>\r\n                    <div className='library-search-row' >\r\n                        <input\r\n                            className='library-search-input'\r\n                            placeholder='Song name'\r\n                            onKeyDown={(e) => {\r\n                                if (e.code === \"Enter\") this.searchSongs()\r\n                            }}\r\n                            onInput={(e) => this.handleSearchInput(e.target.value)}\r\n                            value={this.state.searchInput}\r\n                        />\r\n                        <button className='library-search-btn' onClick={this.clearSearch}>\r\n                            <FaTimes />\r\n                        </button>\r\n                        <button className='library-search-btn' onClick={this.searchSongs}>\r\n                            <FaSearch />\r\n                        </button>\r\n                    </div>\r\n                    <div className='library-search-songs-wrapper'>\r\n                        {searchStatus === \"success\" ?\r\n                            searchedSongs.length > 0\r\n                                ? searchedSongs.map(song =>\r\n                                    <LibrarySearchedSong\r\n                                        key={song.file}\r\n                                        data={song}\r\n                                        functions={searchedSongFunctions}\r\n                                        songStore={songStore}\r\n                                    >\r\n                                        {song.name}\r\n                                    </LibrarySearchedSong>)\r\n                                : <div className='library-search-result-text'>\r\n                                    No results\r\n                                </div>\r\n                            : <div className='library-search-result-text'>\r\n                                {searchStatus}\r\n                            </div>\r\n                        }\r\n                    </div>\r\n                </MenuPanel>\r\n                <MenuPanel title=\"Help\" visible={selectedMenu}>\r\n                    <div className='help-icon-wrapper'>\r\n                        <a href='https://discord.gg/Arsf65YYHq' >\r\n                            <FaDiscord className='help-icon' />\r\n                        </a>\r\n                        <a href='https://github.com/Specy/genshin-music' >\r\n                            <FaGithub className='help-icon' />\r\n                        </a>\r\n\r\n                    </div>\r\n                    <HelpTab />\r\n                    {!isTwa() && <DonateButton onClick={changePage} />}\r\n                </MenuPanel>\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\nfunction SongRow(props) {\r\n    let data = props.data\r\n    let deleteSong = props.functions.removeSong\r\n    let toggleMenu = props.functions.toggleMenu\r\n    let downloadSong = props.functions.downloadSong\r\n\r\n    return <div className=\"song-row\">\r\n        <div className=\"song-name\" onClick={() => {\r\n            songStore.data = {\r\n                eventType: 'play',\r\n                song: data,\r\n                start: 0\r\n            }\r\n            toggleMenu(false)\r\n        }}>\r\n            {data.name}\r\n        </div>\r\n        <div className=\"song-buttons-wrapper\">\r\n            <button className=\"song-button\" onClick={() => {\r\n                songStore.data = {\r\n                    eventType: 'practice',\r\n                    song: data,\r\n                    start: 0\r\n                }\r\n                toggleMenu(false)\r\n            }}\r\n            >\r\n                <FaCrosshairs />\r\n            </button>\r\n\r\n            <button className=\"song-button\" onClick={() => {\r\n                songStore.data = {\r\n                    eventType: 'approaching',\r\n                    song: data,\r\n                    start: 0\r\n                }\r\n                toggleMenu(false)\r\n            }}\r\n            >\r\n                <BsCircle />\r\n            </button>\r\n            <button className=\"song-button\" onClick={() => downloadSong(data)}>\r\n                <FaDownload />\r\n\r\n            </button>\r\n            <button className=\"song-button\" onClick={() => deleteSong(data.name)}>\r\n                <FaTrash color=\"#ed4557\" />\r\n            </button>\r\n        </div>\r\n    </div>\r\n}\r\n\r\n\r\n\r\nexport default Menu","import { isMobile } from \"is-mobile\"\r\nimport { instruments, appName } from \"appConfig\"\r\n\r\nexport const ComposerSettings = {\r\n    settingVesion: appName + 17,\r\n    instrument: {\r\n        name: \"Instrument (Layer 1)\",\r\n        type: \"instrument\",\r\n        songSetting: false,\r\n        value: instruments[0],\r\n        volume: 100,\r\n        options: instruments\r\n    },\r\n    layer2: {\r\n        name: \"Instrument (Layer 2)\",\r\n        type: \"instrument\",\r\n        songSetting: false,\r\n        value: instruments[0],\r\n        volume: 100,\r\n        options: instruments\r\n    },\r\n    layer3: {\r\n        name: \"Instrument (Layer 3)\",\r\n        type: \"instrument\",\r\n        songSetting: false,\r\n        value: instruments[0],\r\n        volume: 100,\r\n        options: instruments\r\n    },\r\n    bpm: {\r\n        name: \"Bpm\",\r\n        type: \"number\",\r\n        songSetting: true,\r\n        threshold: [0, 1600],\r\n        value: 220\r\n    },\r\n    beatMarks: {\r\n        name: \"Beat marks\",\r\n        type: \"select\",\r\n        songSetting: false,\r\n        value: 3,\r\n        options: [\r\n            3,\r\n            4\r\n        ]\r\n    },\r\n    noteNameType: {\r\n        name: \"Note name type\",\r\n        type: \"select\",\r\n        songSetting: false,\r\n        value: appName === \"Genshin\"\r\n            ? isMobile()\r\n                ? \"Do Re Mi\"\r\n                : \"Keyboard layout\"\r\n            : \"Note name\",\r\n        options: appName === \"Genshin\"\r\n            ? [\r\n                \"Note name\",\r\n                \"Keyboard layout\",\r\n                \"Do Re Mi\"\r\n            ]\r\n            : [\r\n                \"Note name\",\r\n                \"Keyboard layout\"\r\n            ]\r\n    },\r\n    pitch: {\r\n        name: \"Pitch\",\r\n        type: \"select\",\r\n        songSetting: true,\r\n        value: \"C\",\r\n        options: [\r\n            \"C\",\r\n            \"Db\",\r\n            \"D\",\r\n            \"Eb\",\r\n            \"E\",\r\n            \"F\",\r\n            \"Gb\",\r\n            \"G\",\r\n            \"Ab\",\r\n            \"A\",\r\n            \"Bb\",\r\n            \"B\",\r\n        ]\r\n    },\r\n    columnsPerCanvas: {\r\n        name: \"Number of visible columns\",\r\n        type: \"select\",\r\n        songSetting: false,\r\n        value: 35,\r\n        options: [\r\n            20,\r\n            25,\r\n            30,\r\n            35,\r\n            40,\r\n            45,\r\n            50\r\n        ]\r\n    },\r\n    caveMode: {\r\n        name: \"Reverb (cave mode)\",\r\n        type: \"checkbox\",\r\n        songSetting: false,\r\n        value: false,\r\n    },\r\n    autosave: {\r\n        name: \"Autosave changes\",\r\n        type: \"checkbox\",\r\n        songSetting: false,\r\n        value: false,\r\n    },\r\n    backgroundImage: {\r\n        name: \"Background image (url)\",\r\n        type: \"text\",\r\n        songSetting: false,\r\n        value: \"\",\r\n        placeholder: \"Write here\"\r\n    },\r\n    syncTabs: {\r\n        name: \"Autoplay in all tabs (pc only)\",\r\n        type: \"checkbox\",\r\n        songSetting: false,\r\n        value: false\r\n    }\r\n}\r\n\r\n\r\n\r\nexport const MainPageSettings = {\r\n    settingVesion: appName + 17,\r\n    instrument: {\r\n        name: \"Instrument\",\r\n        type: \"instrument\",\r\n        songSetting: false,\r\n        value: instruments[0],\r\n        volume: 100,\r\n        options: instruments\r\n    },\r\n    pitch: {\r\n        name: \"Pitch\",\r\n        type: \"select\",\r\n        songSetting: true,\r\n        value: \"C\",\r\n        options: [\r\n            \"C\",\r\n            \"Db\",\r\n            \"D\",\r\n            \"Eb\",\r\n            \"E\",\r\n            \"F\",\r\n            \"Gb\",\r\n            \"G\",\r\n            \"Ab\",\r\n            \"A\",\r\n            \"Bb\",\r\n            \"B\",\r\n        ]\r\n    },\r\n    caveMode: {\r\n        name: \"Reverb (cave mode)\",\r\n        type: \"checkbox\",\r\n        songSetting: false,\r\n        value: false,\r\n    },\r\n    keyboardSize: {\r\n        name: \"Keyboard size\",\r\n        type: \"number\",\r\n        songSetting: false,\r\n        value: 100,\r\n        threshold: [0, 200]\r\n    },\r\n    noteNameType: {\r\n        name: \"Note name type\",\r\n        type: \"select\",\r\n        songSetting: false,\r\n        value: appName === \"Genshin\"\r\n            ? isMobile()\r\n                ? \"Do Re Mi\"\r\n                : \"Keyboard layout\"\r\n            : \"Note name\",\r\n\r\n        options: appName === \"Genshin\"\r\n            ? [\r\n                \"Note name\",\r\n                \"Keyboard layout\",\r\n                \"Do Re Mi\"\r\n            ]\r\n            : [\r\n                \"Note name\",\r\n                \"Keyboard layout\"\r\n            ]\r\n    },\r\n    approachSpeed: {\r\n        name: \"Approach Rate (AR)\",\r\n        type: \"number\",\r\n        songSetting: false,\r\n        value: 1500,\r\n        threshold: [0, 5000]\r\n    },\r\n    backgroundImage: {\r\n        name: \"Background image (url)\",\r\n        type: \"text\",\r\n        songSetting: false,\r\n        value: \"\",\r\n        placeholder: \"Write here\"\r\n    },\r\n    noteAnimation: {\r\n        name: \"Note animation\",\r\n        type: \"checkbox\",\r\n        songSetting: false,\r\n        value: false\r\n    }\r\n}","import { instrumentsData, layoutData, instruments,audioContext } from \"appConfig\"\r\n\r\nexport default class Instrument {\r\n    constructor(instrumentName) {\r\n        this.instrumentName = instrumentName === undefined ? instruments[0] : instrumentName\r\n        if (!instruments.includes(this.instrumentName)) this.instrumentName = instruments[0] \r\n        this.layout = []\r\n        this.buffers = []\r\n        this.loaded = false\r\n        this.deleted = false\r\n        this.volumeNode = audioContext.createGain()\r\n        const instrumentData = instrumentsData[this.instrumentName]\r\n        this.keyboardLayout = layoutData[instrumentData.notes].keyboardLayout\r\n        this.mobileLayout = layoutData[instrumentData.notes].mobileLayout\r\n        this.keyboardCodes = layoutData[instrumentData.notes].keyboardCodes\r\n        \r\n        this.keyboardLayout.forEach((noteName, i) => {\r\n            let noteNames = {\r\n                keyboard: noteName,\r\n                mobile: this.mobileLayout[i]\r\n            }\r\n            let url = `./assets/audio/${this.instrumentName}/${i}.mp3`\r\n            this.layout.push(new NoteData(i, noteNames, url))\r\n        })\r\n\r\n        this.volumeNode.gain.value = 0.8\r\n    }\r\n    getNoteFromCode = (code) => {\r\n        let index = this.keyboardLayout.findIndex(e => e === String(code))\r\n        return index !== -1 ? index : null\r\n    }\r\n\r\n    changeVolume = (amount) => {\r\n        let newVolume = Number((amount / 135).toFixed(2))\r\n        if(amount < 5) newVolume = 0\r\n        this.volumeNode.gain.value = newVolume\r\n    }\r\n\r\n    play = (note, pitch) => {\r\n        if(this.deleted) return\r\n        let player = audioContext.createBufferSource()\r\n        player.buffer = this.buffers[note]\r\n        player.connect(this.volumeNode)\r\n        player.playbackRate.value = pitch\r\n        player.start(0)\r\n        player.onended = () => {\r\n            player.stop()\r\n            player.disconnect()\r\n        }\r\n    }\r\n    load = async () => {\r\n        let emptyBuffer = audioContext.createBuffer(2, audioContext.sampleRate, audioContext.sampleRate)\r\n        const requests = this.layout.map(note => {\r\n            return new Promise(resolve => {\r\n                fetch(note.url)\r\n                    .then(result => result.arrayBuffer())\r\n                    .then(buffer => {\r\n                        audioContext.decodeAudioData(buffer, resolve, () => {\r\n                            resolve(emptyBuffer)\r\n                        })\r\n                        .catch(e => {resolve(emptyBuffer)})\r\n                    }).catch(e => {resolve(emptyBuffer)})\r\n            })\r\n        })\r\n        this.buffers = await Promise.all(requests)\r\n        this.loaded = true\r\n        return true\r\n    }\r\n    disconnect = () =>{\r\n        this.volumeNode.disconnect()\r\n    }\r\n    connect = (node) => {\r\n        this.volumeNode.connect(node)\r\n    }\r\n    delete = () => {\r\n        this.disconnect()\r\n        this.deleted = true\r\n        this.buffers = null\r\n    }\r\n}\r\n\r\nclass NoteData {\r\n    constructor(index, noteNames, url) {\r\n        this.index = index\r\n        this.noteNames = noteNames\r\n        this.url = url\r\n        this.buffer = new ArrayBuffer(8)\r\n    }\r\n}","import { audioContext } from \"appConfig\";\r\nimport toWav from 'audiobuffer-to-wav'\r\nimport MediaRecorderPolyfill from 'audio-recorder-polyfill'\r\nexport default class AudioRecorder {\r\n    constructor() {\r\n        this.node = audioContext.createMediaStreamDestination()\r\n        if(!window.MediaRecorder){\r\n            console.log(\"Audio recorder Polyfill\")\r\n            this.recorder = new MediaRecorderPolyfill(this.node.stream)\r\n        }else{\r\n            this.recorder = new MediaRecorder(this.node.stream)\r\n        }\r\n    }\r\n    start() {\r\n        this.recorder.start()\r\n    }\r\n    stop() {\r\n        return new Promise(resolve => {\r\n            this.recorder.addEventListener('dataavailable', function (e) {\r\n                resolve({\r\n                    data: e.data,\r\n                    toUrl: () => {\r\n                        return URL.createObjectURL(e.data);\r\n                    }\r\n                })\r\n            }, { once: true })\r\n            this.recorder.stop()\r\n        })\r\n    }\r\n\r\n    async download(urlBlob, fileName) {\r\n        const anchor = document.createElement(\"a\")\r\n        const wav = toWav(await blobToAudio(urlBlob))\r\n        var blob = new Blob([new DataView(wav)], {\r\n            type: 'audio/wav'\r\n        })\r\n        anchor.download = fileName\r\n        anchor.href = URL.createObjectURL(blob)\r\n        anchor.click();\r\n    }\r\n}\r\n\r\nfunction blobToAudio(blob) {\r\n    return new Promise(resolve => {\r\n        const audioContext = new AudioContext();\r\n        const fileReader = new FileReader();\r\n        fileReader.onloadend = () => {\r\n            audioContext.decodeAudioData(fileReader.result, (audioBuffer) => {\r\n                resolve(audioBuffer)\r\n            });\r\n        };\r\n        fileReader.readAsArrayBuffer(blob);\r\n    })\r\n}","import { LoggerEvent } from \"lib/Utils\"\r\n\r\nasync function asyncPrompt(question) {\r\n    return new Promise(resolve => {\r\n        const container = document.createElement(\"div\")\r\n        const text = document.createElement(\"div\")\r\n        const row = document.createElement(\"div\")\r\n        const cancel = document.createElement(\"button\")\r\n        const ok = document.createElement(\"button\")\r\n        const input = document.createElement(\"input\")\r\n\r\n        input.type = \"text\"\r\n        container.className = \"floating-prompt\"\r\n        input.placeholder = \"Write here\"\r\n        input.className = \"prompt-input\"\r\n        cancel.className = \"prompt-button\"\r\n        ok.className = \"prompt-button disabled\"\r\n        row.className = \"prompt-row\"\r\n        ok.innerText = \"Ok\"\r\n        cancel.innerText = \"Cancel\"\r\n        text.innerText = question\r\n\r\n        row.append(cancel, ok)\r\n        container.append(text, input, row)\r\n        document.body.appendChild(container)\r\n\r\n        let disposed = false\r\n        function inputListener(){\r\n            if(disposed) return\r\n            if (input.value.trim() === \"\") {\r\n                ok.classList.add(\"disabled\")\r\n            } else {\r\n                ok.classList.remove(\"disabled\")\r\n            }\r\n        }\r\n        function cancelListener(){\r\n            if(disposed) return\r\n            resolve(null)\r\n            dispose()\r\n        }\r\n        function okListener(){\r\n            if(disposed) return\r\n            if (input.value.trim() === '') return\r\n            if (input.value.trim() === \"Untitled\") {\r\n                input.value = \"\"\r\n                return new LoggerEvent(\"Warning\", '\"Untitled\" is a reserved word, use another').trigger()\r\n            }\r\n            resolve(input.value.trim())\r\n            dispose()\r\n        }\r\n        function handleKeyboard(event){\r\n            const key = event.code\r\n            if(key === 'Enter') okListener()\r\n            if(key === 'Escape') cancelListener()\r\n        }\r\n        input.focus()\r\n        cancel.addEventListener(\"click\", cancelListener)\r\n        ok.addEventListener(\"click\", okListener)\r\n        window.addEventListener('keydown',handleKeyboard)\r\n        input.addEventListener(\"input\", inputListener)\r\n\r\n        function dispose(){\r\n            ok.removeEventListener('click',okListener)\r\n            cancel.removeEventListener('click',cancelListener)\r\n            window.removeEventListener('keydown',handleKeyboard)\r\n            input.removeEventListener('inpit',inputListener)\r\n            disposed = true\r\n            container.classList.add(\"floating-prompt-hidden\")\r\n            setTimeout(() => container.remove(), 200)\r\n        }\r\n    })\r\n}\r\n\r\nasync function asyncConfirm(question) {\r\n    return new Promise(resolve => {\r\n        const container = document.createElement(\"div\")\r\n        const text = document.createElement(\"div\")\r\n        const row = document.createElement(\"div\")\r\n        const cancel = document.createElement(\"button\")\r\n        const ok = document.createElement(\"button\")\r\n\r\n        container.className = \"floating-prompt\"\r\n        text.innerText = question\r\n        cancel.className = \"prompt-button\"\r\n        ok.className = \"prompt-button\"\r\n        row.className = \"prompt-row\"\r\n        ok.innerText = \"Yes\"\r\n        ok.style.background = '#628c83'\r\n        cancel.style.background = '#a9525a'\r\n        cancel.innerText = \"No\"\r\n        \r\n        row.append(cancel, ok)\r\n        container.append(text, row)\r\n        document.body.appendChild(container)\r\n\r\n        let disposed = false\r\n        function okListener(){\r\n            if(disposed) return\r\n            resolve(true)\r\n            dispose()\r\n        }\r\n        function cancelListener(){\r\n            if(disposed) return\r\n            resolve(false)\r\n            dispose()\r\n        }\r\n        function handleKeyboard(event){\r\n            const key = event.code\r\n            if(key === 'Enter') okListener()\r\n            if(key === 'Escape') cancelListener()\r\n        }\r\n        cancel.addEventListener(\"click\", cancelListener)\r\n        ok.addEventListener(\"click\", okListener)\r\n        window.addEventListener('keydown',handleKeyboard)\r\n        document.activeElement.blur()\r\n        function dispose(){\r\n            disposed = true\r\n            cancel.removeEventListener('click',cancelListener)\r\n            ok.removeEventListener('click',okListener)\r\n            window.removeEventListener('keydown',handleKeyboard)\r\n            container.classList.add(\"floating-prompt-hidden\")\r\n            setTimeout(() => container.remove(), 200)\r\n        }\r\n    })\r\n}\r\n\r\nexport {\r\n    asyncConfirm,\r\n    asyncPrompt\r\n}","import React, { Component } from 'react';\r\nimport Keyboard from \"./Keyboard\"\r\nimport Menu from \"./Menu\"\r\nimport { songStore } from './SongStore'\r\nimport ZangoDb from \"zangodb\"\r\nimport { Song, Recording, LoggerEvent, prepareSongImport, getPitchChanger } from \"lib/Utils\"\r\nimport { MainPageSettings } from \"lib/SettingsObj\"\r\nimport Instrument from 'lib/Instrument';\r\nimport AudioRecorder from 'lib/AudioRecorder';\r\nimport { asyncConfirm, asyncPrompt } from \"components/AsyncPrompts\"\r\nimport { appName, audioContext , isTwa} from \"appConfig\"\r\nimport './App.css';\r\nclass App extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props)\r\n\t\tthis.db = new ZangoDb.Db(appName, { songs: [] })\r\n\t\tthis.recording = new Recording()\r\n\t\tlet settings = this.getSettings()\r\n\t\tthis.dbCol = {\r\n\t\t\tsongs: this.db.collection(\"songs\")\r\n\t\t}\r\n\t\tthis.state = {\r\n\t\t\tinstrument: new Instrument(),\r\n\t\t\tisLoadingInstrument: true,\r\n\t\t\tisRecording: false,\r\n\t\t\tisRecordingAudio: false,\r\n\t\t\tsongs: [],\r\n\t\t\tsettings: settings,\r\n\t\t\tisDragging: false,\r\n\t\t\tthereIsSong: false\r\n\t\t}\r\n\t\tthis.mounted = false\r\n\t\tthis.reverbNode = undefined\r\n\t\tthis.reverbVolumeNode = undefined\r\n\t\tthis.audioContext = audioContext\r\n\t\tthis.recorder = new AudioRecorder()\r\n\t}\r\n\r\n\tinit = async () => {\r\n\t\tconst { settings } = this.state\r\n\t\tawait this.loadInstrument(settings.instrument.value)\r\n\t\tawait this.loadReverb()\r\n\t\tthis.toggleReverbNodes(settings.caveMode.value)\r\n\t}\r\n\tcomponentDidMount() {\r\n\t\tdocument.body.addEventListener('dragenter', this.handleDrag)\r\n\t\tdocument.body.addEventListener('dragleave', this.resetDrag)\r\n\t\tdocument.body.addEventListener('dragover', this.handleDragOver)\r\n\t\tdocument.body.addEventListener('drop', this.handleDrop)\r\n        window.addEventListener('keydown', this.handleKeyboard)\r\n\r\n\t\tthis.mounted = true\r\n\t\tthis.syncSongs()\r\n\t\tthis.init()\r\n\t}\r\n\tcomponentWillUnmount() {\r\n\t\tdocument.body.removeEventListener('dragenter', this.handleDrag)\r\n\t\tdocument.body.removeEventListener('dragleave', this.resetDrag)\r\n\t\tdocument.body.removeEventListener('drop', this.handleDrop)\r\n\t\tdocument.body.removeEventListener('dragover', this.handleDragOver)\r\n        window.removeEventListener('keydown', this.handleKeyboard)\r\n\r\n\t\tsongStore.data = {\r\n\t\t\tsong: {},\r\n\t\t\teventType: 'stop',\r\n\t\t\tstart: 0\r\n\t\t}\r\n\t\tthis.mounted = false\r\n\t\tthis.audioContext = undefined\r\n\t\tthis.recorder = undefined\r\n\t\tthis.reverbNode = undefined\r\n\t\tthis.reverbVolumeNode = undefined\r\n\t\tthis.state.instrument.delete()\r\n\t}\r\n\thandleKeyboard =async (event) => {\r\n\t\tconst { thereIsSong } = this.state\r\n        if (event.repeat) return\r\n        if (document.activeElement.tagName === \"INPUT\") return\r\n        if(event.shiftKey){\r\n            switch(event.code){\r\n                case \"KeyR\" : {\r\n                    if(!thereIsSong){\r\n\t\t\t\t\t\tthis.toggleRecord()\r\n\t\t\t\t\t\tevent.preventDefault()\r\n\t\t\t\t\t}\r\n                    break;\r\n                }\r\n\t\t\t\tdefault: break;\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\tresetDrag = (e) => {\r\n\t\tthis.setState({\r\n\t\t\tisDragging: false\r\n\t\t})\r\n\t}\r\n\thandleDragOver = (e) => {\r\n\t\te.preventDefault()\r\n\t\tthis.setState({\r\n\t\t\tisDragging: true\r\n\t\t})\r\n\t}\r\n\thandleDrag = (e) => {\r\n\t\te.preventDefault()\r\n\t\tthis.setState({\r\n\t\t\tisDragging: true\r\n\t\t})\r\n\t}\r\n\tsetHasSong = (data) => {\r\n\t\tthis.setState({\r\n\t\t\tthereIsSong: data\r\n\t\t})\r\n\t}\r\n\thandleDrop = async (e) => {\r\n\t\tthis.resetDrag()\r\n\t\te.preventDefault()\r\n\t\tlet songs = await Promise.all(Array.from(e.dataTransfer.files).map(file => file.text()))\r\n\t\tfor (let i = 0; i < songs.length; i++) {\r\n\t\t\ttry {\r\n\t\t\t\tlet song = prepareSongImport(JSON.parse(songs[i]))\r\n\t\t\t\tawait this.addSong(song)\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(e)\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\ttoggleReverbNodes = (hasReverb) => {\r\n\t\tif(!this.mounted) return\r\n\t\tconst { instrument } = this.state\r\n\t\tif (hasReverb) {\r\n\t\t\tif (!this.reverbNode) return console.log(\"Couldn't connect to reverb\")\r\n\t\t\tinstrument.disconnect()\r\n\t\t\tinstrument.connect(this.reverbNode)\r\n\t\t} else {\r\n\t\t\tinstrument.disconnect()\r\n\t\t\tinstrument.connect(this.audioContext.destination)\r\n\t\t}\r\n\t}\r\n\tchangeVolume = (obj) => {\r\n        let settings = this.state.settings\r\n        if (obj.key === \"instrument\") {\r\n            settings.instrument.volume = obj.value\r\n            this.state.instrument.changeVolume(obj.value)\r\n        }\r\n        this.setState({\r\n            settings: settings\r\n        }, () => this.updateSettings())\r\n    }\r\n\tgetSettings = () => {\r\n\t\tlet storedSettings = localStorage.getItem(appName + \"_Main_Settings\")\r\n\t\ttry {\r\n\t\t\tstoredSettings = JSON.parse(storedSettings)\r\n\t\t} catch (e) {\r\n\t\t\tstoredSettings = null\r\n\t\t}\r\n\t\tif (storedSettings !== null) {\r\n\t\t\tif (storedSettings.settingVesion !== MainPageSettings.settingVesion) {\r\n\t\t\t\tthis.updateSettings(MainPageSettings)\r\n\t\t\t\treturn MainPageSettings\r\n\t\t\t}\r\n\t\t\treturn storedSettings\r\n\t\t}\r\n\t\treturn MainPageSettings\r\n\t}\r\n\tloadInstrument = async (name) => {\r\n\t\tthis.state.instrument?.delete?.()\r\n\t\tlet newInstrument = new Instrument(name)\r\n\t\tthis.setState({ isLoadingInstrument: true })\r\n\t\tawait newInstrument.load()\r\n\t\tif(!this.mounted) return \r\n\t\tnewInstrument.connect(this.audioContext.destination)\r\n\t\tthis.setState({\r\n\t\t\tinstrument: newInstrument,\r\n\t\t\tisLoadingInstrument: false\r\n\t\t}, () => this.toggleReverbNodes(this.state.settings.caveMode.value))\r\n\t}\r\n\tloadReverb() {\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tfetch(\"./assets/audio/reverb4.wav\")\r\n\t\t\t\t.then(r => r.arrayBuffer())\r\n\t\t\t\t.then(b => {\r\n\t\t\t\t\tif(!this.mounted) return\r\n\t\t\t\t\tthis.audioContext.decodeAudioData(b, (impulse_response) => {\r\n\t\t\t\t\t\tif(!this.mounted) return\r\n\t\t\t\t\t\tlet convolver = this.audioContext.createConvolver()\r\n\t\t\t\t\t\tlet gainNode = this.audioContext.createGain()\r\n\t\t\t\t\t\tgainNode.gain.value = 2.5\r\n\t\t\t\t\t\tconvolver.buffer = impulse_response\r\n\t\t\t\t\t\tconvolver.connect(gainNode)\r\n\t\t\t\t\t\tgainNode.connect(this.audioContext.destination)\r\n\t\t\t\t\t\tthis.reverbVolumeNode = gainNode\r\n\t\t\t\t\t\tthis.reverbNode = convolver\r\n\t\t\t\t\t\tresolve()\r\n\t\t\t\t\t})\r\n\t\t\t\t}).catch((e) => {\r\n\t\t\t\t\tconsole.log(\"Error with reverb\", e)\r\n\t\t\t\t})\r\n\t\t})\r\n\r\n\t}\r\n\tplaySound = (note) => {\r\n\t\tconst { state } = this\r\n\t\tconst { settings } = state\r\n\t\tif (note === undefined) return\r\n\t\tif (state.isRecording) this.handleRecording(note)\r\n\t\tthis.state.instrument.play(note.index, getPitchChanger(settings.pitch.value))\r\n\t}\r\n\tupdateSettings = (override) => {\r\n\t\tlet state\r\n\t\tif (override !== undefined) {\r\n\t\t\tstate = override\r\n\t\t} else {\r\n\t\t\tstate = this.state.settings\r\n\t\t}\r\n\t\tlocalStorage.setItem(appName + \"_Main_Settings\", JSON.stringify(state))\r\n\t}\r\n\thandleSettingChange = (setting) => {\r\n\t\tlet settings = this.state.settings\r\n\t\tlet data = setting.data\r\n\t\tsettings[setting.key].value = data.value\r\n\t\tif (setting.key === \"instrument\") {\r\n\t\t\tthis.loadInstrument(data.value)\r\n\t\t}\r\n\t\tif (setting.key === 'caveMode') {\r\n\t\t\tthis.toggleReverbNodes(data.value)\r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\tsettings: settings,\r\n\t\t}, this.updateSettings)\r\n\t}\r\n\tsyncSongs = async () => {\r\n\t\tlet songs = await this.dbCol.songs.find().toArray()\r\n\t\tthis.setState({\r\n\t\t\tsongs: songs\r\n\t\t})\r\n\t}\r\n\r\n\tsongExists = async (name) => {\r\n\t\treturn await this.dbCol.songs.findOne({ name: name }) !== undefined\r\n\t}\r\n\taddSong = async (song) => {\r\n\t\ttry {\r\n\t\t\tif (await this.songExists(song.name)) {\r\n\t\t\t\treturn new LoggerEvent(\"Warning\", \"A song with this name already exists! \\n\" + song.name).trigger()\r\n\t\t\t}\r\n\t\t\tawait this.dbCol.songs.insert(song)\r\n\t\t\tthis.syncSongs()\r\n\t\t\tnew LoggerEvent(\"Success\", `Song added to the ${song.data.isComposedVersion ? \"Composed\" : \"Recorded\"} tab!`, 4000).trigger()\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error(e)\r\n\t\t\treturn new LoggerEvent(\"Error\", 'There was an error importing the song').trigger()\r\n\t\t}\r\n\r\n\t}\r\n\tcomponentDidCatch() {\r\n\t\tnew LoggerEvent(\"Warning\", \"There was an error with the song! Restoring default...\").trigger()\r\n\t\tsongStore.data = {\r\n\t\t\tsong: {}, eventType: 'stop', start: 0\r\n\t\t}\r\n\t}\r\n\tremoveSong = async (name) => {\r\n\t\tlet result = await asyncConfirm(`Are you sure you want to delete the song: \"${name}\" ?`)\r\n\t\tif(!this.mounted) return\r\n\t\tif (result) {\r\n\t\t\tthis.dbCol.songs.remove({ name: name }, this.syncSongs)\r\n\t\t}\r\n\t}\r\n\thandleRecording = (note) => {\r\n\t\tif (this.state.isRecording) {\r\n\t\t\tthis.recording.addNote(note.index)\r\n\t\t}\r\n\t}\r\n\taskForSongName = () => {\r\n\t\treturn new Promise(async resolve => {\r\n\t\t\tlet promptString = \"Write song name, press cancel to ignore\"\r\n\t\t\twhile (true) {\r\n\t\t\t\tlet songName = await asyncPrompt(promptString)\r\n\t\t\t\tif (songName === null) return resolve(null)\r\n\t\t\t\tif (songName !== \"\") {\r\n\t\t\t\t\tif (await this.songExists(songName)) {\r\n\t\t\t\t\t\tpromptString = \"This song already exists: \" + songName\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn resolve(songName)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpromptString = \"Write song name, press cancel to ignore\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t}\r\n\ttoggleRecord = async (override) => {\r\n\t\tif (typeof override !== \"boolean\") override = undefined\r\n\t\tlet newState = override !== undefined ? override : !this.state.isRecording\r\n\t\tif (!newState && this.recording.notes.length > 0) { //if there was a song recording\r\n\t\t\tlet songName = await this.askForSongName()\r\n\t\t\tif(!this.mounted) return\r\n\t\t\tlet song = new Song(songName, this.recording.notes)\r\n\t\t\tsong.pitch = this.state.settings.pitch.value\r\n\t\t\tif (songName !== null) this.addSong(song)\r\n\t\t} else {\r\n\t\t\tthis.recording = new Recording()\r\n\t\t}\r\n\t\tthis.state.isRecording = newState\r\n\t\tthis.setState({\r\n\t\t\topen: this.state.isRecording\r\n\t\t})\r\n\t}\r\n\ttoggleRecordAudio = async (override) => {\r\n\t\tif(!this.mounted) return\r\n\t\tif (typeof override !== \"boolean\") override = undefined\r\n\t\tconst { instrument } = this.state\r\n\t\tconst { recorder } = this\r\n\t\tconst hasReverb = this.state.settings.caveMode.value\r\n\t\tconst newState = override !== undefined ? override : !this.state.isRecordingAudio\r\n\t\tif (newState) {\r\n\t\t\tif (hasReverb) {\r\n\t\t\t\tthis.reverbVolumeNode.connect(recorder.node)\r\n\t\t\t} else {\r\n\t\t\t\tinstrument.connect(recorder.node)\r\n\t\t\t}\r\n\t\t\trecorder.start()\r\n\t\t} else {\r\n\t\t\tlet recording = await recorder.stop()\r\n\t\t\tlet fileName = await asyncPrompt(\"Write the song name, press cancel to ignore\")\r\n\t\t\tif(!this.mounted) return\r\n\t\t\tif (fileName) recorder.download(recording.data, fileName + '.wav')\r\n\t\t\tthis.toggleReverbNodes(hasReverb)\r\n\t\t\tthis.reverbVolumeNode.disconnect()\r\n\t\t\tthis.reverbVolumeNode.connect(audioContext.destination)\r\n\r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\tisRecordingAudio: newState\r\n\t\t})\r\n\t}\r\n\trender() {\r\n\t\tconst { state } = this\r\n\t\tconst keyboardFunctions = {\r\n\t\t\tchangeSliderState: this.changeSliderState,\r\n\t\t\tplaySound: this.playSound,\r\n\t\t\tsetHasSong: this.setHasSong\r\n\t\t}\r\n\t\tconst keyboardData = {\r\n\t\t\tisLoading: state.isLoadingInstrument,\r\n\t\t\tkeyboard: state.instrument,\r\n\t\t\tpitch: state.settings.pitch.value,\r\n\t\t\tkeyboardSize: state.settings.keyboardSize.value,\r\n\t\t\tnoteNameType: state.settings.noteNameType.value,\r\n\t\t\thasSong: state.thereIsSong,\r\n\t\t\thasAnimation: state.settings.noteAnimation.value,\r\n\t\t\tapproachRate: state.settings.approachSpeed.value\r\n\t\t}\r\n\t\tconst menuFunctions = {\r\n\t\t\taddSong: this.addSong,\r\n\t\t\tremoveSong: this.removeSong,\r\n\t\t\tchangePage: this.props.changePage,\r\n\t\t\thandleSettingChange: this.handleSettingChange,\r\n\t\t\tchangeVolume: this.changeVolume\r\n\t\t}\r\n\t\tconst menuData = {\r\n\t\t\tsongs: state.songs,\r\n\t\t\tsettings: state.settings\r\n\t\t}\r\n\r\n\t\treturn <div className='app bg-image' style={{ backgroundImage: `url(${state.settings.backgroundImage.value})` }}>\r\n\t\t\t{songStore.data.eventType !== 'approaching' &&\r\n\t\t\t\t<div className='record-button'>\r\n\t\t\t\t\t<AppButton\r\n\t\t\t\t\t\tactive={state.isRecordingAudio}\r\n\t\t\t\t\t\tclick={this.toggleRecordAudio}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{state.isRecordingAudio ? \"Finish recording\" : \"Record audio\"}\r\n\t\t\t\t\t</AppButton>\r\n\t\t\t\t</div>\r\n\t\t\t}\r\n\r\n\t\t\t{state.isDragging && <div className='drag-n-drop'>\r\n\t\t\t\tDrop file here\r\n\t\t\t</div>}\r\n\t\t\t<Menu functions={menuFunctions} data={menuData} />\r\n\t\t\t<div className=\"right-panel\">\r\n\t\t\t\t<div className=\"upper-right\">\r\n\t\t\t\t\t{!this.state.thereIsSong\r\n\t\t\t\t\t\t&&\r\n\t\t\t\t\t\t<AppButton\r\n\t\t\t\t\t\t\tactive={state.isRecording}\r\n\t\t\t\t\t\t\tclick={this.toggleRecord}\r\n\t\t\t\t\t\t\tstyle={{marginTop: \"0.8rem\"}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{state.isRecording ? \"Stop\" : \"Record\"}\r\n\t\t\t\t\t\t</AppButton>\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"keyboard-wrapper\" style={{marginBottom: '2vh'}}>\r\n\t\t\t\t\t<Keyboard\r\n\t\t\t\t\t\tkey={state.instrument.instrumentName}\r\n\t\t\t\t\t\tdata={keyboardData}\r\n\t\t\t\t\t\tfunctions={keyboardFunctions}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\r\n\t}\r\n}\r\n\r\n\r\nfunction setIfInTWA() {\r\n\tif (isTwa()) return console.log('inTWA')\r\n\tlet isInTwa = document.referrer.includes('android-app://')\r\n\tsessionStorage.setItem('isTwa', isInTwa)\r\n}\r\nsetIfInTWA()\r\nfunction AppButton(props) {\r\n\tlet className = \"genshin-button \" + (props.active ? \"selected\" : \"\")\r\n\treturn <button className={className} onClick={props.click} style={{ ...(props.style || {}) }}>\r\n\t\t{props.children}\r\n\t</button>\r\n}\r\nexport default App;\r\n","export default __webpack_public_path__ + \"static/media/addCell.73b6c8e9.svg\";","export default __webpack_public_path__ + \"static/media/removeCell.e266ba1a.svg\";","import { useState, useEffect } from 'react';\r\nfunction useDebounce(value, delay) {\r\n  // State and setters for debounced value\r\n  const [debouncedValue, setDebouncedValue] = useState(value);\r\n  useEffect(\r\n    () => {\r\n      const handler = setTimeout(() => {\r\n        setDebouncedValue(value);\r\n      }, delay);\r\n      return () => {\r\n        clearTimeout(handler);\r\n      };\r\n    },\r\n    [value, delay]\r\n  );\r\n  return debouncedValue;\r\n}\r\nexport default useDebounce;","import React, { Component, useEffect, useState } from 'react'\r\nimport { FilePicker } from \"react-file-picker\"\r\nimport { Midi } from '@tonejs/midi'\r\nimport { LoggerEvent, pitchArr, ColumnNote, Column, numberToLayer, ComposedSong, groupByIndex, mergeLayers } from 'lib/Utils'\r\nimport { appName } from 'appConfig'\r\nimport { FaInfoCircle } from 'react-icons/fa'\r\nimport useDebounce from './useDebounce'\r\nclass MidiImport extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            fileName: '',\r\n            midi: null,\r\n            bpm: 220,\r\n            offset: 0,\r\n            pitch: 'C',\r\n            accidentals: 0,\r\n            outOfRange: 0,\r\n            totalNotes: 0,\r\n            includeAccidentals: true\r\n        }\r\n    }\r\n    handleFile = (file) => {\r\n        const reader = new FileReader();\r\n        reader.addEventListener('load', (event) => {\r\n            let midi\r\n            try {\r\n                midi = new Midi(event.target.result)\r\n            } catch (e) {\r\n                console.error(e)\r\n            }\r\n            if (!midi) return new LoggerEvent('Error', 'There was an error importing this file', 2000).trigger()\r\n            let bpm = midi.header.tempos[0]?.bpm\r\n            let key = midi.header.keySignatures[0]?.key\r\n            midi.tracks.forEach((track, i) => {\r\n                track.selected = true\r\n                track.layer = 0\r\n                track.name = track.name || `Track n.${i + 1}`\r\n                track.numberOfAccidentals = 0\r\n                track.numberOfOutOfRange = 0\r\n            })\r\n            this.setState({\r\n                midi: midi,\r\n                fileName: file.name,\r\n                bpm: Math.floor(bpm * 4) || 220,\r\n                offset: 0,\r\n                pitch: pitchArr.includes(key) ? key : 'C',\r\n            }, () => { if (this.state.midi !== null) this.convertMidi()})\r\n        })\r\n        reader.readAsArrayBuffer(file)\r\n    }\r\n\r\n    convertMidi = () => {\r\n        const { midi, bpm, offset, includeAccidentals,pitch } = this.state\r\n        let tracks = midi.tracks.filter(track => track.selected)\r\n        let notes = []\r\n        let numberOfAccidentals = 0\r\n        let outOfRange = 0\r\n        let totalNotes = 0\r\n        tracks.forEach(track => {\r\n            track.numberOfAccidentals = 0\r\n            track.numberOfOutOfRange = 0\r\n            track.notes.forEach(midiNote => {\r\n                totalNotes++\r\n                let convertedNote = convertMidiNote(midiNote.midi - offset)\r\n                let note = {\r\n                    time: Math.floor(midiNote.time * 1000),\r\n                    note: convertedNote.note,\r\n                    layer: track.layer\r\n                }\r\n                if(convertedNote.isAccidental){\r\n                    numberOfAccidentals ++\r\n                    track.numberOfAccidentals ++\r\n                }\r\n                if (note.note !== null) {\r\n                    if (includeAccidentals || !convertedNote.isAccidental) {\r\n                        notes.push(note)\r\n                    }\r\n                } else {\r\n                    outOfRange++\r\n                    track.numberOfOutOfRange ++\r\n                }\r\n            })\r\n        })\r\n        notes = notes.sort((a, b) => a.time - b.time)\r\n        let bpmToMs = Math.floor(60000 / bpm)\r\n        let groupedNotes = []\r\n        while (notes.length > 0) {\r\n            let row = [notes.shift()]\r\n            let amount = 0\r\n            for (let i = 0; i < notes.length; i++) {\r\n                if (row[0].time > notes[i].time - bpmToMs / 9) amount++\r\n            }\r\n            groupedNotes.push([...row, ...notes.splice(0, amount)])\r\n        }\r\n        let columns = []\r\n        let previousTime = 0\r\n        groupedNotes.forEach(notes => {\r\n            let note = notes[0]\r\n            if (!note) return\r\n            let elapsedTime = note.time - previousTime\r\n            previousTime = note.time\r\n            let emptyColumns = Math.floor((elapsedTime - bpmToMs) / bpmToMs)\r\n            if (emptyColumns > -1) new Array(emptyColumns).fill(0).forEach(() => columns.push(new Column())) // adds empty columns\r\n            let noteColumn = new Column()\r\n            noteColumn.notes = notes.map(note => {\r\n                return new ColumnNote(note.note, numberToLayer(note.layer))\r\n            })\r\n            columns.push(noteColumn)\r\n        })\r\n        columns.forEach(column => { //merges notes of different layer\r\n            let groupedNotes = groupByIndex(column)\r\n            column.notes = groupedNotes.map(group => {\r\n                group[0].layer = mergeLayers(group)\r\n                return group[0]\r\n            })\r\n        })\r\n        let song = new ComposedSong(\"Untitled\")\r\n        song.columns = columns\r\n        song.bpm = bpm\r\n        song.instruments = this.props.data.instruments\r\n        song.pitch = pitch\r\n        let lastColumn = this.props.data.selectedColumn\r\n        song.selected = lastColumn < song.columns.length ? lastColumn : 0\r\n        if (song.columns.length === 0) {\r\n            return new LoggerEvent(\"Error\", \"There are no notes\", 2000).trigger()\r\n        }\r\n        this.props.functions.loadSong(song)\r\n        this.setState({\r\n            accidentals: numberOfAccidentals,\r\n            totalNotes: totalNotes,\r\n            outOfRange: outOfRange\r\n        })\r\n    }\r\n\r\n    editTrack = (command, data) => {\r\n        let tracks = this.state.midi.tracks\r\n        if (command === 'index') {\r\n\r\n            tracks[data.index].selected = !tracks[data.index].selected\r\n        }\r\n        if (command === 'layer') {\r\n            tracks[data.index].layer = data.layer\r\n        }\r\n\r\n        this.setState({\r\n            midi: this.state.midi\r\n        }, () => { if (this.state.midi !== null) this.convertMidi() })\r\n    }\r\n    changeOffset = (value) => {\r\n        value = parseInt(value)\r\n        if (!Number.isInteger(value)) value = 0\r\n        if(this.state.offset === value) return\r\n        this.setState({\r\n            offset: value\r\n        }, () => { if (this.state.midi !== null) this.convertMidi() })\r\n    }\r\n    changePitch = (value) => {\r\n        this.props.functions.changePitch(value)\r\n        this.setState({\r\n            pitch: value\r\n        })\r\n    }\r\n    toggleAccidentals = () => {\r\n        this.setState({\r\n            includeAccidentals: !this.state.includeAccidentals\r\n        }, () => { if (this.state.midi !== null) this.convertMidi() })\r\n    }\r\n    changeBpm = (value) => {\r\n        value = parseInt(value)\r\n        if (!Number.isInteger(value)) value = 0\r\n        if(this.state.bpm === value) return\r\n        this.setState({\r\n            bpm: value\r\n        }, () => { if (this.state.midi !== null) this.convertMidi() })\r\n    }\r\n    render() {\r\n        const { handleFile, editTrack, state, changeBpm, changeOffset, changePitch } = this\r\n        const { fileName, midi, bpm, offset, pitch, accidentals, outOfRange, totalNotes, includeAccidentals } = state\r\n        const { functions } = this.props\r\n        const { changeMidiVisibility } = functions\r\n        return <div className='floating-midi'>\r\n            <div\r\n                className='midi-row separator-border'\r\n                style={{ width: '100%' }}\r\n            >\r\n                <FilePicker onChange={handleFile}>\r\n                    <button className=\"midi-btn\">\r\n                        Click to load midi file\r\n                    </button>\r\n                </FilePicker>\r\n                <div style={{ margin: '0 0.5rem', maxWidth: '8rem', textOverflow: 'ellipsis', overflow: 'hidden' }}>\r\n                    {fileName}\r\n                </div>\r\n                <button\r\n                    className='midi-btn'\r\n                    style={{ marginLeft: 'auto' }}\r\n                    onClick={() => changeMidiVisibility(false)}\r\n                >\r\n                    Close\r\n                </button>\r\n            </div>\r\n            <table className='separator-border' style={{ width: \"100%\" }}>\r\n                <tr>\r\n                    <td>\r\n                        <div style={{ marginRight: '0.5rem' }}>Bpm:</div>\r\n                    </td>\r\n                    <td style={{ display: 'flex', justifyContent: 'flex-end', alignItems:\"center\" }}>\r\n                    <NumberInput\r\n                            value={bpm}\r\n                            changeValue={changeBpm}\r\n                            delay={600}\r\n                            step={5}\r\n                        />\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\r\n                        <div style={{ marginRight: '0.5rem' }}>Scale notes by: </div>\r\n                    </td>\r\n                    <td>\r\n                        <NumberInput\r\n                            value={offset}\r\n                            changeValue={changeOffset}\r\n                            delay={600}\r\n                            step={1}\r\n                        />\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\r\n                        <div style={{ marginRight: '0.5rem' }}>Pitch:</div>\r\n                    </td>\r\n                    <td style={{ display: 'flex', justifyContent: 'flex-end', alignItems:\"center\" }}>\r\n                        <select\r\n                            className='midi-select'\r\n                            value={pitch}\r\n                            onChange={(event) => changePitch(event.target.value)}\r\n                            style={{ backgroundColor: '#576377', width: '5rem' }}\r\n                        >\r\n                            <option value=\"C\">C</option>\r\n                            <option value=\"Db\">Db</option>\r\n                            <option value=\"D\">D</option>\r\n                            <option value=\"Eb\">Eb</option>\r\n                            <option value=\"E\">E</option>\r\n                            <option value=\"F\">F</option>\r\n                            <option value=\"Gb\">Gb</option>\r\n                            <option value=\"G\">G</option>\r\n                            <option value=\"Ab\">Ab</option>\r\n                            <option value=\"A\">A</option>\r\n                            <option value=\"Bb\">Bb</option>\r\n                            <option value=\"B\">B</option>\r\n                        </select>\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td>\r\n                        <div style={{ marginRight: '0.5rem' }}>Include accidentals:</div>\r\n                    </td>\r\n                    <td style={{ display: 'flex', justifyContent: 'flex-end' }}>\r\n                        <input type='checkbox'\r\n                            checked={includeAccidentals}\r\n                            onChange={this.toggleAccidentals}\r\n                        />\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n            {midi !== null && <div className='midi-column separator-border' style={{ width: '100%' }}>\r\n                <div className='midi-column' style={{ width: '100%' }}>\r\n                    <div>Select midi tracks</div>\r\n                    {midi?.tracks.map((track, i) =>\r\n                        <Track\r\n                            data={track}\r\n                            key={i}\r\n                            index={i}\r\n                            editTrack={editTrack}\r\n                        />\r\n                    )}\r\n                </div>\r\n            </div>\r\n            }\r\n            {midi !== null && <table>\r\n                <tr>\r\n                    <td>Total notes: </td>\r\n                    <td />\r\n                    <td>{totalNotes}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>Accidentals: </td>\r\n                    <td />\r\n                    <td>{accidentals}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>Out of range: </td>\r\n                    <td />\r\n                    <td>{outOfRange}</td>\r\n                </tr>\r\n            </table>\r\n            }\r\n        </div>\r\n    }\r\n}\r\n\r\nfunction Track(props) {\r\n    const { data, index, editTrack } = props\r\n    const [dataShown, setDataShown] = useState(false)\r\n    return <div className='midi-track-column'>\r\n        <div className='midi-track-wrapper'>\r\n            <div className='midi-track-center'>\r\n                <input type='checkbox' onChange={() => editTrack(\"index\", { index: index })} checked={data.selected} />\r\n                {data.name} ({data.notes.length})\r\n            </div>\r\n            <div className='midi-track-center'>\r\n                <div style={{ textAlign: 'center' }}>\r\n                    {data.instrument.family}\r\n                </div>\r\n                <select\r\n                    onChange={(event) => editTrack('layer', { index: index, layer: Number(event.target.value) })}\r\n                    value={data.layer}\r\n                    className='midi-select'\r\n                >\r\n                    <option value='0'>Layer 1</option>\r\n                    <option value='1'>Layer 2</option>\r\n                    <option value='2'>Layer 3</option>\r\n                </select>\r\n\r\n                <FaInfoCircle\r\n                    size={22}\r\n                    color={dataShown ? \"rgb(207, 122, 130)\" : \"white\"}\r\n                    onClick={() => setDataShown(!dataShown)}\r\n                    cursor='pointer'\r\n                />\r\n            </div>\r\n\r\n        </div>\r\n        <div className='midi-track-data' style={{ display: dataShown ? \"flex\" : \"none\" }}>\r\n            <div className='midi-track-data-row'>\r\n                <div>Instrument:</div>\r\n                <div>{data.instrument.name}</div>\r\n            </div>\r\n            <div className='midi-track-data-row'>\r\n                <div>Number of notes:</div>\r\n                <div>{data.notes.length}</div>\r\n            </div>\r\n            <div className='midi-track-data-row'>\r\n                <div>Accidentals:</div>\r\n                <div>{data.numberOfAccidentals}</div>\r\n            </div>\r\n            <div className='midi-track-data-row'>\r\n                <div>Out of range:</div>\r\n                <div>{data.numberOfOutOfRange}</div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n}\r\n\r\nexport default MidiImport\r\n\r\nfunction NumberInput(props) {\r\n    const { changeValue, value, delay = 500, step = 1 } = props\r\n    const [elementValue, setElementValue] = useState(value)\r\n    const debounced = useDebounce(elementValue, delay) \r\n    useEffect(() => {\r\n        changeValue(debounced)\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [debounced]);\r\n    useEffect(() => {\r\n        setElementValue(value)\r\n    }, [value])\r\n    return <div style={{ display: 'flex', justifyContent: 'flex-end' }} >\r\n        <button\r\n            onClick={() => setElementValue(elementValue - step)}\r\n            className='midi-btn-small'\r\n        >-</button>\r\n        <input\r\n            type=\"text\"\r\n            value={elementValue}\r\n            onChange={(e) => setElementValue(e.target.value)}\r\n            className='midi-input'\r\n            style={{ margin: '0 0.3rem' }}\r\n        />\r\n        <button\r\n            onClick={() => setElementValue(elementValue + step)}\r\n            className='midi-btn-small'\r\n        >+</button>\r\n    </div>\r\n}\r\n\r\nfunction convertMidiNote(midiNote) {\r\n    let note = null\r\n    let isAccidental = false\r\n    if (appName === 'Sky') {\r\n        switch (midiNote) {\r\n            case 60: note = 0; break;\r\n            case 61: note = 0; isAccidental = true; break;\r\n            case 62: note = 1; break;\r\n            case 63: note = 1; isAccidental = true; break;\r\n            case 64: note = 2; break;\r\n            case 65: note = 3; break;\r\n            case 66: note = 3; isAccidental = true; break;\r\n            case 67: note = 4; break;\r\n            case 68: note = 4; isAccidental = true; break;\r\n            case 69: note = 5; break;\r\n            case 70: note = 5; isAccidental = true; break;\r\n            case 71: note = 6; break;\r\n            case 72: note = 7; break;\r\n            case 73: note = 7; isAccidental = true; break;\r\n            case 74: note = 8; break;\r\n            case 75: note = 8; isAccidental = true; break;\r\n            case 76: note = 9; break;\r\n            case 77: note = 10; break;\r\n            case 78: note = 10; isAccidental = true; break;\r\n            case 79: note = 11; break;\r\n            case 80: note = 11; isAccidental = true; break;\r\n            case 81: note = 12; break;\r\n            case 82: note = 12; isAccidental = true; break;\r\n            case 83: note = 13; break;\r\n            case 84: note = 14; break;\r\n            default: note = null;\r\n        }\r\n    }\r\n    if (appName === 'Genshin') {\r\n        switch (midiNote) {\r\n            case 48: note = 14; break;\r\n            case 49: note = 14; isAccidental = true; break;\r\n            case 50: note = 15; break;\r\n            case 51: note = 15; isAccidental = true; break;\r\n            case 52: note = 16; break;\r\n            case 53: note = 17; break;\r\n            case 54: note = 17; isAccidental = true; break;\r\n            case 55: note = 18; break;\r\n            case 56: note = 18; isAccidental = true; break;\r\n            case 57: note = 19; break;\r\n            case 58: note = 19; isAccidental = true; break;\r\n            case 59: note = 20; break;\r\n            case 60: note = 7; break;\r\n            case 61: note = 7; isAccidental = true; break;\r\n            case 62: note = 8; break;\r\n            case 63: note = 8; isAccidental = true; break;\r\n            case 64: note = 9; break;\r\n            case 65: note = 10; break;\r\n            case 66: note = 10; isAccidental = true; break;\r\n            case 67: note = 11; break;\r\n            case 68: note = 11; isAccidental = true; break;\r\n            case 69: note = 12; break;\r\n            case 70: note = 12; isAccidental = true; break;\r\n            case 71: note = 13; break;\r\n            case 72: note = 0; break;\r\n            case 73: note = 0; isAccidental = true; break;\r\n            case 74: note = 1; break;\r\n            case 75: note = 1; isAccidental = true; break;\r\n            case 76: note = 2; break;\r\n            case 77: note = 3; break;\r\n            case 78: note = 3; isAccidental = true; break;\r\n            case 79: note = 4; break;\r\n            case 80: note = 4; isAccidental = true; break;\r\n            case 81: note = 5; break;\r\n            case 82: note = 5; isAccidental = true; break;\r\n            case 83: note = 6; break;\r\n            default: note = null;\r\n        }\r\n    }\r\n    return {\r\n        note: note,\r\n        isAccidental: isAccidental\r\n    }\r\n}","\r\nexport default function ComposerTools(props) {\r\n    const { data, functions } = props\r\n    const { toggleTools, copyColumns, eraseColumns, pasteColumns, deleteColumns } = functions\r\n    const { visible, copiedColumns } = data\r\n\r\n    return <div className={visible ? \"floating-tools tools-visible\" : \"floating-tools\"}>\r\n        <div className=\"tools-row\">\r\n            <div>\r\n                Scroll to the left / right to select the columns\r\n            </div>\r\n            <button onClick={toggleTools}>\r\n                Close\r\n            </button>\r\n        </div>\r\n        <div className=\"tools-buttons-wrapper\">\r\n            <div className='tools-half'>\r\n                <button\r\n                    disabled={copiedColumns.length !== 0}\r\n                    onClick={(e) => {\r\n                        e.currentTarget.blur()\r\n                        copyColumns('all')\r\n                    }}\r\n                    className={copiedColumns.length !== 0 ? \"tools-button-highlighted\" : \"\"}\r\n                >\r\n                    Copy\r\n                </button>\r\n                <button\r\n                    disabled={copiedColumns.length !== 0}\r\n                    onClick={(e) => {\r\n                        e.currentTarget.blur()\r\n                        copyColumns(data.layer)\r\n                    }}\r\n                    className={copiedColumns.length !== 0 ? \"tools-button-highlighted\" : \"\"}\r\n                >\r\n                    Copy layer {data.layer}\r\n                </button>\r\n            </div>\r\n            <div className='tools-half'>\r\n                <button\r\n                    disabled={copiedColumns.length === 0}\r\n                    onClick={(e) => {\r\n                        e.currentTarget.blur()\r\n                        pasteColumns(false)\r\n                    }}\r\n                >\r\n                    Paste\r\n                </button>\r\n                <button\r\n                    disabled={copiedColumns.length === 0}\r\n                    onClick={(e) => {\r\n                        e.currentTarget.blur()\r\n                        pasteColumns(true)\r\n                    }}\r\n                >\r\n                    Insert\r\n                </button>\r\n            </div>\r\n            <div className='tools-half'>\r\n                <button\r\n                    disabled={copiedColumns.length !== 0}\r\n                    onClick={(e) => {\r\n                        e.currentTarget.blur()\r\n                        eraseColumns('all')\r\n                    }}\r\n                >\r\n                    Erase\r\n                </button>\r\n                <button\r\n                    disabled={copiedColumns.length !== 0}\r\n                    onClick={(e) => {\r\n                        e.currentTarget.blur()\r\n                        eraseColumns(data.layer)\r\n                    }}\r\n                >\r\n                    Erase layer {data.layer}\r\n                </button>\r\n            </div>\r\n\r\n            <button\r\n                disabled={copiedColumns.length !== 0}\r\n                onClick={deleteColumns}\r\n            >\r\n                Delete\r\n            </button>\r\n        </div>\r\n    </div>\r\n}","import React, { Component } from 'react'\r\nimport { cssClasses, appName , instrumentsData} from \"appConfig\" \r\nimport GenshinNoteBorder from 'components/GenshinNoteBorder'\r\nclass ComposerNote extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n\r\n        }\r\n    }\r\n    shouldComponentUpdate(next, prev) {\r\n        let canRender = false\r\n        canRender = canRender ||this.props.layers !== next.layers || this.props.noteText !== next.noteText\r\n        canRender = canRender || this.props.instrument !== next.instrument\r\n        return canRender\r\n    }\r\n    render() {\r\n        const {props} = this\r\n        const { data, layers,instrument } = props\r\n        let className = cssClasses.noteComposer\r\n        if (layers[0] === \"1\") className += \" layer-1\"\r\n        if (layers[1] === \"1\") className += \" layer-2\"\r\n        if (layers[2] === \"1\") className += \" layer-3\"\r\n        let layer3Class = \"Sky\" ? \"layer-3-ball-bigger\" : \"layer-3-ball\"\r\n        let effects = instrumentsData[instrument]?.effects || {}\r\n        return <button onPointerDown={() => this.props.clickAction(data)} className=\"button-hitbox\">\r\n            <div className={className} >\r\n                <img\r\n                    draggable=\"false\"\r\n                    alt={data.noteNames.mobile}\r\n                    src={props.noteImage}\r\n                    style={effects}\r\n                >\r\n                  \r\n                </img>\r\n                {appName === 'Genshin' && <GenshinNoteBorder\r\n                    className='genshin-border'\r\n                />}\r\n                <div className={layer3Class}>\r\n                </div>\r\n                <div className={appName === \"Sky\" ? \"note-name-sky\" : \"note-name\"}>\r\n                    {props.noteText}\r\n                </div>\r\n            </div>\r\n        </button>\r\n    }\r\n}\r\n\r\nexport default ComposerNote","\r\nexport default function MultiSwitch(props){\r\n    const { options, selected, selectedColor, buttonsClass, onSelect } = props\r\n    return <>\r\n        {options.map(e => {\r\n            return <button\r\n                style={{ backgroundColor: e === selected ? selectedColor : \"\" }}\r\n                className={buttonsClass}\r\n                onClick={() => onSelect(e)}\r\n                key={e}\r\n            >\r\n                {e}\r\n            </button>\r\n        })}\r\n    </>\r\n}","import React, { Component } from 'react'\r\nimport ComposerNote from \"./ComposerNote\"\r\nimport MultiSwitch from \"./MultiSwitch\"\r\nimport { appName, keyNames, pitchArr , layoutImages,layoutData } from \"appConfig\"\r\nclass ComposerKeyboard extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n\r\n        }\r\n        //TODO convert this into a functional component\r\n    }\r\n\r\n    render() {\r\n        const { data, functions } = this.props\r\n        let notesIndexes = data.currentColumn.notes.map((e) => e.index)\r\n        let hiddenSideMenu = data.isPlaying ? \" hidden\" : \"\"\r\n        let keyboardClass = \"keyboard\"\r\n        if (data.keyboard.layout.length === 15) keyboardClass += \" keyboard-5\"\r\n        if (data.keyboard.layout.length === 8) keyboardClass += \" keyboard-4\"\r\n        return <div>\r\n            <div className={keyboardClass}>\r\n            {data.keyboard.layout.length === 0 ? <div className=\"loading\">Loading...</div> : null}\r\n                {data.keyboard.layout.map((note, i) => {\r\n                    let index = notesIndexes.indexOf(i)\r\n                    let noteText = \"\"\r\n                    let noteImage = \"\"\r\n                    try{    \r\n                        noteImage = layoutImages[data.keyboard.layout.length][note.index]  \r\n                        if(data.noteNameType === \"Note name\") noteText = keyNames[appName][pitchArr.indexOf(data.pitch)][note.index]\r\n                        if(data.noteNameType === \"Keyboard layout\") noteText = layoutData[data.keyboard.layout.length].keyboardLayout[note.index]\r\n                        if(data.noteNameType === \"Do Re Mi\") noteText = layoutData[data.keyboard.layout.length].mobileLayout[note.index]\r\n                    }catch(e){}\r\n                    return <ComposerNote\r\n                        key={note.index}\r\n                        layers={index >= 0 ? data.currentColumn.notes[index].layer : \"000\"}\r\n                        data={note}\r\n                        noteText={noteText}\r\n                        instrument={data.keyboard.instrumentName}\r\n                        noteImage={`./assets/icons/keys/${noteImage}.svg`}\r\n                        clickAction={functions.handleClick}\r\n                    />\r\n                })}\r\n            </div>\r\n            <div className={\"bottom-right-wrapper\" + hiddenSideMenu}>\r\n                <div className={\"layer-buttons-wrapper\"}>\r\n                    <div className=\"bottom-right-text\">\r\n                        Layer\r\n                    </div>\r\n                    <MultiSwitch\r\n                        buttonsClass={\"layer-button\"}\r\n                        selectedColor={\"#63aea7\"}\r\n                        options={[1, 2, 3]}\r\n                        onSelect={functions.changeLayer}\r\n                        selected={data.layer}\r\n                    />\r\n                </div>\r\n                <div className=\"tempo-changers-wrapper\">\r\n                    <div className=\"bottom-right-text\">\r\n                        Tempo\r\n                    </div>\r\n                    {data.TempoChangers.map((e) => {\r\n                        return <button\r\n                            key={e.id}\r\n                            onClick={() => functions.handleTempoChanger(e)}\r\n                            style={{ backgroundColor: \"#\" + e.color.toString(16) }}\r\n                        >\r\n                            {e.text}\r\n                        </button>\r\n                    })}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\n\r\n\r\n\r\nexport default ComposerKeyboard","import { TempoChangers } from \"lib/Utils\"\r\nimport * as PIXI from \"pixi.js\"\r\nimport { cacheData, notesPerColumn } from \"appConfig\"\r\nconst { noteData, horizontalLineBreak, standards, layersCombination, breakpoints } = cacheData\r\n\r\nexport class ComposerCache {\r\n    constructor(width, height, margin = 4, timelineHeight = 30) {\r\n        this.width = width\r\n        this.height = height\r\n        this.cache = {\r\n            columns: [],\r\n            notes: {},\r\n            standard: [],\r\n            columnsLarger: [],\r\n            standardLarger: [],\r\n            breakpoints: []\r\n        }\r\n        this.notesFigures = []\r\n        this.timelineHeight = timelineHeight\r\n        this.margin = margin\r\n        this.noteWidth = this.width\r\n        this.noteHeight = this.height / notesPerColumn\r\n        this.app = new PIXI.Application({\r\n            width: width,\r\n            height: height,\r\n        })\r\n        this.generate()\r\n    }\r\n    destroy = () => {\r\n        this.app.destroy()\r\n    }\r\n    generate = () => {\r\n        TempoChangers.forEach(tempoChanger => {\r\n            let canvas = drawColumn(tempoChanger, this, 1)\r\n            this.cache.columns.push(canvas.toDataURL())\r\n        })\r\n        standards.forEach(standardColumn => {\r\n            let canvas = drawColumn(standardColumn, this, 1)\r\n            this.cache.standard.push(canvas.toDataURL())\r\n        })\r\n        standards.forEach(standardColumn => {\r\n            let canvas = drawColumn(standardColumn, this, 3)\r\n            this.cache.standardLarger.push(canvas.toDataURL())\r\n        })\r\n        layersCombination.forEach(note => {\r\n            let roundNess = this.noteWidth > 20 ? 4 : 2\r\n            let canvas = document.createElement(\"canvas\")\r\n            canvas.height = this.noteHeight\r\n            canvas.width = this.noteWidth\r\n            let ctx = canvas.getContext(\"2d\")\r\n            if (note[0] === \"1\") {\r\n                ctx.fillStyle = noteData.background\r\n                roundRect(\r\n                    ctx,\r\n                    this.margin / 2,\r\n                    this.margin / 2,\r\n                    this.noteWidth - this.margin - 1,\r\n                    this.noteHeight - this.margin - 1,\r\n                    roundNess,\r\n                    true,\r\n                    false\r\n                )\r\n            }\r\n            if (note[1] === \"1\") {\r\n                ctx.strokeStyle = noteData.border\r\n                ctx.lineWidth = 2\r\n                roundRect(\r\n                    ctx,\r\n                    this.margin / 2,\r\n                    this.margin / 2,\r\n                    this.noteWidth - this.margin - 1,\r\n                    this.noteHeight - this.margin - 1,\r\n                    roundNess,\r\n                    false,\r\n                    true\r\n                )\r\n            }\r\n            if (note[2] === \"1\") {\r\n                ctx.beginPath()\r\n                ctx.fillStyle = noteData.center\r\n                let ballHeight = this.noteHeight / 4\r\n                ctx.arc(this.noteWidth / 2 - 0.5, this.noteHeight / 2 - 0.5, ballHeight, 0, 2 * Math.PI);\r\n                ctx.fill()\r\n            }\r\n            this.cache.notes[note] = canvas.toDataURL()\r\n        })\r\n        TempoChangers.forEach(tempoChanger => {\r\n            let canvas = drawColumn(tempoChanger, this, 2)\r\n            this.cache.columnsLarger.push(canvas.toDataURL())\r\n        })\r\n        breakpoints.forEach(breakpoint => {\r\n            let canvas = document.createElement(\"canvas\")\r\n            if (breakpoint.type === \"short\") {\r\n                let size = this.timelineHeight / 6\r\n                canvas.height = this.timelineHeight\r\n                canvas.width = size * 2\r\n                let ctx = canvas.getContext(\"2d\")\r\n                ctx.fillStyle = breakpoint.color\r\n                ctx.arc(size, this.timelineHeight / 2, size, 0, 2 * Math.PI);\r\n                ctx.fill()\r\n                this.cache.breakpoints.push(canvas.toDataURL())\r\n            } else {\r\n                canvas.height = this.height\r\n                canvas.width = this.width\r\n                let ctx = canvas.getContext(\"2d\")\r\n                ctx.fillStyle = breakpoint.color\r\n                /*\r\n               ctx.strokeStyle = breakpoint.color\r\n               ctx.lineWidth = 3\r\n                ctx.strokeRect(1,1,this.width - 3,this.height - 2)\r\n                */\r\n                ctx.beginPath();\r\n                ctx.moveTo(0, this.height)\r\n                ctx.lineTo(this.noteWidth / 2, this.height)\r\n                ctx.lineTo(0, this.height - this.noteHeight)\r\n                ctx.fill();\r\n                ctx.beginPath();\r\n                ctx.moveTo(this.width, this.height)\r\n                ctx.lineTo(this.noteWidth / 2, this.height)\r\n                ctx.lineTo(this.width, this.height - this.noteHeight)\r\n                ctx.fill();\r\n                ctx.beginPath();\r\n                ctx.moveTo(0, 0)\r\n                ctx.lineTo(this.noteWidth / 2, 0)\r\n                ctx.lineTo(0, this.noteHeight)\r\n                ctx.fill();\r\n                ctx.beginPath();\r\n                ctx.moveTo(this.width, 0)\r\n                ctx.lineTo(this.noteWidth / 2, 0)\r\n                ctx.lineTo(this.width, this.noteHeight)\r\n                ctx.fill();\r\n\r\n                this.cache.breakpoints.push(canvas.toDataURL())\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\n\r\nfunction drawColumn(tempoChanger, self, borderWidth) {\r\n    let canvas = document.createElement(\"canvas\")\r\n    canvas.height = self.height\r\n    canvas.width = self.width\r\n    let ctx = canvas.getContext(\"2d\")\r\n    ctx.fillStyle = \"#\" + tempoChanger.color.toString(16)\r\n    ctx.fillRect(0, 0, self.width, self.height)\r\n    ctx.strokeStyle = borderWidth === 2 ? \"black\" : \"#333333\"\r\n    ctx.lineWidth = borderWidth\r\n    ctx.beginPath()\r\n    ctx.moveTo(self.width, 0)\r\n    ctx.lineTo(self.width, self.height)\r\n    ctx.stroke()\r\n    ctx.strokeStyle = \"#333333\"\r\n    for (let i = 1; i < 3; i++) {\r\n        ctx.lineWidth = 1\r\n        let y = self.noteHeight * horizontalLineBreak * i\r\n        ctx.moveTo(0, y)\r\n        ctx.lineTo(self.width, y)\r\n    }\r\n    ctx.stroke()\r\n    return canvas\r\n}\r\n\r\nfunction roundRect(ctx, x, y, width, height, radius, fill, stroke) {\r\n    if (typeof stroke === 'undefined') {\r\n        stroke = true;\r\n    }\r\n    if (typeof radius === 'undefined') {\r\n        radius = 5;\r\n    }\r\n    if (typeof radius === 'number') {\r\n        radius = { tl: radius, tr: radius, br: radius, bl: radius };\r\n    } else {\r\n        var defaultRadius = { tl: 0, tr: 0, br: 0, bl: 0 };\r\n        for (var side in defaultRadius) {\r\n            radius[side] = radius[side] || defaultRadius[side];\r\n        }\r\n    }\r\n    ctx.beginPath();\r\n    ctx.moveTo(x + radius.tl, y);\r\n    ctx.lineTo(x + width - radius.tr, y);\r\n    ctx.quadraticCurveTo(x + width, y, x + width, y + radius.tr);\r\n    ctx.lineTo(x + width, y + height - radius.br);\r\n    ctx.quadraticCurveTo(x + width, y + height, x + width - radius.br, y + height);\r\n    ctx.lineTo(x + radius.bl, y + height);\r\n    ctx.quadraticCurveTo(x, y + height, x, y + height - radius.bl);\r\n    ctx.lineTo(x, y + radius.tl);\r\n    ctx.quadraticCurveTo(x, y, x + radius.tl, y);\r\n    ctx.closePath();\r\n    if (fill) {\r\n        ctx.fill();\r\n    }\r\n    if (stroke) {\r\n        ctx.stroke();\r\n    }\r\n\r\n}\r\n","import React, { Component } from 'react'\r\nimport { Stage, Container, Graphics, Sprite } from '@inlet/react-pixi';\r\nimport { FaStepBackward, FaStepForward, FaPlusCircle, FaMinusCircle } from 'react-icons/fa';\r\nimport isMobile from \"is-mobile\"\r\nimport \"./Composer.css\"\r\nimport { ComposerCache } from \"./ComposerCache\"\r\n\r\nimport { composerNotePositions, notesPerColumn, appName } from \"../../appConfig\"\r\nlet NumOfColumnsPerCanvas = 35\r\n\r\nexport default class ComposerCanvas extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        let sizes = document.body.getBoundingClientRect()\r\n        this.sizes = sizes\r\n        NumOfColumnsPerCanvas = Number(this.props.data.settings.columnsPerCanvas.value)\r\n        let width = nearestEven(sizes.width * 0.84)\r\n        let height = nearestEven(sizes.height * 0.45)\r\n\r\n        if (window.screen.width < sizes.height) {\r\n            width = nearestEven(sizes.height * 0.84)\r\n            height = nearestEven(sizes.width * 0.45)\r\n        }\r\n        if(appName === \"Sky\") height = nearestEven(height * 0.95)\r\n        this.state = {\r\n            width: Math.floor(width),\r\n            height: Math.floor(height),\r\n            column: {\r\n                width: calcMinColumnWidth(nearestEven(width)),\r\n                height: height\r\n            },\r\n            timelineHeight: isMobile() ? 25 : 30,\r\n            currentBreakpoint: -1\r\n        }\r\n        this.canvasRef = React.createRef()\r\n        let margin = isMobile() ? 1 : 4\r\n        this.cache = new ComposerCache(this.state.column.width, height, margin, this.state.timelineHeight)\r\n        this.stageSelected = false\r\n        this.sliderSelected = false\r\n        this.stagePreviousPositon = 0\r\n        this.throttleStage = 0\r\n    }\r\n    resetPointerDown = (e) => {\r\n        this.stageSelected = false\r\n        this.sliderSelected = false\r\n        this.stagePreviousPositon = 0\r\n    }\r\n    componentDidMount() {\r\n        window.addEventListener(\"pointerup\", this.resetPointerDown)\r\n        window.addEventListener(\"keydown\", this.handleKeyboard)\r\n        this.canvasRef.current._canvas.addEventListener(\"wheel\", this.handleWheel)\r\n    }\r\n    componentWillUnmount() {\r\n        window.removeEventListener(\"pointerup\", this.resetPointerDown)\r\n        window.removeEventListener(\"keydown\", this.handleKeyboard)\r\n        this.canvasRef.current._canvas.removeEventListener(\"wheel\", this.handleWheel)\r\n        this.cache.destroy()\r\n    }\r\n    handleKeyboard = (event) => {\r\n        let key = event.code\r\n        switch (key) {\r\n            case \"ArrowRight\": this.handleBreakpoints(1)\r\n                break;\r\n            case \"ArrowLeft\": this.handleBreakpoints(-1)\r\n                break;\r\n            default : \r\n                break;\r\n        }\r\n    }\r\n    handleWheel = (e) => {\r\n        if (e.deltaY < 0) {\r\n            this.props.functions.selectColumn(this.props.data.selected - 1, true)\r\n        } else {\r\n            this.props.functions.selectColumn(this.props.data.selected + 1, true)\r\n        }\r\n    }\r\n    handleClick = (e, type) => {\r\n        let x = e.data.global.x\r\n        if (type === \"click\") {\r\n            let totalWidth = this.state.column.width * this.props.data.columns.length\r\n\r\n            let relativePos = Math.floor(x / this.state.width * totalWidth / this.state.column.width)\r\n            this.props.functions.selectColumn(relativePos)\r\n        }\r\n        if (type === \"up\") {\r\n            this.sliderSelected = false\r\n        }\r\n        if (type === \"down\") {\r\n            this.sliderSelected = true\r\n        }\r\n        if (type === \"downStage\") {\r\n            this.stagePreviousPositon = x\r\n            this.stageSelected = true\r\n        }\r\n    }\r\n    handleStageSlide = (e) => {\r\n        let x = e.data.global.x\r\n        if (this.stageSelected === true) {\r\n            this.throttleStage++\r\n            if (this.throttleStage < 5) return\r\n            this.throttleStage = 0\r\n            let isMovingLeft = this.stagePreviousPositon < x\r\n            let amount = Math.ceil(Math.abs(this.stagePreviousPositon - x) / 8)\r\n            if (amount > 4) amount = 4\r\n            let toAdd = isMovingLeft ? -1 : 1\r\n            this.stagePreviousPositon = x\r\n            let finalPos = this.props.data.selected + toAdd * amount\r\n            if (this.props.data.selected === finalPos) return\r\n            if (finalPos < 0) finalPos = 0\r\n            if (finalPos > this.props.data.columns.length) finalPos = this.props.data.columns.length - 1\r\n            this.props.functions.selectColumn(finalPos, true)\r\n        }\r\n    }\r\n    handleBreakpoints = (direction) => {\r\n        let selectedColumn = this.props.data.selected\r\n        let columns = this.props.data.columns\r\n        let breakpoint\r\n        let breakpoints = this.props.data.breakpoints\r\n        if (direction === 1) {//right\r\n            breakpoint = breakpoints.filter((v) => v > selectedColumn).sort((a, b) => a - b)\r\n        } else {\r\n            breakpoint = breakpoints.filter((v) => v < selectedColumn).sort((a, b) => b - a)\r\n        }\r\n        if (breakpoint.length >= 0) {\r\n            if (columns.length >= breakpoint[0] && breakpoint[0] >= 0) {\r\n                this.props.functions.selectColumn(breakpoint[0])\r\n            }\r\n        }\r\n\r\n    }\r\n    handleSlide = (e) => {\r\n        if (this.sliderSelected) {\r\n            this.throttleStage++\r\n            if (this.throttleStage < 4) return\r\n            this.throttleStage = 0\r\n            let totalWidth = this.state.column.width * this.props.data.columns.length\r\n            let x = e.data.global.x\r\n            let relativePos = Math.floor(x / this.state.width * totalWidth / this.state.column.width)\r\n            this.props.functions.selectColumn(relativePos, true)\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let s = this.state\r\n        const { width, timelineHeight, height} = this.state\r\n        const cache = this.cache.cache\r\n        const { data, functions } = this.props\r\n        const sizes = this.state.column\r\n        const xPos = (data.selected - NumOfColumnsPerCanvas / 2 + 1) * - sizes.width\r\n        let switcher = false\r\n        let counter = 0\r\n        const beatMarks = Number(data.settings.beatMarks.value)\r\n        const counterLimit = beatMarks === 0 ? 11 : 4 * beatMarks - 1\r\n        const relativeColumnWidth = width / data.columns.length\r\n        let stageSize = Math.floor(relativeColumnWidth * (NumOfColumnsPerCanvas + 1))\r\n        if (stageSize > width) stageSize = width\r\n        const stagePosition = relativeColumnWidth * data.selected - (NumOfColumnsPerCanvas / 2 - 1) * relativeColumnWidth\r\n        return <div className=\"canvas-wrapper\" style={{ width: width + 2 }}>\r\n            <Stage\r\n                width={width}\r\n                height={height}\r\n                raf={false}\r\n                renderOnComponentChange={true}\r\n                options={{\r\n                    backgroundColor: 0x495466,\r\n                }}\r\n                key={this.state.width}\r\n                ref={this.canvasRef}\r\n            >\r\n                <Container\r\n                    anchor={[0.5, 0.5]}\r\n                    x={xPos}\r\n                    interactive={true}\r\n                    pointerdown={(e) => this.handleClick(e, \"downStage\")}\r\n                    pointermove={(e) => this.handleStageSlide(e)}\r\n                >\r\n                    {data.columns.map((column, i) => {\r\n                        if (counter > counterLimit) {\r\n                            switcher = !switcher\r\n                            counter = 0\r\n                        }\r\n                        counter++\r\n                        if (!isVisible(i, data.selected)) return null\r\n                        let tempoChangersCache = (i + 1) % 4 === 0 ? cache.columnsLarger : cache.columns\r\n                        let standardCache = (i + 1) % 4 === 0 ? cache.standardLarger : cache.standard\r\n                        let standardBg = standardCache[Number(switcher)] // boolean is 1 or 0\r\n                        let background = column.tempoChanger === 0 ? standardBg : tempoChangersCache[column.tempoChanger]\r\n                        return <Column\r\n                            cache={cache}\r\n                            key={i}\r\n                            data={column}\r\n                            index={i}\r\n                            sizes={sizes}\r\n                            backgroundCache={background}\r\n                            isToolsSelected={data.toolsColumns.includes(i)}\r\n                            click={functions.selectColumn}\r\n                            isSelected={i === data.selected}\r\n                            isBreakpoint={data.breakpoints.includes(i)}\r\n                        />\r\n\r\n                    })}\r\n\r\n                </Container>\r\n            </Stage>\r\n            <div className=\"timeline-wrapper\" style={{ height: this.state.timelineHeight }}>\r\n                <div className=\"timeline-button\" onClick={() => this.handleBreakpoints(-1)}>\r\n                    <FaStepBackward />\r\n                </div>\r\n                <div className=\"timeline-button\" onClick={() => this.handleBreakpoints(1)}>\r\n                    <FaStepForward />\r\n                </div>\r\n                <Stage\r\n                    width={s.width}\r\n                    height={timelineHeight}\r\n                    options={{ antialias: true, autoDensity: true,backgroundColor: 0x515c6f }}\r\n                    raf={false}\r\n                    renderOnComponentChange={true}\r\n                >   \r\n                    <Container\r\n                        width={this.state.width}\r\n                        height={this.state.timelineHeight}\r\n                        interactive={true}\r\n                        pointertap={(e) => this.handleClick(e, \"click\")}\r\n                        pointerdown={(e) => this.handleClick(e, \"down\")}\r\n                        pointerup={(e) => this.handleClick(e, \"up\")}\r\n                        pointermove={this.handleSlide}\r\n                    >\r\n                        <Graphics draw={(e) => { fillX(e, this.state.width, this.state.timelineHeight) }}/>\r\n                        {data.breakpoints.map(breakpoint => {\r\n                            return <Sprite\r\n                                image={cache.breakpoints[0]}\r\n                                key={breakpoint}\r\n                                x={relativeColumnWidth * breakpoint}\r\n                            >\r\n                            </Sprite>\r\n                        })}\r\n                    </Container>\r\n\r\n                    <Graphics draw={(e) => drawStage(e, stageSize, this.state.timelineHeight)} x={stagePosition} y={2} />\r\n\r\n\r\n                </Stage>\r\n                <div className=\"timeline-button\" onClick={functions.toggleBreakpoint}>\r\n                    {data.breakpoints.includes(data.selected) ? <FaMinusCircle/> : <FaPlusCircle />}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\n\r\nfunction fillX(g, width, height) {\r\n    g.clear()\r\n    g.beginFill(0x515c6f, 1)\r\n    g.drawRect(0, 0, width, height)\r\n}\r\nfunction drawStage(g, width, height) {\r\n    g.clear()\r\n    g.lineStyle(3, 0x1a968b, 0.8)\r\n    g.drawRoundedRect(0, 0, width - 2, height - 4, 6)\r\n}\r\n\r\nfunction Column(props) {\r\n    let { data, index, sizes, click, cache, backgroundCache, isBreakpoint, isSelected, isToolsSelected } = props\r\n    return <Container\r\n        pointertap={() => click(index)}\r\n        interactive={true}\r\n        x={sizes.width * index}\r\n    >\r\n        <Sprite\r\n            image={backgroundCache}\r\n            interactiveChildren={false}\r\n        >\r\n            {isSelected || isToolsSelected ? <Sprite\r\n                image={isToolsSelected && !isSelected? cache.standard[3] : cache.standard[2]}\r\n                alpha={isToolsSelected ?0.4 : 0.6}\r\n                zIndex={1}\r\n            >\r\n            </Sprite> : null}\r\n            {isBreakpoint ? <Sprite\r\n                image={cache.breakpoints[1]}\r\n            >\r\n            </Sprite> : null}\r\n        </Sprite>\r\n        {data.notes.map((note) => {\r\n            return <Sprite\r\n                key={note.index}\r\n                image={cache.notes[note.layer]}\r\n                y={composerNotePositions[note.index] * sizes.height / notesPerColumn}\r\n            >\r\n            </Sprite>\r\n        })}\r\n\r\n    </Container>\r\n}\r\n\r\nfunction calcMinColumnWidth(parentWidth) {\r\n    return nearestEven(parentWidth / NumOfColumnsPerCanvas)\r\n}\r\n\r\nfunction nearestEven(num) {\r\n    return 2 * Math.round(num / 2);\r\n}\r\n\r\nfunction isVisible(pos, currentPos) {\r\n    let threshold = NumOfColumnsPerCanvas / 2 + 2\r\n    let boundaries = [currentPos - threshold, currentPos + threshold]\r\n    return boundaries[0] < pos && pos < boundaries[1]\r\n}","import React, { Component } from 'react'\r\nimport { FaMusic, FaSave, FaCog, FaHome, FaTrash, FaDownload } from 'react-icons/fa';\r\nimport { FileDownloader, LoggerEvent, ComposerSongSerialization, prepareSongDownload } from \"lib/Utils\"\r\nimport { appName,isTwa } from 'appConfig'\r\nimport MenuItem from 'components/MenuItem'\r\nimport MenuPanel from 'components/MenuPanel'\r\nimport MenuClose from 'components/MenuClose'\r\nimport SettingsRow from 'components/SettingsRow'\r\nimport DonateButton from 'components/DonateButton'\r\n\r\nclass Menu extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            open: false,\r\n            selectedMenu: \"Settings\",\r\n            selectedSongType: \"composed\",\r\n        }    \r\n    }\r\n    componentDidMount() {\r\n        window.addEventListener(\"keydown\", this.handleKeyboard)\r\n    }\r\n    componentWillUnmount(){\r\n        window.removeEventListener(\"keydown\", this.handleKeyboard)\r\n    }\r\n    handleKeyboard = (event) => {\r\n        let key = event.code\r\n        if (document.activeElement.tagName === \"INPUT\") return\r\n\r\n        switch (key) {\r\n            case \"Escape\": {\r\n                if(this.state.open) this.props.functions.toggleMenuVisible()\r\n                this.setState({ open: false })\r\n                break\r\n            }\r\n            default: break;\r\n        }\r\n    }\r\n    toggleMenu = (override) => {\r\n        if (typeof override !== \"boolean\") override = undefined\r\n        let newState = override !== undefined ? override : !this.state.open\r\n        this.setState({\r\n            open: newState,\r\n        })\r\n        if (newState === false) {\r\n            this.props.functions.toggleMenuVisible()\r\n        }\r\n    }\r\n    changeSelectedSongType = (name) => {\r\n        this.setState({\r\n            selectedSongType: name\r\n        })\r\n    }\r\n    selectSideMenu = (selection) => {\r\n        if (selection === this.state.selectedMenu && this.state.open) {\r\n            return this.setState({\r\n                open: false,\r\n            })\r\n        }\r\n        this.setState({\r\n            selectedMenu: selection,\r\n            open: true\r\n        })\r\n    }\r\n    downloadSong = (song) => {\r\n        if (song._id) delete song._id\r\n        if (song.data.isComposedVersion) {\r\n            song = ComposerSongSerialization(song)\r\n        }\r\n        let songName = song.name\r\n        if (appName === \"Sky\") {\r\n            //adds old format into the sheet\r\n            song = prepareSongDownload(song)\r\n        }\r\n        if (!Array.isArray(song)) song = [song]\r\n        song.forEach(song1 => {\r\n            song1.data.appName = appName\r\n        })\r\n        let json = JSON.stringify(song)\r\n        let fileDownloader = new FileDownloader()\r\n        fileDownloader.download(json, `${songName}.${appName.toLowerCase()}sheet.json`)\r\n        new LoggerEvent(\"Success\", \"Song downloaded\").trigger()\r\n    }\r\n    render() {\r\n        const { data, functions } = this.props\r\n        let sideClass = this.state.open ? \"side-menu menu-open\" : \"side-menu\"\r\n        let selectedMenu = this.state.selectedMenu\r\n        const { loadSong, removeSong, updateSong, changePage, handleSettingChange, changeVolume, createNewSong, changeMidiVisibility } = functions\r\n        let songFunctions = {\r\n            loadSong: loadSong,\r\n            removeSong: removeSong,\r\n            toggleMenu: this.toggleMenu,\r\n            downloadSong: this.downloadSong\r\n        }\r\n        let songs = data.songs.filter(song => !song.data?.isComposedVersion)\r\n        let composedSongs = data.songs.filter(song => song.data?.isComposedVersion)\r\n        let hasUnsaved = data.hasChanges ? \"margin-top-auto not-saved\" : \"margin-top-auto\"\r\n        let menuClass = data.menuOpen ? \"menu menu-visible\" : \"menu\"\r\n        return <div className=\"menu-wrapper\">\r\n            <div className={menuClass}>\r\n                <MenuClose action={this.toggleMenu} />\r\n                <MenuItem type=\"Save\" action={() => updateSong(data.currentSong)} className={hasUnsaved}>\r\n                    <FaSave className=\"icon\" />\r\n                </MenuItem>\r\n                <MenuItem type=\"Songs\" action={this.selectSideMenu}>\r\n                    <FaMusic className=\"icon\" />\r\n                </MenuItem>\r\n                <MenuItem type=\"Settings\" action={this.selectSideMenu}>\r\n                    <FaCog className=\"icon\" />\r\n                </MenuItem>\r\n                <MenuItem type=\"Home\" action={() => changePage(\"home\")}>\r\n                    <FaHome className=\"icon\" />\r\n                </MenuItem>\r\n            </div>\r\n            <div className={sideClass}>\r\n                <MenuPanel title=\"No selection\" visible={selectedMenu}>\r\n                </MenuPanel>\r\n                <MenuPanel title=\"Songs\" visible={selectedMenu}>\r\n                    <div className=\"songs-buttons-wrapper\">\r\n                        <button className=\"genshin-button\" onClick={() => { changeMidiVisibility(true); this.toggleMenu() }}>\r\n                            Create from MIDI\r\n                        </button>\r\n                        <button className=\"genshin-button\" onClick={createNewSong}>\r\n                            Create new song\r\n                        </button>\r\n                    </div>\r\n                    <div className=\"tab-selector-wrapper\">\r\n                        <button\r\n                            className={this.state.selectedSongType === \"recorded\" ? \"tab-selector tab-selected\" : \"tab-selector\"}\r\n                            onClick={() => this.changeSelectedSongType(\"recorded\")}\r\n                        >\r\n                            Recorded\r\n                        </button>\r\n                        <button\r\n                            className={this.state.selectedSongType === \"composed\" ? \"tab-selector tab-selected\" : \"tab-selector\"}\r\n                            onClick={() => this.changeSelectedSongType(\"composed\")}\r\n                        >\r\n                            Composed\r\n                        </button>\r\n                    </div>\r\n                    <div className=\"songs-wrapper\" style={{marginBottom: '0.5rem'}}>\r\n                        {this.state.selectedSongType === \"recorded\"\r\n                            ? songs.map(song => {\r\n                                return <SongRow\r\n                                    data={song}\r\n                                    key={song.name}\r\n                                    functions={songFunctions}\r\n                                >\r\n                                </SongRow>\r\n                            })\r\n\r\n                            : composedSongs.map(song => {\r\n                                return <SongRow\r\n                                    data={song}\r\n                                    key={song.name}\r\n                                    functions={songFunctions}\r\n                                >\r\n                                </SongRow>\r\n                            })\r\n                        }\r\n\r\n                    </div>\r\n                    <div className=\"songs-buttons-wrapper\" style={{marginTop: 'auto'}}>\r\n                        <button \r\n                            className={`genshin-button record-btn ${data.isRecordingAudio ? \"selected\" : \"\"}`}\r\n                            onClick={() => functions.startRecordingAudio(!data.isRecordingAudio)}\r\n                        >\r\n                                {data.isRecordingAudio ? \"Stop recording audio\" : \"Start recording audio\"}\r\n                        </button>\r\n                    </div>\r\n\r\n                </MenuPanel>\r\n                <MenuPanel title=\"Settings\" visible={selectedMenu}>\r\n                    {Object.entries(data.settings).map(([key, data]) => {\r\n                        return <SettingsRow\r\n                            key={key + data.value}\r\n                            objKey={key}\r\n                            data={data}\r\n                            changeVolume={changeVolume}\r\n                            update={handleSettingChange}\r\n                        >\r\n\r\n                        </SettingsRow>\r\n                    })}\r\n                    {!isTwa() && <DonateButton onClick={changePage}/>}\r\n                </MenuPanel>\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\n\r\n\r\nfunction SongRow(props) {\r\n    const { data, functions } = props\r\n    const { removeSong, toggleMenu, loadSong, downloadSong } = functions\r\n    return <div className=\"song-row\">\r\n        <div className=\"song-name\" onClick={() => {\r\n            loadSong(data)\r\n            toggleMenu(false)\r\n        }}>\r\n            {data.name}\r\n        </div>\r\n        <div className=\"song-buttons-wrapper\">\r\n            <button className=\"song-button\" onClick={() => downloadSong(data)}>\r\n                <FaDownload />\r\n            </button>\r\n            <button className=\"song-button\" onClick={() => removeSong(data.name)}>\r\n                <FaTrash color=\"#ed4557\" />\r\n            </button>\r\n        </div>\r\n    </div>\r\n}\r\n\r\n\r\n\r\nexport default Menu","import React, { Component } from 'react'\r\nimport ZangoDb from \"zangodb\"\r\nimport { FaPlay, FaPlus, FaPause, FaBars, FaChevronLeft, FaChevronRight, FaTools } from 'react-icons/fa';\r\n\r\nimport addCell from \"assets/icons/addCell.svg\"\r\nimport removeCell from \"assets/icons/removeCell.svg\"\r\nimport { appName, audioContext } from \"appConfig\"\r\n\r\nimport MidiImport from \"./MidiParser\"\r\nimport ComposerTools from \"./ComposerTools\"\r\nimport ComposerKeyboard from \"./ComposerKeyboard\"\r\nimport ComposerCanvas from \"./ComposerCanvas\"\r\nimport Menu from \"./Menu\"\r\n\r\nimport { asyncConfirm, asyncPrompt } from \"components/AsyncPrompts\"\r\nimport { ComposerSettings } from \"lib/SettingsObj\"\r\nimport Instrument from \"lib/Instrument\"\r\nimport {\r\n    ComposedSong, LoggerEvent, ColumnNote, Column, TempoChangers,\r\n    ComposerSongSerialization, ComposerSongDeSerialization, getPitchChanger, RecordingToComposed, delayMs\r\n} from \"lib/Utils\"\r\nimport AudioRecorder from 'lib/AudioRecorder'\r\n\r\nclass Composer extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.db = new ZangoDb.Db(appName, { songs: [] })\r\n        this.dbCol = {\r\n            songs: this.db.collection(\"songs\")\r\n\r\n        }\r\n        let settings = this.getSettings()\r\n        this.playbackInterval = undefined\r\n        this.audioContext = audioContext\r\n        this.reverbNode = undefined\r\n        this.reverbVolumeNode = undefined\r\n        this.recorder = new AudioRecorder()\r\n\r\n        this.state = {\r\n            instrument: new Instrument(),\r\n            layers: [new Instrument(), new Instrument()],\r\n            songs: [],\r\n            isPlaying: false,\r\n            song: new ComposedSong(\"Untitled\"),\r\n            settings: settings,\r\n            menuOpen: false,\r\n            layer: 1,\r\n            toolsColumns: [],\r\n            toolsVisible: false,\r\n            midiVisible: false,\r\n            isRecordingAudio: false\r\n        }\r\n        this.mounted = false\r\n        this.copiedColums = []\r\n        this.changes = 0\r\n        this.broadcastChannel = {}\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.mounted = true\r\n        this.init()\r\n        window.addEventListener(\"keydown\", this.handleKeyboard)\r\n        this.broadcastChannel = window.BroadcastChannel ? new BroadcastChannel(appName + '_composer') : {}\r\n        this.broadcastChannel.onmessage = (event) => {\r\n            if (!this.state.settings.syncTabs.value) return\r\n            if (!['play', 'stop'].includes(event?.data)) return\r\n            this.togglePlay(event.data === 'play')\r\n        }\r\n        if (window.location.hostname !== \"localhost\") {\r\n            window.addEventListener(\"beforeunload\", (event) => {\r\n                event.preventDefault()\r\n                event.returnValue = ''\r\n            })\r\n        }\r\n\r\n    }\r\n    componentWillUnmount() {\r\n        this.mounted = false\r\n        window.removeEventListener('keydown', this.handleKeyboard)\r\n        const {instrument, layers} = this.state\r\n        this.broadcastChannel?.close?.()\r\n        const instruments = [instrument, layers[0], layers[1]]\r\n        instruments.forEach(instrument => instrument.delete())\r\n        this.reverbNode = undefined\r\n        this.reverbVolumeNode = undefined\r\n        this.audioContext = undefined   \r\n        let state = this.state\r\n        state.isPlaying = false\r\n    }\r\n\r\n    init = async () => {\r\n        this.syncSongs()\r\n        const { settings } = this.state\r\n        const promises = [\r\n            this.loadInstrument(settings.instrument.value, 1),\r\n            this.loadInstrument(settings.layer2.value, 2),\r\n            this.loadInstrument(settings.layer3.value, 3)\r\n        ]\r\n        if(this.mounted) await Promise.all(promises)\r\n        if(this.mounted) await this.loadReverb()\r\n        if(this.mounted) this.setupAudioDestination(settings.caveMode.value)\r\n    }\r\n    componentDidCatch() {\r\n        this.setState({\r\n            song: new ComposedSong(\"Untitled\")\r\n        })\r\n        new LoggerEvent(\"Warning\", \"There was an error with the song! Restoring default...\").trigger()\r\n    }\r\n    handleAutoSave = () => {\r\n        this.changes++\r\n        if (this.changes > 5 && this.state.settings.autosave.value) {\r\n            if (this.state.song.name !== \"Untitled\") {\r\n                this.updateSong(this.state.song)\r\n            }\r\n\r\n        }\r\n    }\r\n    loadReverb() {\r\n        return new Promise(resolve => {\r\n            fetch(\"./assets/audio/reverb4.wav\")\r\n                .then(r => r.arrayBuffer())\r\n                .then(b => {\r\n                    if(!this.mounted) return\r\n                    this.audioContext.decodeAudioData(b, (impulse_response) => {\r\n                        if(!this.mounted) return\r\n                        let convolver = this.audioContext.createConvolver()\r\n                        let gainNode = this.audioContext.createGain()\r\n                        gainNode.gain.value = 2.5\r\n                        convolver.buffer = impulse_response\r\n                        convolver.connect(gainNode)\r\n                        gainNode.connect(this.audioContext.destination)\r\n                        this.reverbNode = convolver\r\n                        this.reverbVolumeNode = gainNode\r\n                        resolve()\r\n                    })\r\n                }).catch((e) => {\r\n                    console.log(\"Error with reverb\", e)\r\n                })\r\n        })\r\n    }\r\n    getSettings = () => {\r\n        let storedSettings = localStorage.getItem(appName + \"_Composer_Settings\")\r\n        try {\r\n            storedSettings = JSON.parse(storedSettings)\r\n        } catch (e) {\r\n            storedSettings = null\r\n        }\r\n        if (storedSettings !== null) {\r\n            if (storedSettings.settingVesion !== ComposerSettings.settingVesion) {\r\n                this.updateSettings(ComposerSettings)\r\n                return ComposerSettings\r\n            }\r\n            return storedSettings\r\n        }\r\n        return ComposerSettings\r\n    }\r\n\r\n    updateSettings = (override) => {\r\n        let state\r\n        if (override !== undefined) {\r\n            state = override\r\n        } else {\r\n            state = this.state.settings\r\n        }\r\n        localStorage.setItem(appName + \"_Composer_Settings\", JSON.stringify(state))\r\n    }\r\n\r\n    handleSettingChange = (setting) => {\r\n        const { state } = this\r\n        let settings = state.settings\r\n        let data = setting.data\r\n        settings[setting.key].value = data.value\r\n        if (data.songSetting) {\r\n            state.song[setting.key] = data.value\r\n        }\r\n        if (setting.key === \"instrument\") this.loadInstrument(data.value, 1)\r\n        if (setting.key === \"layer2\") this.loadInstrument(data.value, 2)\r\n        if (setting.key === \"layer3\") this.loadInstrument(data.value, 3)\r\n        if (setting.key === \"caveMode\") this.setupAudioDestination(data.value)\r\n        this.setState({\r\n            settings: settings,\r\n            song: this.state.song\r\n        }, () => {\r\n            this.updateSettings()\r\n        })\r\n    }\r\n\r\n    loadInstrument = async (name, layer) => {\r\n        if(!this.mounted) return\r\n        const { settings } = this.state\r\n        if (layer === 1) {\r\n            this.state.instrument.delete()\r\n            let newInstrument = new Instrument(name)\r\n            await newInstrument.load()\r\n\t\t    if(!this.mounted) return \r\n            newInstrument.changeVolume(settings.instrument.volume)\r\n            this.setState({\r\n                instrument: newInstrument\r\n            })\r\n        } else {\r\n            let newInstrument = new Instrument(name)\r\n            let layers = this.state.layers\r\n            layers[layer-2].delete()\r\n            layers[layer - 2] = newInstrument\r\n            await newInstrument.load()\r\n\t\t    if(!this.mounted) return \r\n            newInstrument.changeVolume(settings[`layer${layer}`]?.volume)\r\n            this.setState({\r\n                layers: layers\r\n            })\r\n        }\r\n        this.setupAudioDestination(settings.caveMode.value)\r\n    }\r\n    changeVolume = (obj) => {\r\n        let settings = this.state.settings\r\n        if (obj.key === \"instrument\") {\r\n            settings.instrument.volume = obj.value\r\n            this.state.instrument.changeVolume(obj.value)\r\n        }\r\n        if (obj.key === \"layer2\") {\r\n            settings.layer2.volume = obj.value\r\n            this.state.layers[0].changeVolume(obj.value)\r\n        }\r\n        if (obj.key === \"layer3\") {\r\n            settings.layer3.volume = obj.value\r\n            this.state.layers[1].changeVolume(obj.value)\r\n        }\r\n        this.setState({\r\n            settings: settings\r\n        }, () => this.updateSettings())\r\n    }\r\n    setupAudioDestination = (hasReverb) => {\r\n        if(!this.mounted) return\r\n        const { instrument, layers } = this.state\r\n        const instruments = [instrument, layers[0], layers[1]]\r\n        instruments.forEach(ins => {\r\n            if (hasReverb) {\r\n                if (!this.reverbNode) return console.log(\"Couldn't connect to reverb\")\r\n                ins.disconnect()\r\n                ins.connect(this.reverbNode)\r\n            } else {\r\n                ins.disconnect()\r\n                ins.connect(this.audioContext.destination)\r\n            }\r\n        })\r\n    }\r\n    startRecordingAudio =async (override) => { //will record untill the song stops\r\n        if(!this.mounted) return\r\n        if(!override){\r\n            this.setState({ isRecordingAudio: false })\r\n            return this.togglePlay(false)\r\n        }\r\n        const { instrument, layers } = this.state\r\n        const instruments = [instrument, layers[0], layers[1]]\r\n        const hasReverb = this.state.settings.caveMode.value\r\n        const { recorder } = this\r\n        if (hasReverb) {\r\n            this.reverbVolumeNode.connect(recorder.node)\r\n        } else {\r\n            instruments.forEach(instrument => {\r\n                instrument.connect(recorder.node)\r\n            })\r\n        }\r\n        recorder.start()\r\n        this.setState({ isRecordingAudio: true })\r\n        await this.togglePlay(true) //wait till song finishes\r\n\t\tif(!this.mounted) return \r\n        let recording = await recorder.stop()\r\n        this.setState({ isRecordingAudio: false })\r\n        let fileName = await asyncPrompt(\"Write the song name, press cancel to ignore\")\r\n        if (fileName)  recorder.download(recording.data, fileName + '.wav')\r\n        if(!this.mounted) return\r\n        this.reverbVolumeNode.disconnect()\r\n        this.reverbVolumeNode.connect(audioContext.destination)\r\n        this.setupAudioDestination(hasReverb)\r\n    }\r\n    handleKeyboard = (event) => {\r\n        if (document.activeElement.tagName === \"INPUT\") return\r\n        const { instrument,layer,layers,isPlaying } = this.state\r\n        let key = event.code\r\n        const shouldEditKeyboard = isPlaying || event.shiftKey\r\n        if (shouldEditKeyboard) {\r\n            let letter = key?.replace(\"Key\", \"\")\r\n            let note = instrument.getNoteFromCode(letter)\r\n            if (note !== null) this.handleClick(instrument.layout[note])\r\n            switch (key) {\r\n                case \"Space\": {\r\n                    this.togglePlay()\r\n                    if (!this.state.settings.syncTabs.value) break;\r\n                    this.broadcastChannel?.postMessage?.(\"stop\")\r\n                    break;\r\n                }\r\n                default: break;\r\n            }\r\n        } else {\r\n            switch (key) {\r\n                case \"KeyD\": this.selectColumn(this.state.song.selected + 1); break;\r\n                case \"KeyA\": this.selectColumn(this.state.song.selected - 1); break;\r\n                case \"Digit1\": this.handleTempoChanger(TempoChangers[0]); break;\r\n                case \"Digit2\": this.handleTempoChanger(TempoChangers[1]); break;\r\n                case \"Digit3\": this.handleTempoChanger(TempoChangers[2]); break;\r\n                case \"Digit4\": this.handleTempoChanger(TempoChangers[3]); break;\r\n                case \"Space\": {\r\n                    this.togglePlay()\r\n                    if (!this.state.settings.syncTabs.value) break;\r\n                    this.broadcastChannel?.postMessage?.(\"play\")\r\n                    break;\r\n                }\r\n                case \"ArrowUp\":{\r\n                    let nextLayer = layer - 1\r\n                    if(nextLayer > 0) this.changeLayer(nextLayer)\r\n                    break;\r\n                }   \r\n                case \"ArrowDown\":{\r\n                    let nextLayer = layer + 1\r\n                    if(nextLayer < layers.length + 2) this.changeLayer(nextLayer)\r\n                    break;\r\n                }\r\n                case \"KeyQ\": this.removeColumns(1, this.state.song.selected); break;\r\n                case \"KeyE\": this.addColumns(1, this.state.song.selected); break;\r\n                default: break;\r\n            }\r\n        }\r\n\r\n    }\r\n    playSound = (instrument, index) => {\r\n        try {\r\n            let note = instrument.layout[index]\r\n            if (note === undefined) return\r\n            instrument.play(note.index, getPitchChanger(this.state.settings.pitch.value))\r\n        } catch (e) {\r\n\r\n        }\r\n    }\r\n    changePitch = (value) => {\r\n        const { settings } = this.state\r\n        settings.pitch.value = value\r\n        this.setState({\r\n            settings: settings\r\n        }, () => this.updateSettings())\r\n    }\r\n    handleClick = (note) => {\r\n        let column = this.state.song.columns[this.state.song.selected]\r\n        let index = column.notes.findIndex((n) => {\r\n            return note.index === n.index\r\n        })\r\n        let layerIndex = this.state.layer - 1\r\n        if (index < 0) { //if it doesn't exist, create a new one\r\n            let columnNote = new ColumnNote(note.index)\r\n            columnNote.layer = replaceAt(columnNote.layer, layerIndex, \"1\")\r\n            column.notes.push(columnNote)\r\n        } else { //if it exists, toggle the current layer and if it's 000 delete it\r\n            let currentNote = column.notes[index]\r\n            currentNote.layer = replaceAt(currentNote.layer, layerIndex, currentNote.layer[layerIndex] === \"0\" ? \"1\" : \"0\")\r\n            if (currentNote.layer === \"000\") column.notes.splice(index, 1)\r\n        }\r\n        this.setState({\r\n            song: this.state.song\r\n        })\r\n        this.handleAutoSave()\r\n        let instrument = this.state.instrument\r\n        if (this.state.layer > 1) {\r\n            instrument = this.state.layers[this.state.layer - 2]\r\n        }\r\n        this.playSound(instrument, note.index)\r\n    }\r\n    syncSongs = async () => {\r\n        let songs = await this.dbCol.songs.find().toArray()\r\n        if(!this.mounted) return\r\n        songs = songs.map(song => {\r\n            if (song.data.isComposedVersion) {\r\n                return ComposerSongDeSerialization(song)\r\n            }\r\n            return song\r\n        })\r\n        this.setState({\r\n            composedSongs: songs,\r\n            songs: songs\r\n        })\r\n    }\r\n    addSong = async (song) => {\r\n        if (await this.songExists(song.name)) {\r\n            return new LoggerEvent(\"Warning\", \"A song with this name already exists! \\n\" + song.name).trigger()\r\n        }\r\n        await this.dbCol.songs.insert(ComposerSongSerialization(song))\r\n        this.syncSongs()\r\n    }\r\n    updateSong = async (song) => {\r\n        if (song.name === \"Untitled\") {\r\n            let name = await this.askForSongName()\r\n            if(!this.mounted) return\r\n            if (name === null) return\r\n            song.name = name\r\n            return this.addSong(song)\r\n        }\r\n        return new Promise(async resolve => {\r\n            let settings = this.state.settings\r\n            if (await this.songExists(song.name)) {\r\n                song.instruments[0] = settings.instrument.value\r\n                song.instruments[1] = settings.layer2.value\r\n                song.instruments[2] = settings.layer3.value\r\n                await this.dbCol.songs.update({ name: song.name }, ComposerSongSerialization(song))\r\n                console.log(\"song saved:\", song.name)\r\n                this.changes = 0\r\n                this.syncSongs()\r\n            } else {\r\n                if (song.name.includes(\"- Composed\")) {\r\n                    let name = await this.askForSongName(\"Write composed song name, press cancel to ignore\")\r\n                    if (name === null) return resolve()\r\n                    song.name = name\r\n                    await this.dbCol.songs.insert(ComposerSongSerialization(song))\r\n                    this.syncSongs()\r\n                    return resolve()\r\n                }\r\n                console.log(\"song doesn't exist\")\r\n                song.name = \"Untitled\"\r\n                this.updateSong(song)\r\n            }\r\n            resolve()\r\n        })\r\n    }\r\n    askForSongName = (question) => {\r\n        return new Promise(async resolve => {\r\n            let promptString = question || \"Write song name, press cancel to ignore\"\r\n            while (true) {\r\n                let songName = await asyncPrompt(promptString)\r\n                if (songName === null) return resolve(null)\r\n                if (songName !== \"\") {\r\n                    if (await this.songExists(songName)) {\r\n                        promptString = \"This song already exists: \" + songName\r\n                    } else {\r\n                        return resolve(songName)\r\n                    }\r\n                } else {\r\n                    promptString =question || \"Write song name, press cancel to ignore\"\r\n                }\r\n            }\r\n        })\r\n\r\n    }\r\n    askForSongUpdate = () => {\r\n        return new Promise(async resolve => {\r\n            let result = await asyncConfirm(`You have unsaved changes to the song: \"${this.state.song.name}\" do you want to save now?`)\r\n            resolve(result)\r\n        })\r\n    }\r\n    songExists = async (name) => {\r\n        return await this.dbCol.songs.findOne({ name: name }) !== undefined\r\n    }\r\n    createNewSong = async () => {\r\n        if (this.state.song.name !== \"Untitled\" && this.changes > 0) {\r\n            let wantsToSave = await this.askForSongUpdate()\r\n            if (wantsToSave) {\r\n                await this.updateSong(this.state.song)\r\n            }\r\n        }\r\n        let name = await this.askForSongName(\"Write new song name, press cancel to ignore\")\r\n        if (name === null) return\r\n        let song = new ComposedSong(name)\r\n        this.changes = 0\r\n        if(!this.mounted) return\r\n        this.setState({\r\n            song: song\r\n        }, () => this.addSong(song))\r\n    }\r\n    removeSong = async (name) => {\r\n        let confirm = await asyncConfirm(\"Are you sure you want to delete the song: \" + name)\r\n        if (confirm) this.dbCol.songs.remove({ name: name }, this.syncSongs)\r\n    }\r\n\r\n    loadSong = async (song) => {\r\n        const state = this.state\r\n        song = JSON.parse(JSON.stringify(song)) //lose reference\r\n        if (!song.data.isComposedVersion) {\r\n            song = RecordingToComposed(song)\r\n            song.name += \" - Composed\"\r\n        }\r\n        if (this.changes !== 0) {\r\n            let confirm = state.settings.autosave.value && state.song.name !== \"Untitled\"\r\n            if (!confirm && state.song.columns.length > 0) {\r\n                confirm = await asyncConfirm(`You have unsaved changes to the song: \"${state.song.name}\" do you want to save? UNSAVED CHANGES WILL BE LOST`)\r\n            }\r\n            if (confirm) await this.updateSong(state.song)\r\n        }\r\n        let settings = this.state.settings\r\n        settings.bpm.value = song.bpm\r\n        settings.pitch.value = song.pitch\r\n        if (settings.instrument.value !== song.instruments[0]) {\r\n            this.loadInstrument(song.instruments[0], 1)\r\n            settings.instrument.value = song.instruments[0]\r\n        }\r\n        if (settings.layer2.value !== song.instruments[1]) {\r\n            this.loadInstrument(song.instruments[1], 2)\r\n            settings.layer2.value = song.instruments[1]\r\n        }\r\n        if (settings.layer3.value !== song.instruments[2]) {\r\n            this.loadInstrument(song.instruments[2], 3)\r\n            settings.layer3.value = song.instruments[2]\r\n        }\r\n        this.changes = 0\r\n        console.log(\"song loaded\")\r\n        if(!this.mounted) return\r\n        this.setState({\r\n            song: song,\r\n            settings: settings,\r\n            toolsColumns: []\r\n        })\r\n    }\r\n\r\n    addColumns = (amount = 1, position = \"end\") => {\r\n        return new Promise(resolve => {\r\n            let columns = new Array(amount).fill().map(() => new Column())\r\n            let songColumns = this.state.song.columns\r\n            if (position === \"end\") {\r\n                songColumns.push(...columns)\r\n            } else {\r\n                songColumns.splice(position + 1, 0, ...columns)\r\n            }\r\n            if (amount === 1) this.selectColumn(this.state.song.selected + 1)\r\n            this.handleAutoSave()\r\n            this.setState({\r\n                song: this.state.song\r\n            }, resolve)\r\n        })\r\n\r\n    }\r\n    removeColumns = (amount, position) => {\r\n        let song = this.state.song\r\n        if (song.columns.length < 16) return\r\n        let indexes = new Array(amount).fill().map((e, i) => position + i)\r\n        indexes.forEach(index => {\r\n            if (song.breakpoints.includes(index)) this.toggleBreakpoint(index)\r\n        })\r\n        song.columns.splice(position, amount)\r\n        if (song.columns.length <= song.selected) this.selectColumn(song.selected - 1)\r\n        this.handleAutoSave()\r\n        this.setState({\r\n            song: song\r\n        })\r\n    }\r\n    //----------------------------------------------//\r\n\r\n    togglePlay = async (override) => {\r\n        return new Promise(resolve => {\r\n            let newState = typeof override === \"boolean\" ? override : !this.state.isPlaying\r\n            this.setState({\r\n                isPlaying: newState\r\n            }, async () => {\r\n                if (this.state.isPlaying) this.selectColumn(this.state.song.selected)\r\n                let pastError = 0\r\n                let previousTime = new Date().getTime()\r\n                while (this.state.isPlaying) {\r\n                    const { song, settings } = this.state\r\n                    let tempoChanger = TempoChangers[song.columns[song.selected].tempoChanger]\r\n                    let msPerBPM = Math.floor(60000 / settings.bpm.value * tempoChanger.changer) + pastError\r\n                    previousTime = new Date().getTime()\r\n                    await delayMs(msPerBPM)\r\n                    if (!this.state.isPlaying || !this.mounted) break\r\n                    this.handleTick()\r\n                    pastError = previousTime + msPerBPM - new Date().getTime()\r\n                }\r\n                resolve()\r\n            })\r\n        }) \r\n    }\r\n\r\n\r\n    handleTick = () => {\r\n        let newIndex = this.state.song.selected + 1\r\n        if (this.state.isPlaying && newIndex > this.state.song.columns.length - 1) {\r\n            return this.togglePlay(false)\r\n        }\r\n        this.selectColumn(this.state.song.selected + 1)\r\n\r\n    }\r\n    toggleMenuVisible = () => {\r\n        this.setState({\r\n            menuOpen: !this.state.menuOpen\r\n        })\r\n    }\r\n    toggleBreakpoint = (override) => {\r\n        let song = this.state.song\r\n        let index = typeof override === \"number\" ? override : song.selected\r\n        let indexOfBreakpoint = song.breakpoints.indexOf(index)\r\n        if (indexOfBreakpoint >= 0 && song.columns.length > index) {\r\n            song.breakpoints.splice(indexOfBreakpoint, 1)\r\n        } else if (song.columns.length > index) {\r\n            song.breakpoints.push(index)\r\n        }\r\n        this.validateBreakpoints()\r\n        this.setState({\r\n            song: song\r\n        })\r\n    }\r\n    handleTempoChanger = (changer) => {\r\n        let song = this.state.song\r\n        song.columns[this.state.song.selected].tempoChanger = changer.id\r\n        this.handleAutoSave()\r\n        this.setState({\r\n            song: song\r\n        })\r\n    }\r\n    changePage = async (page) => {\r\n        if (this.changes !== 0) {\r\n            if (this.state.settings.autosave.value) {\r\n                await this.updateSong(this.state.song)\r\n            } else {\r\n                let confirm = await asyncConfirm(`You have unsaved changes to the song: \"${this.state.song.name}\" do you want to save? UNSAVED CHANGES WILL BE LOST`)\r\n                if (confirm) {\r\n                    await this.updateSong(this.state.song)\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        this.props.changePage(page)\r\n    }\r\n    selectColumn = (index, ignoreAudio) => {\r\n        const state = this.state\r\n        let song = state.song\r\n        if (index < 0 || index > song.columns.length - 1) return\r\n        let currentColumn = state.song.columns[index]\r\n        song.selected = index\r\n        let toolsColumns = state.toolsColumns\r\n        if (state.toolsVisible && this.copiedColums.length === 0) {\r\n            toolsColumns.push(index)\r\n            let min = Math.min(...toolsColumns)\r\n            let max = Math.max(...toolsColumns)\r\n            toolsColumns = new Array(max - min + 1).fill().map((e, i) => min + i)\r\n        }\r\n        this.setState({\r\n            song: song,\r\n            toolsColumns: toolsColumns\r\n        })\r\n\r\n        if (ignoreAudio) return\r\n        currentColumn.notes.forEach(note => {\r\n            if (note.layer[0] === \"1\") this.playSound(state.instrument, note.index)\r\n            if (note.layer[1] === \"1\") this.playSound(state.layers[0], note.index)\r\n            if (note.layer[2] === \"1\") this.playSound(state.layers[1], note.index)\r\n        })\r\n    }\r\n    changeLayer = (layer) => {\r\n        this.setState({\r\n            layer: layer\r\n        })\r\n    }\r\n    //-----------------------TOOLS---------------------//\r\n    toggleTools = () => {\r\n        this.setState({\r\n            toolsVisible: !this.state.toolsVisible,\r\n            toolsColumns: this.state.toolsVisible ? [] : [this.state.song.selected]\r\n        })\r\n        this.copiedColums = []\r\n    }\r\n    copyColumns = (layer) => {\r\n        this.copiedColums = []\r\n        this.state.toolsColumns.forEach((index) => {\r\n            let column = this.state.song.columns[index]\r\n            if (column !== undefined) this.copiedColums.push(column)\r\n        })\r\n        this.copiedColums = JSON.parse(JSON.stringify(this.copiedColums)) // removing reference\r\n        if (layer !== 'all') {\r\n            this.copiedColums = this.copiedColums.map(column => {\r\n                column.notes = column.notes.filter(e => e.layer[layer - 1] === '1')\r\n                column.notes = column.notes.map(e => {\r\n                    e.layer = '000'\r\n                    e.layer = replaceAt(e.layer, layer - 1, '1')\r\n                    return e\r\n                })\r\n                return column\r\n            })\r\n        }\r\n        this.setState({\r\n            toolsColumns: []\r\n        })\r\n    }\r\n    pasteColumns = async (insert) => {\r\n        let song = this.state.song\r\n        let copiedColumns = JSON.parse(JSON.stringify(this.copiedColums))\r\n        if (!insert) {\r\n            song.columns.splice(song.selected, 0, ...copiedColumns)\r\n        } else {\r\n            copiedColumns.forEach((copiedColumn, i) => {\r\n                let column = song.columns[song.selected + i]\r\n                if (column !== undefined) {\r\n                    copiedColumn.notes.forEach(copiedNote => {\r\n                        let index = column.notes.findIndex(note => copiedNote.index === note.index)\r\n                        if (index < 0) {\r\n                            column.notes.push(copiedNote)\r\n                        } else {\r\n                            for (let j = 0; j < 3; j++) {\r\n                                if (copiedNote.layer[j] === '1') {\r\n                                    column.notes[index].layer = replaceAt(column.notes[index].layer, j, 1)\r\n                                }\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n        }\r\n\r\n        this.setState({\r\n            song: song\r\n        })\r\n    }\r\n    eraseColumns = (layer) => {\r\n        let song = this.state.song\r\n        if (layer === 'all') {\r\n            this.state.toolsColumns.forEach(columnIndex => {\r\n                let column = song.columns[columnIndex]\r\n                if (column !== undefined) song.columns[columnIndex].notes = []\r\n            })\r\n        } else {\r\n            this.state.toolsColumns.forEach(columnIndex => {\r\n                let column = song.columns[columnIndex]\r\n                if (column !== undefined) {\r\n                    song.columns[columnIndex].notes.forEach(note => {\r\n                        note.layer = replaceAt(note.layer, layer - 1, '0')\r\n                    })\r\n                }\r\n            })\r\n        }\r\n\r\n        this.setState({\r\n            song: song\r\n        })\r\n    }\r\n    validateBreakpoints = () => {\r\n        let breakpoints = this.state.song.breakpoints.filter(breakpoint => breakpoint < this.state.song.columns.length)\r\n        let song = this.state.song\r\n        song.breakpoints = breakpoints\r\n        this.setState({\r\n            song: song\r\n        })\r\n    }\r\n    deleteColumns = async () => {\r\n        let song = this.state.song\r\n        song.columns = song.columns.filter((e, i) => !this.state.toolsColumns.includes(i))\r\n        if (song.selected > song.columns.length - 1) song.selected = song.columns.length - 1\r\n        if (song.selected <= 0) song.selected = 0\r\n        if (song.columns.length === 0) await this.addColumns(12, 0)\r\n        this.setState({\r\n            song: song,\r\n            toolsColumns: []\r\n        }, this.validateBreakpoints)\r\n    }\r\n    changeMidiVisibility = (visibility) => {\r\n        this.setState({\r\n            midiVisible: visibility\r\n        })\r\n    }\r\n    render() {\r\n\r\n        const { state } = this\r\n        const { midiVisible } = state\r\n        let song = state.song\r\n        let menuData = {\r\n            songs: state.songs,\r\n            currentSong: state.song,\r\n            settings: state.settings,\r\n            hasChanges: this.changes,\r\n            menuOpen: state.menuOpen,\r\n            isRecordingAudio: state.isRecordingAudio\r\n        }\r\n        let menuFunctions = {\r\n            loadSong: this.loadSong,\r\n            removeSong: this.removeSong,\r\n            createNewSong: this.createNewSong,\r\n            changePage: this.changePage,\r\n            updateSong: this.updateSong,\r\n            handleSettingChange: this.handleSettingChange,\r\n            toggleMenuVisible: this.toggleMenuVisible,\r\n            changeVolume: this.changeVolume,\r\n            changeMidiVisibility: this.changeMidiVisibility,\r\n            startRecordingAudio: this.startRecordingAudio\r\n        }\r\n        let keyboardFunctions = {\r\n            handleClick: this.handleClick,\r\n            handleTempoChanger: this.handleTempoChanger,\r\n            changeLayer: this.changeLayer\r\n        }\r\n        let keyboardData = {\r\n            keyboard: state.instrument,\r\n            currentColumn: state.song.columns[state.song.selected],\r\n            TempoChangers: TempoChangers,\r\n            layer: state.layer,\r\n            pitch: state.settings.pitch.value,\r\n            isPlaying: state.isPlaying,\r\n            noteNameType: state.settings.noteNameType.value,\r\n        }\r\n        let canvasFunctions = {\r\n            selectColumn: this.selectColumn,\r\n            toggleBreakpoint: this.toggleBreakpoint\r\n        }\r\n        let canvasData = {\r\n            columns: song.columns,\r\n            selected: song.selected,\r\n            settings: state.settings,\r\n            breakpoints: state.song.breakpoints,\r\n            toolsColumns: state.toolsColumns\r\n        }\r\n        let toolsData = {\r\n            visible: this.state.toolsVisible,\r\n            copiedColumns: this.copiedColums,\r\n            layer: this.state.layer\r\n        }\r\n        let toolsFunctions = {\r\n            toggleTools: this.toggleTools,\r\n            eraseColumns: this.eraseColumns,\r\n            deleteColumns: this.deleteColumns,\r\n            copyColumns: this.copyColumns,\r\n            pasteColumns: this.pasteColumns\r\n        }\r\n        let midiParserFunctions = {\r\n            loadSong: this.loadSong,\r\n            changeMidiVisibility: this.changeMidiVisibility,\r\n            changePitch: this.changePitch,\r\n        }\r\n        let midiParserData = {\r\n            instruments: [state.instrument, ...state.layers].map(layer => layer.instrumentName),\r\n            selectedColumn: song.selected,\r\n\r\n        }\r\n        return <div className=\"app bg-image\" style={{ backgroundImage: `url(${state.settings.backgroundImage.value})` }}>\r\n            {midiVisible && <MidiImport functions={midiParserFunctions} data={midiParserData} />}\r\n            <div className=\"hamburger\" onClick={this.toggleMenuVisible}>\r\n                <FaBars />\r\n            </div>\r\n            <div className=\"right-panel-composer\">\r\n\r\n                <div className=\"column fill-x\">\r\n\r\n                    <div className=\"top-panel-composer\">\r\n                        <div className=\"buttons-composer-wrapper\">\r\n                            <div className=\"tool\" onClick={() => this.selectColumn(song.selected + 1)}>\r\n                                <FaChevronRight />\r\n                            </div>\r\n                            <div className=\"tool\" onClick={() => this.selectColumn(song.selected - 1)}>\r\n                                <FaChevronLeft />\r\n                            </div>\r\n\r\n                            <div className=\"tool\" onClick={this.togglePlay}>\r\n                                {this.state.isPlaying ? <FaPause/> : <FaPlay />}\r\n                            </div>\r\n                        </div>\r\n                        <ComposerCanvas\r\n                            key={this.state.settings.columnsPerCanvas.value}\r\n                            functions={canvasFunctions}\r\n                            data={canvasData}\r\n                        />\r\n                        <div className=\"buttons-composer-wrapper-right\">\r\n\r\n                            <div className=\"tool\" onClick={() => this.addColumns(1, song.selected)}>\r\n                                <img src={addCell} className=\"tool-icon\" alt=\"Add a new cell\" />\r\n                            </div>\r\n                            <div className=\"tool\" onClick={() => this.removeColumns(1, song.selected)}>\r\n                                <img src={removeCell} className=\"tool-icon\" alt=\"Remove a cell\" />\r\n                            </div>\r\n                            <div className=\"tool\" onClick={() => this.addColumns(this.state.settings.beatMarks.value * 4, \"end\")}>\r\n                                <FaPlus />\r\n                            </div>\r\n                            <div className=\"tool\" onClick={this.toggleTools}>\r\n                                <FaTools />\r\n                            </div>\r\n\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n\r\n                <ComposerKeyboard\r\n                    functions={keyboardFunctions}\r\n                    data={keyboardData}\r\n                />\r\n            </div>\r\n            <Menu\r\n                data={menuData}\r\n                functions={menuFunctions}\r\n            />\r\n            <ComposerTools\r\n                data={toolsData}\r\n                functions={toolsFunctions}\r\n            />\r\n            <div className=\"song-info\">\r\n                <div>\r\n                    {song.name}\r\n                </div>\r\n                <div>\r\n                    {formatMillis(calculateLength(this.state.song, this.state.song.selected))}\r\n                    /\r\n                    {formatMillis(calculateLength(this.state.song, this.state.song.columns.length))}\r\n                </div>\r\n\r\n\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\nfunction formatMillis(millis) {\r\n    let minutes = Math.floor(millis / 60000);\r\n    let seconds = ((millis % 60000) / 1000).toFixed(0);\r\n    return (\r\n        seconds === 60 \r\n        ? (minutes+1) + \":00\" \r\n        : minutes + \":\" + (seconds < 10 ? \"0\" : \"\") + seconds\r\n    )\r\n}\r\nfunction calculateLength(song, end) {\r\n    let columns = song.columns\r\n    let bpmPerMs = Math.floor(60000 / song.bpm)\r\n    let totalLength = 0\r\n    columns.forEach((column, i) => {\r\n        if (i > end) return\r\n        totalLength += bpmPerMs * TempoChangers[column.tempoChanger].changer\r\n    })\r\n    return totalLength\r\n}\r\n\r\nfunction replaceAt(string, index, replacement) {\r\n    if (index >= string.length) {\r\n        return string.valueOf();\r\n    }\r\n\r\n    return string.substring(0, index) + replacement + string.substring(index + 1);\r\n}\r\nexport default Composer\r\n\r\n","import { useState} from 'react'\r\nimport { FaHome, FaDiscord } from 'react-icons/fa';\r\n\r\nimport MenuItem from 'components/MenuItem'\r\nimport MenuPanel from 'components/MenuPanel'\r\n\r\n\r\nexport function SimpleMenu(props) {\r\n    const [open, setOpen] = useState(false)\r\n    const [selectedMenu, setSelectedMenu] = useState(\"Settings\")\r\n    const { functions, children } = props\r\n    const { changePage, toggleMenuVisible } = functions\r\n    \r\n    // eslint-disable-next-line\r\n    const toggleMenu = (override) => {\r\n        if (typeof override !== \"boolean\") override = undefined\r\n        let newState = override !== undefined ? override : !open\r\n        setOpen(newState)\r\n        if (newState === false) toggleMenuVisible()\r\n    }\r\n    // eslint-disable-next-line\r\n    const selectSideMenu = (selection) => {\r\n        if (selection === this.state.selectedMenu && this.state.open) {\r\n            return setOpen(false)\r\n        }\r\n        setSelectedMenu(selection)\r\n        setOpen(true)\r\n    }\r\n\r\n\r\n    return <div className=\"menu-wrapper\" >\r\n        <div className=\"menu menu-visible\" style={{ justifyContent: 'flex-end' }}>\r\n\r\n            {children}\r\n\r\n            <MenuItem type='Discord'>\r\n                <a href='https://discord.gg/Arsf65YYHq' target='_blank' rel='noreferrer' >\r\n                    <FaDiscord className=\"icon\" />\r\n                </a>\r\n            </MenuItem>\r\n\r\n            <MenuItem type=\"Home\" action={() => changePage(\"home\")}>\r\n                <FaHome className=\"icon\" />\r\n            </MenuItem>\r\n\r\n        </div>\r\n        <div className={open ? \"side-menu menu-open\" : \"side-menu\"}>\r\n            <MenuPanel title=\"No selection\" visible={selectedMenu}>\r\n            </MenuPanel>\r\n        </div>\r\n    </div>\r\n}","import React, { Component } from 'react'\r\nimport { FaTrash, FaDownload} from 'react-icons/fa';\r\nimport ZangoDb from \"zangodb\"\r\nimport { FileDownloader, LoggerEvent,prepareSongDownload } from \"lib/Utils\"\r\nimport { asyncConfirm } from \"components/AsyncPrompts\"\r\nimport { appName } from \"appConfig\"\r\nimport { SimpleMenu } from 'components/SimpleMenu'\r\nclass ErrorPage extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.db = new ZangoDb.Db(appName, { songs: [] })\r\n        this.dbCol = {\r\n            songs: this.db.collection(\"songs\")\r\n\r\n        }\r\n        this.state = {\r\n            songs: []\r\n        }\r\n\r\n    }\r\n    componentDidMount(){\r\n        this.syncSongs()\r\n    }\r\n    downloadAllSongs = () => {\r\n        let toDownload = []\r\n        const { songs } = this.state\r\n        songs.forEach(song => {\r\n            if (song._id) delete song._id\r\n            if(appName === \"Sky\"){\r\n                song = prepareSongDownload(song)\r\n            }\r\n            Array.isArray(song) ? toDownload.push(...song) : toDownload.push(song)\r\n        })\r\n        let fileDownloader = new FileDownloader()\r\n        let json = JSON.stringify(toDownload)\r\n        let date = new Date().toISOString().split('T')[0]\r\n        fileDownloader.download(json,`${appName}_Backup_${date}.json`)\r\n        new LoggerEvent(\"Success\", \"Song backup downloaded\").trigger()\r\n    }\r\n    syncSongs = async () => {\r\n        let songs = await this.dbCol.songs.find().toArray()\r\n        this.setState({\r\n            songs: songs\r\n        })\r\n    }\r\n    deleteSong = async (name) => {\r\n        if (await asyncConfirm(\"Are you sure you want to delete the song: \" + name)) {\r\n            this.dbCol.songs.remove({ name: name }, this.syncSongs)\r\n        }\r\n\r\n    }\r\n    deleteAllSongs = async () =>{\r\n        if (await asyncConfirm(\"Are you sure you want to delete ALL SONGS?\")) {\r\n            this.dbCol.songs.remove({}, this.syncSongs)\r\n        }\r\n    }\r\n    resetSettings = () => {\r\n        localStorage.removeItem(appName+\"_Composer_Settings\")\r\n        localStorage.removeItem(appName+\"_Main_Settings\")\r\n        new LoggerEvent(\"Success\", \"Settings have been reset\").trigger()\r\n    }\r\n    downloadSong = (song) => {\r\n        if (song._id) delete song._id\r\n        let songName = song.name\r\n        if(appName === \"Sky\"){\r\n            song = prepareSongDownload(song)\r\n        }\r\n        if(!Array.isArray(song)) song = [song]\r\n        song.forEach(song1 => {\r\n            song1.data.appName = appName\r\n        })\r\n        let json = JSON.stringify(song)\r\n        let fileDownloader = new FileDownloader()\r\n        fileDownloader.download(json,`${songName}.${appName.toLowerCase()}sheet.json`)\r\n        new LoggerEvent(\"Success\", \"Song downloaded\").trigger()\r\n    }\r\n    render() {\r\n        return <div className=\"error-page app\">\r\n            <SimpleMenu functions={{changePage: this.props.changePage}}/>\r\n            <div className=\"error-text-wrapper\">\r\n                There seems to be an error. <br />\r\n                Here you can download or delete your songs,\r\n                try to find what song caused the error and remove it.\r\n            </div>\r\n            <div className=\"error-buttons-wrapper\">\r\n                <button className=\"genshin-button\" onClick={this.resetSettings}>\r\n                    Reset settings\r\n                </button>\r\n                <button className=\"genshin-button\" onClick={this.deleteAllSongs}>\r\n                    Delete all songs\r\n                </button>\r\n            </div>\r\n            <div className=\"error-songs-wrapper\">\r\n                {this.state.songs.map(song => \r\n                    <SongRow\r\n                        key={song?.name}\r\n                        data={song}\r\n                        functions={{\r\n                            deleteSong: this.deleteSong,\r\n                            downloadSong: this.downloadSong\r\n                        }}\r\n                    />\r\n                )}\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\n\r\nfunction SongRow(props) {\r\n    let data = props.data\r\n    let deleteSong = props.functions.deleteSong\r\n    let downloadSong = props.functions.downloadSong\r\n    return <div className=\"song-row\">\r\n        <div className=\"song-name\">\r\n            {data.name}\r\n        </div>\r\n        <div className=\"song-buttons-wrapper\">\r\n            <button className=\"song-button\" onClick={() => downloadSong(data)}>\r\n                <FaDownload />\r\n\r\n            </button>\r\n            <button className=\"song-button\" onClick={() => deleteSong(data.name)}>\r\n                <FaTrash color=\"#ed4557\" />\r\n            </button>\r\n        </div>\r\n    </div>\r\n}\r\n\r\nexport default ErrorPage","import { SimpleMenu } from 'components/SimpleMenu'\r\nimport MenuItem from 'components/MenuItem'\r\nimport { FaGithub } from 'react-icons/fa'\r\nimport './Changelog.css'\r\n\r\nexport default function Changelogpage(props) {\r\n    return <div className='changelog-page'>\r\n        <div className='changelog-page-title'>\r\n            Changelog\r\n        </div>\r\n        <SimpleMenu functions={{changePage: props.changePage}}>\r\n            <MenuItem>\r\n                <a href='https://github.com/Specy/genshin-music' className='icon' target=\"_blank\" rel='noreferrer'>\r\n                    <FaGithub />\r\n                </a>\r\n            </MenuItem>\r\n        </SimpleMenu>\r\n        {changelogs.map(e => <ChangelogRow\r\n            data={e}\r\n            key={e.version}\r\n        />)}\r\n        <div className='changelog-ending'>\r\n\r\n        </div>\r\n    </div>\r\n}\r\n\r\nfunction ChangelogRow(props) {\r\n    const { version, title, changes, date } = props.data\r\n    return <div className='changelog-wrapper'>\r\n        <div className='changelog-title'>\r\n            <div className='clt-1'>\r\n                {version}\r\n            </div>\r\n            <div className='clt-2'>\r\n                {date}\r\n            </div>\r\n        </div>\r\n        <div className='changelog-list'>\r\n            <div className='cll-1'>\r\n                {title}\r\n            </div>\r\n            <ul>\r\n                {changes.map((e, i) =>\r\n                    <li key={i}>\r\n                        {e.split('$l').map((item, i, arr) => {\r\n                            if (i === 0) {\r\n                                return <div key={i}>{item}</div>\r\n                            }\r\n                            return <p key={i} className='cll-new-line'>\r\n                                {item}\r\n                            </p>\r\n                        })}\r\n                    </li>\r\n                )}\r\n            </ul>\r\n        </div>\r\n\r\n    </div>\r\n}\r\nconst changelogs = [\r\n    {\r\n        version: '2.1.1',\r\n        title: 'Zither and icons',\r\n        date: '2021 - 16/12',\r\n        changes: [\r\n            'Changed note icon and animation (Genshin)',\r\n            'Added Help page',\r\n            'Changed zither audio (Genshin)',\r\n            'UI improvements'\r\n        ]\r\n    },\r\n    {\r\n        version: '2.1',\r\n        title: 'Home menu and pages',\r\n        date: '2021 - 11/12',\r\n        changes: [\r\n            'Restructured code',\r\n            'Added opacity to some elements',\r\n            'Changed margins and padding of some elements',\r\n            'Added home page',\r\n            'Added Partners page',\r\n            'Added shortcuts for main page',\r\n            'Fixed loading bug in composer and main page',\r\n            'Added Donate page'\r\n        ]\r\n    },\r\n    {\r\n        version: '2.0',\r\n        title: 'Approaching circles',\r\n        date: '2021 - 28/11',\r\n        changes: [\r\n            `Added Approaching cirlces mode, a new way to learn a song, or a way to challange yourself.\r\n            You can find it in the main page, next to the practice button`,\r\n            `Rewrite of the main page to increase overall performance`,\r\n            `Added changelog page`,\r\n            `Added audio recording feature in main page and composer`,\r\n            `Added tabs autoplay (composer) on pc as a setting`,\r\n            `Added note animations when pressing the note`,\r\n            `Added possibility to change background image from URL`,\r\n            `Updated info page`,\r\n            `In the composer you can now press shift + note name to add a note`,\r\n            `In the composer you can press up/down keys to change layer`,\r\n            `While in the composer on PC, you can now add new notes by simply pressing the PC keyboard while in \"playing\" mode`\r\n        ]\r\n    }, {\r\n        version: '1.7',\r\n        title: 'Zither',\r\n        date: '2021 - 20/10',\r\n        changes: [\r\n            '(For genshin) Added Zither',\r\n            'Added back \"do re mi\" format'\r\n        ]\r\n    }, {\r\n        version: '1.6',\r\n        title: 'Performance tweaks',\r\n        date: '2021 - 17/10',\r\n        changes: [\r\n            'Performance of composer improved by 2x',\r\n            'Added note names for genshin (made it a setting)',\r\n            'Fixed instrument volume bug',\r\n            'Fixed keyboard layout issues',\r\n            'Fixed other small bugs'\r\n        ]\r\n    }, {\r\n        version: '1.5',\r\n        title: 'MIDI import',\r\n        date: '2021 - 14/10',\r\n        changes: [\r\n            `Added to both Sky and Genshin music nightly the MIDI import feature $l\r\n            - Music track selection (select or deselect which tracks to include) $l\r\n            - Instrument track selection (select what instrument to give to each track) $l\r\n            - Track info (get info on how successful your parsing was, accidentals and notes out of range) $l\r\n            - Change note offset (in case that the song is outside of the octaves available) \r\n            `\r\n        ]\r\n    }, {\r\n        version: '1.4',\r\n        title: 'Song library',\r\n        date: '2021 - 28/08',\r\n        changes: [\r\n            'Added song library integration, directly import songs from the app (700+ songs)',\r\n            'Bug fixes'\r\n        ]\r\n    }, {\r\n        version: '1.3',\r\n        title: 'New audio files',\r\n        date: '2021 - 25/08',\r\n        changes: [\r\n            'Changed audio files',\r\n            'Added ocarina',\r\n            'Removed support button in TWA',\r\n            'Bug fixes'\r\n        ]\r\n    }, {\r\n        version: '1.2',\r\n        title: 'Bug fixes and PWA',\r\n        date: '2021 - 18/08',\r\n        changes: [\r\n            \"(For sky) Fixed bug where sheets couldn't be imported in sky studio\",\r\n            'Changed app install to more modern approach with description and images'\r\n        ]\r\n    }, {\r\n        version: '1.1',\r\n        title: 'Sheets compatibility',\r\n        date: '2021 - 07/08',\r\n        changes: [\r\n            '(For sky) Added backwards compatibility for sheets, now sheets made in sky music nightly can be imported into sky music and sky studio (with some losses)',\r\n            'Bug fixes',\r\n            'General improvement in performance'\r\n        ]\r\n    }, {\r\n        version: '1.0',\r\n        title: 'Release',\r\n        date: '2021 - 22/05',\r\n        changes: [\r\n            '3 Instruments composition',\r\n            'Better performance than previous version',\r\n            'Better practice tool',\r\n            'Better interface',\r\n            'Breakpoints for the composer',\r\n            'New features for both composer and main page',\r\n            'Feature rich customisability to make learning and composition easier'\r\n        ]\r\n    }\r\n]\r\n","export default __webpack_public_path__ + \"static/media/windsong-db.e533a22d.jpg\";","import './Partners.css'\r\nimport { SimpleMenu } from 'components/SimpleMenu'\r\nimport WindsongDBImg from 'assets/images/partners/windsong-db.jpg'\r\n\r\nexport default function Partners(props) {\r\n    return <div className='partners-page'>\r\n        <SimpleMenu functions={{ changePage: props.changePage }} />\r\n        <div className='partner-wrapper'>\r\n            <Partner\r\n                name='Specy'\r\n                description='The youtube channel that collects videos created by users of this app'\r\n            >\r\n                <Iframe\r\n                    src='https://www.youtube.com/embed/Sh7kqYVMjwM'\r\n                    title=\"Specy\"\r\n                />\r\n            </Partner>\r\n            <Partner\r\n                name='ChaconneScott_ACG'\r\n                description='YouTube pianist and arranger, features Genshin Impact OST'\r\n            >\r\n                <Iframe\r\n                    src='https://www.youtube.com/embed/ltE8zfGfUVo'\r\n                    title=\"ChaconneScott_ACG\"\r\n                />\r\n            </Partner>\r\n            <Partner\r\n                name='uma✿'\r\n                description={`Arranges music, primarily from anime and games for Sky and Genshin.`}\r\n            >\r\n                <Iframe\r\n                    src='https://www.youtube.com/embed/7aIkAGvp9Y0'\r\n                    title=\"uma\"\r\n                />\r\n            </Partner>\r\n            <Partner\r\n                name='Windsong DB'\r\n                description='A Genshin Impact Database for Instrument Gadget Keymaps'\r\n            >\r\n                <PartnerImg \r\n                    img={WindsongDBImg}\r\n                    to='https://genshin-lyre.notion.site/genshin-lyre/Windsong-DB-8012b5f6939b486d857552c7b60e917f'\r\n                    alt='Windsong DB'\r\n                />\r\n\r\n            </Partner>\r\n        </div>\r\n\r\n    </div>\r\n}\r\n\r\nfunction PartnerImg(props){\r\n    return <a \r\n        href={props.to}\r\n        style={{width: '18.8rem', height: '10.5rem', overflow: 'hidden', borderRadius: '0.3rem'}}\r\n        target='_blank'\r\n        rel='noreferrer'\r\n    >\r\n        <img \r\n            src={props.img} \r\n            style={{width: '100%', objectFit: 'cover'}}\r\n            alt={props.alt}\r\n        />\r\n    </a>\r\n}\r\nfunction Iframe(props) {\r\n    return <iframe\r\n        src={props.src}\r\n        title={props.src}\r\n        frameBorder=\"0\"\r\n        allow=\"autoplay; picture-in-picture\"\r\n        allowFullScreen\r\n    >\r\n    </iframe>\r\n}\r\nfunction Partner(props) {\r\n    return <div className='partner'>\r\n        <div className='partner-title'>\r\n            {props.name}\r\n        </div>\r\n        <div className='partner-description'>\r\n            {props.description}\r\n        </div>\r\n        {props.children}\r\n    </div>\r\n}\r\n","import './Home.css'\r\nimport { FaCompactDisc, FaTimes } from 'react-icons/fa'\r\nimport { BsMusicPlayerFill } from 'react-icons/bs'\r\nimport { appName, isTwa } from 'appConfig'\r\n\r\nexport default function Home(props) {\r\n    const to = props.changePage\r\n    const { data, askForStorage, hasVisited } = props\r\n    const homeClass = data.isInPosition ? \"home\" : \"home home-visible\"\r\n    const breakpoint = window.innerWidth > 900\r\n    return <div className={homeClass}>\r\n        <FaTimes className='close-home' onClick={() => props.toggleHome(false)} />\r\n        {(breakpoint || !hasVisited) && <div className='home-top'>\r\n            <div className='home-title'>\r\n                {appName} Music Nightly\r\n            </div>\r\n            <div className='home-top-text'>\r\n                An app where you can create, practice and play songs for {appName}\r\n            </div>\r\n        </div>  \r\n        }\r\n\r\n        {!hasVisited && <div className='home-welcome'>\r\n            <div>\r\n                {!isTwa() && <div className='home-spacing'>\r\n                    To have the webapp fullscreen and better view, please add the website to the home screen\r\n                </div>}\r\n                <div  className='home-spacing'>\r\n                    <div className=\"red-text\">WARNING</div>:\r\n                    Clearing your browser cache / storage might delete your songs, make sure you make backups\r\n                </div>\r\n                {data.hasPersistentStorage ?\r\n                    <div>\r\n                        <div className=\"red-text\">WARNING</div>: Click the button below to make sure that your browser won't delete your songs if you\r\n                        lack storage\r\n                    </div>\r\n                    : null\r\n                }\r\n            </div>\r\n            <div style={{display:'flex', justifyContent:'flex-end'}}>\r\n                <button className=\"home-accept-storage\" onClick={askForStorage}>\r\n                    Confirm\r\n                </button>\r\n            </div>\r\n\r\n        </div>}\r\n        <div className='home-content'>\r\n            <MainContentelement\r\n                icon={<FaCompactDisc />}\r\n                title='Composer'\r\n                background={`./manifestData/composer.png`}\r\n                onClick={() => to(\"Composer\")}\r\n            >\r\n                Create or edit songs with a fully fledged music composer. Also with MIDI.\r\n            </MainContentelement>\r\n            <MainContentelement\r\n                icon={<BsMusicPlayerFill />}\r\n                title='Player'\r\n                background={`./manifestData/main.png`}\r\n                onClick={() => to(\"\")}\r\n            >\r\n                Play, download, record and import songs. Learn a song with approaching circle\r\n                mode and practice mode.\r\n            </MainContentelement>\r\n        </div>\r\n        <Separator> Other pages </Separator>\r\n        <div className='page-redirect-wrapper'>\r\n            <PageRedirect onClick={() => to(\"Changelog\")}>\r\n                Changelog\r\n            </PageRedirect>\r\n            {!isTwa() &&\r\n                <PageRedirect onClick={() => to(\"Donate\")}>\r\n                    Donate\r\n                </PageRedirect>\r\n            }\r\n            <PageRedirect onClick={() => to(\"Partners\")}>\r\n                Partners\r\n            </PageRedirect>\r\n            <PageRedirect onClick={() => to(\"Help\")}>\r\n                Help\r\n            </PageRedirect>\r\n        </div>\r\n        <div className='home-dont-show-again' onClick={() => props.setDontShowHome(!data.canShow)}>\r\n            <input type='checkbox' checked={!data.canShow} readOnly />\r\n            Hide on open\r\n        </div>\r\n        <div className='home-bottom'> \r\n            <div>\r\n                © All rights reserved by {appName === 'Genshin' ? 'miHoYo' : 'TGC'}. Other properties belong to their respective owners. \r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n}\r\n\r\n// © 2021 {appName} Music. All rights reserved.   <br />\r\nfunction PageRedirect(props) {\r\n    return <button onClick={props.onClick}>\r\n        {props.children}\r\n    </button>\r\n}\r\n\r\nfunction MainContentelement(props) {\r\n    return <div className='home-content-element' onClick={props.onClick}>\r\n        <div className='home-content-background' style={{ backgroundImage: `url(${props.background})` }}>\r\n        </div>\r\n        <div className='home-content-main'>\r\n            <div className='home-content-title'>\r\n                {props.icon} {props.title}\r\n            </div>\r\n            <div className='home-content-text'>\r\n                {props.children}\r\n            </div>\r\n            <div className='home-content-open'>\r\n                <button>\r\n                    OPEN\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n}\r\n\r\nfunction Separator(props) {\r\n    return <div className='home-separator'>\r\n        {props.children}\r\n    </div>\r\n}","import { HelpTab } from \"components/HelpTab\"\r\nimport { SimpleMenu } from \"components/SimpleMenu\"\r\nimport './Help.css'\r\n\r\nexport default function Help(props){\r\n    return <div className=\"help-page\">\r\n        <SimpleMenu functions={{changePage: props.changePage}}/>\r\n        <div className=\"help-content\">\r\n            <div style={{fontSize: '2rem', margin: '1rem 0'}}>\r\n                Info about the app\r\n            </div>\r\n            <div style={{marginLeft: '1rem'}}>\r\n                In this page you will find an explaination for what all the buttons in the app do and\r\n                how to use them.\r\n                <br/><br/>\r\n                If you Have issues, bugs, or suggestions, please join our \r\n                <a href=\"https://discord.gg/Arsf65YYHq\" style={{color: 'var(--note-text)'}}>\r\n                <>&nbsp;</> Discord server\r\n                </a>\r\n                . <br/>\r\n            </div>\r\n            <HelpTab />\r\n        </div>\r\n    </div>\r\n}","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://cra.link/PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://cra.link/PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then((registration) => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://cra.link/PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch((error) => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then((response) => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then((registration) => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log('No internet connection found. App is running in offline mode.');\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then((registration) => {\r\n        registration.unregister();\r\n      })\r\n      .catch((error) => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","export default function FloatingMessage(props){\r\n    const { title, text, visible, onClick} = props\r\n\tlet classes = visible ? \"floating-message floating-message-visible\" : \"floating-message\"\r\n    return <div className={classes} onClick={onClick}>\r\n    <div className=\"floating-message-title\">\r\n        {title}\r\n    </div>\r\n    <div className=\"floating-message-text\">\r\n        {text}\r\n    </div>\r\n</div>\r\n}","export default __webpack_public_path__ + \"static/media/paypalme.45abe55e.png\";","export default __webpack_public_path__ + \"static/media/buymeacoffee.b124acdd.svg\";","import './Donate.css'\r\nimport paypalImg from 'assets/images/paypalme.png'\r\nimport buyMeACoffeeImg from 'assets/images/buymeacoffee.svg'\r\nimport kofiImg from 'assets/images/kofi.png'\r\nimport { SimpleMenu } from 'components/SimpleMenu'\r\nexport default function Donate(props) {\r\n    return <div className='donate-page'>\r\n        <SimpleMenu functions={{changePage: props.changePage}}/>\r\n        <div className=\"donate-text\">\r\n            Each App I make takes months of learning and development. Added to that\r\n            are also the costs of hosting. With a higher budget I can afford to not\r\n            worry so much about how much I spend on the server, giving you the best\r\n            possible experience.<br />\r\n            I care about giving users all features without\r\n            having to pay for it, neither having intrusive ads which can be annoying.\r\n            For this same reason, there is no source of income except donations.\r\n            <br /><br />\r\n            I would be really thankful if you could consider donating in order to fund\r\n            development and costs.\r\n        </div>\r\n        <div className=\"donation-wrapper\">\r\n            <a href=\"https://paypal.me/specyDev\" target=\"_blank\" className=\"paypal\" rel=\"noreferrer\">\r\n                <img src={paypalImg} alt=\"paypalme\" style={{ height: \"4rem\" }} />\r\n            </a>\r\n            <a href=\"https://ko-fi.com/specy\" target=\"_blank\" className=\"kofi\" rel=\"noreferrer\">\r\n                <img src={kofiImg} alt=\"kofi\" style={{ height: \"3rem\" }} />\r\n            </a>\r\n            <a href=\"https://www.buymeacoffee.com/specy\" target=\"_blank\" rel=\"noreferrer\">\r\n                <img src={buyMeACoffeeImg} alt=\"buymeacoffee\" style={{ height: \"4rem\" }} />\r\n            </a>\r\n        </div>\r\n    </div>\r\n}","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWUAAACNCAMAAABYO5vSAAABIFBMVEX///8Auf4mJyoAAAD/XlsAu/8AoNwAt/4wMDAAtf7w8PAAv/8VFxsbHSDz8/OTk5XBwcLa2toICxG0tLT/XGP/W2kAvf//XWD/Wm3/W2jj4+QAJjXR0dEAR2L/WXEAlMsANUn/WHZUVVcABQ2dnZ0AaZDs+v+EhIYZGx7/V3r/WHT/U1AATWtERETE7P/V8v8Are6srK07PD9nZ2mG2P5Exv6h4P+25/9bW10AWXoREREAPlVxcnPj9f9hzP7R8f+q4v8Ae6n/3+NSy/7/S0d60P4AdaEAGCAAir7/vsX/ydD/fJH/Y4P/r73/7fD/iJP/oqz/ZHX/19r/Rmj/R1v/l6X/foj/tLX/fHn/qqj/aWYAExn/l5X/dnT/hoT/m5qa6M4eAAAQ3klEQVR4nO2d/UPaVhfHJSkGSMJLaGkbaXUEgVWxvCpWRK3Vdt3mttq12/p0+///iycvJDn35r4kMUAt+f6kQMLNJ4dzzzn3JRsbqb51tU7PDkdXV7PZ2NTl7OpqdHhw2lp1q74jtQ5Gs7Es5SVLGVv2n3mpNp6Njk5X3b7vQAejcdaDG5TJOiNfHaVGfQcdXebzVMAAdT4/PkxBx1HraJYJg9gjfXmego6os1ktAmJH+czl0arbfZ90dkn3xEyDlsYp55A6GEc2Y2DQtfNVt/8+yGQcG3HKOZxaszsytjmPz1Z9Hd+0DrPxfQWUNFr1lXy7OpMTMOQ55mzaDZI1SoyxpfxlGj4H1Ron4yw8SbWDVV/TN6eDhDwywjn1zqiS9Rau8pervq5vSknEbyRJcloXdZW4SwaYs2no7KglLwyypbQPtHS6gH4PKp9i3th4mV0oYwtzmqCc1hYN2XTO627NrSVANrXmXeBiOz5fax3QLS6Ew1Rb46LGbFmQM9J41de6Mh0uKOMjYp6t+mpXpLMlQjbjucNVX+9KtKTwwpP0ctVXvAotzynPJa/6ilegZTplR2vomk+XbcmZdUy1L1dAOVNb9VUvWUdL9xeW1m2ICokvsgmLgXmtMu0R8Be1zGbC6pk3Tq6RYH8HKWCx3C9NJ9N2v8z75Clg3NsVk5exc3zRy8pBzPe9A+xPDENRVFVVFEMt6czPXnmmnO1tLQCyo5Prnhww6HsdNPcHmir4Ujp95/V6e9iYTKtF5MPAlDOLg2zpeBO3Z+n+GrPe0ARMYsV8vTDQLOtWjRxi275Xlm138SqXqIRXrwDnHpbIczxzvd+v1rkXXGwOh80i92OJqmqoOGRBaZtvDJX5f50J+HjL7/rktyaIafItqpRLXZfzRQZxG8zB1uJU1DRNFDg9S1nRVFUTKom2maOyEWAsCOrQbLPi/asBYwYBRs/CsCCb0JuDuX/uQbchseYbTeYt1pjmXHY+pQ6WaM31oCFbTTAttOi/IwLK/hVnN00IwuKaVs7ZmLV3EHOeXptruvaiTqif8SCb96KZfJNp6hIpKyUa5XMJpZxbZOOac68BMEtX1E/7zTcK1A+VRc+SGotoMlHNQMfnYS10SJTHmSVS3tAnNuZriJn6YZHUXkxV/0OCupAmkwQgq5qmmEGF+UfHME15Qyf5ZRjGLYGya84AMzUzKYSg3IfX211Um3GBrs+YlHW9XJp2B92p00l7HgP8tmByvRTK5k/cku+bqf1fCMoQsiD2F9ZmTFPPK2jB7yyLlmWbNi76ffZ42bZs9s825p4f0FGmDfApN4G7EJThAtuMauCZK+k7C81GThhMAH9kSHVJlB1rPvHSE+mc/DEuZQSytoA4nybPKbBDTE/QYSROudro2hpOmygl2ze/8zBT8j8eZaSjN9rJtZunoucwVHaByBV0GElT1mEJo4vc9Yb5yhfPZVBmGnEolxCfXEqs2Xz5lJVw+aa0QMpVtFQEf9E6Ysx58uxENuU2THGNJSYk0Skf5JdHWeyCDHhq/r/jhhmUkSkmZQSyVk2s0WEUlfIogi2/NoW/dvP6w0/vgy87siifWIMl29cnDmb/PduYN12fQXbMLMpt6C40djVJrzdL7em0XapW6ClkFPEp68gXoeVeBuX3P//yo6lffv71xn/xw2/Pby09+fSedIxF+ZmczWZrcm37LeY0JkhqQvxOBuUpTEYUVkdfbw9UQ1E6qtpRNE1o9MP1VxQV6pbKfuLRr88FT1saCLlB2wPdyoej/PuPrn54cfvznPPNp9vntp48efLxjw/BoxzK8w4us2Nh9o2uD4M5cvmTTnkIIbMqnk1V8xNe55YYk/gV0qmhWQKnVDRXXa+JTusUL79G3XKmtk2k/OEHj7GlF7e/Wq9+9hmbevTx98BxkHImm7Gs+ZX3puUyjJ7rmIlTE6mUEcgDunH2O6SijioOY9pzQyGczjutNr97fdFt2fywcykE5Q+3ALEJ+cWL2z83NhxDfjLXo0cEzAjlTM36oYAkOAccM7kuR6M8BBfbGVBdrT4hFdrtg9RYuTilEOdhnpctvMTQmP9yR2Eo/wEYm4hfmHBv//z0xCNsIX706OnTjz9hB6KUM/Ix0gFajvnCdRnE7o9CGUJWGtTKfVUhloDnAOIkig3GCe3G2I0EXeM8hr8kUMYL5n//AKzYZozasIPY1MOH2BVjlG2v7+Nqm//sMrs/MmX4s9XopYsSzZDnBLqRB1aKA+YZ52OroIrvUsZGlG3KWCm8+AdixYCwy/jpnPHDx5/RQzHKmZoVz3mRrVXM2Pe6P1L2R6JchJAZFtlmQzZ/37nIUR3Plp3uLkC5leVT/nCLIH5OQ2xRfsimbLsMLxO2KnM77lvE7I9AGYVML100MchWFKegLsTrnEKrzer8rPJ2kUj5ZYZP+fMtFTEkbEF+vHeDHBqgfG2+4JGpmP9seZRJlfwgZQSySM+qy7BYJyhit92sVvulhgj7L4U1mEiSrjKNef4zDVA+k/iUf38eQPyEiNjUHho0BzzGO5iYWKHcW/ctYvEzQLk48MfUBIMeJxSQGT9gZlWxn4NePWqFSRc0pWMKnF7tOFI0tz2xKP9HMuOnJMZ8ytuQctEazfYokwJmnHJhAC6PVboYgpuhTdFurgQxh6sOA5WbbVNDvx3TtqNS33XzAcpYUkKxZQ7ix64ePOBRvsBt2fMYxHoRRllHRucZpQs4ISU4YlT2vUbcgUL/FEowvwlQxueGE/0y31HYhC3toWWjgF/ehZQtv3ySDU9ZHyB+gJEmg1jAIFg8cNqkt0MIUA42I0D5nOQxsD7h/UcsLKYhNvUGPZQYyXm2ZcUYz9xIjpj8IZR1Aet6qAzq/mFkzwtzOOpZWIpG+TCEX775CAMKBmJTf6GHsrOSKsxKiOulAGWtjEPuUBMS32vSPIJv7AbqeAq4yKXSaJRHJMr47f0Uxoodh4Gl2OwMewozbOJsgQISj+GiztcCDoHSu9W9HhAZg+4PNBGXRqosJWDLeB3j80dqb4cLOxKlLG+j1aIuLOPHoCxQyso+AvrsuolPwjdWcrqo5IKYE/DLOOXiw3CIH+z9jR2JUJZtf+Gf3A6X3con1y8TlSOWIqb+MD41Dqlqwc9UKBW3TvBeRaOMxxjkKv7nj2xH4eqfwLX4lGt2RiKC2TbWZIF9f34RJ8YgXz9x9iGo6VArFQXfVL3+sUTLn7WAMUejjMfLlLGSvx5zrNgx5cBoiUPZUmb7mQ0ZuNIcHMQOTVlFUJBcsw+QNR23G/zQkJY+iwGS0SjjuR9tROorF7EJ+XPgMIvy1vX18f7JfLVKG33vi//NvNzPbfekivyuCclbxbsPHcY8GM8x+zMGqXXNu9pyWMobXx+wEZuQ/xc8Cp8pAC3vFVJd5tYx5s0eYnNdhGD5sq5hF0lU28vBvaCHPO/bVHCKfzTKeE2OSrn4lUWYAnk+udNVFzbIKuGL4Jt5NTnHqOywawKKFISuCRBgzITxi5gewxKl9yO4pWiU8foyfabAzT9syP+SDir4iDtDpL+3Z30CU+bWl+3LdZLzQg55ETfYajjK3q3yKBeDC8vsLyB0sdEo42MljPkYN9Ehm9FaqV0qlZr9so7+6AoqrHralDljJQKo2dcRGiIWrgHKDL/sd3XA5zSFQFIiDkhuJyJlbNyPNbeIgXnvK/1yiLIXS20jC/9IH0Mog4ERdCxZRV0zSEoYI6igoBRjulFEyqPwlOlOY+8vyhEUFbu4v+CPYQsGtCk4io2v2fEtnbWYJ0xQTVdEyucEytQy1euEINuWvI9YMnc+BhYv5GA8gLrmCrgD9Kkafg8aZ5FgRMoHhBlcIvXkr/cScBd1yyf75fs5Zc7cItws0WwYKawVKa8jAstR4hTyI1LG5sk5a1fpZyf45qiQS3afsoN+LXeeXODH30cqOxo0Wi+tY6QlfrWIuDCEp4iU8SCDQ9n0zZg506ILWvNsQxafZfAdHIifZlBGR+2ROrIfpMGCGyLwU2CFe/TLiEgZ6/54lM30BMFMTEaox1bnK96vA7tk8OYvEzoyJFWDQRsY9aPFcqBkEX2AdSM6ZcwxcymbyfZeLMiFcrvjMP6yHdjzhTsXn0BZR4JpWOQEbwQLPZbg6Gus5a5RKW9EtGVT/+5FglzQ9XK/PfDC/OtMcKdLyu4NTMrYzBawWGkKrZzgM3QAmZW50BWZ8hi9XoNPeeO/OeZA1T6gKZ5JGce9gCFnQqyRIoa+yKIH4JorcGV2cOJtBd4E+vpuliJTRh2z/CUE5Y2/34SDXMcY71wTGYdY70dOMCYU1wxfV3OY40WGaTvxVmJGpoxuBxyO8sbnN8R6Mi6k8rmzu5khM6ZEy3zKfsHekj+3At2GRSkBc9bbaKQdb/FDZMqoywhJ2cT8hrheB5VD+cvbZ7sXm5lscP8tT5S9+3iU4cwLAbrmKTKioqjTsp3gFapDBR1ribkUMzplxGXY+xaFub8fKIvPEFkZyO7YGpEibtnnmTJ/TwFaSaJJds0g/3Pe0cRctyuIGlqoj73TQ3TKcH+MjLwVknIoobPtqQqxPwa18APnHYK4rcwZl6UiCqfolBGXkSxla+XIO/4O5dS9XkJQLsC6Ecjj+iEw45Xp8IpBGdblbMpxsiGSilZRfJP7wCT6vkUhKCMlfRj8NrmY77BnSQzKLWjL1oB+UmuarUmdX3pUup7DoO7BFYYyrBshNQlkF5ig1E5sS+ZRDqyRsgX6P3vua1J7IFhu+YTrlln7yfmUGZUzP6AwkBSjrEKfjUnBw+hIAj8gQnXaew8ZlwV7I9ozgJLaycoK4y64bpm1N6I3bkTYHciXO69Zw7LlwpDmNVSxfbcN/twBXoWU1XiD4ehEDhjMiYk5Zns/F77DYO3z6cbD7F0PdaFjkwvae3mAxW7O2YzGXa+wItrnVVRiuwbOrwtzvSCYsx1zIjtkWF5ZPOY7DOaetWVruYxidNnVBn2SU9QGsTspNzooaFUThglYUaWhGEZnSLn5bWsRfA53/P7+y/aszyT2U9WFcKbM2X+5UG23S/x+qlCh3ge9PxwYmmJL0wbT6p12bvBVKdfpZypUKpXAHYDGvJ8I5rpdTL7me+VlbL9c1Mv9JmleyJLle+Zsz94upHun1KTglDz3uZC/g33xo8jnUes5NbRus64X8WUWxUI9oHLVVXOuhnOGE667WLNnPMCRqdrmW7z4HkvHfMj5NXteCZzLVes9uzvjrRAFjLV79g76HKna5h0fQrB1QRjdC5ry/X3yQFwh66Wycu9if2eLrB1MJ/tzHe86uujJYZ4VuIbPRMOfbJutybHFrNmDr1j1Fa9Cp3wuiYr5cIfvV/iKqQVDXrf4wtUofYbwMpQ+D3spWtqz3WmTA9ZC+KKpRYmy4fK6qMUnlICk9QwvfL1cgjXf46fNJaXFY17DxDqo0+xiu8A1zUZwteSFYl7vjs9Xa3EBnVSjP2du7TRbUBYoyescJwe0mGQ7z3ou5TrqYAF9IGUp1DqrdZmwOUu1NLggKFmvkb+kPF9u3XUgJ8ZZyqapCFWHyXhnKfXITLWuEsAsjdMgmaOD8R3dRl5OnUUInY3z8Q06ZRxaZzMpFmdJGqfRWwS9nGUjG7SUuUwZR1TrKJJBS/nxYVqziKPWoZwPY9GSlK+NUsTx1ToajU2KVNQm4Iw8O0oR31mtg9FsLEt5SfJxW3/mpdp4NkoJJ6jW6dnh6Go2G4/H8ng8m11dHR6cppWKVCvR/wHDcffSeAGLqQAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/rotate.e7c0f107.svg\";","import React, { Component } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from 'pages/Main';\r\nimport Composer from \"pages/Composer\"\r\nimport ErrorPage from \"pages/ErrorPage\"\r\nimport Changelogpage from 'pages/Changelog'\r\nimport Partners from 'pages/Partners';\r\nimport Home from 'pages/Home';\r\nimport Help from 'pages/Help';\r\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration';\r\nimport { HashRouter, Route, Redirect } from \"react-router-dom\";\r\nimport { LoggerEvent, delayMs } from \"lib/Utils\"\r\nimport { appName, appVersion, pages, isTwa, updateMessage } from \"appConfig\"\r\nimport FloatingMessage from 'components/FloatingMessage'\r\nimport Donate from 'pages/Donate';\r\nimport rotateImg from \"assets/icons/rotate.svg\"\r\n\r\nclass Index extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props)\r\n\t\tlet path = window.location.href.split(\"/\")\r\n\t\tpath = path.length === 0 ? \"\" : path = path[path.length - 1]\r\n\t\tif (!pages.includes(path)) path = \"\"\r\n\t\tconst hasVisited = localStorage.getItem(appName + \"_Visited\")\r\n\t\tlet canShowHome = localStorage.getItem(appName + \"_ShowHome\")\r\n\t\tcanShowHome = canShowHome === null ? 'true' : canShowHome\r\n\t\tthis.state = {\r\n\t\t\tfloatingMessage: {\r\n\t\t\t\ttimestamp: 0,\r\n\t\t\t\tvisible: false,\r\n\t\t\t\ttext: \"Text\",\r\n\t\t\t\ttitle: \"Title\"\r\n\t\t\t},\r\n\t\t\thomeData: {\r\n\t\t\t\tcanShow: canShowHome === 'true',\r\n\t\t\t\tvisible: canShowHome === 'true',\r\n\t\t\t\tisInPosition: false,\r\n\t\t\t\thasPersistentStorage: Boolean(navigator.storage && navigator.storage.persist)\r\n\t\t\t},\r\n\t\t\tselectedPage: path,\r\n\t\t\thasVisited: hasVisited === 'true'\r\n\t\t}\r\n\t\tthis.updateChecked = false\r\n\t}\r\n\tcomponentDidMount() {\r\n\t\twindow.addEventListener('logEvent', this.logEvent);\r\n\t\tthis.checkUpdate()\r\n\t}\r\n\tchangePage = (page) => {\r\n\t\tif (page === 'home') return this.toggleHome(true)\r\n\t\tif (this.state.homeData.visible) this.toggleHome(false)\r\n\t\tthis.setState({\r\n\t\t\tselectedPage: page,\r\n\t\t\thomeVisible: false\r\n\t\t})\r\n\t}\r\n\ttoggleHome = (override = false) => {\r\n\t\t//TODO please refactor this\r\n\t\tconst lastState = this.state.homeData\r\n\t\tif (override) { //if its to be shown then just show it\r\n\t\t\treturn this.setState({\r\n\t\t\t\thomeData: { ...lastState, visible: true, isInPosition: false }\r\n\t\t\t})\r\n\t\t}\r\n\t\tthis.setState({ //if it needs to be hidden, first trigger the animation\r\n\t\t\thomeData: { ...lastState, isInPosition: true }\r\n\t\t}, () => {\r\n\t\t\tsetTimeout(() => { //then demount it\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\thomeData: { ...lastState, visible: false }\r\n\t\t\t\t})\r\n\t\t\t}, 150)\r\n\t\t})\r\n\t}\r\n\tsetDontShowHome = (override = false) => {\r\n\t\tlocalStorage.setItem(appName + \"_ShowHome\", override)\r\n\t\tconst lastState = this.state.homeData\r\n\t\tthis.setState({\r\n\t\t\thomeData: { ...lastState, canShow: override }\r\n\t\t})\r\n\t}\r\n\tcomponentDidCatch() {\r\n\t\tthis.setState({\r\n\t\t\tselectedPage: \"ErrorPage\"\r\n\t\t})\r\n\t}\r\n\tcomponentWillUnmount() {\r\n\t\twindow.removeEventListener('logEvent', this.logEvent);\r\n\t}\r\n\taskForStorage = async () => {\r\n\t\ttry {\r\n\t\t\tif (navigator.storage && navigator.storage.persist) {\r\n\t\t\t\tlet result = await navigator.storage.persist()\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\tnew LoggerEvent(\"Success\", \"Storage permission allowed\").trigger()\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//new LoggerEvent(\"Warning\", \"Storage permission refused, will try next time\", 6000).trigger()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tconsole.log(e)\r\n\t\t\tnew LoggerEvent(\"Error\", \"There was an error with setting up persistent storage\").trigger()\r\n\t\t}\r\n\t\tthis.closeWelcomeScreen()\r\n\t}\r\n\tcloseWelcomeScreen = () => {\r\n\t\tlocalStorage.setItem(appName + \"_Visited\", true)\r\n\t\tthis.setState({\r\n\t\t\thasVisited: true\r\n\t\t})\r\n\t}\r\n\thideMessage = () => {\r\n\t\tlet state = this.state\r\n\t\tstate.floatingMessage.visible = false\r\n\t\tthis.setState({\r\n\t\t\tfloatingMessage: state.floatingMessage\r\n\t\t})\r\n\t}\r\n\tcheckUpdate = async () => {\r\n\t\tawait delayMs(1000)\r\n\t\tif (this.updateChecked) return\t\r\n\t\tlet storedVersion = localStorage.getItem(appName + \"_Version\")\r\n\t\tif (!this.state.hasVisited) {\r\n\t\t\treturn localStorage.setItem(appName + \"_Version\", appVersion)\r\n\t\t}\r\n\r\n\t\tif (appVersion !== storedVersion) {\r\n\t\t\tnew LoggerEvent(\"Update V\" + appVersion, updateMessage, 6000).trigger()\r\n\t\t\tlocalStorage.setItem(appName + \"_Version\", appVersion)\r\n\t\t}\r\n\t\tthis.updateChecked = true\r\n\t\tif (!this.state.hasVisited) return\r\n\t\tif (navigator.storage && navigator.storage.persist) {\r\n\t\t\tlet isPersisted = await navigator.storage.persisted()\r\n\t\t\tif (!isPersisted) isPersisted = await navigator.storage.persist()\r\n\t\t\tconsole.log(isPersisted ? \"Storage Persisted\" : \"Storage Not persisted\")\r\n\t\t}\r\n\t}\r\n\r\n\tlogEvent = (error) => {\r\n\t\terror = error.detail\r\n\t\terror.timestamp = new Date().getTime()\r\n\t\tif (typeof error !== \"object\") return\r\n\t\tthis.setState({\r\n\t\t\tfloatingMessage: {\r\n\t\t\t\ttimestamp: error.timestamp,\r\n\t\t\t\tvisible: true,\r\n\t\t\t\ttext: error.text,\r\n\t\t\t\ttitle: error.title\r\n\t\t\t}\r\n\t\t})\r\n\t\tsetTimeout(() => {\r\n\t\t\tif (this.state.floatingMessage.timestamp !== error.timestamp) return\r\n\t\t\tthis.setState({\r\n\t\t\t\tfloatingMessage: {\r\n\t\t\t\t\ttimestamp: 0,\r\n\t\t\t\t\tvisible: false,\r\n\t\t\t\t\ttext: \"\",\r\n\t\t\t\t\ttitle: \"\"\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}, error.timeout)\r\n\t}\r\n\trender() {\r\n\t\tconst { floatingMessage, hasVisited, homeData } = this.state\r\n\t\treturn <div className=\"index\">\r\n\r\n\t\t\t<FloatingMessage\r\n\t\t\t\ttitle={floatingMessage.title}\r\n\t\t\t\tvisible={floatingMessage.visible}\r\n\t\t\t\tonClick={this.hideMessage}\r\n\t\t\t\ttext={floatingMessage.text}\r\n\t\t\t/>\r\n\t\t\t{homeData.visible && <Home\r\n\t\t\t\ttoggleHome={this.toggleHome}\r\n\t\t\t\tchangePage={this.changePage}\r\n\t\t\t\tsetDontShowHome={this.setDontShowHome}\r\n\t\t\t\taskForStorage={this.askForStorage}\r\n\t\t\t\thasVisited={hasVisited}\r\n\t\t\t\tdata={homeData}\r\n\t\t\t/>}\r\n\t\t\t<HashRouter>\r\n\t\t\t\t<Redirect to={\"/\" + this.state.selectedPage}></Redirect>\r\n\t\t\t\t{this.state.selectedPage === \"ErrorPage\"\r\n\t\t\t\t\t? <Route exact path={\"/ErrorPage\"}>\r\n\t\t\t\t\t\t<ErrorPage changePage={this.changePage} />\r\n\t\t\t\t\t</Route>\r\n\t\t\t\t\t: <>\r\n\t\t\t\t\t\t<Route exact path={\"/ErrorPage\"}>\r\n\t\t\t\t\t\t\t<ErrorPage changePage={this.changePage} />\r\n\t\t\t\t\t\t</Route>\r\n\t\t\t\t\t\t<Route exact path=\"/\">\r\n\t\t\t\t\t\t\t<App changePage={this.changePage} />\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route exact path=\"/Composer\">\r\n\t\t\t\t\t\t\t<Composer changePage={this.changePage} />\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route exact path=\"/Donate\">\r\n\t\t\t\t\t\t\t<Donate changePage={this.changePage} />\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route exact path=\"/Changelog\">\r\n\t\t\t\t\t\t\t<Changelogpage changePage={this.changePage} />\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route exact path=\"/Partners\">\r\n\t\t\t\t\t\t\t<Partners changePage={this.changePage} />\r\n\t\t\t\t\t\t</Route>\r\n\r\n\t\t\t\t\t\t<Route exact path='/Help'>\r\n\t\t\t\t\t\t\t<Help changePage={this.changePage} />\r\n\t\t\t\t\t\t</Route>\r\n\t\t\t\t\t</>\r\n\t\t\t\t}\r\n\t\t\t</HashRouter>\r\n\t\t\t<div className=\"rotate-screen\">\r\n\t\t\t\t<img src={rotateImg} alt=\"icon for the rotating screen\">\r\n\t\t\t\t</img>\r\n\t\t\t\tFor a better experience, add the website to the home screen, and rotate your device\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t}\r\n}\r\n\r\nReactDOM.render(\r\n\t<React.StrictMode>\r\n\t\t<Index />\r\n\t</React.StrictMode>,\r\n\tdocument.getElementById('root')\r\n);\r\n\r\n\r\nfunction setIfInTWA() {\r\n\tif (isTwa()) return console.log('inTWA')\r\n\tlet isInTwa = document.referrer.includes('android-app://')\r\n\tsessionStorage.setItem('isTwa', isInTwa)\r\n}\r\n\r\n\r\nsetIfInTWA()\r\nserviceWorkerRegistration.register();"],"sourceRoot":""}