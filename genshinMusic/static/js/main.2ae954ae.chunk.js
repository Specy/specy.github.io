(this["webpackJsonpgenshin-music"]=this["webpackJsonpgenshin-music"]||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},102:function(e,t,n){},184:function(e,t,n){},201:function(e,t,n){},202:function(e,t,n){},203:function(e,t,n){},204:function(e,t,n){},205:function(e,t,n){},206:function(e,t,n){},207:function(e,t,n){},208:function(e,t,n){},213:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n.n(a),s=n(4),i=n(6),o=n(7),c=n(10),l=n(15),u=n(14),d=n(2),h=n.n(d),m=n(79),g=n.n(m),b=n(22),p=n(13),f=n(8),v=n(40),j="Genshin",x="2.3";console.log("".concat(j,"-V").concat(x));var y="Genshin"===j?" - Added MIDI Keyboard support on all pages with custom layouts\n        - Performance improvements in main page\n        - UI improvements and bug fixes\n        - Added note names to sheet visualizer and empty cells\n        - Added ABC format\n    ".trim():" - Added MIDI Keyboard support on all pages with custom layouts\n        - Performance improvements\n        - UI improvements and bug fixes\n        - Added note names to sheet visualizer and empty cells\n        - Added ABC format\n        - Added Panflute\n    ".trim(),O=["","Composer","ErrorPage","Changelog","Donate","Partners","Home","Help","SheetVisualizer","MidiSetup"],k=[1,2,3],S={noteComposer:"Genshin"===j?"note-composer":"note-composer-sky",note:"Genshin"===j?"note":"note-sky",noteAnimation:"Genshin"===j?"note-animation":"note-animation-sky",approachCircle:"Genshin"===j?"approach-circle":"approach-circle-sky",noteName:"Genshin"===j?"note-name":"note-name-sky"},w=new(window.AudioContext||window.webkitAudioContext),C=144,N=!!navigator.requestMIDIAccess,A="Genshin"===j?["Lyre","Zither","Old-Zither","DunDun"]:["Piano","Contrabass","Guitar","Harp","Horn","Trumpet","Pipa","WinterPiano","Xylophone","Flute","Panflute","Ocarina","Kalimba","ToyUkulele","Drum","Bells","DunDun","HandPan"],E="Genshin"===j?21:15,M={Lyre:{notes:21},Zither:{notes:21,effects:{filter:"sepia(100%)"},clickColor:"#ddcba8"},"Old-Zither":{notes:21,effects:{filter:"sepia(100%)"},clickColor:"#ddcba8"},DunDun:{notes:8},Panflute:{notes:15},Bells:{notes:8},Trumpet:{notes:15},Contrabass:{notes:15},Drum:{notes:8},Flute:{notes:15},Guitar:{notes:15},HandPan:{notes:8},ToyUkulele:{notes:15},Harp:{notes:15},Horn:{notes:15},Piano:{notes:15},Pipa:{notes:15},Kalimba:{notes:15},WinterPiano:{notes:15},Xylophone:{notes:15},Ocarina:{notes:15}},D={21:{keyboardLayout:"Q W E R T Y U A S D F G H J Z X C V B N M".split(" "),mobileLayout:"do re mi fa so la ti do re mi fa so la ti do re mi fa so la ti".split(" "),keyboardCodes:"81 87 69 82 84 89 85 65 83 68 70 71 72 74 90 88 67 86 66 78 77".split(" "),abcLayout:"A1 A2 A3 A4 A5 A6 A7 B1 B2 B3 B4 B5 B6 B7 C1 C2 C3 C4 C5 C6 C7".split(" ")},8:{keyboardLayout:"Q W E R A S D F".split(" "),mobileLayout:"do re mi fa do re mi fa".split(" "),keyboardCodes:"81 87 69 82 65 83 68 70".split(" "),abcLayout:"A1 A2 A3 A4B1 B2 B3 B4".split(" ")},15:{keyboardLayout:"Q W E R T A S D F G Z X C V B".split(" "),mobileLayout:"do re mi fa so do re mi fa so do re mi fa so".split(" "),keyboardCodes:"81 87 69 82 84 65 83 68 70 71 90 88 67 86 66".split(" "),abcLayout:"A1 A2 A3 A4 A5 B1 B2 B3 B4 B5 C1 C2 C3 C4 C5".split(" ")}},T={Sky:{0:["C","D","E","F","G","A","B","C","D","E","F","G","A","B","C"],1:["Db","Eb","F","Gb","Ab","Bb","C","Db","Eb","F","Gb","Ab","Bb","C","Db"],2:["D","E","F#","G","A","B","C#","D","E","F#","G","A","B","C#","D"],3:["Eb","F","G","Ab","Bb","C","D","Eb","F","G","Ab","Bb","C","D","Eb"],4:["E","F#","G#","A","B","C#","D#","E","F#","G#","A","B","C#","D#","E"],5:["F","G","A","Bb","C","D","E","F","G","A","Bb","C","D","E","F"],6:["Gb","Ab","Bb","Cb","Db","Eb","F","Gb","Ab","Bb","Cb","Db","Eb","F","Gb"],7:["G","A","B","C","D","E","F#","G","A","B","C","D","E","F#","G"],8:["Ab","Bb","C","Db","Eb","F","G","Ab","Bb","C","Db","Eb","F","G","Ab"],9:["A","B","C#","D","E","F#","G#","A","B","C#","D","E","F#","G#","A"],10:["Bb","C","D","Eb","F","G","A","Bb","C","D","Eb","F","G","A","Bb"],11:["B","C#","D#","E","F#","G#","A#","B","C#","D#","E","F#","G#","A#","B"]},Genshin:{0:["C","D","E","F","G","A","B","C","D","E","F","G","A","B","C","D","E","F","G","A","B"],1:["Db","Eb","F","Gb","Ab","Bb","C","Db","Eb","F","Gb","Ab","Bb","C","Db","Eb","F","Gb","Ab","Bb","C","Db"],2:["D","E","F#","G","A","B","C#","D","E","F#","G","A","B","C#","D","E","F#","G","A","B","C#","D"],3:["Eb","F","G","Ab","Bb","C","D","Eb","F","G","Ab","Bb","C","D","Eb","F","G","Ab","Bb","C","D","Eb"],4:["E","F#","G#","A","B","C#","D#","E","F#","G#","A","B","C#","D#","E","F#","G#","A","B","C#","D#","E"],5:["F","G","A","Bb","C","D","E","F","G","A","Bb","C","D","E","F","G","A","Bb","C","D","E","F"],6:["Gb","Ab","Bb","Cb","Db","Eb","F","Gb","Ab","Bb","Cb","Db","Eb","F","Gb","Ab","Bb","Cb","Db","Eb","F","Gb"],7:["G","A","B","C","D","E","F#","G","A","B","C","D","E","F#","G","A","B","C","D","E","F#","G"],8:["Ab","Bb","C","Db","Eb","F","G","Ab","Bb","C","Db","Eb","F","G","Ab","Bb","C","Db","Eb","F","G","Ab"],9:["A","B","C#","D","E","F#","G#","A","B","C#","D","E","F#","G#","A","B","C#","D","E","F#","G#","A"],10:["Bb","C","D","Eb","F","G","A","Bb","C","D","Eb","F","G","A","Bb","C","D","Eb","F","G","A","Bb"],11:["B","C#","D#","E","F#","G#","A#","B","C#","D#","E","F#","G#","A#","B","C#","D#","E","F#","G#","A#","B"]}},P=[.25,.5,.75,1,1.25,1.5,2].map((function(e){return{name:"x".concat(e),value:e}})),I=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],B="Genshin"===j?[14,15,16,17,18,19,20,7,8,9,10,11,12,13,0,1,2,3,4,5,6].reverse():[15,16,17,18,19,20,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14].reverse(),L="Genshin"===j?[14,15,16,17,18,19,20,7,8,9,10,11,12,13,0]:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],R={15:"dmcr dm cr dm cr cr dm dmcr dm cr cr dm cr dm dmcr".split(" "),8:"Sky"===j?"cr dm cr dm cr dm cr dm".split(" "):"do re mi fa do re mi fa".split(" "),21:"do re mi fa so la ti do re mi fa so la ti do re mi fa so la ti".split(" ")},G={noteData:{background:"#d3bd8e",border:"#de4545",center:"#de4545"},horizontalLineBreak:E/3,standards:[{color:5332079},{color:4739939},{color:1742475},{color:14053935}],layersCombination:["000","001","010","011","100","101","110","111"],breakpoints:[{type:"short",color:"#282875"},{type:"long",color:"#282875"}]};function V(){return JSON.parse(sessionStorage.getItem("isTwa"))}var F=n(1);function U(e){var t=e.fill,n=e.className;return Object(F.jsx)("svg",{width:"156mm",height:"156mm",className:n,viewBox:"0 0 156 156",xmlns:"http://www.w3.org/2000/svg",style:{fill:t||"#eae5ce"},children:Object(F.jsx)("path",{d:"M 78.00026,10.550111 C 51.476969,10.181626 25.897505,27.22936 15.85058,51.745551 5.361171,75.829889 10.788685,105.74811 29.175285,124.53663 46.865842,143.57562 76.01089,150.52219 100.41467,141.63611 125.70972,133.0432 144.35989,108.19482 145.36211,81.471209 147.04137,55.492614 131.98362,29.525813 108.70692,17.929174 99.25071,13.06968 88.62966,10.533948 78.00026,10.550111 Z m 0,0.140044 c 2.58037,3.675401 5.16075,7.3508 7.74113,11.026201 24.63414,2.976727 45.57649,23.919913 48.5469,48.555693 3.66955,2.57607 7.33909,5.15214 11.00864,7.72821 -3.6711,2.57728 -7.34219,5.15455 -11.01328,7.73183 -2.97314,24.642991 -23.92605,45.594011 -48.5712,48.558271 -2.57073,3.66162 -5.14146,7.32324 -7.71219,10.98486 -2.57073,-3.66162 -5.141461,-7.32324 -7.712192,-10.98486 -24.643357,-2.96412 -45.595396,-23.91214 -48.570678,-48.553111 -3.673332,-2.57899 -7.346667,-5.15799 -11.019999,-7.73699 3.677467,-2.58193 7.354932,-5.16386 11.0324,-7.74578 2.977996,-24.622822 23.903746,-45.560994 48.529337,-48.537607 2.580378,-3.675573 5.160752,-7.351144 7.741132,-11.026717 z"})})}var H=Object(d.memo)((function(e){var t,n,a=e.data,r=e.approachingNotes,s=e.outgoingAnimation,o=e.fadeTime,c=e.handleClick,l=e.noteImage,u=e.noteText,d=a.status,h=a.approachRate,m=a.instrument,g={transition:"background-color ".concat(o,"ms  ").concat(o===("Genshin"===j?100:200)?"ease":"linear"," , transform 0.15s, border-color 100ms")},b=function(e){var t=S.note;switch(e){case"clicked":t+=" click-event";break;case"toClick":t+=" note-red";break;case"toClickNext":t+=" note-border-click";break;case"toClickAndNext":t+=" note-red note-border-click";break;case"approach-wrong":t+=" click-event approach-wrong";break;case"approach-correct":t+=" click-event approach-correct"}return t}(d),p=(null===(t=M[m])||void 0===t?void 0:t.effects)||{},f=null===(n=M[m])||void 0===n?void 0:n.clickColor;return Object(F.jsxs)("button",{onPointerDown:function(e){e.preventDefault(),c(a)},className:"button-hitbox-bigger",children:[r.map((function(e){return Object(F.jsx)(K,{index:a.index,approachRate:h},e.id)})),s.map((function(e){return Object(F.jsx)("div",{className:S.noteAnimation},e.key)})),Object(F.jsxs)("div",{className:b,style:Object(i.a)(Object(i.a)({},g),f&&"clicked"===d?{backgroundColor:f}:{}),children:[Object(F.jsx)("img",{draggable:"false",alt:"",src:l,style:p}),"Genshin"===j&&Object(F.jsx)(U,{className:"genshin-border",fill:z(d)}),Object(F.jsx)("div",{className:S.noteName,children:u})]})]})}),(function(e,t){return e.data.status===t.data.status&&e.data.approachRate===t.data.approachRate&&e.data.instrument===t.data.instrument&&e.noteText===t.noteText&&e.fadeTime===t.fadeTime&&e.handleClick===t.handleClick&&e.noteImage===t.noteImage&&e.noteText===t.noteText&&e.outgoingAnimation===t.outgoingAnimation&&e.approachingNotes===t.approachingNotes}));function W(e){var t="Sky"===j?5:7;return["#3da399","#ffb347","#3da399"][Math.floor(e/t)]}var K=Object(d.memo)((function(e){var t=e.approachRate,n=e.index;return Object(F.jsx)("div",{className:S.approachCircle,style:{animation:"approach ".concat(t,"ms linear"),borderColor:W(n)}})}),(function(e,t){return e.approachRate===t.approachRate&&e.index===t.index}));function z(e){var t="#eae5ce";return"clicked"===e?t="transparent":"toClickNext"!==e&&"toClickAndNext"!==e||(t="#63aea7"),t}var J=Object(v.a)({data:{song:{},eventType:"",start:0}}),Y=n(90),Z=function e(){var t=this;Object(o.a)(this,e),this.init=function(){t.start=(new Date).getTime()-100,console.log("Started new recording")},this.addNote=function(e){0===t.notes.length&&t.init();var n=[e,(new Date).getTime()-t.start];t.notes.push(n)},this.start=(new Date).getTime(),this.notes=[]},X=function e(t){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(o.a)(this,e),this.name=t,this.version=1,this.notes=a,this.bpm=220,this.pitch="C",this.data={isComposed:!1,isComposedVersion:!1,appName:j},Object.entries(r).forEach((function(e){n.data[e[0]]=e[1]}))},Q=function e(t,n,a){var r=this;Object(o.a)(this,e),this.trigger=function(){window.dispatchEvent(r.event)},this.title=t,this.timeout=a,this.text=n,void 0===a&&(this.timeout=3e3),this.event=new CustomEvent("logEvent",{detail:{title:this.title,text:this.text,timeout:this.timeout}})},q=function e(t){var n=this;Object(o.a)(this,e),this.download=function(e,t){var a=n.dataType+encodeURIComponent(e),r=document.createElement("a");r.style="display:none",document.body.appendChild(r),r.setAttribute("href",a),r.setAttribute("download",t),r.click(),r.remove()},void 0===t&&(t="text/json"),this.dataType="data:"+t+";charset=utf-8,"},_=[{id:0,text:"1",changer:1,color:5332079},{id:1,text:"1/2",changer:.5,color:5338451},{id:2,text:"1/4",changer:1/4,color:4410493},{id:3,text:"1/8",changer:1/8,color:7818605}],$=function e(t){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(o.a)(this,e),r.isComposed=!0,r.isComposedVersion=!0,this.version=1,this.data=r,this.name=t,this.bpm=220,this.pitch="C",this.notes=a,this.instruments=[A[0],A[0],A[0]],this.breakpoints=[0],this.columns=[],this.selected=0,new Array(100).fill().forEach((function(e){var t=new de;t.tempoChanger=0,n.columns.push(t)}))},ee=function e(t,n){Object(o.a)(this,e),this.index=0,this.midi=0,this.status="wrong",this.index=t,this.midi=n,this.status=n<0?"wrong":"right"},te=function e(t,n){Object(o.a)(this,e),this.type=t,this.midi=n,this.status=n<0?"wrong":"right"};function ne(e,t,n,a){try{var r=D[a];if("Note name"===e)return T[j][I.indexOf(n)][t];if("Keyboard layout"===e)return r.keyboardLayout[t];if("Do Re Mi"===e)return r.mobileLayout[t];if("ABC"===e)return r.abcLayout[t]}catch(s){}return""}function ae(e){return new Array(e).fill().map((function(){return[]}))}function re(e){var t,n,a=Number(e.bpm),r={data:e.data,name:e.name,bpm:isNaN(a)?220:a,pitch:null!==(t=e.pitch)&&void 0!==t?t:"C",instruments:e.instruments||[A[0],A[0],A[0]],breakpoints:null!==(n=e.breakpoints)&&void 0!==n?n:[],notes:[],selected:0,columns:[]};return e.columns.forEach((function(e){var t=new de;t.tempoChanger=e[0],e[1].forEach((function(e){t.notes.push(new me(e[0],e[1]))})),r.columns.push(t)})),r}function se(e){var t=new X(e.name),n=Math.floor(6e4/e.bpm),a=100;return e.columns.forEach((function(e){e[1].forEach((function(e){t.notes.push([e[0],a])})),a+=Math.floor(n*_[e[0]].changer)})),t}function ie(e){var t=Number(e.bpm),n={data:e.data,name:e.name,bpm:isNaN(t)?220:t,pitch:e.pitch,breakpoints:e.breakpoints,instruments:e.instruments,columns:[]};return n.data.appName=j,e.columns.forEach((function(e){var t=[e.tempoChanger],a=e.notes.map((function(e){return[e.index,e.layer]}));t[1]=a,n.columns.push(t)})),n}function oe(e){var t,n=JSON.parse(JSON.stringify(e)),a={};return a=(null===(t=n.data)||void 0===t?void 0:t.isComposedVersion)?function(e){var t=[],n=Math.floor(6e4/e.bpm),a=100;return e.columns.forEach((function(e){e[1].forEach((function(e){var n=1;"111"===e[1]&&(n=3),"011"===e[1]&&(n=2),"101"===e[1]&&(n=3),"001"===e[1]&&(n=2),"110"===e[1]&&(n=3),"010"===e[1]&&(n=2),"100"===e[1]&&(n=1);var r={key:(n>2?2:n)+"Key"+e[0],time:a};n>2&&(r.l=3),t.push(r)})),a+=Math.floor(n*_[e[0]].changer)})),t}(n):function(e){var t=[];return e.notes.forEach((function(e){t.push({time:e[1],key:"1Key"+e[0]})})),t}(n),n.isComposed=n.data.isComposedVersion,n.pitchLevel=I.indexOf(n.pitch),n.songNotes=a,n.bitsPerPage=16,n.isEncrypted=!1,[n]}function ce(e){var t,n;Array.isArray(e)&&e.length>0&&(e=e[0]);var a=function(e){try{if(void 0!==e.data)return e.data.isComposedVersion?"string"!==typeof e.name||"number"!==typeof e.bpm?"none":I.includes(e.pitch)&&Array.isArray(e.breakpoints)?e.breakpoints.length>0&&"number"!==typeof e.breakpoints[0]?"none":Array.isArray(e.columns)?e.columns.length>0&&"number"!==typeof e.columns[0][0]?"none":"newComposed":"none":"none":"string"!==typeof e.name||"number"!==typeof e.bpm?"none":I.includes(e.pitch)?"newRecorded":"none";if(e.pitchLevel=e.pitchLevel||0,void 0!==e.songNotes)return"oldSky"}catch(t){return console.log(t),"none"}return"none"}(e);if("none"===a)throw new Q("Error","Invalid song").trigger(),new Error("Error Invalid song");if("oldSky"===a&&(e=function(e){var t=new X("Error");try{var n=Number(e.bpm);(t=new X(e.name)).bpm=isNaN(n)?220:n,t.pitch=I[e.pitchLevel||0]||"C",e.songNotes=e.songNotes.filter((function(e,t,n){return t===n.findIndex((function(t){return t.key.split("Key")[1]===e.key.split("Key")[1]&&t.time===e.time}))})),e.songNotes.forEach((function(e){var n,a=e.key.split("Key");t.notes.push([le[a[1]],e.time,null!==(n=e.l)&&void 0!==n?n:Number(a[0])])})),[!0,"true"].includes(e.isComposed)?t=ie(ue(t)):t.notes=t.notes.map((function(e){return[e[0],e[1]]}))}catch(a){return console.log(a),new X("Error importing song, invalid format")}return t}(e)),"Sky"===j&&"Sky"!==(null===(t=e.data)||void 0===t?void 0:t.appName))throw new Q("Error","Invalid song").trigger(),new Error("Error Invalid song");return"Genshin"===j&&"Sky"===(null===(n=e.data)||void 0===n?void 0:n.appName)&&(e=function(e){e.data.isComposedVersion&&(e.instruments=e.instruments.map((function(e){return"Lyre"})),e.columns.forEach((function(e){e[1]=e[1].map((function(e){return[le[e[0]],e[1]]}))})));e.data.isComposedVersion||(e.notes=e.notes.map((function(e){return e[0]=le[e[0]],e})));return e}(e)),e}var le=L;function ue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=Math.floor(6e4/e.bpm),a=new $(e.name,[]);a.bpm=e.bpm,a.pitch=e.pitch;var r=e.notes,s=[];if(1===t){for(var i=[],o=r[0][1];r.length>0;){for(var c=[r.shift()],l=0,u=0;u<r.length;u++)c[0][1]>r[u][1]-n/9&&l++;i.push([].concat(c,Object(p.a)(r.splice(0,l))))}var d=[];i.forEach((function(e){var t=e[0];if(t){var a=t[1]-o;o=t[1];var r=Math.floor((a-n)/n);r>-1&&new Array(r).fill(0).forEach((function(){return d.push(new de)}));var s=new de;s.notes=e.map((function(e){return new me(e[0],be(e[2]||0))})),d.push(s)}})),d.forEach((function(e){var t=fe(e);e.notes=t.map((function(e){return e[0].layer=pe(e),e[0]}))})),s=d}else for(var h=he(r,n/9),m=[n,Math.floor(n/2),Math.floor(n/4),Math.floor(n/8)],g=function(e){var n,a=new de;a.notes=h[e].map((function(e){var t=new me(e[0]);return 0===e[2]&&(t.layer="100"),1===e[2]&&(t.layer="100"),2===e[2]&&(t.layer="010"),3===e[2]&&(t.layer="110"),void 0===e[2]&&(t.layer="100"),t}));for(var r=(h[e+1]||[[0,0,0]])[0][1]-h[e][0][1],i=[];r>=m[3];)if(r/m[0]>=1)r-=m[0],i.push(0);else if(r/m[1]>=1){if(r-=m[1],t<=1)continue;i.push(1)}else if(r/m[2]>=1){if(r-=m[2],t<=2)continue;i.push(2)}else if(r/m[3]>=1){if(r-=m[3],t<=3)continue;i.push(3)}var o=[];a.tempoChanger=i.shift()||0,i=i.forEach((function(e,t){var n=new de;n.tempoChanger=e,o.push(n)})),(n=s).push.apply(n,[a].concat(o))},b=0;b<h.length;b++)g(b);return a.columns=s,a}var de=function e(){Object(o.a)(this,e),this.notes=[],this.tempoChanger=0};function he(e,t){for(var n=[];e.length>0;){for(var a=[e.shift()],r=0,s=0;s<e.length;s++)a[0][1]>e[s][1]-t&&r++;n.push([].concat(a,Object(p.a)(e.splice(0,r))))}return n}var me=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"000";Object(o.a)(this,e),this.index=t,this.layer=n};function ge(e){var t=I.indexOf(e);return t<0&&(t=0),Number(Math.pow(2,t/12).toFixed(4))}function be(e){var t="100";return 0===e&&(t="100"),1===e&&(t="010"),2===e&&(t="001"),t}function pe(e){var t="000".split("");return e.forEach((function(e){e.layer.split("").forEach((function(e,n){"1"===e&&(t[n]="1")}))})),t.join("")}function fe(e){var t=[];return e.notes.forEach((function(e){t[e.index]?t[e.index].push(e):t[e.index]=[e]})),t.filter((function(e){return Array.isArray(e)}))}function ve(e){return new Promise((function(t){Y.a(t,e)}))}n(99);var je=n(20),xe=n.n(je),ye={settingVesion:j+19,instrument:{name:"Instrument (Layer 1)",type:"instrument",songSetting:!1,value:A[0],volume:100,options:A},layer2:{name:"Instrument (Layer 2)",type:"instrument",songSetting:!1,value:A[0],volume:100,options:A},layer3:{name:"Instrument (Layer 3)",type:"instrument",songSetting:!1,value:A[0],volume:100,options:A},bpm:{name:"Bpm",type:"number",songSetting:!0,threshold:[0,1600],value:220},beatMarks:{name:"Beat marks",type:"select",songSetting:!1,value:3,options:[3,4]},noteNameType:{name:"Note name type",type:"select",songSetting:!1,value:"Genshin"===j?Object(je.isMobile)()?"Do Re Mi":"Keyboard layout":"Note name",options:"Genshin"===j?["Note name","Keyboard layout","Do Re Mi","ABC"]:["Note name","Keyboard layout","ABC"]},pitch:{name:"Pitch",type:"select",songSetting:!0,value:"C",options:["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"]},columnsPerCanvas:{name:"Number of visible columns",type:"select",songSetting:!1,value:35,options:[20,25,30,35,40,45,50]},caveMode:{name:"Reverb (cave mode)",type:"checkbox",songSetting:!1,value:!1},autosave:{name:"Autosave changes",type:"checkbox",songSetting:!1,value:!1},backgroundImage:{name:"Background image (url)",type:"text",songSetting:!1,value:"",placeholder:"Write here"},syncTabs:{name:"Autoplay in all tabs (pc only)",type:"checkbox",songSetting:!1,value:!1}},Oe={settingVesion:j+19,instrument:{name:"Instrument",type:"instrument",songSetting:!1,value:A[0],volume:100,options:A},pitch:{name:"Pitch",type:"select",songSetting:!0,value:"C",options:["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"]},caveMode:{name:"Reverb (cave mode)",type:"checkbox",songSetting:!1,value:!1},keyboardSize:{name:"Keyboard size",type:"number",songSetting:!1,value:100,threshold:[0,200]},noteNameType:{name:"Note name type",type:"select",songSetting:!1,value:"Genshin"===j?Object(je.isMobile)()?"Do Re Mi":"Keyboard layout":"Note name",options:"Genshin"===j?["Note name","Keyboard layout","Do Re Mi","ABC"]:["Note name","Keyboard layout","ABC"]},approachSpeed:{name:"Approach Rate (AR)",type:"number",songSetting:!1,value:1500,threshold:[0,5e3]},backgroundImage:{name:"Background image (url)",type:"text",songSetting:!1,value:"",placeholder:"Write here"},noteAnimation:{name:"Note animation",type:"checkbox",songSetting:!1,value:!1}},ke={settingVesion:j+4,enabled:!1,currentSource:"",notes:new Array("Genshin"===j?21:15).fill(0).map((function(e,t){return new ee(t,-1)})),shortcuts:[new te("toggle_play",-1),new te("next_column",-1),new te("previous_column",-1),new te("add_column",-1),new te("remove_column",-1),new te("change_layer",-1)]};function Se(){var e=localStorage.getItem(j+"_MIDI_Settings");try{e=JSON.parse(e)}catch(t){e=null}return null===e||e.settingVesion!==ke.settingVesion?ke:e}var we,Ce=Object(d.memo)((function(e){var t=e.children;return Object(F.jsx)(F.Fragment,{children:t})}),(function(e,t){return null!==t.children.key||null!==e.children.key?e.children.key===t.children.key:void 0!==e.children})),Ne=n(5),Ae=Object(d.memo)((function(e){var t=e.eventType,n=e.stop,a=e.restart,r=e.sliderState,s=e.handleSliderEvent,i=e.handleSpeedChanger,o=e.speedChanger,c=e.approachingScore;return Object(F.jsxs)("div",{className:"upper-right",children:["approaching"===t&&Object(F.jsx)(Ee,{data:c}),Object(F.jsxs)("div",{className:"slider-wrapper",children:[Object(F.jsx)("button",{className:"song-button",onClick:n,children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.x,{})})}),Object(F.jsx)("input",{type:"range",className:"slider",min:0,onChange:s,max:r.size,value:r.position}),Object(F.jsx)("button",{className:"song-button",onClick:a,children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.y,{})})}),Object(F.jsxs)("select",{className:"slider-select",onChange:i,value:o.name,children:[Object(F.jsx)("option",{disabled:!0,children:"Speed"}),P.map((function(e){return Object(F.jsx)("option",{value:e.name,children:e.name},e.name)}))]})]})]})}),(function(e,t){return e.eventType===t.eventType&&e.speedChanger===t.speedChanger&&e.approachingScore===t.approachingScore&&e.sliderState===t.sliderState}));function Ee(e){var t=e.data,n=t.combo,a=t.score,r=t.correct,s=t.wrong;return Object(F.jsx)("div",{className:"approaching-accuracy",children:Object(F.jsx)("table",{children:Object(F.jsxs)("tbody",{children:[Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{className:"sc-2",children:"Accuracy"}),Object(F.jsxs)("td",{className:"sc-1",children:[(r/(r+s-1)*100).toFixed(1),"%"]})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{className:"sc-2",children:"Score"}),Object(F.jsx)("td",{className:"sc-1",children:a})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{className:"sc-2",children:"Combo"}),Object(F.jsx)("td",{className:"sc-1",children:n})]})]})})})}var Me=null===(we=window)||void 0===we?void 0:we.gtag;function De(){return(De=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:return e.t0=e.sent,e.abrupt("return",{data:e.t0});case 7:return e.prev=7,e.t1=e.catch(0),Me&&console.log("Error with GA"),e.abrupt("return",{error:e.t1});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function Te(e,t){return function(e){return De.apply(this,arguments)}((function(){return Me("event",e,t)}))}var Pe={pageView:function(e){return Te("page_view",e)},event:Te,songEvent:function(e){return Te("song_event",e)},userSongs:function(e,t){return Te("songs_"+t,e)},songSearch:function(e){return Te("song_search",e)},UIEvent:function(e,t){return Te("UI_"+e,t)}},Ie=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;Object(o.a)(this,n),(a=t.call(this,e)).initMidi=function(e){e.onstatechange=function(){return a.initMidi(a.MidiAccess)},a.MidiAccess=e;for(var t=a.MidiAccess.inputs.values(),n=[],r=t.next();r&&!r.done;r=t.next())n.push(r.value);a.currentMidiSource&&(a.currentMidiSource.onmidimessage=null),a.currentMidiSource=n.find((function(e){return e.name+" "+e.manufacturer===a.MIDISettings.currentSource})),a.currentMidiSource&&(a.currentMidiSource.onmidimessage=a.handleMidi)},a.handleMidi=function(e){if(a.mounted){var t=a.props.data.keyboard,n=e.data,r=Object(f.a)(n,3),s=r[0],i=r[1],o=r[2];if(C===s&&0!==o){var c=a.MIDISettings.notes.filter((function(e){return e.midi===i}));c.forEach((function(e){a.handleClick(t.layout[e.index])}))}}},a.approachingSong=function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a.approachRate=a.props.data.approachRate||1500,s=a.approachRate,t.notes.forEach((function(e){var t={time:Math.floor(e[1]/a.state.speedChanger.value+s),index:e[0]};n.push(t)})),a.setState({approachingNotes:ae("Sky"===j?15:21),approachingScore:{correct:1,wrong:1,score:0,combo:0}}),a.changeSliderState(0,n.length),a.approachingNotesList=n;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.tick=function(){if(a.props.data.hasSong){var e=a.state,t=e.approachingNotes,n=e.sliderState,r=e.approachingScore,s=e.speedChanger,i=t,o=a.approachingNotesList;o.forEach((function(e){e.time-=a.tickTime}));for(var c=!1,l=0,u=0;u<o.length&&o[u].time<a.approachRate;u++)i[o[u].index].push({clicked:!1,time:a.approachRate,id:Math.floor(1e4*Math.random())}),o.splice(u,1),u--,c=!0;i.forEach((function(e){for(var t=0;t<e.length;t++){var n=e[t];n.time-=a.tickTime,n.clicked&&(n.time<a.approachRate/3?(r.correct++,r.combo++,r.score+=r.combo*s.value):(r.wrong++,r.combo=0),n.time=-1),n.time<0&&(n.clicked||(r.wrong++,r.combo=0),e.splice(t,1),t--,c=!0,l++)}})),c&&(a.changeSliderState(n.position+l),a.setState({approachingNotes:i.map((function(e){return e.slice()})),approachingScore:r}))}},a.playSong=function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s,i,o,c,l,u,d,h,m=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=m.length>1&&void 0!==m[1]?m[1]:0,a.songTimestamp=t.timestamp,s=a.state.keyboard,0!==(i=a.applySpeedChange(t.notes)).length){e.next=6;break}return e.abrupt("return");case 6:o=i[0][1],c=0,l=(new Date).getTime(),u=n;case 10:if(!(u<i.length)){e.next=29;break}if(d=i[u][1]-o,o=i[u][1],h=i[u][0],l=(new Date).getTime(),!(d>16)){e.next=18;break}return e.next=18,ve(d-c);case 18:if(a.mounted){e.next=20;break}return e.abrupt("return");case 20:if(a.songTimestamp===t.timestamp){e.next=22;break}return e.abrupt("return");case 22:s[h].status="clicked",a.handleClick(s[h]),a.setState({keyboard:s,sliderState:{position:u+1,size:i.length}}),c=(new Date).getTime()-l-d;case 26:u++,e.next=10;break;case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.applySpeedChange=function(e){return e.map((function(e){return e[1]=e[1]/a.state.speedChanger.value,e}))},a.practiceSong=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=a.state.keyboard,r=a.applySpeedChange(e.notes),s=r.length;r.splice(0,t);for(var i=[],o=0,c=0;r.length>0;c++){for(var l={notes:[r.shift()],delay:0},u=l.notes.length>0?l.notes[0][1]:0,d=0;d<r.length&&d<20;d++){var h=r[d][1]-l.notes[0][1]-50;h<0&&(l.notes.push(r.shift()),d--)}l.delay=o,o=r.length>0?r[0][1]-u:0,i.push(l)}if(0!==i.length){var m=i[0];a.nextChunkDelay=0;var g=i[1];m.notes.forEach((function(e){n[e[0]].status="toClick",n[e[0]].delay="Genshin"===j?100:200})),null===g||void 0===g||g.notes.forEach((function(e){var t=n[e[0]];if("toClick"===t.status)return t.status="toClickAndNext";t.status="toClickNext"})),a.props.functions.setHasSong(!0),a.setState({songToPractice:i,keyboard:n,sliderState:{position:t,size:s}})}},a.handleSpeedChanger=function(e){var t=P.find((function(t){return t.name===e.target.value}));a.setState({speedChanger:t},a.restartSong)},a.restartSong=function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.parse(JSON.stringify(J.data)),s=a.state.sliderState,e.next=4,a.stopSong();case 4:if(a.mounted){e.next=6;break}return e.abrupt("return");case 6:setTimeout((function(){var e=J.data.start;"practice"===J.data.eventType&&(e=s.position===s.size?0:s.position),J.data=Object(i.a)(Object(i.a)({},n),{},{start:Number.isInteger(t)?t:e})}),200);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.stopSong=function(){return new Promise((function(e){a.songTimestamp=0;var t=a.state.keyboard;t.forEach((function(e){e.status="",e.delay="Genshin"===j?100:200})),a.approachingNotesList=[],a.setState({keyboard:t,songToPractice:[],approachingNotes:ae("Sky"===j?15:21)},e),a.props.functions.setHasSong(!1)}))},a.stopAndClear=function(){a.stopSong(),J.data={song:{},eventType:"stop",start:0}},a.handleSliderEvent=function(e){a.changeSliderState(Number(e.target.value))},a.changeSliderState=function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=s.length>1&&void 0!==s[1]?s[1]:a.state.sliderState.size,a.setState({sliderState:{position:t,size:n}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleKeyboard=function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s,i,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state.keyboard,!t.repeat){e.next=3;break}return e.abrupt("return");case 3:if("INPUT"!==document.activeElement.tagName){e.next=5;break}return e.abrupt("return");case 5:if(!t.shiftKey){e.next=20;break}e.t0=t.code,e.next="KeyR"===e.t0?9:"KeyS"===e.t0?14:17;break;case 9:if(a.props.data.hasSong){e.next=11;break}return e.abrupt("return");case 11:if(!["practice","play","approaching"].includes(J.data.eventType)){e.next=13;break}return e.abrupt("return",a.restartSong(0));case 13:return e.abrupt("break",18);case 14:if(a.props.data.hasSong){e.next=16;break}return e.abrupt("return");case 16:return e.abrupt("return",a.stopAndClear());case 17:return e.abrupt("break",18);case 18:e.next=24;break;case 20:i=null===(s=t.code)||void 0===s?void 0:s.replace("Key",""),o=a.props.data.keyboard.getNoteFromCode(i),(c=n[o])&&a.handleClick(c);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleApproachClick=function(e){var t=a.state.approachingNotes[e.index][0];return t&&(t.clicked=!0,t.time<a.approachRate/3)?"approach-correct":"approach-wrong"},a.handlePracticeClick=function(e){var t=a.state,n=t.keyboard,r=t.songToPractice,s=t.sliderState;if(r.length>0){var i,o=null===(i=r[0])||void 0===i?void 0:i.notes.findIndex((function(t){return t[0]===e.index}));if(-1!==o){if(r[0].notes.splice(o,1),0===r[0].notes.length&&r.shift(),r.length>0){var c=r[0],l=r[1];c.notes.forEach((function(e){n[e[0]].status="toClick",n[e[0]].delay=c.delay})),l&&(null===l||void 0===l||l.notes.forEach((function(e){var t=n[e[0]];if("toClick"===t.status)return t.status="toClickAndNext";t.status="toClickNext"})))}a.setState({songToPractice:r,sliderState:{size:s.size,position:s.position+1}})}}},a.handleClick=function(e){var t=a.state,n=t.keyboard,r=t.outgoingAnimation,s=t.approachingScore,o=a.props.data.hasAnimation;n[e.index].status="clicked",n[e.index].delay="Genshin"===j?100:200,a.handlePracticeClick(e);var c=a.handleApproachClick(e);if("approaching"===J.data.eventType&&(n[e.index].status=c,"approach-wrong"===c&&(s.combo=0)),o&&"approaching"!==J.data.eventType){var l=Math.floor(1e4*Math.random())+(new Date).getTime();r[e.index]=[].concat(Object(p.a)(r[e.index]),[{key:l}])}a.setState(Object(i.a)(Object(i.a)({keyboard:n},"approaching"===J.data.eventType?s:{}),o?r:{}),(function(){o&&"approaching"!==J.data.eventType&&setTimeout((function(){var t=a.state.outgoingAnimation;t[e.index].shift(),t[e.index]=Object(p.a)(t[e.index]),a.setState({outgoingAnimation:t})}),750)})),setTimeout((function(){["clicked","approach-wrong","approach-correct"].includes(n[e.index].status)&&(n[e.index].status="",a.setState({keyboard:n}))}),"Sky"===j?200:100),a.props.functions.playSound(e)};var c=a.props.data.keyboard;return c.layout.forEach((function(e){e.status=""})),a.state={playTimestamp:(new Date).getTime(),songToPractice:[],approachingNotes:ae("Sky"===j?15:21),outgoingAnimation:ae("Sky"===j?15:21),keyboard:c.layout,sliderState:{position:0,size:0},approachingScore:{correct:1,wrong:1,score:0,combo:0},speedChanger:P.find((function(e){return"x1"===e.name}))},a.MIDISettings=Se(),a.approachRate=1500,a.approachingNotesList=[],a.songTimestamp=0,a.nextChunkDelay=0,a.disposeStore=function(){},a.tickTime=50,a.tickInterval=0,a.mounted=!0,a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("keydown",this.handleKeyboard),this.tickInterval=setInterval(this.tick,this.tickTime),this.disposeStore=Object(v.b)(J,function(){var t=Object(s.a)(r.a.mark((function t(n){var a,s,i,o,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=n.object.data,i=s.eventType,o=JSON.parse(JSON.stringify(s.song)),(null===(a=o.data)||void 0===a?void 0:a.isComposedVersion)&&(o=se(o)),o.timestamp=(new Date).getTime(),c=!1,"play"!==i){t.next=11;break}return t.next=9,e.stopSong();case 9:e.playSong(o,s.start),c=!0;case 11:if("practice"!==i){t.next=16;break}return t.next=14,e.stopSong();case 14:e.practiceSong(o,s.start),c=!0;case 16:if("approaching"!==i){t.next=21;break}return t.next=19,e.stopSong();case 19:e.approachingSong(o,s.start),c=!0;case 21:if("stop"!==i){t.next=24;break}return t.next=24,e.stopSong();case 24:if(e.mounted){t.next=26;break}return t.abrupt("return");case 26:e.props.functions.setHasSong(c),"stop"!==i&&Pe.songEvent({type:i});case 28:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.MIDISettings.enabled&&(navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(this.initMidi,(function(){new Q("Error","MIDI permission not accepted").trigger()})):new Q("Error","MIDI is not supported on this browser").trigger())}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyboard),this.disposeStore(),this.songTimestamp=0,this.mounted=!1,this.MidiAccess&&(this.MidiAccess.onstatechange=null),this.currentMidiSource&&(this.currentMidiSource.onmidimessage=null),clearInterval(this.tickInterval)}},{key:"render",value:function(){var e=this,t=this.state,n=this.props.data,a=t.keyboard,r=t.approachingScore,s=t.speedChanger,o=n.keyboardSize/100;o<.5&&(o=.5),o>1.5&&(o=1.5);var c="keyboard";return 15===a.length&&(c+=" keyboard-5"),8===a.length&&(c+=" keyboard-4"),Object(F.jsxs)(F.Fragment,{children:[n.hasSong&&Object(F.jsx)(Ae,{eventType:J.data.eventType,stop:this.stopAndClear,restart:this.restartSong,handleSliderEvent:this.handleSliderEvent,handleSpeedChanger:this.handleSpeedChanger,sliderState:t.sliderState,speedChanger:s,approachingScore:r}),Object(F.jsx)("div",{className:c,style:{transform:"scale(".concat(o,")"),marginBottom:30*o-15},children:n.isLoading?Object(F.jsx)("div",{className:"loading",children:"Loading..."}):a.map((function(r){var s=R[a.length][r.index],o=Object(i.a)(Object(i.a)({},r),{},{approachRate:e.approachRate,instrument:e.props.data.keyboard.instrumentName,isAnimated:"approaching"!==J.data.eventType&&e.props.data.hasAnimation});return Object(F.jsx)(H,{data:o,approachingNotes:t.approachingNotes[r.index],outgoingAnimation:t.outgoingAnimation[r.index],fadeTime:r.delay,handleClick:e.handleClick,noteText:ne(n.noteNameType,r.index,n.pitch,a.length),noteImage:"./assets/icons/keys/".concat(s,".svg")},r.index)}))})]})}}]),n}(d.Component);var Be=n(80),Le=n(31),Re=n(81),Ge=n(41),Ve=n.p+"static/media/mainpage.53c2a740.png",Fe=n.p+"static/media/composer.69d0b59e.png",Ue=n.p+"static/media/songs.4892a692.png";n(100);function He(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("div",{className:"help-title",children:"Main page"}),Object(F.jsxs)("div",{children:[Object(F.jsx)("img",{src:Ve,className:"help-img",alt:"tutorial for the main page"}),Object(F.jsxs)("ol",{children:[Object(F.jsx)("li",{children:"Record the keyboard as an audio file"}),Object(F.jsx)("li",{children:"Current note position, you can change it to reload"}),Object(F.jsx)("li",{children:"Playback speed"}),Object(F.jsx)("li",{children:"Approaching circles score"}),Object(F.jsx)("li",{children:"Approaching circle, click when it's close to the note"})]})]}),!xe()()&&Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("div",{className:"help-title",children:"Main page shortcuts"}),Object(F.jsxs)("div",{className:"help-margin-left",children:[Object(F.jsx)("div",{style:{marginBottom:"0.5rem"},children:"The main page has shortcuts for PC users:"}),Object(F.jsx)("table",{className:"keys-table",children:Object(F.jsxs)("tbody",{children:[Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"Shift + R"})}),Object(F.jsx)("td",{children:"reload song "})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"Shift + R"})}),Object(F.jsx)("td",{children:"Start/Stop recording when there are no songs playing"})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"Shift + M"})}),Object(F.jsx)("td",{children:"Open/Close the menu"})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"Esc"})}),Object(F.jsx)("td",{children:" Close the menu "})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"Shift + S"})}),Object(F.jsx)("td",{children:"stop song "})]})]})})]})]}),Object(F.jsx)("div",{className:"help-title",children:"Songs menu"}),Object(F.jsxs)("div",{children:[Object(F.jsx)("img",{src:Ue,className:"help-img",alt:"tutorial for songs page"}),Object(F.jsxs)("ol",{children:[Object(F.jsx)("li",{children:"Open composer to create a song"}),Object(F.jsx)("li",{children:"Import song (as json)"}),Object(F.jsx)("li",{children:"Play song (click the name)"}),Object(F.jsx)("li",{children:"Practice the song"}),Object(F.jsx)("li",{children:"Play with the approaching circles mode"}),Object(F.jsx)("li",{children:"Download the song (as json)"})]}),Object(F.jsxs)("div",{className:"column",children:[Object(F.jsxs)("div",{children:[Object(F.jsx)(Ne.f,{})," = practice the song"]}),Object(F.jsxs)("div",{children:[Object(F.jsx)(Le.a,{})," = Approaching circles mode"]}),Object(F.jsxs)("div",{children:[Object(F.jsx)(Ne.h,{})," = download the song"]})]})]}),Object(F.jsx)("div",{className:"help-title",children:"Composer"}),Object(F.jsxs)("div",{children:[Object(F.jsx)("img",{src:Fe,className:"help-img",alt:"tutorial for composer"}),Object(F.jsxs)("ol",{children:[Object(F.jsx)("li",{children:"Go to the next / previous breakpoint"}),Object(F.jsx)("li",{children:"Timeline of the breakpoints"}),Object(F.jsx)("li",{children:"Open the tools"}),Object(F.jsx)("li",{children:"Add 16 columns to the end"}),Object(F.jsx)("li",{children:"Remove the current selected column"}),Object(F.jsx)("li",{children:"Add column after the current one"}),Object(F.jsx)("li",{children:"Change layer (instrument)"}),Object(F.jsx)("li",{children:"Change column's duration"})]})]}),!xe()()&&Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("div",{className:"help-title",children:"Composer shortcuts"}),Object(F.jsxs)("div",{className:"help-margin-left",children:[Object(F.jsx)("div",{style:{marginBottom:"0.5rem"},children:"The composer has shortcuts for PC users:"}),Object(F.jsx)("table",{children:Object(F.jsxs)("tbody",{children:[Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"A / D"})}),Object(F.jsx)("td",{children:"move left / right"})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"1 / 2 / 3 / 4"})}),Object(F.jsx)("td",{children:"change tempo"})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"Space bar"})}),Object(F.jsx)("td",{children:"play / pause song"})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"Arrow Left"})}),Object(F.jsx)("td",{children:"go to previous breakpoint"})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"Arrow Right"})}),Object(F.jsx)("td",{children:"go to next breakpoint"})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"Arrow Up"})}),Object(F.jsx)("td",{children:"select previous layer"})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"Arrow Down"})}),Object(F.jsx)("td",{children:"select next layer "})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"Shift + Note"})}),Object(F.jsx)("td",{children:"Adds/remove a note in the column "})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"Q"})}),Object(F.jsx)("td",{children:"remove current column"})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)(We,{children:"E"})}),Object(F.jsx)("td",{children:"add column "})]})]})}),"When playing a song, you can press on the PC keyboard to add notes",Object(F.jsx)("div",{style:{marginBottom:"1rem"}})]})]})]})}function We(e){return Object(F.jsx)("div",{className:"keyboard-key",children:e.children})}var Ke=Object(d.memo)((function(e){var t=e.className,n=e.action,a=e.children,r=e.type;return Object(F.jsx)("div",{className:t?"menu-item ".concat(t):"menu-item",onClick:function(){return null===n||void 0===n?void 0:n(r)},children:a})}),(function(e,t){return null!==t.children.key||null!==e.children.key?e.children.key===t.children.key:void 0!==e.children&&e.className===t.className}));function ze(e){var t=e.visible===e.title?"menu-panel menu-panel-visible":"menu-panel";return Object(F.jsxs)("div",{className:t,children:[Object(F.jsx)("div",{className:"menu-title",children:e.title}),Object(F.jsx)("div",{className:"panel-content-wrapper",children:e.children})]})}function Je(e){return Object(F.jsx)("div",{onClick:function(){return e.action(!1)},className:"close-menu menu-item",children:Object(F.jsx)(Ne.z,{className:"icon"})})}n(101);function Ye(e){var t=e.checked,n=e.onChange;return Object(F.jsx)("div",{className:"switch-wrapper",onClick:function(){return n(!t)},children:Object(F.jsx)("div",{className:"switch-inner ".concat(t?"switch-inner-on":"")})})}var Ze=Object(d.memo)((function(e){var t=e.data,n=e.update,a=e.objKey,r=e.changeVolume,s=Object(d.useState)(t.value),o=Object(f.a)(s,2),c=o[0],l=o[1],u=Object(d.useState)(t.volume),h=Object(f.a)(u,2),m=h[0],g=h[1];function b(e){var r=e.target.value,s={key:a,data:Object(i.a)(Object(i.a)({},t),{},{value:r})};n(s)}return Object(d.useEffect)((function(){l(t.value)}),[t.value]),"settingVesion"===a?null:Object(F.jsxs)("div",{className:"settings-row",children:[Object(F.jsx)("div",{children:t.name}),"select"===t.type&&Object(F.jsx)("select",{value:t.value,onChange:b,children:t.options.map((function(e){return Object(F.jsx)("option",{value:e,children:e},e)}))}),["number","text"].includes(t.type)&&Object(F.jsx)("input",{type:t.type,value:c,placeholder:t.placeholder||"",onBlur:function(){if(t.value!==c){var e={key:a,data:Object(i.a)(Object(i.a)({},t),{},{value:c})};n(e)}},onChange:function(e){var n=e.target,a=n.value;"number"===t.type&&(a=Number(a),n.value="",a<t.threshold[0]||a>t.threshold[1])||l(a)}}),"checkbox"===t.type&&Object(F.jsx)(Ye,{checked:c,onChange:function(e){n({key:a,data:Object(i.a)(Object(i.a)({},t),{},{value:e})}),l(e)}}),"instrument"===t.type&&Object(F.jsxs)("div",{className:"instrument-picker",children:[Object(F.jsx)("select",{value:t.value,onChange:b,children:t.options.map((function(e){return Object(F.jsx)("option",{value:e,children:e},e)}))}),Object(F.jsx)("input",{type:"range",min:1,max:100,value:m,onChange:function(e){g(Number(e.target.value))},onPointerUp:function(){r({key:a,value:m})}})]})]})}),(function(e,t){return e.data.value===t.data.value&&e.data.volume===t.data.volume&&e.update===t.update}));function Xe(e){return Object(F.jsx)("div",{className:"donate-button",onClick:function(){return e.onClick("Donate")},children:"Donate"})}function Qe(e){var t=e.functions,n=e.data,a=e.songStore,i=t.importSong,o=Object(d.useState)(!1),c=Object(f.a)(o,2),l=c[0],u=c[1],h=Object(d.useState)(void 0),m=Object(f.a)(h,2),g=m[0],b=m[1],p=function(){var e=Object(s.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,!g){e.next=5;break}return e.abrupt("return",i(g));case 5:return u(!0),e.next=8,fetch("https://sky-music.herokuapp.com/api/songs?get="+encodeURI(n.file)).then((function(e){return e.json()}));case 8:t=e.sent,u(!1),t=ce(t),b(t),i(t),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(2),u(!1),console.error(e.t0),new Q("Error","Error downloading song").trigger();case 20:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(s.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,!g){e.next=5;break}return e.abrupt("return",a.data={eventType:"play",song:g,start:0});case 5:return u(!0),e.next=8,fetch("https://sky-music.herokuapp.com/api/songs?get="+encodeURI(n.file)).then((function(e){return e.json()}));case 8:t=e.sent,u(!1),t=ce(t),b(t),a.data={eventType:"play",song:t,start:0},e.next=20;break;case 15:e.prev=15,e.t0=e.catch(2),console.error(e.t0),u(!1),new Q("Error","Error downloading song").trigger();case 20:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(){return e.apply(this,arguments)}}();return Object(F.jsxs)("div",{className:"song-row",children:[Object(F.jsx)("div",{className:"song-name",onClick:function(){v(n)},children:n.name}),Object(F.jsx)("div",{className:"song-buttons-wrapper",children:Object(F.jsx)("button",{className:"song-button",onClick:p,children:l?Object(F.jsx)(Ne.u,{}):Object(F.jsx)(Ne.h,{})})})]})}n(102);var qe=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleKeyboard=function(e){var t,n=e.code;if("INPUT"!==document.activeElement.tagName)if(null===(t=document.activeElement)||void 0===t||t.blur(),e.shiftKey){if("KeyM"===n)a.setState({open:!a.state.open})}else if("Escape"===n)a.setState({open:!1})},a.checkPersistentStorage=Object(s.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!navigator.storage||!navigator.storage.persist){e.next=9;break}return e.next=3,navigator.storage.persisted();case 3:if(t=e.sent){e.next=8;break}return e.next=7,navigator.storage.persist();case 7:t=e.sent;case 8:a.setState({isPersistentStorage:t});case 9:case"end":return e.stop()}}),e)}))),a.handleSearchInput=function(e){a.setState({searchInput:e})},a.clearSearch=function(){a.setState({searchInput:"",searchedSongs:[],searchStatus:"Write a song name then search!"})},a.searchSongs=Object(s.a)(r.a.mark((function e(){var t,n,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state,n=t.searchInput,"Searching..."!==t.searchStatus){e.next=3;break}return e.abrupt("return");case 3:if(0!==n.trim().length){e.next=5;break}return e.abrupt("return",a.setState({searchStatus:"Please write a non empty name"}));case 5:return a.setState({searchStatus:"Searching..."}),e.next=8,fetch("https://sky-music.herokuapp.com/api/songs?search="+encodeURI(n)).then((function(e){return e.json()}));case 8:if(!(s=e.sent).error){e.next=12;break}return a.setState({searchStatus:"Please write a non empty name"}),e.abrupt("return",new Q("Error",s.error).trigger());case 12:a.setState({searchedSongs:s,searchStatus:"success"}),Pe.songSearch({name:n});case 14:case"end":return e.stop()}}),e)}))),a.toggleMenu=function(e){"boolean"!==typeof e&&(e=void 0);var t=void 0!==e?e:!a.state.open;a.setState({open:t})},a.selectSideMenu=function(e){if(e===a.state.selectedMenu&&a.state.open)return a.setState({open:!1});a.clearSearch(),a.setState({selectedMenu:e,open:!0}),Pe.UIEvent("menu",{tab:e})},a.changeSelectedSongType=function(e){a.setState({selectedSongType:e})},a.importSong=function(e){var t=new FileReader;t.addEventListener("load",function(){var t=Object(s.a)(r.a.mark((function t(n){var s,i,o,c,l,u,d;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,s=JSON.parse(n.target.result),Array.isArray(s)||(s=[s]),i=Object(Be.a)(s),t.prev=4,i.s();case 6:if((o=i.n()).done){t.next=14;break}return l=ce(l=o.value),t.next=11,a.props.functions.addSong(l);case 11:Pe.userSongs({name:null===(c=l)||void 0===c?void 0:c.name,page:"player"},"import");case 12:t.next=6;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(4),i.e(t.t0);case 19:return t.prev=19,i.f(),t.finish(19);case 22:t.next=30;break;case 24:if(t.prev=24,t.t1=t.catch(0),console.error(t.t1),!(null===e||void 0===e||null===(u=e.name)||void 0===u||null===(d=u.includes)||void 0===d?void 0:d.call(u,".mid"))){t.next=29;break}return t.abrupt("return",new Q("Error","Midi files should be imported in the composer").trigger());case 29:new Q("Error","Error importing song, invalid format").trigger();case 30:case"end":return t.stop()}}),t,null,[[0,24],[4,16,19,22]])})));return function(e){return t.apply(this,arguments)}}()),t.readAsText(e)},a.downloadSong=function(e){var t;e._id&&delete e._id;var n=e.name;"Sky"===j&&(e=oe(e)),Array.isArray(e)||(e=[e]),e.forEach((function(e){e.data.appName=j}));var a=JSON.stringify(e);(new q).download(a,"".concat(n,".").concat(j.toLowerCase(),"sheet.json")),new Q("Success","Song downloaded").trigger(),Pe.userSongs({name:null===(t=e)||void 0===t?void 0:t.name,page:"player"},"download")},a.downloadAllSongs=function(){var e=[];a.props.data.songs.forEach((function(t){t._id&&delete t._id,"Sky"===j&&(t=oe(t)),Array.isArray(t)?e.push.apply(e,Object(p.a)(t)):e.push(t)}));var t=new q,n=JSON.stringify(e),r=(new Date).toISOString().split("T")[0];t.download(n,"".concat(j,"_Backup_").concat(r,".json")),new Q("Success","Song backup downloaded").trigger()},a.state={open:!1,selectedMenu:"Songs",selectedSongType:"recorded",searchInput:"",searchedSongs:[],searchStatus:"Write a song name then search!",isPersistentStorage:!1},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.checkPersistentStorage(),window.addEventListener("keydown",this.handleKeyboard)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyboard)}},{key:"render",value:function(){var e=this,t=this.state.open?"side-menu menu-open":"side-menu",n=this.props,a=n.data,r=n.functions,s=r.handleSettingChange;r.toggleMenu=this.toggleMenu,r.downloadSong=this.downloadSong;var i=this.props.functions.changePage,o=a.songs.filter((function(e){return!e.data.isComposedVersion})),c=a.songs.filter((function(e){return e.data.isComposedVersion})),l=this.state,u=l.searchStatus,d=l.searchedSongs,h=l.selectedMenu,m={importSong:r.addSong};return Object(F.jsxs)("div",{className:"menu-wrapper",children:[Object(F.jsxs)("div",{className:"menu menu-visible menu-main-page",children:[this.state.open&&Object(F.jsx)(Je,{action:this.toggleMenu}),Object(F.jsx)(Ke,{type:"Help",action:this.selectSideMenu,className:"margin-top-auto",children:Object(F.jsx)(Ne.k,{className:"icon"})}),Object(F.jsx)(Ke,{type:"Library",action:this.selectSideMenu,children:Object(F.jsx)(Re.a,{className:"icon"})}),Object(F.jsx)(Ke,{type:"Songs",action:this.selectSideMenu,children:Object(F.jsx)(Ne.n,{className:"icon"})}),Object(F.jsx)(Ke,{type:"Settings",action:this.selectSideMenu,children:Object(F.jsx)(Ne.d,{className:"icon"})}),Object(F.jsx)(Ke,{type:"Home",action:function(){return i("home")},children:Object(F.jsx)(Ne.j,{className:"icon"})})]}),Object(F.jsxs)("div",{className:t,children:[Object(F.jsx)(ze,{title:"No selection",visible:h}),Object(F.jsxs)(ze,{title:"Songs",visible:h,children:[Object(F.jsxs)("div",{className:"songs-buttons-wrapper",children:[Object(F.jsx)("button",{className:"genshin-button",onClick:function(){return i("Composer")},children:"Compose song"}),Object(F.jsx)(Ge.FilePicker,{onChange:function(t){return e.importSong(t)},children:Object(F.jsx)("button",{className:"genshin-button",children:"Import song"})})]}),Object(F.jsxs)("div",{className:"tab-selector-wrapper",children:[Object(F.jsx)("button",{className:"recorded"===this.state.selectedSongType?"tab-selector tab-selected":"tab-selector",onClick:function(){return e.changeSelectedSongType("recorded")},children:"Recorded"}),Object(F.jsx)("button",{className:"composed"===this.state.selectedSongType?"tab-selector tab-selected":"tab-selector",onClick:function(){return e.changeSelectedSongType("composed")},children:"Composed"})]}),Object(F.jsx)("div",{className:"songs-wrapper",children:"recorded"===this.state.selectedSongType?o.map((function(e){return Object(F.jsx)(_e,{data:e,functions:r},e.name)})):c.map((function(e){return Object(F.jsx)(_e,{data:e,functions:r},e.name)}))}),Object(F.jsx)("div",{style:{marginTop:"auto",paddingTop:"0.5rem",width:"100%",display:"flex",justifyContent:"flex-end"},children:Object(F.jsx)("button",{className:"genshin-button",style:{marginLeft:"auto"},onClick:this.downloadAllSongs,children:"Download all songs (backup)"})})]}),Object(F.jsxs)(ze,{title:"Settings",visible:h,children:[Object.entries(a.settings).map((function(e){var t=Object(f.a)(e,2),n=t[0],a=t[1];return Object(F.jsx)(Ze,{objKey:n,data:a,changeVolume:r.changeVolume,update:s},n)})),N&&Object(F.jsx)("button",{className:"genshin-button",onClick:function(){return i("MidiSetup")},style:{marginTop:"0.4rem",width:"fit-content",marginLeft:"auto"},children:"Connect MIDI keyboard"}),Object(F.jsx)("div",{style:{marginTop:"0.4rem",marginBottom:"0.6rem"},children:this.state.isPersistentStorage?"Storage is persisted":"Storage is not persisted"}),!V()&&Object(F.jsx)(Xe,{onClick:i})]}),Object(F.jsxs)(ze,{title:"Library",visible:h,children:[Object(F.jsx)("div",{children:"Here you can find songs to learn, they are provided by the sky-music library."}),Object(F.jsxs)("div",{className:"library-search-row",children:[Object(F.jsx)("input",{className:"library-search-input",placeholder:"Song name",onKeyDown:function(t){"Enter"===t.code&&e.searchSongs()},onInput:function(t){return e.handleSearchInput(t.target.value)},value:this.state.searchInput}),Object(F.jsx)("button",{className:"library-search-btn",onClick:this.clearSearch,children:Object(F.jsx)(Ne.z,{})}),Object(F.jsx)("button",{className:"library-search-btn",onClick:this.searchSongs,children:Object(F.jsx)(Ne.t,{})})]}),Object(F.jsx)("div",{className:"library-search-songs-wrapper",children:"success"===u?d.length>0?d.map((function(e){return Object(F.jsx)(Qe,{data:e,functions:m,songStore:J,children:e.name},e.file)})):Object(F.jsx)("div",{className:"library-search-result-text",children:"No results"}):Object(F.jsx)("div",{className:"library-search-result-text",children:u})})]}),Object(F.jsxs)(ze,{title:"Help",visible:h,children:[Object(F.jsxs)("div",{className:"help-icon-wrapper",children:[Object(F.jsx)("a",{href:"https://discord.gg/Arsf65YYHq",children:Object(F.jsx)(Ne.g,{className:"help-icon"})}),Object(F.jsx)("a",{href:"https://github.com/Specy/genshin-music",children:Object(F.jsx)(Ne.i,{className:"help-icon"})})]}),Object(F.jsx)(He,{}),!V()&&Object(F.jsx)(Xe,{onClick:i})]})]})]})}}]),n}(d.Component);function _e(e){var t=e.data,n=e.functions.removeSong,a=e.functions.toggleMenu,r=e.functions.downloadSong;return Object(F.jsxs)("div",{className:"song-row",children:[Object(F.jsx)("div",{className:"song-name",onClick:function(){J.data={eventType:"play",song:t,start:0},a(!1)},children:t.name}),Object(F.jsxs)("div",{className:"song-buttons-wrapper",children:[Object(F.jsx)("button",{className:"song-button",onClick:function(){J.data={eventType:"practice",song:t,start:0},a(!1)},children:Object(F.jsx)(Ne.f,{})}),Object(F.jsx)("button",{className:"song-button",onClick:function(){J.data={eventType:"approaching",song:t,start:0},a(!1)},children:Object(F.jsx)(Le.a,{})}),Object(F.jsx)("button",{className:"song-button",onClick:function(){return r(t)},children:Object(F.jsx)(Ne.h,{})}),Object(F.jsx)("button",{className:"song-button",onClick:function(){return n(t.name)},children:Object(F.jsx)(Ne.B,{color:"#ed4557"})})]})]})}var $e=qe,et=n(82),tt=n.n(et),nt=function(){function e(){Object(o.a)(this,e),this.db=new tt.a.Db(j,{songs:[]}),this.collections={songs:this.db.collection("songs")}}return Object(c.a)(e,[{key:"getSongs",value:function(){var e=Object(s.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.collections.songs.find().toArray();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSongById",value:function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.collections.songs.findOne({_id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"existsSong",value:function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.collections.songs.findOne(t);case 2:return e.t0=e.sent,e.t1=void 0,e.abrupt("return",e.t0!==e.t1);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateSong",value:function(){var e=Object(s.a)(r.a.mark((function e(t,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.collections.songs.update(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addSong",value:function(e){return this.collections.songs.insert(e)}},{key:"removeSong",value:function(e){return this.collections.songs.remove(e)}}]),e}(),at=new nt,rt=function e(t){var n=this;Object(o.a)(this,e),this.getNoteFromCode=function(e){var t=n.keyboardLayout.findIndex((function(t){return t===String(e)}));return-1!==t?t:null},this.changeVolume=function(e){var t=Number((e/135).toFixed(2));e<5&&(t=0),n.volumeNode.gain.value=t},this.play=function(e,t){if(!n.deleted){var a=w.createBufferSource();a.buffer=n.buffers[e],a.connect(n.volumeNode),a.playbackRate.value=t,a.start(0),a.onended=function(){a.stop(),a.disconnect()}}},this.load=Object(s.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=w.createBuffer(2,w.sampleRate,w.sampleRate),a=n.layout.map((function(e){return new Promise((function(n){fetch(e.url).then((function(e){return e.arrayBuffer()})).then((function(e){w.decodeAudioData(e,n,(function(){n(t)})).catch((function(e){n(t)}))})).catch((function(e){n(t)}))}))})),e.next=4,Promise.all(a);case 4:return n.buffers=e.sent,n.loaded=!0,e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e)}))),this.disconnect=function(){n.volumeNode.disconnect()},this.connect=function(e){n.volumeNode.connect(e)},this.delete=function(){n.disconnect(),n.deleted=!0,n.buffers=null},this.instrumentName=void 0===t?A[0]:t,A.includes(this.instrumentName)||(this.instrumentName=A[0]),this.layout=[],this.buffers=[],this.loaded=!1,this.deleted=!1,this.volumeNode=w.createGain();var a=M[this.instrumentName];this.keyboardLayout=D[a.notes].keyboardLayout,this.mobileLayout=D[a.notes].mobileLayout,this.keyboardCodes=D[a.notes].keyboardCodes,this.keyboardLayout.forEach((function(e,t){var a={keyboard:e,mobile:n.mobileLayout[t]},r="./assets/audio/".concat(n.instrumentName,"/").concat(t,".mp3");n.layout.push(new st(t,a,r))})),this.volumeNode.gain.value=.8},st=function e(t,n,a){Object(o.a)(this,e),this.index=t,this.noteNames=n,this.url=a,this.buffer=new ArrayBuffer(8)},it=n(83),ot=n.n(it),ct=n(92),lt=function(){function e(){Object(o.a)(this,e),this.node=w.createMediaStreamDestination(),window.MediaRecorder?this.recorder=new MediaRecorder(this.node.stream):(console.log("Audio recorder Polyfill"),this.recorder=new ct.a(this.node.stream))}return Object(c.a)(e,[{key:"start",value:function(){this.recorder.start()}},{key:"stop",value:function(){var e=this;return new Promise((function(t){e.recorder.addEventListener("dataavailable",(function(e){t({data:e.data,toUrl:function(){return URL.createObjectURL(e.data)}})}),{once:!0}),e.recorder.stop()}))}},{key:"download",value:function(){var e=Object(s.a)(r.a.mark((function e(t,n){var a,s,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=document.createElement("a"),e.t0=ot.a,e.next=4,ut(t);case 4:e.t1=e.sent,s=(0,e.t0)(e.t1),i=new Blob([new DataView(s)],{type:"audio/wav"}),a.download=n,a.href=URL.createObjectURL(i),a.click();case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function ut(e){return new Promise((function(t){var n=new AudioContext,a=new FileReader;a.onloadend=function(){n.decodeAudioData(a.result,(function(e){t(e)}))},a.readAsArrayBuffer(e)}))}function dt(e){return ht.apply(this,arguments)}function ht(){return(ht=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),s=document.createElement("div"),i=document.createElement("button"),o=document.createElement("button"),c=document.createElement("input");n.className="prompt-overlay",c.type="text",a.className="floating-prompt",c.placeholder="Write here",c.className="prompt-input",i.className="prompt-button",o.className="prompt-button disabled",s.className="prompt-row",o.innerText="Ok",i.innerText="Cancel",r.innerText=t,s.append(i,o),a.append(r,c,s),n.append(a),document.body.appendChild(n);var l=!1;function u(){l||(""===c.value.trim()?o.classList.add("disabled"):o.classList.remove("disabled"))}function d(){l||(e(null),b())}function h(){if(!l&&""!==c.value.trim()){if("Untitled"===c.value.trim())return c.value="",new Q("Warning",'"Untitled" is a reserved word, use another').trigger();e(c.value.trim()),b()}}function m(e){var t=e.code;"Enter"===t&&h(),"Escape"===t&&d()}function g(e){var t;(null===e||void 0===e||null===(t=e.path)||void 0===t?void 0:t[0])===n&&d()}function b(){n.removeEventListener("click",g),o.removeEventListener("click",h),i.removeEventListener("click",d),window.removeEventListener("keydown",m),c.removeEventListener("input",u),l=!0,n.classList.add("prompt-overlay-hidden"),a.classList.add("floating-prompt-hidden"),setTimeout((function(){return bt(n)}),200)}c.focus(),n.addEventListener("click",g),i.addEventListener("click",d),o.addEventListener("click",h),window.addEventListener("keydown",m),c.addEventListener("input",u)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mt(e){return gt.apply(this,arguments)}function gt(){return gt=Object(s.a)(r.a.mark((function e(t){var n,a=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],e.abrupt("return",new Promise((function(e){var a=document.createElement("div"),r=document.createElement("div"),s=document.createElement("div"),i=document.createElement("div"),o=document.createElement("button"),c=document.createElement("button");a.className="prompt-overlay",r.className="floating-prompt",s.innerText=t,o.className="prompt-button",c.className="prompt-button",i.className="prompt-row",c.innerText="Yes",c.style.background="#628c83",o.style.background="#a9525a",o.innerText="No",i.append(o,c),r.append(s,i),a.append(r),document.body.appendChild(a);var l=!1;function u(){l||(e(!0),g())}function d(){l||(e(!1),g())}function h(e){var t=e.code;"Enter"===t&&u(),"Escape"===t&&n&&d()}function m(e){var t;(null===e||void 0===e||null===(t=e.path)||void 0===t?void 0:t[0])===a&&n&&d()}function g(){l=!0,o.removeEventListener("click",d),c.removeEventListener("click",u),window.removeEventListener("keydown",h),a.removeEventListener("click",m),a.classList.add("prompt-overlay-hidden"),r.classList.add("floating-prompt-hidden"),setTimeout((function(){return bt(a)}),200)}a.addEventListener("click",m),o.addEventListener("click",d),c.addEventListener("click",u),window.addEventListener("keydown",h),document.activeElement.blur()})));case 2:case"end":return e.stop()}}),e)}))),gt.apply(this,arguments)}function bt(e){e.querySelectorAll("*").forEach((function(e){return e.remove()})),e.remove()}n(184);var pt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;Object(o.a)(this,n),(a=t.call(this,e)).init=Object(s.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.settings,e.next=3,a.loadInstrument(t.instrument.value);case 3:return e.next=5,a.loadReverb();case 5:a.toggleReverbNodes(t.caveMode.value);case 6:case"end":return e.stop()}}),e)}))),a.handleKeyboard=function(){var e=Object(s.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state.thereIsSong,!t.repeat){e.next=3;break}return e.abrupt("return");case 3:if("INPUT"!==document.activeElement.tagName){e.next=5;break}return e.abrupt("return");case 5:if(!t.shiftKey){e.next=12;break}e.t0=t.code,e.next="KeyC"===e.t0?9:11;break;case 9:return n||(a.toggleRecord(),t.preventDefault()),e.abrupt("break",12);case 11:return e.abrupt("break",12);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.resetDrag=function(e){a.setState({isDragging:!1})},a.handleDragOver=function(e){e.preventDefault(),a.setState({isDragging:!0})},a.handleDrag=function(e){e.preventDefault(),a.setState({isDragging:!0})},a.setHasSong=function(e){a.setState({thereIsSong:e})},a.handleDrop=function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.resetDrag(),t.preventDefault(),e.next=4,Promise.all(Array.from(t.dataTransfer.files).map((function(e){return e.text()})));case 4:n=e.sent,s=0;case 6:if(!(s<n.length)){e.next=19;break}return e.prev=7,i=ce(JSON.parse(n[s])),e.next=11,a.addSong(i);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(7),console.error(e.t0);case 16:s++,e.next=6;break;case 19:case"end":return e.stop()}}),e,null,[[7,13]])})));return function(t){return e.apply(this,arguments)}}(),a.toggleReverbNodes=function(e){if(a.mounted){var t=a.state.instrument;if(e){if(!a.reverbNode)return console.log("Couldn't connect to reverb");t.disconnect(),t.connect(a.reverbNode)}else t.disconnect(),t.connect(a.audioContext.destination)}},a.changeVolume=function(e){var t=a.state.settings;"instrument"===e.key&&(t.instrument=Object(i.a)(Object(i.a)({},t.instrument),{},{volume:e.value}),a.state.instrument.changeVolume(e.value)),a.setState({settings:t},(function(){return a.updateSettings()}))},a.getSettings=function(){var e=localStorage.getItem(j+"_Main_Settings");try{e=JSON.parse(e)}catch(t){e=null}return null!==e?e.settingVesion!==Oe.settingVesion?(a.updateSettings(Oe),Oe):e:Oe},a.loadInstrument=function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=a.state.instrument)||void 0===n||null===(s=n.delete)||void 0===s||s.call(n),(i=new rt(t)).changeVolume(a.state.settings.instrument.volume||100),a.setState({isLoadingInstrument:!0}),e.next=6,i.load();case 6:if(a.mounted){e.next=8;break}return e.abrupt("return");case 8:i.connect(a.audioContext.destination),a.setState({instrument:i,isLoadingInstrument:!1},(function(){return a.toggleReverbNodes(a.state.settings.caveMode.value)}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.playSound=function(e){var t=Object(b.a)(a).state,n=t.settings;void 0!==e&&(t.isRecording&&a.handleRecording(e),a.state.instrument.play(e.index,ge(n.pitch.value)))},a.updateSettings=function(e){var t;t=void 0!==e?e:a.state.settings,localStorage.setItem(j+"_Main_Settings",JSON.stringify(t))},a.handleSettingChange=function(e){var t=a.state.settings,n=e.data;t[e.key]=Object(i.a)(Object(i.a)({},t[e.key]),{},{value:n.value}),"instrument"===e.key&&a.loadInstrument(n.value),"caveMode"===e.key&&a.toggleReverbNodes(n.value),a.setState({settings:t},a.updateSettings)},a.syncSongs=Object(s.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,at.getSongs();case 3:e.t1=e.sent,e.t2={songs:e.t1},e.t0.setState.call(e.t0,e.t2);case 6:case"end":return e.stop()}}),e)}))),a.songExists=function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,at.existsSong({name:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.addSong=function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.songExists(t.name);case 3:if(!e.sent){e.next=5;break}return e.abrupt("return",new Q("Warning","A song with this name already exists! \n"+t.name).trigger());case 5:return e.next=7,at.addSong(t);case 7:a.syncSongs(),new Q("Success","Song added to the ".concat(t.data.isComposedVersion?"Composed":"Recorded"," tab!"),4e3).trigger(),e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",new Q("Error","There was an error importing the song").trigger());case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),a.removeSong=function(){var e=Object(s.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt('Are you sure you want to delete the song: "'.concat(t,'" ?'));case 2:if(n=e.sent,a.mounted){e.next=5;break}return e.abrupt("return");case 5:if(!n){e.next=9;break}return e.next=8,at.removeSong({name:t});case 8:a.syncSongs();case 9:Pe.userSongs({name:t,page:"player"},"delete");case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleRecording=function(e){a.state.isRecording&&a.recording.addNote(e.index)},a.askForSongName=function(){return new Promise(function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="Write song name, press cancel to ignore";case 1:return e.next=4,dt(n);case 4:if(null!==(s=e.sent)){e.next=7;break}return e.abrupt("return",t(null));case 7:if(""===s){e.next=17;break}return e.next=10,a.songExists(s);case 10:if(!e.sent){e.next=14;break}n="This song already exists: "+s,e.next=15;break;case 14:return e.abrupt("return",t(s));case 15:e.next=18;break;case 17:n="Write song name, press cancel to ignore";case 18:e.next=1;break;case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},a.toggleRecord=function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("boolean"!==typeof t&&(t=void 0),(n=void 0!==t?t:!a.state.isRecording)||!(a.recording.notes.length>0)){e.next=13;break}return e.next=5,a.askForSongName();case 5:if(s=e.sent,a.mounted){e.next=8;break}return e.abrupt("return");case 8:(i=new X(s,a.recording.notes)).pitch=a.state.settings.pitch.value,null!==s&&(a.addSong(i),Pe.userSongs({name:s,page:"player"},"record")),e.next=14;break;case 13:a.recording=new Z;case 14:a.state.isRecording=n,a.setState({open:a.state.isRecording});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.toggleRecordAudio=function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s,i,o,c,l,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.mounted){e.next=2;break}return e.abrupt("return");case 2:if("boolean"!==typeof t&&(t=void 0),n=a.state.instrument,s=Object(b.a)(a),i=s.recorder,o=a.state.settings.caveMode.value,!(c=void 0!==t?t:!a.state.isRecordingAudio)){e.next=12;break}o?a.reverbVolumeNode.connect(i.node):n.connect(i.node),i.start(),e.next=24;break;case 12:return e.next=14,i.stop();case 14:return l=e.sent,e.next=17,dt("Write the song name, press cancel to ignore");case 17:if(u=e.sent,a.mounted){e.next=20;break}return e.abrupt("return");case 20:u&&i.download(l.data,u+".wav"),a.toggleReverbNodes(o),a.reverbVolumeNode.disconnect(),a.reverbVolumeNode.connect(w.destination);case 24:a.setState({isRecordingAudio:c});case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.recording=new Z;var c=a.getSettings();return a.state={instrument:new rt,isLoadingInstrument:!0,isRecording:!1,isRecordingAudio:!1,songs:[],settings:c,isDragging:!1,thereIsSong:!1},a.mounted=!1,a.reverbNode=void 0,a.reverbVolumeNode=void 0,a.audioContext=w,a.recorder=new lt,a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){document.body.addEventListener("dragenter",this.handleDrag),document.body.addEventListener("dragleave",this.resetDrag),document.body.addEventListener("dragover",this.handleDragOver),document.body.addEventListener("drop",this.handleDrop),window.addEventListener("keydown",this.handleKeyboard),this.mounted=!0,this.syncSongs(),this.init()}},{key:"componentWillUnmount",value:function(){document.body.removeEventListener("dragenter",this.handleDrag),document.body.removeEventListener("dragleave",this.resetDrag),document.body.removeEventListener("drop",this.handleDrop),document.body.removeEventListener("dragover",this.handleDragOver),window.removeEventListener("keydown",this.handleKeyboard),J.data={song:{},eventType:"stop",start:0},this.mounted=!1,this.audioContext=void 0,this.recorder=void 0,this.reverbNode=void 0,this.reverbVolumeNode=void 0,this.state.instrument.delete()}},{key:"componentDidCatch",value:function(){new Q("Warning","There was an error with the song! Restoring default...").trigger(),J.data={song:{},eventType:"stop",start:0}}},{key:"loadReverb",value:function(){var e=this;return new Promise((function(t){fetch("./assets/audio/reverb4.wav").then((function(e){return e.arrayBuffer()})).then((function(n){e.mounted&&e.audioContext.decodeAudioData(n,(function(n){if(e.mounted){var a=e.audioContext.createConvolver(),r=e.audioContext.createGain();r.gain.value=2.5,a.buffer=n,a.connect(r),r.connect(e.audioContext.destination),e.reverbVolumeNode=r,e.reverbNode=a,t()}}))})).catch((function(e){console.log("Error with reverb",e)}))}))}},{key:"render",value:function(){var e=this.state,t={changeSliderState:this.changeSliderState,playSound:this.playSound,setHasSong:this.setHasSong},n={isLoading:e.isLoadingInstrument,keyboard:e.instrument,pitch:e.settings.pitch.value,keyboardSize:e.settings.keyboardSize.value,noteNameType:e.settings.noteNameType.value,hasSong:e.thereIsSong,hasAnimation:e.settings.noteAnimation.value,approachRate:e.settings.approachSpeed.value},a={addSong:this.addSong,removeSong:this.removeSong,changePage:this.props.changePage,handleSettingChange:this.handleSettingChange,changeVolume:this.changeVolume},r={songs:e.songs,settings:e.settings};return Object(F.jsxs)("div",{className:"app bg-image",style:{backgroundImage:"url(".concat(e.settings.backgroundImage.value,")")},children:["approaching"!==J.data.eventType&&Object(F.jsx)("div",{className:"record-button",children:Object(F.jsx)(ft,{active:e.isRecordingAudio,click:this.toggleRecordAudio,children:e.isRecordingAudio?"Finish recording":"Record audio"})}),e.isDragging&&Object(F.jsx)("div",{className:"drag-n-drop",children:"Drop file here"}),Object(F.jsx)($e,{functions:a,data:r}),Object(F.jsxs)("div",{className:"right-panel",children:[Object(F.jsx)("div",{className:"upper-right",children:!this.state.thereIsSong&&Object(F.jsx)(ft,{active:e.isRecording,click:this.toggleRecord,style:{marginTop:"0.8rem"},children:e.isRecording?"Stop":"Record"})}),Object(F.jsx)("div",{className:"keyboard-wrapper",style:{marginBottom:"2vh"},children:Object(F.jsx)(Ie,{data:n,functions:t},e.instrument.instrumentName)})]})]})}}]),n}(d.Component);function ft(e){var t="genshin-button "+(e.active?"selected":"");return Object(F.jsx)("button",{className:t,onClick:e.click,style:Object(i.a)({},e.style||{}),children:e.children})}!function(){if(V())return console.log("inTWA");var e=document.referrer.includes("android-app://");sessionStorage.setItem("isTwa",e)}();var vt=pt,jt=n.p+"static/media/addCell.73b6c8e9.svg",xt=n.p+"static/media/removeCell.e266ba1a.svg",yt=n(84);var Ot=function(e,t){var n=Object(d.useState)(e),a=Object(f.a)(n,2),r=a[0],s=a[1];return Object(d.useEffect)((function(){var n=setTimeout((function(){s(e)}),t);return function(){clearTimeout(n)}}),[e,t]),r};function kt(e){var t=e.data,n=e.index,a=e.editTrack,r=Object(d.useState)(!1),s=Object(f.a)(r,2),i=s[0],o=s[1];return Object(F.jsxs)("div",{className:"midi-track-column",children:[Object(F.jsxs)("div",{className:"midi-track-wrapper",children:[Object(F.jsxs)("div",{className:"midi-track-center",children:[Object(F.jsx)("input",{type:"checkbox",onChange:function(){return a("index",{index:n})},checked:t.selected}),t.name," (",t.notes.length,")"]}),Object(F.jsxs)("div",{className:"midi-track-center",children:[Object(F.jsx)("div",{style:{textAlign:"center"},children:t.instrument.family}),Object(F.jsxs)("select",{onChange:function(e){return a("layer",{index:n,layer:Number(e.target.value)})},value:t.layer,className:"midi-select",children:[Object(F.jsx)("option",{value:"0",children:"Layer 1"}),Object(F.jsx)("option",{value:"1",children:"Layer 2"}),Object(F.jsx)("option",{value:"2",children:"Layer 3"})]}),Object(F.jsx)(Ne.l,{size:22,color:i?"rgb(207, 122, 130)":"white",onClick:function(){return o(!i)},cursor:"pointer"})]})]}),Object(F.jsxs)("div",{className:"midi-track-data",style:{display:i?"flex":"none"},children:[Object(F.jsxs)("div",{className:"midi-track-data-row",children:[Object(F.jsx)("div",{children:"Instrument:"}),Object(F.jsx)("div",{children:t.instrument.name})]}),Object(F.jsxs)("div",{className:"midi-track-data-row",children:[Object(F.jsx)("div",{children:"Number of notes:"}),Object(F.jsx)("div",{children:t.notes.length})]}),Object(F.jsxs)("div",{className:"midi-track-data-row",children:[Object(F.jsx)("div",{children:"Accidentals:"}),Object(F.jsx)("div",{children:t.numberOfAccidentals})]}),Object(F.jsxs)("div",{className:"midi-track-data-row",children:[Object(F.jsx)("div",{children:"Out of range:"}),Object(F.jsx)("div",{children:t.numberOfOutOfRange})]})]})]})}var St=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleFile=function(e){var t=new FileReader;t.addEventListener("load",(function(t){var n,r,s;try{s=new yt.Midi(t.target.result)}catch(c){console.error(c)}if(!s)return new Q("Error","There was an error importing this file",2e3).trigger();var i=null===(n=s.header.tempos[0])||void 0===n?void 0:n.bpm,o=null===(r=s.header.keySignatures[0])||void 0===r?void 0:r.key;s.tracks.forEach((function(e,t){e.selected=!0,e.layer=0,e.name=e.name||"Track n.".concat(t+1),e.numberOfAccidentals=0,e.numberOfOutOfRange=0})),a.setState({midi:s,fileName:e.name,bpm:Math.floor(4*i)||220,offset:0,pitch:I.includes(o)?o:"C"},(function(){null!==a.state.midi&&a.convertMidi()}))})),t.readAsArrayBuffer(e)},a.convertMidi=function(){var e=a.state,t=e.midi,n=e.bpm,r=e.offset,s=e.includeAccidentals,i=e.pitch,o=t.tracks.filter((function(e){return e.selected})),c=[],l=0,u=0,d=0;o.forEach((function(e){e.numberOfAccidentals=0,e.numberOfOutOfRange=0,e.notes.forEach((function(t){d++;var n=function(e){var t=null,n=!1;if("Sky"===j)switch(e){case 60:t=0;break;case 61:t=0,n=!0;break;case 62:t=1;break;case 63:t=1,n=!0;break;case 64:t=2;break;case 65:t=3;break;case 66:t=3,n=!0;break;case 67:t=4;break;case 68:t=4,n=!0;break;case 69:t=5;break;case 70:t=5,n=!0;break;case 71:t=6;break;case 72:t=7;break;case 73:t=7,n=!0;break;case 74:t=8;break;case 75:t=8,n=!0;break;case 76:t=9;break;case 77:t=10;break;case 78:t=10,n=!0;break;case 79:t=11;break;case 80:t=11,n=!0;break;case 81:t=12;break;case 82:t=12,n=!0;break;case 83:t=13;break;case 84:t=14;break;default:t=null}if("Genshin"===j)switch(e){case 48:t=14;break;case 49:t=14,n=!0;break;case 50:t=15;break;case 51:t=15,n=!0;break;case 52:t=16;break;case 53:t=17;break;case 54:t=17,n=!0;break;case 55:t=18;break;case 56:t=18,n=!0;break;case 57:t=19;break;case 58:t=19,n=!0;break;case 59:t=20;break;case 60:t=7;break;case 61:t=7,n=!0;break;case 62:t=8;break;case 63:t=8,n=!0;break;case 64:t=9;break;case 65:t=10;break;case 66:t=10,n=!0;break;case 67:t=11;break;case 68:t=11,n=!0;break;case 69:t=12;break;case 70:t=12,n=!0;break;case 71:t=13;break;case 72:t=0;break;case 73:t=0,n=!0;break;case 74:t=1;break;case 75:t=1,n=!0;break;case 76:t=2;break;case 77:t=3;break;case 78:t=3,n=!0;break;case 79:t=4;break;case 80:t=4,n=!0;break;case 81:t=5;break;case 82:t=5,n=!0;break;case 83:t=6;break;default:t=null}return{note:t,isAccidental:n}}(t.midi-r),a={time:Math.floor(1e3*t.time),note:n.note,layer:e.layer};n.isAccidental&&(l++,e.numberOfAccidentals++),null!==a.note?!s&&n.isAccidental||c.push(a):(u++,e.numberOfOutOfRange++)}))})),c=c.sort((function(e,t){return e.time-t.time}));for(var h=Math.floor(6e4/n),m=[];c.length>0;){for(var g=[c.shift()],b=0,f=0;f<c.length;f++)g[0].time>c[f].time-h/9&&b++;m.push([].concat(g,Object(p.a)(c.splice(0,b))))}var v=[],x=0;m.forEach((function(e){var t=e[0];if(t){var n=t.time-x;x=t.time;var a=Math.floor((n-h)/h);a>-1&&new Array(a).fill(0).forEach((function(){return v.push(new de)}));var r=new de;r.notes=e.map((function(e){return new me(e.note,be(e.layer))})),v.push(r)}})),v.forEach((function(e){var t=fe(e);e.notes=t.map((function(e){return e[0].layer=pe(e),e[0]}))}));var y=new $("Untitled");y.columns=v,y.bpm=n,y.instruments=a.props.data.instruments,y.pitch=i;var O=a.props.data.selectedColumn;if(y.selected=O<y.columns.length?O:0,0===y.columns.length)return new Q("Error","There are no notes",2e3).trigger();a.props.functions.loadSong(y),a.setState({accidentals:l,totalNotes:d,outOfRange:u})},a.editTrack=function(e,t){var n=a.state.midi.tracks;"index"===e&&(n[t.index].selected=!n[t.index].selected),"layer"===e&&(n[t.index].layer=t.layer),a.setState({midi:a.state.midi},(function(){null!==a.state.midi&&a.convertMidi()}))},a.changeOffset=function(e){e=parseInt(e),Number.isInteger(e)||(e=0),a.state.offset!==e&&a.setState({offset:e},(function(){null!==a.state.midi&&a.convertMidi()}))},a.changePitch=function(e){a.props.functions.changePitch(e),a.setState({pitch:e})},a.toggleAccidentals=function(){a.setState({includeAccidentals:!a.state.includeAccidentals},(function(){null!==a.state.midi&&a.convertMidi()}))},a.changeBpm=function(e){e=parseInt(e),Number.isInteger(e)||(e=0),a.state.bpm!==e&&a.setState({bpm:e},(function(){null!==a.state.midi&&a.convertMidi()}))},a.state={fileName:"",midi:null,bpm:220,offset:0,pitch:"C",accidentals:0,outOfRange:0,totalNotes:0,includeAccidentals:!0},a}return Object(c.a)(n,[{key:"render",value:function(){var e=this.handleFile,t=this.editTrack,n=this.state,a=this.changeBpm,r=this.changeOffset,s=this.changePitch,i=n.fileName,o=n.midi,c=n.bpm,l=n.offset,u=n.pitch,d=n.accidentals,h=n.outOfRange,m=n.totalNotes,g=n.includeAccidentals,b=this.props.functions.changeMidiVisibility;return Object(F.jsxs)("div",{className:"floating-midi",children:[Object(F.jsxs)("div",{className:"midi-row separator-border",style:{width:"100%"},children:[Object(F.jsx)(Ge.FilePicker,{onChange:e,children:Object(F.jsx)("button",{className:"midi-btn",children:"Click to load midi file"})}),Object(F.jsx)("div",{style:{margin:"0 0.5rem",maxWidth:"8rem",textOverflow:"ellipsis",overflow:"hidden"},children:i}),Object(F.jsx)("button",{className:"midi-btn",style:{marginLeft:"auto"},onClick:function(){return b(!1)},children:"Close"})]}),Object(F.jsx)("table",{className:"separator-border",style:{width:"100%"},children:Object(F.jsxs)("tbody",{children:[Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)("div",{style:{marginRight:"0.5rem"},children:"Bpm:"})}),Object(F.jsx)("td",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"},children:Object(F.jsx)(wt,{value:c,changeValue:a,delay:600,step:5})})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)("div",{style:{marginRight:"0.5rem"},children:"Scale notes by: "})}),Object(F.jsx)("td",{children:Object(F.jsx)(wt,{value:l,changeValue:r,delay:600,step:1})})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)("div",{style:{marginRight:"0.5rem"},children:"Pitch:"})}),Object(F.jsx)("td",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"},children:Object(F.jsxs)("select",{className:"midi-select",value:u,onChange:function(e){return s(e.target.value)},style:{backgroundColor:"#576377",width:"5rem"},children:[Object(F.jsx)("option",{value:"C",children:"C"}),Object(F.jsx)("option",{value:"Db",children:"Db"}),Object(F.jsx)("option",{value:"D",children:"D"}),Object(F.jsx)("option",{value:"Eb",children:"Eb"}),Object(F.jsx)("option",{value:"E",children:"E"}),Object(F.jsx)("option",{value:"F",children:"F"}),Object(F.jsx)("option",{value:"Gb",children:"Gb"}),Object(F.jsx)("option",{value:"G",children:"G"}),Object(F.jsx)("option",{value:"Ab",children:"Ab"}),Object(F.jsx)("option",{value:"A",children:"A"}),Object(F.jsx)("option",{value:"Bb",children:"Bb"}),Object(F.jsx)("option",{value:"B",children:"B"})]})})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:Object(F.jsx)("div",{style:{marginRight:"0.5rem"},children:"Include accidentals:"})}),Object(F.jsx)("td",{style:{display:"flex",justifyContent:"flex-end"},children:Object(F.jsx)("input",{type:"checkbox",checked:g,onChange:this.toggleAccidentals})})]})]})}),null!==o&&Object(F.jsx)("div",{className:"midi-column separator-border",style:{width:"100%"},children:Object(F.jsxs)("div",{className:"midi-column",style:{width:"100%"},children:[Object(F.jsx)("div",{children:"Select midi tracks"}),null===o||void 0===o?void 0:o.tracks.map((function(e,n){return Object(F.jsx)(kt,{data:e,index:n,editTrack:t},n)}))]})}),null!==o&&Object(F.jsx)("table",{children:Object(F.jsxs)("tbody",{children:[Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:"Total notes: "}),Object(F.jsx)("td",{}),Object(F.jsx)("td",{children:m})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:"Accidentals: "}),Object(F.jsx)("td",{}),Object(F.jsx)("td",{children:d})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:"Out of range: "}),Object(F.jsx)("td",{}),Object(F.jsx)("td",{children:h})]})]})})]})}}]),n}(d.Component);function wt(e){var t=e.changeValue,n=e.value,a=e.delay,r=void 0===a?500:a,s=e.step,i=void 0===s?1:s,o=Object(d.useState)(n),c=Object(f.a)(o,2),l=c[0],u=c[1],h=Ot(l,r);return Object(d.useEffect)((function(){t(h)}),[h]),Object(d.useEffect)((function(){u(n)}),[n]),Object(F.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[Object(F.jsx)("button",{onClick:function(){return u(l-i)},className:"midi-btn-small",children:"-"}),Object(F.jsx)("input",{type:"text",value:l,onChange:function(e){return u(e.target.value)},className:"midi-input",style:{margin:"0 0.3rem"}}),Object(F.jsx)("button",{onClick:function(){return u(l+i)},className:"midi-btn-small",children:"+"})]})}function Ct(e){var t=e.data,n=e.functions,a=n.toggleTools,r=n.copyColumns,s=n.eraseColumns,i=n.pasteColumns,o=n.deleteColumns,c=t.visible,l=t.copiedColumns;return Object(F.jsxs)("div",{className:c?"floating-tools tools-visible":"floating-tools",children:[Object(F.jsxs)("div",{className:"tools-row",children:[Object(F.jsx)("div",{children:"Scroll to the left / right to select the columns"}),Object(F.jsx)("button",{onClick:a,children:"Close"})]}),Object(F.jsxs)("div",{className:"tools-buttons-wrapper",children:[Object(F.jsxs)("div",{className:"tools-half",children:[Object(F.jsx)("button",{disabled:0!==l.length,onClick:function(e){e.currentTarget.blur(),r("all")},className:0!==l.length?"tools-button-highlighted":"",children:"Copy"}),Object(F.jsxs)("button",{disabled:0!==l.length,onClick:function(e){e.currentTarget.blur(),r(t.layer)},className:0!==l.length?"tools-button-highlighted":"",children:["Copy layer ",t.layer]})]}),Object(F.jsxs)("div",{className:"tools-half",children:[Object(F.jsx)("button",{disabled:0===l.length,onClick:function(e){e.currentTarget.blur(),i(!1)},children:"Paste"}),Object(F.jsx)("button",{disabled:0===l.length,onClick:function(e){e.currentTarget.blur(),i(!0)},children:"Insert"})]}),Object(F.jsxs)("div",{className:"tools-half",children:[Object(F.jsx)("button",{disabled:0!==l.length,onClick:function(e){e.currentTarget.blur(),s("all")},children:"Erase"}),Object(F.jsxs)("button",{disabled:0!==l.length,onClick:function(e){e.currentTarget.blur(),s(t.layer)},children:["Erase layer ",t.layer]})]}),Object(F.jsx)("button",{disabled:0!==l.length,onClick:o,children:"Delete"})]})]})}var Nt=Object(d.memo)((function(e){var t,n=e.data,a=e.layers,r=e.instrument,s=e.clickAction,i=e.noteText,o=e.noteImage,c=S.noteComposer;"1"===a[0]&&(c+=" layer-1"),"1"===a[1]&&(c+=" layer-2"),"1"===a[2]&&(c+=" layer-3");var l=(null===(t=M[r])||void 0===t?void 0:t.effects)||{};return Object(F.jsx)("button",{onPointerDown:function(){return s(n)},className:"button-hitbox",children:Object(F.jsxs)("div",{className:c,children:[Object(F.jsx)("img",{draggable:"false",alt:n.noteNames.mobile,src:o,style:l}),"Genshin"===j&&Object(F.jsx)(U,{className:"genshin-border"}),Object(F.jsx)("div",{className:"layer-3-ball-bigger"}),Object(F.jsx)("div",{className:"Sky"===j?"note-name-sky":"note-name",children:i})]})})}),(function(e,t){return e.noteText===t.noteText&&e.clickAction===t.clickAction&&e.noteImage===t.noteImage&&e.noteText===t.noteText&&e.layers===t.layers&&e.instrument===t.instrument})),At=Object(d.memo)((function(e){var t=e.options,n=e.selected,a=e.selectedColor,r=e.buttonsClass,s=e.onSelect;return Object(F.jsx)(F.Fragment,{children:t.map((function(e){return Object(F.jsx)("button",{style:{backgroundColor:e===n?a:""},className:r,onClick:function(){return s(e)},children:e},e)}))})}),(function(e,t){var n,a;return(null===(n=e.options)||void 0===n?void 0:n.length)===(null===(a=t.options)||void 0===a?void 0:a.length)&&e.selected===t.selected&&e.onSelect===t.onSelect}));function Et(e){var t=e.data,n=e.functions,a=t.currentColumn.notes.map((function(e){return e.index})),r=t.isPlaying?" hidden":"",s="keyboard";return 15===t.keyboard.layout.length&&(s+=" keyboard-5"),8===t.keyboard.layout.length&&(s+=" keyboard-4"),Object(F.jsxs)("div",{children:[Object(F.jsxs)("div",{className:s,children:[0===t.keyboard.layout.length?Object(F.jsx)("div",{className:"loading",children:"Loading..."}):null,t.keyboard.layout.map((function(e,r){var s=a.indexOf(r),i="",o="";try{o=R[t.keyboard.layout.length][e.index],i=ne(t.noteNameType,e.index,t.pitch,t.keyboard.layout.length)}catch(c){}return Object(F.jsx)(Nt,{layers:s>=0?t.currentColumn.notes[s].layer:"000",data:e,noteText:i,instrument:t.keyboard.instrumentName,noteImage:"./assets/icons/keys/".concat(o,".svg"),clickAction:n.handleClick},e.index)}))]}),Object(F.jsxs)("div",{className:"bottom-right-wrapper"+r,children:[Object(F.jsxs)("div",{className:"layer-buttons-wrapper",children:[Object(F.jsx)("div",{className:"bottom-right-text",children:"Layer"}),Object(F.jsx)(At,{buttonsClass:"layer-button",selectedColor:"#63aea7",options:k,onSelect:n.changeLayer,selected:t.layer})]}),Object(F.jsxs)("div",{className:"tempo-changers-wrapper",children:[Object(F.jsx)("div",{className:"bottom-right-text",children:"Tempo"}),t.TempoChangers.map((function(e){return Object(F.jsx)("button",{onClick:function(){return n.handleTempoChanger(e)},style:{backgroundColor:"#"+e.color.toString(16)},children:e.text},e.id)}))]})]})]})}var Mt=n(19),Dt=(n(201),G.noteData),Tt=G.horizontalLineBreak,Pt=G.standards,It=G.layersCombination,Bt=G.breakpoints,Lt=function e(t,n){var a=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;Object(o.a)(this,e),this.destroy=function(){},this.generate=function(){_.forEach((function(e){var t=Rt(e,a,1);a.cache.columns.push(t.toDataURL())})),Pt.forEach((function(e){var t=Rt(e,a,1);a.cache.standard.push(t.toDataURL())})),Pt.forEach((function(e){var t=Rt(e,a,3);a.cache.standardLarger.push(t.toDataURL())})),It.forEach((function(e){var t=a.noteWidth>20?4:2,n=document.createElement("canvas");n.height=a.noteHeight,n.width=a.noteWidth;var r=n.getContext("2d");if("1"===e[0]&&(r.fillStyle=Dt.background,Gt(r,a.margin/2,a.margin/2,Math.ceil(a.noteWidth-a.margin-1),Math.floor(a.noteHeight-a.margin-1),t,!0,!1)),"1"===e[1]&&(r.strokeStyle=Dt.border,r.lineWidth=2,Gt(r,a.margin/2,a.margin/2,Math.ceil(a.noteWidth-a.margin-1),Math.floor(a.noteHeight-a.margin-1),t,!1,!0)),"1"===e[2]){r.beginPath(),r.fillStyle=Dt.center;var s=a.noteHeight/4;r.arc(a.noteWidth/2-.5,a.noteHeight/2-.5,s,0,2*Math.PI),r.fill()}a.cache.notes[e]=n.toDataURL()})),_.forEach((function(e){var t=Rt(e,a,2);a.cache.columnsLarger.push(t.toDataURL())})),Bt.forEach((function(e){var t=document.createElement("canvas");if("short"===e.type){var n=a.timelineHeight/6;t.height=a.timelineHeight,t.width=2*n;var r=t.getContext("2d");r.fillStyle=e.color,r.arc(n,a.timelineHeight/2,n,0,2*Math.PI),r.fill(),a.cache.breakpoints.push(t.toDataURL())}else{t.height=a.height,t.width=a.width;var s=t.getContext("2d");s.fillStyle=e.color,s.beginPath(),s.moveTo(0,a.height),s.lineTo(a.noteWidth/2,a.height),s.lineTo(0,a.height-a.noteHeight),s.fill(),s.beginPath(),s.moveTo(a.width,a.height),s.lineTo(a.noteWidth/2,a.height),s.lineTo(a.width,a.height-a.noteHeight),s.fill(),s.beginPath(),s.moveTo(0,0),s.lineTo(a.noteWidth/2,0),s.lineTo(0,a.noteHeight),s.fill(),s.beginPath(),s.moveTo(a.width,0),s.lineTo(a.noteWidth/2,0),s.lineTo(a.width,a.noteHeight),s.fill(),a.cache.breakpoints.push(t.toDataURL())}}))},this.width=t,this.height=n,this.cache={columns:[],notes:{},standard:[],columnsLarger:[],standardLarger:[],breakpoints:[]},this.notesFigures=[],this.timelineHeight=s,this.margin=r,this.noteWidth=this.width,this.noteHeight=this.height/E,this.generate()};function Rt(e,t,n){var a=document.createElement("canvas");a.height=t.height,a.width=t.width;var r=a.getContext("2d");r.fillStyle="#"+e.color.toString(16),r.fillRect(0,0,t.width,t.height),r.strokeStyle=2===n?"black":"#333333",r.lineWidth=n,r.beginPath(),r.moveTo(t.width,0),r.lineTo(t.width,t.height),r.stroke(),r.strokeStyle="#333333";for(var s=1;s<3;s++){r.lineWidth=1;var i=t.noteHeight*Tt*s;r.moveTo(0,i),r.lineTo(t.width,i)}return r.stroke(),a}function Gt(e,t,n,a,r){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5,i=arguments.length>6?arguments[6]:void 0,o=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];if("number"===typeof s)s={tl:s,tr:s,br:s,bl:s};else{var c={tl:0,tr:0,br:0,bl:0};for(var l in c)s[l]=s[l]||c[l]}e.beginPath(),e.moveTo(t+s.tl,n),e.lineTo(t+a-s.tr,n),e.quadraticCurveTo(t+a,n,t+a,n+s.tr),e.lineTo(t+a,n+r-s.br),e.quadraticCurveTo(t+a,n+r,t+a-s.br,n+r),e.lineTo(t+s.bl,n+r),e.quadraticCurveTo(t,n+r,t,n+r-s.bl),e.lineTo(t,n+s.tl),e.quadraticCurveTo(t,n,t+s.tl,n),e.closePath(),i&&e.fill(),o&&e.stroke()}var Vt=35,Ft=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;Object(o.a)(this,n),(a=t.call(this,e)).resetPointerDown=function(e){a.stageSelected=!1,a.sliderSelected=!1,a.stagePreviousPositon=0},a.handleKeyboard=function(e){switch(e.code){case"ArrowRight":a.handleBreakpoints(1);break;case"ArrowLeft":a.handleBreakpoints(-1)}},a.handleWheel=function(e){a.props.functions.selectColumn(a.props.data.selected+Math.sign(e.deltaY),!0)},a.handleClick=function(e,t){var n=e.data.global.x,r=a.state.width,s=a.props.data;if("up"===t&&(a.sliderSelected=!1),"down"===t){a.sliderSelected=!0;var i=r/s.columns.length,o=i*(Vt+1),c=i*s.selected-Vt/2*i;a.onSlider=n>c&&n<c+o,a.sliderOffset=c+o/2-n,a.throttleScroll=Number.MAX_SAFE_INTEGER,a.handleSlide(e)}"downStage"===t&&(a.stagePreviousPositon=n,a.stageSelected=!0)},a.handleStageSlide=function(e){var t=e.data.global.x;if(!0===a.stageSelected){if(a.throttleScroll++<5)return;a.throttleScroll=0;var n=a.props,r=n.data,s=n.functions,i=Ht(Math.ceil(Math.abs(a.stagePreviousPositon-t)/8),0,4),o=a.stagePreviousPositon<t?-1:1;a.stagePreviousPositon=t;var c=r.selected+o*i;if(r.selected===c)return;s.selectColumn(Ht(c,0,r.columns.length-1),!0)}},a.handleBreakpoints=function(e){var t=a.props.data,n=t.selected,r=t.columns,s=t.breakpoints,i=1===e?s.filter((function(e){return e>n})).sort((function(e,t){return e-t})):s.filter((function(e){return e<n})).sort((function(e,t){return t-e}));0!==i.length&&r.length>=i[0]&&i[0]>=0&&a.props.functions.selectColumn(i[0])},a.handleSlide=function(e){var t=e.data.global.x;if(a.sliderSelected){if(a.throttleScroll++<4)return;var n=a.state,r=n.width,s=n.column,i=a.props.data;a.hasSlided=!0,a.throttleScroll=0;var o=s.width*i.columns.length,c=a.onSlider?t+a.sliderOffset:t,l=Math.floor(c/r*o/s.width);a.props.functions.selectColumn(l,!0)}};var r=document.body.getBoundingClientRect();a.sizes=r,Vt=Number(a.props.data.settings.columnsPerCanvas.value);var s,i=Wt(.84*r.width),c=Wt(.45*r.height);window.screen.width<r.height&&(i=Wt(.84*r.height),c=Wt(.45*r.width)),"Sky"===j&&(c=Wt(.95*c)),a.state={width:Math.floor(i),height:Math.floor(c),column:{width:(s=Wt(i),Wt(s/Vt)),height:c},timelineHeight:xe()()?25:30,currentBreakpoint:-1},a.canvasRef=h.a.createRef();var l=xe()()?1:4;return a.cache=new Lt(a.state.column.width,c,l,a.state.timelineHeight),a.stageSelected=!1,a.sliderSelected=!1,a.hasSlided=!1,a.stagePreviousPositon=0,a.sliderOffset=0,a.throttleScroll=0,a.onSlider=!1,a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("pointerup",this.resetPointerDown),window.addEventListener("keydown",this.handleKeyboard),this.canvasRef.current._canvas.addEventListener("wheel",this.handleWheel)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("pointerup",this.resetPointerDown),window.removeEventListener("keydown",this.handleKeyboard),this.canvasRef.current._canvas.removeEventListener("wheel",this.handleWheel),this.cache.destroy()}},{key:"render",value:function(){var e=this,t=this.state,n=t.width,a=t.timelineHeight,r=t.height,s=this.props,i=s.data,o=s.functions,c=this.cache.cache,l=this.state.column,u=(i.selected-Vt/2+1)*-l.width,d=Number(i.settings.beatMarks.value),h=0===d?11:4*d-1,m=n/i.columns.length,g=!1,b=0,p=Math.floor(m*(Vt+1));p>n&&(p=n);var f=m*i.selected-(Vt/2-1)*m;return Object(F.jsxs)("div",{className:"canvas-wrapper",style:{width:n+2},children:[Object(F.jsx)(Mt.Stage,{width:n,height:r,raf:!1,renderOnComponentChange:!0,options:{backgroundColor:4805734},ref:this.canvasRef,children:Object(F.jsx)(Mt.Container,{anchor:[.5,.5],x:u,interactive:!0,pointerdown:function(t){return e.handleClick(t,"downStage")},pointermove:function(t){return e.handleStageSlide(t)},children:i.columns.map((function(e,t){if(b++>h&&(g=!g,b=0),!function(e,t){var n=Vt/2+2,a=[t-n,t+n];return a[0]<e&&e<a[1]}(t,i.selected))return null;var n=(t+1)%4===0?c.columnsLarger:c.columns,a=(t+1)%4===0?c.standardLarger:c.standard,r=0===e.tempoChanger?a[Number(g)]:n[e.tempoChanger];return Object(F.jsx)(Ut,{cache:c,data:e,index:t,sizes:l,backgroundCache:r,isToolsSelected:i.toolsColumns.includes(t),click:o.selectColumn,isSelected:t===i.selected,isBreakpoint:i.breakpoints.includes(t)},t)}))})},this.state.width),Object(F.jsxs)("div",{className:"timeline-wrapper",style:{height:this.state.timelineHeight},children:[Object(F.jsx)("div",{className:"timeline-button",onClick:function(){return e.handleBreakpoints(-1)},children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.v,{})})}),Object(F.jsx)("div",{className:"timeline-button",onClick:function(){return e.handleBreakpoints(1)},style:{marginLeft:0},children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.w,{})})}),Object(F.jsx)("div",{className:"timeline-scroll",children:Object(F.jsxs)(Mt.Stage,{width:n,height:a,options:{antialias:!0,autoDensity:!0,backgroundColor:5332079},raf:!1,renderOnComponentChange:!0,children:[Object(F.jsxs)(Mt.Container,{width:n,height:a,interactive:!0,pointerdown:function(t){return e.handleClick(t,"down")},pointerup:function(t){return e.handleClick(t,"up")},pointermove:this.handleSlide,children:[Object(F.jsx)(Mt.Graphics,{draw:function(e){!function(e,t,n){e.clear(),e.beginFill(5332079,1),e.drawRect(0,0,t,n)}(e,n,a)}}),i.breakpoints.map((function(e){return Object(F.jsx)(Mt.Sprite,{image:c.breakpoints[0],x:m*e},e)}))]}),Object(F.jsx)(Mt.Graphics,{draw:function(e){return function(e,t,n){e.clear(),e.lineStyle(3,1742475,.8),e.drawRoundedRect(0,0,t-2,n-4,6)}(e,p,a)},x:f,y:2})]})}),Object(F.jsx)("div",{className:"timeline-button",onClick:o.toggleBreakpoint,children:Object(F.jsx)(Ce,{children:i.breakpoints.includes(i.selected)?Object(F.jsx)(Ne.m,{},"minus"):Object(F.jsx)(Ne.r,{},"plus")})})]})]})}}]),n}(d.Component);function Ut(e){var t=e.data,n=e.index,a=e.sizes,r=e.click,s=e.cache,i=e.backgroundCache,o=e.isBreakpoint,c=e.isSelected,l=e.isToolsSelected;return Object(F.jsxs)(Mt.Container,{pointertap:function(){return r(n)},interactive:!0,x:a.width*n,children:[Object(F.jsxs)(Mt.Sprite,{image:i,interactiveChildren:!1,children:[c||l?Object(F.jsx)(Mt.Sprite,{image:l&&!c?s.standard[3]:s.standard[2],alpha:l?.4:.6,zIndex:1}):null,o?Object(F.jsx)(Mt.Sprite,{image:s.breakpoints[1]}):null]}),t.notes.map((function(e){return Object(F.jsx)(Mt.Sprite,{image:s.notes[e.layer],y:B[e.index]*a.height/E},e.index)}))]})}var Ht=function(e,t,n){return Math.min(Math.max(e,t),n)};function Wt(e){return 2*Math.round(e/2)}function Kt(e){var t=e.data,n=e.functions,a=n.removeSong,r=n.toggleMenu,s=n.loadSong,i=n.downloadSong;return Object(F.jsxs)("div",{className:"song-row",children:[Object(F.jsx)("div",{className:"song-name",onClick:function(){s(t),r(!1)},children:t.name}),Object(F.jsxs)("div",{className:"song-buttons-wrapper",children:[Object(F.jsx)("button",{className:"song-button",onClick:function(){return i(t)},children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.h,{})})}),Object(F.jsx)("button",{className:"song-button",onClick:function(){return a(t.name)},children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.B,{color:"#ed4557"})})})]})]})}var zt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleKeyboard=function(e){var t,n=e.code;if("INPUT"!==document.activeElement.tagName&&(null===(t=document.activeElement)||void 0===t||t.blur(),"Escape"===n))a.state.open&&a.props.functions.toggleMenuVisible(),a.setState({open:!1})},a.toggleMenu=function(e){"boolean"!==typeof e&&(e=void 0);var t=void 0!==e?e:!a.state.open;a.setState({open:t}),!1===t&&a.props.functions.toggleMenuVisible()},a.changeSelectedSongType=function(e){a.setState({selectedSongType:e})},a.selectSideMenu=function(e){if(e===a.state.selectedMenu&&a.state.open)return a.setState({open:!1});a.setState({selectedMenu:e,open:!0}),Pe.UIEvent("menu",{tab:e})},a.downloadSong=function(e){var t;e._id&&delete e._id,e.data.isComposedVersion&&(e=ie(e));var n=e.name;"Sky"===j&&(e=oe(e)),Array.isArray(e)||(e=[e]),e.forEach((function(e){e.data.appName=j}));var a=JSON.stringify(e);(new q).download(a,"".concat(n,".").concat(j.toLowerCase(),"sheet.json")),new Q("Success","Song downloaded").trigger(),Pe.userSongs({name:null===(t=e)||void 0===t?void 0:t.name,page:"composer"},"download")},a.updateSong=function(){a.props.functions.updateSong(a.props.data.currentSong)},a.state={open:!1,selectedMenu:"Settings",selectedSongType:"composed"},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.handleKeyboard)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyboard)}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,a=t.functions,r=this.state.open?"side-menu menu-open":"side-menu",s=this.state.selectedMenu,i=a.loadSong,o=a.removeSong,c=a.changePage,l=a.handleSettingChange,u=a.changeVolume,d=a.createNewSong,h=a.changeMidiVisibility,m={loadSong:i,removeSong:o,toggleMenu:this.toggleMenu,downloadSong:this.downloadSong},g=n.songs.filter((function(e){var t;return!(null===(t=e.data)||void 0===t?void 0:t.isComposedVersion)})),b=n.songs.filter((function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.isComposedVersion})),p=n.hasChanges?"margin-top-auto not-saved":"margin-top-auto",v=n.menuOpen?"menu menu-visible":"menu";return Object(F.jsxs)("div",{className:"menu-wrapper",children:[Object(F.jsxs)("div",{className:v,children:[Object(F.jsx)(Je,{action:this.toggleMenu}),Object(F.jsx)(Ke,{type:"Save",action:this.updateSong,className:p,children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.s,{className:"icon"})})}),Object(F.jsx)(Ke,{type:"Songs",action:this.selectSideMenu,children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.n,{className:"icon"})})}),Object(F.jsx)(Ke,{type:"Settings",action:this.selectSideMenu,children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.d,{className:"icon"})})}),Object(F.jsx)(Ke,{type:"Home",action:function(){return c("home")},children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.j,{className:"icon"})})})]}),Object(F.jsxs)("div",{className:r,children:[Object(F.jsx)(ze,{title:"No selection",visible:s}),Object(F.jsxs)(ze,{title:"Songs",visible:s,children:[Object(F.jsxs)("div",{className:"songs-buttons-wrapper",children:[Object(F.jsx)("button",{className:"genshin-button",onClick:function(){h(!0),e.toggleMenu()},children:"Create from MIDI"}),Object(F.jsx)("button",{className:"genshin-button",onClick:d,children:"Create new song"})]}),Object(F.jsxs)("div",{className:"tab-selector-wrapper",children:[Object(F.jsx)("button",{className:"recorded"===this.state.selectedSongType?"tab-selector tab-selected":"tab-selector",onClick:function(){return e.changeSelectedSongType("recorded")},children:"Recorded"}),Object(F.jsx)("button",{className:"composed"===this.state.selectedSongType?"tab-selector tab-selected":"tab-selector",onClick:function(){return e.changeSelectedSongType("composed")},children:"Composed"})]}),Object(F.jsx)("div",{className:"songs-wrapper",style:{marginBottom:"0.5rem"},children:"recorded"===this.state.selectedSongType?g.map((function(e){return Object(F.jsx)(Kt,{data:e,functions:m},e.name)})):b.map((function(e){return Object(F.jsx)(Kt,{data:e,functions:m},e.name)}))}),Object(F.jsx)("div",{className:"songs-buttons-wrapper",style:{marginTop:"auto"},children:Object(F.jsx)("button",{className:"genshin-button record-btn ".concat(n.isRecordingAudio?"selected":""),onClick:function(){return a.startRecordingAudio(!n.isRecordingAudio)},children:n.isRecordingAudio?"Stop recording audio":"Start recording audio"})})]}),Object(F.jsxs)(ze,{title:"Settings",visible:s,children:[Object.entries(n.settings).map((function(e){var t=Object(f.a)(e,2),n=t[0],a=t[1];return Object(F.jsx)(Ze,{objKey:n,data:a,changeVolume:u,update:l},n)})),N&&Object(F.jsx)("button",{className:"genshin-button",onClick:function(){return c("MidiSetup")},style:{width:"fit-content",margin:"0.4rem 0 0.7rem auto"},children:"Connect MIDI keyboard"}),!V()&&Object(F.jsx)(Xe,{onClick:c})]})]})]})}}]),n}(d.Component),Jt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;Object(o.a)(this,n),(a=t.call(this,e)).init=Object(s.a)(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.syncSongs(),t=a.state.settings,n=[a.loadInstrument(t.instrument.value,1),a.loadInstrument(t.layer2.value,2),a.loadInstrument(t.layer3.value,3)],!a.mounted){e.next=6;break}return e.next=6,Promise.all(n);case 6:if(!a.mounted){e.next=9;break}return e.next=9,a.loadReverb();case 9:a.mounted&&a.setupAudioDestination(t.caveMode.value),a.MIDISettings.enabled&&(navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(a.initMidi,(function(){new Q("Error","MIDI permission not accepted").trigger()})):new Q("Error","MIDI is not supported on this browser").trigger());case 11:case"end":return e.stop()}}),e)}))),a.handleAutoSave=function(){a.changes++,a.changes>5&&a.state.settings.autosave.value&&"Untitled"!==a.state.song.name&&a.updateSong(a.state.song)},a.initMidi=function(e){e.onstatechange=function(){return a.initMidi(a.MidiAccess)},a.MidiAccess=e;for(var t=a.MidiAccess.inputs.values(),n=[],r=t.next();r&&!r.done;r=t.next())n.push(r.value);a.currentMidiSource&&(a.currentMidiSource.onmidimessage=null),a.currentMidiSource=n.find((function(e){return e.name+" "+e.manufacturer===a.MIDISettings.currentSource})),a.currentMidiSource&&(a.currentMidiSource.onmidimessage=a.handleMidi)},a.handleMidi=function(e){if(a.mounted){var t=a.state,n=t.instrument,r=t.song,s=t.layer,i=e.data,o=Object(f.a)(i,3),c=o[0],l=o[1],u=o[2];if(C===c&&0!==u){var d=a.MIDISettings.notes.filter((function(e){return e.midi===l}));d.forEach((function(e){a.handleClick(n.layout[e.index])}));var h=a.MIDISettings.shortcuts.find((function(e){return e.midi===l}));if(!h)return;switch(h.type){case"toggle_play":a.togglePlay();break;case"next_column":a.selectColumn(r.selected+1);break;case"previous_column":a.selectColumn(r.selected-1);break;case"add_column":a.addColumns(1,r.selected);break;case"remove_column":a.removeColumns(1,r.selected);break;case"change_layer":var m=s+1;m>k.length&&(m=1),a.changeLayer(m)}}}},a.getSettings=function(){var e=localStorage.getItem(j+"_Composer_Settings");try{e=JSON.parse(e)}catch(t){e=null}return null!==e?e.settingVesion!==ye.settingVesion?(a.updateSettings(ye),ye):e:ye},a.updateSettings=function(e){var t;t=void 0!==e?e:a.state.settings,localStorage.setItem(j+"_Composer_Settings",JSON.stringify(t))},a.handleSettingChange=function(e){var t=Object(b.a)(a).state,n=t.settings,r=e.data;n[e.key]=Object(i.a)(Object(i.a)({},n[e.key]),{},{value:r.value}),r.songSetting&&(t.song[e.key]=r.value),"instrument"===e.key&&a.loadInstrument(r.value,1),"layer2"===e.key&&a.loadInstrument(r.value,2),"layer3"===e.key&&a.loadInstrument(r.value,3),"caveMode"===e.key&&a.setupAudioDestination(r.value),a.setState({settings:n,song:a.state.song},(function(){a.updateSettings()}))},a.loadInstrument=function(){var e=Object(s.a)(r.a.mark((function e(t,n){var s,i,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.mounted){e.next=2;break}return e.abrupt("return");case 2:if(s=a.state.settings,1!==n){e.next=14;break}return a.state.instrument.delete(),i=new rt(t),e.next=8,i.load();case 8:if(a.mounted){e.next=10;break}return e.abrupt("return");case 10:i.changeVolume(s.instrument.volume),a.setState({instrument:i}),e.next=24;break;case 14:return c=new rt(t),(l=a.state.layers)[n-2].delete(),l[n-2]=c,e.next=20,c.load();case 20:if(a.mounted){e.next=22;break}return e.abrupt("return");case 22:c.changeVolume(null===(o=s["layer".concat(n)])||void 0===o?void 0:o.volume),a.setState({layers:l});case 24:a.setupAudioDestination(s.caveMode.value);case 25:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),a.changeVolume=function(e){var t=a.state.settings;"instrument"===e.key&&(t.instrument=Object(i.a)(Object(i.a)({},t.instrument),{},{volume:e.value}),a.state.instrument.changeVolume(e.value)),"layer2"===e.key&&(t.layer2=Object(i.a)(Object(i.a)({},t.layer2),{},{volume:e.value}),a.state.layers[0].changeVolume(e.value)),"layer3"===e.key&&(t.layer3=Object(i.a)(Object(i.a)({},t.layer3),{},{volume:e.value}),a.state.layers[1].changeVolume(e.value)),a.setState({settings:t},(function(){return a.updateSettings()}))},a.setupAudioDestination=function(e){if(a.mounted){var t=a.state,n=t.instrument,r=t.layers;[n,r[0],r[1]].forEach((function(t){if(e){if(!a.reverbNode)return console.log("Couldn't connect to reverb");t.disconnect(),t.connect(a.reverbNode)}else t.disconnect(),t.connect(a.audioContext.destination)}))}},a.startRecordingAudio=function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s,i,o,c,l,u,d,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.mounted){e.next=2;break}return e.abrupt("return");case 2:if(t){e.next=5;break}return a.setState({isRecordingAudio:!1}),e.abrupt("return",a.togglePlay(!1));case 5:return n=a.state,s=n.instrument,i=n.layers,o=[s,i[0],i[1]],c=a.state.settings.caveMode.value,l=Object(b.a)(a),u=l.recorder,c?a.reverbVolumeNode.connect(u.node):o.forEach((function(e){e.connect(u.node)})),u.start(),a.setState({isRecordingAudio:!0}),e.next=14,a.togglePlay(!0);case 14:if(a.mounted){e.next=16;break}return e.abrupt("return");case 16:return e.next=18,u.stop();case 18:return d=e.sent,a.setState({isRecordingAudio:!1}),e.next=22,dt("Write the song name, press cancel to ignore");case 22:if((h=e.sent)&&u.download(d.data,h+".wav"),a.mounted){e.next=26;break}return e.abrupt("return");case 26:a.reverbVolumeNode.disconnect(),a.reverbVolumeNode.connect(w.destination),a.setupAudioDestination(c);case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleKeyboard=function(e){if("INPUT"!==document.activeElement.tagName){var t=a.state,n=t.instrument,r=t.layer,s=t.layers,i=t.isPlaying,o=t.song,c=e.code;if(i||e.shiftKey){var l=null===c||void 0===c?void 0:c.replace("Key",""),u=n.getNoteFromCode(l);switch(null!==u&&a.handleClick(n.layout[u]),c){case"Space":var d,h;if(a.togglePlay(),!a.state.settings.syncTabs.value)break;null===(d=a.broadcastChannel)||void 0===d||null===(h=d.postMessage)||void 0===h||h.call(d,"stop")}}else switch(c){case"KeyD":a.selectColumn(a.state.song.selected+1);break;case"KeyA":a.selectColumn(a.state.song.selected-1);break;case"Digit1":a.handleTempoChanger(_[0]);break;case"Digit2":a.handleTempoChanger(_[1]);break;case"Digit3":a.handleTempoChanger(_[2]);break;case"Digit4":a.handleTempoChanger(_[3]);break;case"Space":var m,g;if(a.togglePlay(),!a.state.settings.syncTabs.value)break;null===(m=a.broadcastChannel)||void 0===m||null===(g=m.postMessage)||void 0===g||g.call(m,"play");break;case"ArrowUp":var b=r-1;b>0&&a.changeLayer(b);break;case"ArrowDown":var p=r+1;p<s.length+2&&a.changeLayer(p);break;case"KeyQ":a.removeColumns(1,o.selected);break;case"KeyE":a.addColumns(1,o.selected)}}},a.playSound=function(e,t){try{var n=e.layout[t];if(void 0===n)return;e.play(n.index,ge(a.state.settings.pitch.value))}catch(r){}},a.changePitch=function(e){var t=a.state.settings;t.pitch=Object(i.a)(Object(i.a)({},t.pitch),{},{value:e}),a.setState({settings:t},(function(){return a.updateSettings()}))},a.handleClick=function(e){var t=a.state.song.columns[a.state.song.selected],n=t.notes.findIndex((function(t){return e.index===t.index})),r=a.state.layer-1;if(n<0){var s=new me(e.index);s.layer=Zt(s.layer,r,"1"),t.notes.push(s)}else{var i=t.notes[n];i.layer=Zt(i.layer,r,"0"===i.layer[r]?"1":"0"),"000"===i.layer&&t.notes.splice(n,1)}a.setState({song:a.state.song}),a.handleAutoSave();var o=a.state.instrument;a.state.layer>1&&(o=a.state.layers[a.state.layer-2]),a.playSound(o,e.index)},a.syncSongs=Object(s.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,at.getSongs();case 2:if(t=e.sent,a.mounted){e.next=5;break}return e.abrupt("return");case 5:t=t.map((function(e){return e.data.isComposedVersion?re(e):e})),a.setState({composedSongs:t,songs:t});case 7:case"end":return e.stop()}}),e)}))),a.addSong=function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.songExists(t.name);case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",new Q("Warning","A song with this name already exists! \n"+t.name).trigger());case 4:return e.next=6,at.addSong(ie(t));case 6:a.syncSongs();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.updateSong=function(){var e=Object(s.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Untitled"!==t.name){e.next=9;break}return e.next=3,a.askForSongName();case 3:if(null!==(n=e.sent)&&a.mounted){e.next=6;break}return e.abrupt("return");case 6:return t.name=n,a.changes=0,e.abrupt("return",a.addSong(t));case 9:return e.abrupt("return",new Promise(function(){var e=Object(s.a)(r.a.mark((function e(n){var s,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=a.state.settings,e.next=3,a.songExists(t.name);case 3:if(!e.sent){e.next=14;break}return t.instruments[0]=s.instrument.value,t.instruments[1]=s.layer2.value,t.instruments[2]=s.layer3.value,e.next=9,at.updateSong({name:t.name},ie(t));case 9:console.log("song saved:",t.name),a.changes=0,a.syncSongs(),e.next=28;break;case 14:if(!t.name.includes("- Composed")){e.next=25;break}return e.next=17,a.askForSongName("Write composed song name, press cancel to ignore");case 17:if(null!==(i=e.sent)){e.next=20;break}return e.abrupt("return",n());case 20:return t.name=i,e.next=23,at.addSong(ie(t));case 23:return a.syncSongs(),e.abrupt("return",n());case 25:console.log("song doesn't exist"),t.name="Untitled",a.updateSong(t);case 28:n();case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.askForSongName=function(e){return new Promise(function(){var t=Object(s.a)(r.a.mark((function t(n){var s,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=e||"Write song name, press cancel to ignore";case 1:return t.next=4,dt(s);case 4:if(null!==(i=t.sent)){t.next=7;break}return t.abrupt("return",n(null));case 7:if(""===i){t.next=17;break}return t.next=10,a.songExists(i);case 10:if(!t.sent){t.next=14;break}s="This song already exists: "+i,t.next=15;break;case 14:return t.abrupt("return",n(i));case 15:t.next=18;break;case 17:s=e||"Write song name, press cancel to ignore";case 18:t.next=1;break;case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},a.askForSongUpdate=function(){return new Promise(function(){var e=Object(s.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt('You have unsaved changes to the song: "'.concat(a.state.song.name,'" do you want to save now?'));case 2:n=e.sent,t(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},a.songExists=function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,at.existsSong({name:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.createNewSong=Object(s.a)(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("Untitled"!==a.state.song.name&&a.changes>0)){e.next=7;break}return e.next=3,a.askForSongUpdate();case 3:if(!e.sent){e.next=7;break}return e.next=7,a.updateSong(a.state.song);case 7:return e.next=9,a.askForSongName("Write new song name, press cancel to ignore");case 9:if(null!==(t=e.sent)){e.next=12;break}return e.abrupt("return");case 12:if(n=new $(t),a.changes=0,a.mounted){e.next=16;break}return e.abrupt("return");case 16:a.setState({song:n},(function(){return a.addSong(n)})),Pe.songEvent({type:"create"});case 18:case"end":return e.stop()}}),e)}))),a.removeSong=function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt("Are you sure you want to delete the song: "+t);case 2:if(!e.sent){e.next=6;break}return e.next=6,at.removeSong({name:t});case 6:a.syncSongs(),Pe.userSongs({name:t,page:"composer"},"delete");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.loadSong=function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state,(t=JSON.parse(JSON.stringify(t))).data.isComposedVersion||((t=ue(t,4)).name+=" - Composed"),0===a.changes){e.next=12;break}if((s=n.settings.autosave.value&&"Untitled"!==n.song.name)||!(n.song.columns.length>0)){e.next=9;break}return e.next=8,mt('You have unsaved changes to the song: "'.concat(n.song.name,'" do you want to save? UNSAVED CHANGES WILL BE LOST'));case 8:s=e.sent;case 9:if(!s){e.next=12;break}return e.next=12,a.updateSong(n.song);case 12:if((o=a.state.settings).bpm=Object(i.a)(Object(i.a)({},o.bpm),{},{value:t.bpm}),o.pitch=Object(i.a)(Object(i.a)({},o.pitch),{},{value:t.pitch}),a.mounted){e.next=17;break}return e.abrupt("return");case 17:o.instrument.value!==t.instruments[0]&&(a.loadInstrument(t.instruments[0],1),o.instrument=Object(i.a)(Object(i.a)({},o.instrument),{},{value:t.instruments[0]})),o.layer2.value!==t.instruments[1]&&(a.loadInstrument(t.instruments[1],2),o.layer2=Object(i.a)(Object(i.a)({},o.layer2),{},{value:t.instruments[1]})),o.layer3.value!==t.instruments[2]&&(a.loadInstrument(t.instruments[2],3),o.layer3=Object(i.a)(Object(i.a)({},o.layer3),{},{value:t.instruments[2]})),a.changes=0,console.log("song loaded"),a.setState({song:t,settings:o,toolsColumns:[]});case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.addColumns=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"end";return new Promise((function(n){var r=new Array(e).fill().map((function(){return new de})),s=a.state.song.columns;"end"===t?s.push.apply(s,Object(p.a)(r)):s.splice.apply(s,[t+1,0].concat(Object(p.a)(r))),1===e&&a.selectColumn(a.state.song.selected+1),a.handleAutoSave(),a.setState({song:a.state.song},n)}))},a.removeColumns=function(e,t){var n=a.state.song;n.columns.length<16||(new Array(e).fill().map((function(e,n){return t+n})).forEach((function(e){n.breakpoints.includes(e)&&a.toggleBreakpoint(e)})),n.columns.splice(t,e),n.columns.length<=n.selected&&a.selectColumn(n.selected-1),a.handleAutoSave(),a.setState({song:n}))},a.togglePlay=function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n="boolean"===typeof t?t:!a.state.isPlaying;a.setState({isPlaying:n},Object(s.a)(r.a.mark((function t(){var n,s,i,o,c,l,u;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.state.isPlaying&&a.selectColumn(a.state.song.selected),n=0,s=(new Date).getTime();case 3:if(!a.state.isPlaying){t.next=16;break}return i=a.state,o=i.song,c=i.settings,l=_[o.columns[o.selected].tempoChanger],u=Math.floor(6e4/c.bpm.value*l.changer)+n,s=(new Date).getTime(),t.next=10,ve(u);case 10:if(a.state.isPlaying&&a.mounted){t.next=12;break}return t.abrupt("break",16);case 12:a.handleTick(),n=s+u-(new Date).getTime(),t.next=3;break;case 16:e();case 17:case"end":return t.stop()}}),t)}))))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleTick=function(){var e=a.state.song.selected+1;if(a.state.isPlaying&&e>a.state.song.columns.length-1)return a.togglePlay(!1);a.selectColumn(a.state.song.selected+1)},a.toggleMenuVisible=function(){a.setState({menuOpen:!a.state.menuOpen})},a.toggleBreakpoint=function(e){var t=a.state.song,n="number"===typeof e?e:t.selected,r=t.breakpoints.indexOf(n);r>=0&&t.columns.length>n?t.breakpoints.splice(r,1):t.columns.length>n&&t.breakpoints.push(n),a.validateBreakpoints(),a.setState({song:t})},a.handleTempoChanger=function(e){var t=a.state.song;t.columns[a.state.song.selected].tempoChanger=e.id,a.handleAutoSave(),a.setState({song:t})},a.changePage=function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===a.changes){e.next=12;break}if(!a.state.settings.autosave.value){e.next=6;break}return e.next=4,a.updateSong(a.state.song);case 4:e.next=12;break;case 6:return e.next=8,mt('You have unsaved changes to the song: "'.concat(a.state.song.name,'" do you want to save? UNSAVED CHANGES WILL BE LOST'),!1);case 8:if(!e.sent){e.next=12;break}return e.next=12,a.updateSong(a.state.song);case 12:a.props.changePage(t);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.selectColumn=function(e,t){var n=a.state,r=n.song;if(!(e<0||e>r.columns.length-1)){var s=n.song.columns[e];r.selected=e;var i=n.toolsColumns;if(n.toolsVisible&&0===a.copiedColums.length){i.push(e);var o=Math.min.apply(Math,Object(p.a)(i)),c=Math.max.apply(Math,Object(p.a)(i));i=new Array(c-o+1).fill().map((function(e,t){return o+t}))}a.setState({song:r,toolsColumns:i}),t||s.notes.forEach((function(e){"1"===e.layer[0]&&a.playSound(n.instrument,e.index),"1"===e.layer[1]&&a.playSound(n.layers[0],e.index),"1"===e.layer[2]&&a.playSound(n.layers[1],e.index)}))}},a.changeLayer=function(e){a.setState({layer:e})},a.toggleTools=function(){a.setState({toolsVisible:!a.state.toolsVisible,toolsColumns:a.state.toolsVisible?[]:[a.state.song.selected]}),a.copiedColums=[]},a.copyColumns=function(e){a.copiedColums=[],a.state.toolsColumns.forEach((function(e){var t=a.state.song.columns[e];void 0!==t&&a.copiedColums.push(t)})),a.copiedColums=JSON.parse(JSON.stringify(a.copiedColums)),"all"!==e&&(a.copiedColums=a.copiedColums.map((function(t){return t.notes=t.notes.filter((function(t){return"1"===t.layer[e-1]})),t.notes=t.notes.map((function(t){return t.layer="000",t.layer=Zt(t.layer,e-1,"1"),t})),t}))),a.setState({toolsColumns:[]})},a.pasteColumns=function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.state.song,s=JSON.parse(JSON.stringify(a.copiedColums)),t?s.forEach((function(e,t){var a=n.columns[n.selected+t];void 0!==a&&e.notes.forEach((function(e){var t=a.notes.findIndex((function(t){return e.index===t.index}));if(t<0)a.notes.push(e);else for(var n=0;n<3;n++)"1"===e.layer[n]&&(a.notes[t].layer=Zt(a.notes[t].layer,n,1))}))})):(i=n.columns).splice.apply(i,[n.selected,0].concat(Object(p.a)(s))),a.setState({song:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.eraseColumns=function(e){var t=a.state.song;"all"===e?a.state.toolsColumns.forEach((function(e){void 0!==t.columns[e]&&(t.columns[e].notes=[])})):a.state.toolsColumns.forEach((function(n){void 0!==t.columns[n]&&t.columns[n].notes.forEach((function(t){t.layer=Zt(t.layer,e-1,"0")}))})),a.setState({song:t})},a.validateBreakpoints=function(){var e=a.state.song.breakpoints.filter((function(e){return e<a.state.song.columns.length})),t=a.state.song;t.breakpoints=e,a.setState({song:t})},a.deleteColumns=Object(s.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=a.state.song).columns=t.columns.filter((function(e,t){return!a.state.toolsColumns.includes(t)})),t.selected>t.columns.length-1&&(t.selected=t.columns.length-1),t.selected<=0&&(t.selected=0),0!==t.columns.length){e.next=7;break}return e.next=7,a.addColumns(12,0);case 7:a.setState({song:t,toolsColumns:[]},a.validateBreakpoints);case 8:case"end":return e.stop()}}),e)}))),a.changeMidiVisibility=function(e){a.setState({midiVisible:e}),e&&Pe.songEvent({type:"create_MIDI"})};var c=a.getSettings();return a.playbackInterval=void 0,a.audioContext=w,a.reverbNode=void 0,a.reverbVolumeNode=void 0,a.recorder=new lt,a.state={instrument:new rt,layers:[new rt,new rt],songs:[],isPlaying:!1,song:new $("Untitled"),settings:c,menuOpen:!1,layer:1,toolsColumns:[],toolsVisible:!1,midiVisible:!1,isRecordingAudio:!1},a.MIDISettings=Se(),a.MidiAccess=void 0,a.currentMidiSource=void 0,a.state.song.bpm=c.bpm.value,a.state.song.instruments=[c.instrument.value,c.layer2.value,c.layer3.value],a.mounted=!1,a.copiedColums=[],a.changes=0,a.broadcastChannel={},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.mounted=!0,this.init(),window.addEventListener("keydown",this.handleKeyboard),this.broadcastChannel=window.BroadcastChannel?new BroadcastChannel(j+"_composer"):{},this.broadcastChannel.onmessage=function(t){e.state.settings.syncTabs.value&&["play","stop"].includes(null===t||void 0===t?void 0:t.data)&&e.togglePlay("play"===t.data)},"localhost"!==window.location.hostname&&window.addEventListener("beforeunload",(function(e){e.preventDefault(),e.returnValue=""}))}},{key:"componentWillUnmount",value:function(){var e,t;this.mounted=!1,this.currentMidiSource&&(this.currentMidiSource.onmidimessage=null),this.MidiAccess&&(this.MidiAccess.onstatechange=null),window.removeEventListener("keydown",this.handleKeyboard);var n=this.state,a=n.instrument,r=n.layers;null===(e=this.broadcastChannel)||void 0===e||null===(t=e.close)||void 0===t||t.call(e),[a,r[0],r[1]].forEach((function(e){return e.delete()})),this.reverbNode=void 0,this.reverbVolumeNode=void 0,this.audioContext=void 0,this.state.isPlaying=!1}},{key:"componentDidCatch",value:function(){this.setState({song:new $("Untitled")}),new Q("Warning","There was an error with the song! Restoring default...").trigger()}},{key:"loadReverb",value:function(){var e=this;return new Promise((function(t){fetch("./assets/audio/reverb4.wav").then((function(e){return e.arrayBuffer()})).then((function(n){e.mounted&&e.audioContext.decodeAudioData(n,(function(n){if(e.mounted){var a=e.audioContext.createConvolver(),r=e.audioContext.createGain();r.gain.value=2.5,a.buffer=n,a.connect(r),r.connect(e.audioContext.destination),e.reverbNode=a,e.reverbVolumeNode=r,t()}}))})).catch((function(e){console.log("Error with reverb",e)}))}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.midiVisible,a=t.song,r=function(e,t,n){for(var a=Math.floor(6e4/t),r=0,s=0,i=0,o=0;o<e.length;o++)i=a*_[e[o].tempoChanger].changer,o<n&&(s+=i),r+=i;return{total:r,current:s}}(a.columns,t.settings.bpm.value,a.selected),s={songs:t.songs,currentSong:t.song,settings:t.settings,hasChanges:this.changes,menuOpen:t.menuOpen,isRecordingAudio:t.isRecordingAudio},i={loadSong:this.loadSong,removeSong:this.removeSong,createNewSong:this.createNewSong,changePage:this.changePage,updateSong:this.updateSong,handleSettingChange:this.handleSettingChange,toggleMenuVisible:this.toggleMenuVisible,changeVolume:this.changeVolume,changeMidiVisibility:this.changeMidiVisibility,startRecordingAudio:this.startRecordingAudio},o={handleClick:this.handleClick,handleTempoChanger:this.handleTempoChanger,changeLayer:this.changeLayer},c={keyboard:t.instrument,currentColumn:t.song.columns[t.song.selected],TempoChangers:_,layer:t.layer,pitch:t.settings.pitch.value,isPlaying:t.isPlaying,noteNameType:t.settings.noteNameType.value},l={selectColumn:this.selectColumn,toggleBreakpoint:this.toggleBreakpoint},u={columns:a.columns,selected:a.selected,settings:t.settings,breakpoints:t.song.breakpoints,toolsColumns:t.toolsColumns},d={visible:this.state.toolsVisible,copiedColumns:this.copiedColums,layer:this.state.layer},h={toggleTools:this.toggleTools,eraseColumns:this.eraseColumns,deleteColumns:this.deleteColumns,copyColumns:this.copyColumns,pasteColumns:this.pasteColumns},m={loadSong:this.loadSong,changeMidiVisibility:this.changeMidiVisibility,changePitch:this.changePitch},g={instruments:[t.instrument].concat(Object(p.a)(t.layers)).map((function(e){return e.instrumentName})),selectedColumn:a.selected};return Object(F.jsxs)("div",{className:"app bg-image",style:{backgroundImage:"url(".concat(t.settings.backgroundImage.value,")")},children:[n&&Object(F.jsx)(St,{functions:m,data:g}),Object(F.jsx)("div",{className:"hamburger",onClick:this.toggleMenuVisible,children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.a,{})})}),Object(F.jsxs)("div",{className:"right-panel-composer",children:[Object(F.jsx)("div",{className:"column fill-x",children:Object(F.jsxs)("div",{className:"top-panel-composer",children:[Object(F.jsxs)("div",{className:"buttons-composer-wrapper",children:[Object(F.jsx)("div",{className:"tool",onPointerDown:function(){return e.selectColumn(a.selected+1)},children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.c,{})})}),Object(F.jsx)("div",{className:"tool",onClick:function(){return e.selectColumn(a.selected-1)},children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.b,{})})}),Object(F.jsx)("div",{className:"tool",onClick:this.togglePlay,children:Object(F.jsx)(Ce,{children:this.state.isPlaying?Object(F.jsx)(Ne.o,{},"pause"):Object(F.jsx)(Ne.p,{},"play")})})]}),Object(F.jsx)(Ft,{functions:l,data:u},this.state.settings.columnsPerCanvas.value),Object(F.jsxs)("div",{className:"buttons-composer-wrapper-right",children:[Object(F.jsx)("div",{className:"tool",onClick:function(){return e.addColumns(1,a.selected)},children:Object(F.jsx)("img",{src:jt,className:"tool-icon",alt:"Add a new cell"})}),Object(F.jsx)("div",{className:"tool",onClick:function(){return e.removeColumns(1,a.selected)},children:Object(F.jsx)("img",{src:xt,className:"tool-icon",alt:"Remove a cell"})}),Object(F.jsx)("div",{className:"tool",onClick:function(){return e.addColumns(4*e.state.settings.beatMarks.value,"end")},children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.q,{})})}),Object(F.jsx)("div",{className:"tool",onClick:this.toggleTools,children:Object(F.jsx)(Ce,{children:Object(F.jsx)(Ne.A,{})})})]})]})}),Object(F.jsx)(Et,{functions:o,data:c})]}),Object(F.jsx)(zt,{data:s,functions:i}),Object(F.jsx)(Ct,{data:d,functions:h}),Object(F.jsxs)("div",{className:"song-info",children:[Object(F.jsx)("div",{children:a.name}),Object(F.jsxs)("div",{children:[Yt(r.current),"/",Yt(r.total)]})]})]})}}]),n}(d.Component);function Yt(e){var t=Math.floor(e/6e4),n=(e%6e4/1e3).toFixed(0);return 60===n?t+1+":00":t+":"+(n<10?"0":"")+n}function Zt(e,t,n){return t>=e.length?e.valueOf():e.substring(0,t)+n+e.substring(t+1)}var Xt=Jt;function Qt(e){var t=e.functions,n=e.children,a=e.className,r=Object(d.useState)(!1),s=Object(f.a)(r,2),i=s[0],o=(s[1],Object(d.useState)("Settings")),c=Object(f.a)(o,2),l=c[0],u=(c[1],t.changePage);t.toggleMenuVisible;return Object(F.jsxs)("div",{className:"menu-wrapper "+(a||""),children:[Object(F.jsxs)("div",{className:"menu menu-visible",style:{justifyContent:"flex-end"},children:[n,Object(F.jsx)(Ke,{type:"Discord",children:Object(F.jsx)("a",{href:"https://discord.gg/Arsf65YYHq",target:"_blank",rel:"noreferrer",children:Object(F.jsx)(Ne.g,{className:"icon"})})}),Object(F.jsx)(Ke,{type:"Home",action:function(){return u("home")},children:Object(F.jsx)(Ne.j,{className:"icon"})})]}),Object(F.jsx)("div",{className:i?"side-menu menu-open":"side-menu",children:Object(F.jsx)(ze,{title:"No selection",visible:l})})]})}n(202);var qt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).downloadAllSongs=function(){var e=[];a.state.songs.forEach((function(t){t._id&&delete t._id,"Sky"===j&&(t=oe(t)),Array.isArray(t)?e.push.apply(e,Object(p.a)(t)):e.push(t)}));var t=new q,n=JSON.stringify(e),r=(new Date).toISOString().split("T")[0];t.download(n,"".concat(j,"_Backup_").concat(r,".json")),new Q("Success","Song backup downloaded").trigger()},a.syncSongs=Object(s.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,at.getSongs();case 3:e.t1=e.sent,e.t2={songs:e.t1},e.t0.setState.call(e.t0,e.t2);case 6:case"end":return e.stop()}}),e)}))),a.deleteSong=function(){var e=Object(s.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt("Are you sure you want to delete the song: "+t);case 2:if(!e.sent){e.next=6;break}return e.next=5,at.removeSong({name:t});case 5:a.syncSongs();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.deleteAllSongs=Object(s.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt("Are you sure you want to delete ALL SONGS?");case 2:if(!e.sent){e.next=6;break}return e.next=5,at.removeSong({});case 5:a.syncSongs();case 6:case"end":return e.stop()}}),e)}))),a.resetSettings=function(){localStorage.removeItem(j+"_Composer_Settings"),localStorage.removeItem(j+"_Main_Settings"),new Q("Success","Settings have been reset").trigger()},a.downloadSong=function(e){e._id&&delete e._id;var t=e.name;"Sky"===j&&(e=oe(e)),Array.isArray(e)||(e=[e]),e.forEach((function(e){e.data.appName=j}));var n=JSON.stringify(e);(new q).download(n,"".concat(t,".").concat(j.toLowerCase(),"sheet.json")),new Q("Success","Song downloaded").trigger()},a.state={songs:[]},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.syncSongs()}},{key:"render",value:function(){var e=this;return Object(F.jsxs)("div",{className:"error-page app",children:[Object(F.jsx)(Qt,{functions:{changePage:this.props.changePage}}),Object(F.jsxs)("div",{className:"error-text-wrapper",children:["There seems to be an error. ",Object(F.jsx)("br",{}),"Here you can download or delete your songs, try to find what song caused the error and remove it."]}),Object(F.jsxs)("div",{className:"error-buttons-wrapper",children:[Object(F.jsx)("button",{className:"genshin-button",onClick:this.resetSettings,children:"Reset settings"}),Object(F.jsx)("button",{className:"genshin-button",onClick:this.deleteAllSongs,children:"Delete all songs"})]}),Object(F.jsx)("div",{className:"error-songs-wrapper",children:this.state.songs.map((function(t){return Object(F.jsx)(_t,{data:t,functions:{deleteSong:e.deleteSong,downloadSong:e.downloadSong}},null===t||void 0===t?void 0:t.name)}))})]})}}]),n}(d.Component);function _t(e){var t=e.data,n=e.functions.deleteSong,a=e.functions.downloadSong;return Object(F.jsxs)("div",{className:"song-row",children:[Object(F.jsx)("div",{className:"song-name",children:t.name}),Object(F.jsxs)("div",{className:"song-buttons-wrapper",children:[Object(F.jsx)("button",{className:"song-button",onClick:function(){return a(t)},children:Object(F.jsx)(Ne.h,{})}),Object(F.jsx)("button",{className:"song-button",onClick:function(){return n(t.name)},children:Object(F.jsx)(Ne.B,{color:"#ed4557"})})]})]})}var $t=qt;n(203);function en(e){return Object(F.jsxs)("div",{className:"default-page",children:[Object(F.jsx)("div",{className:"changelog-page-title",children:"Changelog"}),Object(F.jsx)(Qt,{functions:{changePage:e.changePage},children:Object(F.jsx)(Ke,{children:Object(F.jsx)("a",{href:"https://github.com/Specy/genshin-music",className:"icon",target:"_blank",rel:"noreferrer",children:Object(F.jsx)(Ne.i,{})})})}),nn.map((function(e){return Object(F.jsx)(tn,{data:e},e.version)})),Object(F.jsx)("div",{className:"changelog-ending"})]})}function tn(e){var t=e.data,n=t.version,a=t.title,r=t.changes,s=t.date;return Object(F.jsxs)("div",{children:[Object(F.jsxs)("div",{className:"changelog-title",children:[Object(F.jsx)("div",{className:"clt-1",children:n}),Object(F.jsx)("div",{className:"clt-2",children:s})]}),Object(F.jsxs)("div",{className:"changelog-list",children:[Object(F.jsx)("div",{className:"cll-1",children:a}),Object(F.jsx)("ul",{children:r.map((function(e,t){return Object(F.jsx)("li",{children:e.split("$l").map((function(e,t,n){return 0===t?Object(F.jsx)("div",{children:e},t):Object(F.jsx)("p",{className:"cll-new-line",children:e},t)}))},t)}))})]})]})}var nn=[{version:"2.3",title:"MIDI Keyboard and Performance",date:"2022 - 3/02",changes:["Added MIDI Keyboard support on all pages with custom layouts and shortcuts","Big performance improvements of main page","Added note names to sheet visualizer and empty cells","Added ABC format","Added Panflute (Sky)","UI improvements and bug fixes"]},{version:"2.2",title:"Sheet visualizer",date:"2022 - 17/01",changes:["Added sheet visualizer","Changed timeline behaviour when dragging the scroll bar","Improved performance by 2 times in some places","UI improvements and bug fixes"]},{version:"2.1.1",title:"Zither and icons",date:"2021 - 16/12",changes:["Changed note icon and animation (Genshin)","Added Help page","Changed zither audio (Genshin)","UI improvements"]},{version:"2.1",title:"Home menu and pages",date:"2021 - 11/12",changes:["Restructured code","Added opacity to some elements","Changed margins and padding of some elements","Added home page","Added Partners page","Added shortcuts for main page","Fixed loading bug in composer and main page","Added Donate page"]},{version:"2.0",title:"Approaching circles",date:"2021 - 28/11",changes:["Added Approaching cirlces mode, a new way to learn a song, or a way to challange yourself.\n            You can find it in the main page, next to the practice button","Rewrite of the main page to increase overall performance","Added changelog page","Added audio recording feature in main page and composer","Added tabs autoplay (composer) on pc as a setting","Added note animations when pressing the note","Added possibility to change background image from URL","Updated info page","In the composer you can now press shift + note name to add a note","In the composer you can press up/down keys to change layer",'While in the composer on PC, you can now add new notes by simply pressing the PC keyboard while in "playing" mode']},{version:"1.7",title:"Zither",date:"2021 - 20/10",changes:["(For genshin) Added Zither",'Added back "do re mi" format']},{version:"1.6",title:"Performance tweaks",date:"2021 - 17/10",changes:["Performance of composer improved by 2x","Added note names for genshin (made it a setting)","Fixed instrument volume bug","Fixed keyboard layout issues","Fixed other small bugs"]},{version:"1.5",title:"MIDI import",date:"2021 - 14/10",changes:["Added to both Sky and Genshin music nightly the MIDI import feature $l\n            - Music track selection (select or deselect which tracks to include) $l\n            - Instrument track selection (select what instrument to give to each track) $l\n            - Track info (get info on how successful your parsing was, accidentals and notes out of range) $l\n            - Change note offset (in case that the song is outside of the octaves available) \n            "]},{version:"1.4",title:"Song library",date:"2021 - 28/08",changes:["Added song library integration, directly import songs from the app (700+ songs)","Bug fixes"]},{version:"1.3",title:"New audio files",date:"2021 - 25/08",changes:["Changed audio files","Added ocarina","Removed support button in TWA","Bug fixes"]},{version:"1.2",title:"Bug fixes and PWA",date:"2021 - 18/08",changes:["(For sky) Fixed bug where sheets couldn't be imported in sky studio","Changed app install to more modern approach with description and images"]},{version:"1.1",title:"Sheets compatibility",date:"2021 - 07/08",changes:["(For sky) Added backwards compatibility for sheets, now sheets made in sky music nightly can be imported into sky music and sky studio (with some losses)","Bug fixes","General improvement in performance"]},{version:"1.0",title:"Release",date:"2021 - 22/05",changes:["3 Instruments composition","Better performance than previous version","Better practice tool","Better interface","Breakpoints for the composer","New features for both composer and main page","Feature rich customisability to make learning and composition easier"]}],an=(n(204),n.p+"static/media/windsong-db.e533a22d.jpg");function rn(e){return Object(F.jsxs)("div",{className:"partners-page",children:[Object(F.jsx)(Qt,{functions:{changePage:e.changePage}}),Object(F.jsxs)("div",{className:"partner-wrapper",children:[Object(F.jsx)(cn,{name:"Specy",description:"The youtube channel that collects videos created by users of this app",children:Object(F.jsx)(on,{src:"https://www.youtube.com/embed/Sh7kqYVMjwM",title:"Specy"})}),Object(F.jsx)(cn,{name:"ChaconneScott_ACG",description:"YouTube pianist and arranger, features Genshin Impact OST",children:Object(F.jsx)(on,{src:"https://www.youtube.com/embed/ltE8zfGfUVo",title:"ChaconneScott_ACG"})}),Object(F.jsx)(cn,{name:"uma\u273f",description:"Arranges music, primarily from anime and games for Sky and Genshin.",children:Object(F.jsx)(on,{src:"https://www.youtube.com/embed/7aIkAGvp9Y0",title:"uma"})}),Object(F.jsx)(cn,{name:"Windsong DB",description:"A Genshin Impact Database for Instrument Gadget Keymaps",children:Object(F.jsx)(sn,{img:an,to:"https://genshin-lyre.notion.site/genshin-lyre/Windsong-DB-8012b5f6939b486d857552c7b60e917f",alt:"Windsong DB"})})]})]})}function sn(e){return Object(F.jsx)("a",{href:e.to,style:{width:"18.8rem",height:"10.5rem",overflow:"hidden",borderRadius:"0.3rem"},target:"_blank",rel:"noreferrer",children:Object(F.jsx)("img",{src:e.img,style:{width:"100%",objectFit:"cover"},alt:e.alt})})}function on(e){return Object(F.jsx)("iframe",{src:e.src,title:e.src,frameBorder:"0",allow:"autoplay; picture-in-picture",allowFullScreen:!0})}function cn(e){return Object(F.jsxs)("div",{className:"partner",children:[Object(F.jsx)("div",{className:"partner-title",children:e.name}),Object(F.jsx)("div",{className:"partner-description",children:e.description}),e.children]})}n(205);function ln(e){var t=e.changePage,n=e.data,a=e.askForStorage,r=e.hasVisited,s=e.toggleHome,i=e.currentPage,o=e.setDontShowHome,c=t,l=n.isInPosition?"home":"home home-visible",u=window.innerWidth>900;return Object(F.jsxs)("div",{className:l,children:[Object(F.jsx)(Ne.z,{className:"close-home",onClick:function(){return s(!1)}}),(u||!r)&&Object(F.jsxs)("div",{className:"home-top",children:[Object(F.jsxs)("div",{className:"home-title",children:[j," Music Nightly"]}),Object(F.jsxs)("div",{className:"home-top-text",children:["An app where you can create, practice and play songs for ",j]})]}),!r&&Object(F.jsxs)("div",{className:"home-welcome",children:[Object(F.jsxs)("div",{children:[!V()&&Object(F.jsx)("div",{className:"home-spacing",children:"To have the webapp fullscreen and better view, please add the website to the home screen"}),Object(F.jsxs)("div",{className:"home-spacing",children:[Object(F.jsx)("div",{className:"red-text",children:"WARNING"}),": Clearing your browser cache / storage might delete your songs, make sure you make backups"]}),n.hasPersistentStorage?Object(F.jsxs)("div",{children:[Object(F.jsx)("div",{className:"red-text",children:"WARNING"}),": Click the button below to make sure that your browser won't delete your songs if you lack storage"]}):null]}),Object(F.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:Object(F.jsx)("button",{className:"home-accept-storage",onClick:a,children:"Confirm"})})]}),Object(F.jsxs)("div",{className:"home-content",children:[Object(F.jsx)(dn,{icon:Object(F.jsx)(Ne.e,{}),title:"Composer",background:"./manifestData/composer.png",onClick:function(){return c("Composer")},current:"Composer"===i,children:"Create or edit songs with a fully fledged music composer. Also with MIDI."}),Object(F.jsx)(dn,{icon:Object(F.jsx)(Le.b,{}),title:"Player",background:"./manifestData/main.png",onClick:function(){return c("")},current:""===i||"Player"===i,children:"Play, download, record and import songs. Learn a song with approaching circle mode and practice mode."})]}),Object(F.jsx)(hn,{children:" Other pages "}),Object(F.jsxs)("div",{className:"page-redirect-wrapper",children:[Object(F.jsx)(un,{onClick:function(){return c("Changelog")},current:"Changelog"===i,children:"Changelog"}),!V()&&Object(F.jsx)(un,{onClick:function(){return c("Donate")},current:"Donate"===i,children:"Donate"}),Object(F.jsx)(un,{onClick:function(){return c("Partners")},current:"Partners"===i,children:"Partners"}),Object(F.jsx)(un,{onClick:function(){return c("Help")},current:"Help"===i,children:"Help"}),Object(F.jsx)(un,{onClick:function(){return c("SheetVisualizer")},current:"SheetVisualizer"===i,children:"Sheet visualizer"})]}),Object(F.jsxs)("div",{className:"home-dont-show-again",onClick:function(){return o(!n.canShow)},children:[Object(F.jsx)("input",{type:"checkbox",checked:!n.canShow,readOnly:!0}),"Hide on open"]}),Object(F.jsx)("div",{className:"home-bottom",children:Object(F.jsxs)("div",{children:["\xa9 All rights reserved by ","Genshin"===j?"miHoYo":"TGC",". Other properties belong to their respective owners."]})})]})}function un(e){var t=e.children,n=e.onClick,a=e.current;return Object(F.jsx)("button",{onClick:n,className:a?"current-page":"",children:t})}function dn(e){var t=e.title,n=e.icon,a=e.children,r=e.background,s=e.onClick,i=e.current;return Object(F.jsxs)("div",{className:"home-content-element ".concat(i?"current-page":""),onClick:s,children:[Object(F.jsx)("div",{className:"home-content-background",style:{backgroundImage:"url(".concat(r,")")}}),Object(F.jsxs)("div",{className:"home-content-main",children:[Object(F.jsxs)("div",{className:"home-content-title",children:[n," ",t]}),Object(F.jsx)("div",{className:"home-content-text",children:a}),Object(F.jsx)("div",{className:"home-content-open",children:Object(F.jsx)("button",{children:"OPEN"})})]})]})}function hn(e){var t=e.children;return Object(F.jsx)("div",{className:"home-separator",children:t})}function mn(e){return Object(F.jsxs)("div",{className:"default-page",children:[Object(F.jsx)(Qt,{functions:{changePage:e.changePage}}),Object(F.jsxs)("div",{children:[Object(F.jsx)("div",{style:{fontSize:"2rem",margin:"1rem 0"},children:"Info about the app"}),Object(F.jsxs)("div",{style:{marginLeft:"1rem"},children:["In this page you will find an explaination for what all the buttons in the app do and how to use them.",Object(F.jsx)("br",{}),Object(F.jsx)("br",{}),"If you Have issues, bugs, or suggestions, please join our",Object(F.jsxs)("a",{href:"https://discord.gg/Arsf65YYHq",style:{color:"var(--note-text)"},children:[Object(F.jsx)(F.Fragment,{children:"\xa0"})," Discord server"]}),". ",Object(F.jsx)("br",{})]}),Object(F.jsx)(He,{})]})]})}n(206);var gn=50,bn=400;function pn(e){var t=Object(d.useState)([]),n=Object(f.a)(t,2),a=n[0],i=n[1],o=Object(d.useState)([]),c=Object(f.a)(o,2),l=c[0],u=c[1],h=Object(d.useState)(7),m=Object(f.a)(h,2),g=m[0],b=m[1],v=Object(d.useState)({}),x=Object(f.a)(v,2),y=x[0],O=x[1],k=Object(d.useState)("recorded"),S=Object(f.a)(k,2),w=S[0],C=S[1],N=Object(d.useState)(!1),A=Object(f.a)(N,2),E=A[0],M=A[1],D=Object(d.useState)(""),T=Object(f.a)(D,2),P=T[0],I=T[1];function B(e){var t=g+e,n=document.querySelector(".frame-outer");!n||t<1||(n.getBoundingClientRect().width<50&&1===e||b(t))}function L(e){var t=ne("Genshin"===j?"Keyboard layout":"ABC",e,"C","Genshin"===j?21:15);return"Genshin"===j?t.toLowerCase():t.toUpperCase()}function R(e){var t;O(e);var n=JSON.parse(JSON.stringify(e));(null===(t=n.data)||void 0===t?void 0:t.isComposedVersion)&&(n=se(n));for(var a=n.notes,r=[],s=0,i="",o=0;a.length>0;o++){for(var c=new fn([a.shift()]),l=c.notes.length>0?c.notes[0][1]:0,d=0;d<a.length&&d<20;d++){a[d][1]-c.notes[0][1]-gn<0&&(c.notes.push(a.shift()),d--)}c.delay=s,s=a.length>0?a[0][1]-l:0;var h=Math.floor(c.delay/bn);if(r.push.apply(r,Object(p.a)(new Array(h).fill(0).map((function(){return new fn})))),r.push(c),i+=h>2?" \n\n":"- ".repeat(h),c.notes.length>1){var m=c.notes.map((function(e){return L(e[0])})).join("");i+="Genshin"===j?"[".concat(m,"] "):"".concat(m," ")}else c.notes.length>0&&(i+="".concat(L(c.notes[0][0])," "))}I(i),u(r),Pe.songEvent({type:"visualize"})}return Object(d.useEffect)((function(){function e(){return(e=Object(s.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=i,e.next=3,at.getSongs();case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(F.jsx)("div",{className:"default-page",children:Object(F.jsxs)("div",{style:{display:"flex",alignItems:"center",flexDirection:"column"},children:[Object(F.jsx)(Qt,{functions:{changePage:e.changePage},className:"noprint"}),Object(F.jsxs)("div",{children:[Object(F.jsxs)("div",{className:"displayer-songs-wrapper noprint",style:{marginTop:"0"},children:[Object(F.jsxs)("div",{className:"tab-selector-wrapper",children:[Object(F.jsx)("button",{className:"recorded"===w?"tab-selector tab-selected":"tab-selector",onClick:function(){return C("recorded")},children:"Recorded"}),Object(F.jsx)("button",{className:"composed"===w?"tab-selector tab-selected":"tab-selector",onClick:function(){return C("composed")},children:"Composed"})]}),Object(F.jsx)("div",{className:"songs-wrapper",children:a.filter((function(e){var t,n;return"composed"===w?null===(t=e.data)||void 0===t?void 0:t.isComposedVersion:!(null===(n=e.data)||void 0===n?void 0:n.isComposedVersion)})).map((function(e){return Object(F.jsx)(jn,{current:e===y,data:e,functions:{click:R}},null===e||void 0===e?void 0:e.name)}))})]}),Object(F.jsxs)("div",{className:"displayer-buttons-wrapper noprint",children:[Object(F.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(F.jsx)("div",{style:{marginRight:"0.5rem"},children:"Note names"}),Object(F.jsx)(Ye,{checked:E,onChange:M})]}),Object(F.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:["Per row: ",g,Object(F.jsx)("button",{className:"displayer-plus-minus",onClick:function(){return B(-1)},children:"-"}),Object(F.jsx)("button",{className:"displayer-plus-minus",onClick:function(){return B(1)},children:"+"})]})]})]}),Object(F.jsx)("h1",{className:"onprint",children:null===y||void 0===y?void 0:y.name}),Object(F.jsxs)("div",{style:{color:"var(--whitish)",width:"100%"},className:"noprint",children:[Object(F.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(F.jsx)("h2",{children:y.name||"No song selected"}),Object(F.jsx)("button",{onClick:function(){return window.print()},className:"genshin-button",children:"Print as PDF"})]}),Object(F.jsx)("div",{style:{color:"var(--hint-main)"},children:"Remember that you can learn a song with the interactive practice tool in the main page"})]}),Object(F.jsx)("div",{className:"displayer-frame-wrapper",style:{gridTemplateColumns:"repeat(".concat(g,",1fr)")},children:l.map((function(e,t){return Object(F.jsx)(vn,{framesPerRow:g,frame:e,rows:3,hasText:E},t)}))}),P.trim().length>0&&Object(F.jsx)("pre",{className:"text-notation-wrapper",children:P})]})})}var fn=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(o.a)(this,e),this.notes=[],this.delay=0,this.notes=t,this.delay=n};function vn(e){var t=e.frame,n=e.rows,a=e.hasText,r="Genshin"===j?7:5,s=new Array(r*n).fill(0);return t.notes.forEach((function(e){s[e[0]]=1})),0===t.notes.length?Object(F.jsx)("div",{className:"frame-outer displayer-ball",children:Object(F.jsx)("div",{})}):Object(F.jsx)("div",{className:"frame-outer",children:Object(F.jsx)("div",{className:"displayer-frame",style:{gridTemplateColumns:"repeat(".concat(r,",1fr)")},children:s.map((function(e,t){return Object(F.jsx)("div",{className:e?"frame-note-s":"frame-note-ns",children:e&&a?ne("Genshin"===j?"Keyboard layout":"ABC",t,"C","Genshin"===j?21:15):null},t)}))})})}function jn(e){var t=e.data,n=e.current?{backgroundColor:"rgb(124, 116, 106)"}:{};return Object(F.jsx)("div",{className:"song-row",style:n,onClick:function(){return e.functions.click(t)},children:Object(F.jsx)("div",{className:"song-name",children:t.name})})}n(207);function xn(e){var t=e.data,n=e.noteText,a=void 0===n?"A":n,r=e.handleClick,s=e.noteImage,i=function(e){var t=S.note;if("clicked"===e)t+=" click-event";return t}(t.status);return Object(F.jsx)("button",{onPointerDown:function(e){e.preventDefault(),r(t)},className:"button-hitbox-bigger",children:Object(F.jsxs)("div",{className:i,style:{borderColor:yn(t.status)},children:[Object(F.jsx)("img",{draggable:"false",alt:"",src:s}),"Genshin"===j&&Object(F.jsx)(U,{className:"genshin-border",fill:yn(t.status)}),Object(F.jsx)("div",{className:S.noteName,children:a})]})})}function yn(e){var t="#eae5ce";return"clicked"===e?t="transparent":"wrong"===e?t="#d66969":"right"===e&&(t="#358a55"),t}function On(e){var t=e.status,n=e.onClick,a=e.type,r=e.selected,s=e.midi;return Object(F.jsx)("div",{className:"genshin-button midi-shortcut ".concat(t," ").concat(r?"selected":""),onClick:function(){return n(a)},children:kn(a)+" (".concat(-1===s?"NA":s,")")})}function kn(e){var t;return((null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+e.substring(1)).split("_").join(" ")}var Sn=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).init=function(){a.loadInstrument(A[0]),N?navigator.requestMIDIAccess().then(a.initMidi,(function(){new Q("Error","MIDI permission not accepted").trigger()})):new Q("Error","MIDI is not supported on this browser").trigger()},a.initMidi=function(e){if(a.mounted){e.onstatechange=a.midiStateChange,a.MidiAccess=e;for(var t=a.MidiAccess.inputs.values(),n=[],r=t.next();r&&!r.done;r=t.next())n.push(r.value);a.setState({sources:n})}},a.midiStateChange=function(e){if(a.mounted){for(var t=a.state.sources,n=a.MidiAccess.inputs.values(),r=[],s=n.next();s&&!s.done;s=n.next())r.push(s.value);a.setState({sources:r}),t.length>r.length?new Q("Warning","Device disconnected").trigger():r.length>0&&new Q("Warning","Device connected").trigger()}},a.selectMidi=function(e){if(a.mounted){var t=a.state,n=t.sources,r=t.selectedSource,s=t.settings,i=n.find((function(t){return t.id===e.target.value}));r&&(r.onmidimessage=null),i&&(i.onmidimessage=a.handleMidi,s.currentSource=i.name+" "+i.manufacturer,a.setState({selectedSource:i,settings:s}),a.saveLayout())}},a.deselectNotes=function(){var e=a.state.settings;e.notes.forEach((function(e){e.status=e.midi<0?"wrong":"right"})),a.setState({settings:e})},a.saveLayout=function(){var e=a.state.settings;e.enabled=!0,a.setState({settings:e}),localStorage.setItem(j+"_MIDI_Settings",JSON.stringify(a.state.settings))},a.loadInstrument=function(){var e=Object(s.a)(r.a.mark((function e(t){var n,s,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=a.state.instrument)||void 0===n||null===(s=n.delete)||void 0===s||s.call(n),i=new rt(t),e.next=4,i.load();case 4:if(a.mounted){e.next=6;break}return e.abrupt("return");case 6:i.connect(a.audioContext.destination),a.setState({instrument:i});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.checkIfUsed=function(e,t){var n=a.state.settings,r=n.shortcuts,s=n.notes;return!(!r.find((function(t){return t.midi===e}))||!["all","shortcuts"].includes(t))||!(!s.find((function(t){return t.midi===e}))||!["all","notes"].includes(t))},a.handleMidi=function(e){var t=a.state,n=t.selectedNote,r=t.settings,s=t.selectedShortcut,i=Object(f.a)(e.data,3),o=i[0],c=i[1],l=i[2];if(C===o&&0!==l){if(n){if(a.checkIfUsed(c,"shortcuts"))return new Q("Warning","Key already used").trigger();n.midi=c,a.deselectNotes(),a.setState({selectedNote:null}),a.saveLayout()}if(s){var u=r.shortcuts.find((function(e){return e.type===s}));if(a.checkIfUsed(c,"all"))return new Q("Warning","Key already used").trigger();u&&(u.midi=c,u.status=c<0?"wrong":"right",a.setState({settings:r}),a.saveLayout())}var d=r.shortcuts.find((function(e){return e.midi===c}));d&&(d.status="clicked",setTimeout((function(){d.status=c<0?"wrong":"right",a.setState({settings:r})}),150),a.setState({settings:r})),r.notes.filter((function(e){return e.midi===c})).forEach((function(e){a.handleClick(e,!0)}))}},a.handleClick=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=a.state.settings;t||a.deselectNotes(),e.status="clicked",t?(setTimeout((function(){e.status=e.midi<0?"wrong":"right",a.setState({settings:n})}),200),a.setState({settings:n,selectedShortcut:null})):a.setState({settings:n,selectedNote:e,selectedShortcut:null}),a.playSound(e)},a.handleShortcutClick=function(e){if(a.deselectNotes(),a.state.selectedShortcut===e)return a.setState({selectedShortcut:null,selectedNote:null});a.setState({selectedShortcut:e,selectedNote:null})},a.playSound=function(e){void 0!==e&&a.state.instrument.play(e.index,1)},a.state={settings:Se(),instrument:new rt,selectedNote:null,selectedShortcut:null,sources:[],selectedSource:void 0},a.audioContext=w,a.mounted=!0,a.MidiAccess=void 0,a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.init()}},{key:"componentWillUnmount",value:function(){var e=this.state.sources;this.mounted=!1,this.MidiAccess&&(this.MidiAccess.onstatechange=null),null===e||void 0===e||e.forEach((function(e){e.onmidimessage=null})),this.selectedSource&&(this.selectedSource.onmidimessage=null)}},{key:"render",value:function(){var e=this,t=this.state,n=t.settings,a=t.sources,r=t.selectedShortcut,s=this.props.changePage;return Object(F.jsxs)("div",{className:"default-page",children:[Object(F.jsx)(Qt,{functions:{changePage:s}}),Object(F.jsxs)("div",{className:"default-content",style:{alignItems:"center"},children:[Object(F.jsxs)("div",{className:"column midi-setup-column",children:[Object(F.jsxs)("div",{children:["Select MIDI device:",Object(F.jsxs)("select",{className:"midi-select",defaultValue:"None",onChange:this.selectMidi,children:[Object(F.jsx)("option",{disabled:!0,value:"None",children:" None"}),a.map((function(e,t){return Object(F.jsx)("option",{value:e.id,children:e.name},t)}))]})]}),Object(F.jsx)("div",{style:{margin:"0.5rem 0"},children:"Click on the note to map, then press your MIDI keyboard"})]}),Object(F.jsxs)("div",{className:"midi-setup-content",children:[Object(F.jsx)("div",{className:"Genshin"===j?"keyboard":"keyboard keyboard-5",style:{marginTop:"auto",width:"fit-content"},children:n.notes.map((function(t,a){var r=R[n.notes.length][t.index];return Object(F.jsx)(xn,{handleClick:e.handleClick,data:t,noteImage:"./assets/icons/keys/".concat(r,".svg"),noteText:t.midi<0?"NA":t.midi},a)}))}),Object(F.jsxs)("div",{className:"midi-shortcuts-wrapper",children:[Object(F.jsx)("div",{style:{fontSize:"1.5rem"},children:"Shortcuts"}),Object(F.jsx)("div",{className:"midi-shortcuts",children:n.shortcuts.map((function(t){return Object(F.jsx)(On,{type:t.type,status:t.status,midi:t.midi,selected:r===t.type,onClick:e.handleShortcutClick},t.type)}))})]})]})]})]})}}]),n}(d.Component),wn=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Cn(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Nn=n(91),An=n(12);function En(e){var t=e.title,n=e.text,a=e.visible,r=e.onClick,s=a?"floating-message floating-message-visible":"floating-message";return Object(F.jsxs)("div",{className:s,onClick:r,children:[Object(F.jsx)("div",{className:"floating-message-title",children:t}),Object(F.jsx)("div",{className:"floating-message-text",children:n})]})}n(208);var Mn=n.p+"static/media/paypalme.45abe55e.png",Dn=n.p+"static/media/buymeacoffee.b124acdd.svg";function Tn(e){return Object(F.jsxs)("div",{className:"default-page",children:[Object(F.jsx)(Qt,{functions:{changePage:e.changePage}}),Object(F.jsxs)("div",{className:"donate-text",children:["Each App I make takes months of learning and development. Added to that are also the costs of hosting. With a higher budget I can afford to not worry so much about how much I spend on the server, giving you the best possible experience.",Object(F.jsx)("br",{}),"I care about giving users all features without having to pay for it, neither having intrusive ads which can be annoying. For this same reason, there is no source of income except donations.",Object(F.jsx)("br",{}),Object(F.jsx)("br",{}),"I would be really thankful if you could consider donating in order to fund development and costs."]}),Object(F.jsxs)("div",{className:"donation-wrapper",children:[Object(F.jsx)("a",{href:"https://paypal.me/specyDev",target:"_blank",className:"paypal",rel:"noreferrer",children:Object(F.jsx)("img",{src:Mn,alt:"paypalme",style:{height:"3rem"}})}),Object(F.jsx)("a",{href:"https://ko-fi.com/specy",target:"_blank",className:"kofi",rel:"noreferrer",children:Object(F.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWUAAACNCAMAAABYO5vSAAABIFBMVEX///8Auf4mJyoAAAD/XlsAu/8AoNwAt/4wMDAAtf7w8PAAv/8VFxsbHSDz8/OTk5XBwcLa2toICxG0tLT/XGP/W2kAvf//XWD/Wm3/W2jj4+QAJjXR0dEAR2L/WXEAlMsANUn/WHZUVVcABQ2dnZ0AaZDs+v+EhIYZGx7/V3r/WHT/U1AATWtERETE7P/V8v8Are6srK07PD9nZ2mG2P5Exv6h4P+25/9bW10AWXoREREAPlVxcnPj9f9hzP7R8f+q4v8Ae6n/3+NSy/7/S0d60P4AdaEAGCAAir7/vsX/ydD/fJH/Y4P/r73/7fD/iJP/oqz/ZHX/19r/Rmj/R1v/l6X/foj/tLX/fHn/qqj/aWYAExn/l5X/dnT/hoT/m5qa6M4eAAAQ3klEQVR4nO2d/UPaVhfHJSkGSMJLaGkbaXUEgVWxvCpWRK3Vdt3mttq12/p0+///iycvJDn35r4kMUAt+f6kQMLNJ4dzzzn3JRsbqb51tU7PDkdXV7PZ2NTl7OpqdHhw2lp1q74jtQ5Gs7Es5SVLGVv2n3mpNp6Njk5X3b7vQAejcdaDG5TJOiNfHaVGfQcdXebzVMAAdT4/PkxBx1HraJYJg9gjfXmego6os1ktAmJH+czl0arbfZ90dkn3xEyDlsYp55A6GEc2Y2DQtfNVt/8+yGQcG3HKOZxaszsytjmPz1Z9Hd+0DrPxfQWUNFr1lXy7OpMTMOQ55mzaDZI1SoyxpfxlGj4H1Ron4yw8SbWDVV/TN6eDhDwywjn1zqiS9Rau8pervq5vSknEbyRJcloXdZW4SwaYs2no7KglLwyypbQPtHS6gH4PKp9i3th4mV0oYwtzmqCc1hYN2XTO627NrSVANrXmXeBiOz5fax3QLS6Ew1Rb46LGbFmQM9J41de6Mh0uKOMjYp6t+mpXpLMlQjbjucNVX+9KtKTwwpP0ctVXvAotzynPJa/6ilegZTplR2vomk+XbcmZdUy1L1dAOVNb9VUvWUdL9xeW1m2ICokvsgmLgXmtMu0R8Be1zGbC6pk3Tq6RYH8HKWCx3C9NJ9N2v8z75Clg3NsVk5exc3zRy8pBzPe9A+xPDENRVFVVFEMt6czPXnmmnO1tLQCyo5Prnhww6HsdNPcHmir4Ujp95/V6e9iYTKtF5MPAlDOLg2zpeBO3Z+n+GrPe0ARMYsV8vTDQLOtWjRxi275Xlm138SqXqIRXrwDnHpbIczxzvd+v1rkXXGwOh80i92OJqmqoOGRBaZtvDJX5f50J+HjL7/rktyaIafItqpRLXZfzRQZxG8zB1uJU1DRNFDg9S1nRVFUTKom2maOyEWAsCOrQbLPi/asBYwYBRs/CsCCb0JuDuX/uQbchseYbTeYt1pjmXHY+pQ6WaM31oCFbTTAttOi/IwLK/hVnN00IwuKaVs7ZmLV3EHOeXptruvaiTqif8SCb96KZfJNp6hIpKyUa5XMJpZxbZOOac68BMEtX1E/7zTcK1A+VRc+SGotoMlHNQMfnYS10SJTHmSVS3tAnNuZriJn6YZHUXkxV/0OCupAmkwQgq5qmmEGF+UfHME15Qyf5ZRjGLYGya84AMzUzKYSg3IfX211Um3GBrs+YlHW9XJp2B92p00l7HgP8tmByvRTK5k/cku+bqf1fCMoQsiD2F9ZmTFPPK2jB7yyLlmWbNi76ffZ42bZs9s825p4f0FGmDfApN4G7EJThAtuMauCZK+k7C81GThhMAH9kSHVJlB1rPvHSE+mc/DEuZQSytoA4nybPKbBDTE/QYSROudro2hpOmygl2ze/8zBT8j8eZaSjN9rJtZunoucwVHaByBV0GElT1mEJo4vc9Yb5yhfPZVBmGnEolxCfXEqs2Xz5lJVw+aa0QMpVtFQEf9E6Ysx58uxENuU2THGNJSYk0Skf5JdHWeyCDHhq/r/jhhmUkSkmZQSyVk2s0WEUlfIogi2/NoW/dvP6w0/vgy87siifWIMl29cnDmb/PduYN12fQXbMLMpt6C40djVJrzdL7em0XapW6ClkFPEp68gXoeVeBuX3P//yo6lffv71xn/xw2/Pby09+fSedIxF+ZmczWZrcm37LeY0JkhqQvxOBuUpTEYUVkdfbw9UQ1E6qtpRNE1o9MP1VxQV6pbKfuLRr88FT1saCLlB2wPdyoej/PuPrn54cfvznPPNp9vntp48efLxjw/BoxzK8w4us2Nh9o2uD4M5cvmTTnkIIbMqnk1V8xNe55YYk/gV0qmhWQKnVDRXXa+JTusUL79G3XKmtk2k/OEHj7GlF7e/Wq9+9hmbevTx98BxkHImm7Gs+ZX3puUyjJ7rmIlTE6mUEcgDunH2O6SijioOY9pzQyGczjutNr97fdFt2fywcykE5Q+3ALEJ+cWL2z83NhxDfjLXo0cEzAjlTM36oYAkOAccM7kuR6M8BBfbGVBdrT4hFdrtg9RYuTilEOdhnpctvMTQmP9yR2Eo/wEYm4hfmHBv//z0xCNsIX706OnTjz9hB6KUM/Ix0gFajvnCdRnE7o9CGUJWGtTKfVUhloDnAOIkig3GCe3G2I0EXeM8hr8kUMYL5n//AKzYZozasIPY1MOH2BVjlG2v7+Nqm//sMrs/MmX4s9XopYsSzZDnBLqRB1aKA+YZ52OroIrvUsZGlG3KWCm8+AdixYCwy/jpnPHDx5/RQzHKmZoVz3mRrVXM2Pe6P1L2R6JchJAZFtlmQzZ/37nIUR3Plp3uLkC5leVT/nCLIH5OQ2xRfsimbLsMLxO2KnM77lvE7I9AGYVML100MchWFKegLsTrnEKrzer8rPJ2kUj5ZYZP+fMtFTEkbEF+vHeDHBqgfG2+4JGpmP9seZRJlfwgZQSySM+qy7BYJyhit92sVvulhgj7L4U1mEiSrjKNef4zDVA+k/iUf38eQPyEiNjUHho0BzzGO5iYWKHcW/ctYvEzQLk48MfUBIMeJxSQGT9gZlWxn4NePWqFSRc0pWMKnF7tOFI0tz2xKP9HMuOnJMZ8ytuQctEazfYokwJmnHJhAC6PVboYgpuhTdFurgQxh6sOA5WbbVNDvx3TtqNS33XzAcpYUkKxZQ7ix64ePOBRvsBt2fMYxHoRRllHRucZpQs4ISU4YlT2vUbcgUL/FEowvwlQxueGE/0y31HYhC3toWWjgF/ehZQtv3ySDU9ZHyB+gJEmg1jAIFg8cNqkt0MIUA42I0D5nOQxsD7h/UcsLKYhNvUGPZQYyXm2ZcUYz9xIjpj8IZR1Aet6qAzq/mFkzwtzOOpZWIpG+TCEX775CAMKBmJTf6GHsrOSKsxKiOulAGWtjEPuUBMS32vSPIJv7AbqeAq4yKXSaJRHJMr47f0Uxoodh4Gl2OwMewozbOJsgQISj+GiztcCDoHSu9W9HhAZg+4PNBGXRqosJWDLeB3j80dqb4cLOxKlLG+j1aIuLOPHoCxQyso+AvrsuolPwjdWcrqo5IKYE/DLOOXiw3CIH+z9jR2JUJZtf+Gf3A6X3con1y8TlSOWIqb+MD41Dqlqwc9UKBW3TvBeRaOMxxjkKv7nj2xH4eqfwLX4lGt2RiKC2TbWZIF9f34RJ8YgXz9x9iGo6VArFQXfVL3+sUTLn7WAMUejjMfLlLGSvx5zrNgx5cBoiUPZUmb7mQ0ZuNIcHMQOTVlFUJBcsw+QNR23G/zQkJY+iwGS0SjjuR9tROorF7EJ+XPgMIvy1vX18f7JfLVKG33vi//NvNzPbfekivyuCclbxbsPHcY8GM8x+zMGqXXNu9pyWMobXx+wEZuQ/xc8Cp8pAC3vFVJd5tYx5s0eYnNdhGD5sq5hF0lU28vBvaCHPO/bVHCKfzTKeE2OSrn4lUWYAnk+udNVFzbIKuGL4Jt5NTnHqOywawKKFISuCRBgzITxi5gewxKl9yO4pWiU8foyfabAzT9syP+SDir4iDtDpL+3Z30CU+bWl+3LdZLzQg55ETfYajjK3q3yKBeDC8vsLyB0sdEo42MljPkYN9Ehm9FaqV0qlZr9so7+6AoqrHralDljJQKo2dcRGiIWrgHKDL/sd3XA5zSFQFIiDkhuJyJlbNyPNbeIgXnvK/1yiLIXS20jC/9IH0Mog4ERdCxZRV0zSEoYI6igoBRjulFEyqPwlOlOY+8vyhEUFbu4v+CPYQsGtCk4io2v2fEtnbWYJ0xQTVdEyucEytQy1euEINuWvI9YMnc+BhYv5GA8gLrmCrgD9Kkafg8aZ5FgRMoHhBlcIvXkr/cScBd1yyf75fs5Zc7cItws0WwYKawVKa8jAstR4hTyI1LG5sk5a1fpZyf45qiQS3afsoN+LXeeXODH30cqOxo0Wi+tY6QlfrWIuDCEp4iU8SCDQ9n0zZg506ILWvNsQxafZfAdHIifZlBGR+2ROrIfpMGCGyLwU2CFe/TLiEgZ6/54lM30BMFMTEaox1bnK96vA7tk8OYvEzoyJFWDQRsY9aPFcqBkEX2AdSM6ZcwxcymbyfZeLMiFcrvjMP6yHdjzhTsXn0BZR4JpWOQEbwQLPZbg6Gus5a5RKW9EtGVT/+5FglzQ9XK/PfDC/OtMcKdLyu4NTMrYzBawWGkKrZzgM3QAmZW50BWZ8hi9XoNPeeO/OeZA1T6gKZ5JGce9gCFnQqyRIoa+yKIH4JorcGV2cOJtBd4E+vpuliJTRh2z/CUE5Y2/34SDXMcY71wTGYdY70dOMCYU1wxfV3OY40WGaTvxVmJGpoxuBxyO8sbnN8R6Mi6k8rmzu5khM6ZEy3zKfsHekj+3At2GRSkBc9bbaKQdb/FDZMqoywhJ2cT8hrheB5VD+cvbZ7sXm5lscP8tT5S9+3iU4cwLAbrmKTKioqjTsp3gFapDBR1ribkUMzplxGXY+xaFub8fKIvPEFkZyO7YGpEibtnnmTJ/TwFaSaJJds0g/3Pe0cRctyuIGlqoj73TQ3TKcH+MjLwVknIoobPtqQqxPwa18APnHYK4rcwZl6UiCqfolBGXkSxla+XIO/4O5dS9XkJQLsC6Ecjj+iEw45Xp8IpBGdblbMpxsiGSilZRfJP7wCT6vkUhKCMlfRj8NrmY77BnSQzKLWjL1oB+UmuarUmdX3pUup7DoO7BFYYyrBshNQlkF5ig1E5sS+ZRDqyRsgX6P3vua1J7IFhu+YTrlln7yfmUGZUzP6AwkBSjrEKfjUnBw+hIAj8gQnXaew8ZlwV7I9ozgJLaycoK4y64bpm1N6I3bkTYHciXO69Zw7LlwpDmNVSxfbcN/twBXoWU1XiD4ehEDhjMiYk5Zns/F77DYO3z6cbD7F0PdaFjkwvae3mAxW7O2YzGXa+wItrnVVRiuwbOrwtzvSCYsx1zIjtkWF5ZPOY7DOaetWVruYxidNnVBn2SU9QGsTspNzooaFUThglYUaWhGEZnSLn5bWsRfA53/P7+y/aszyT2U9WFcKbM2X+5UG23S/x+qlCh3ge9PxwYmmJL0wbT6p12bvBVKdfpZypUKpXAHYDGvJ8I5rpdTL7me+VlbL9c1Mv9JmleyJLle+Zsz94upHun1KTglDz3uZC/g33xo8jnUes5NbRus64X8WUWxUI9oHLVVXOuhnOGE667WLNnPMCRqdrmW7z4HkvHfMj5NXteCZzLVes9uzvjrRAFjLV79g76HKna5h0fQrB1QRjdC5ry/X3yQFwh66Wycu9if2eLrB1MJ/tzHe86uujJYZ4VuIbPRMOfbJutybHFrNmDr1j1Fa9Cp3wuiYr5cIfvV/iKqQVDXrf4wtUofYbwMpQ+D3spWtqz3WmTA9ZC+KKpRYmy4fK6qMUnlICk9QwvfL1cgjXf46fNJaXFY17DxDqo0+xiu8A1zUZwteSFYl7vjs9Xa3EBnVSjP2du7TRbUBYoyescJwe0mGQ7z3ou5TrqYAF9IGUp1DqrdZmwOUu1NLggKFmvkb+kPF9u3XUgJ8ZZyqapCFWHyXhnKfXITLWuEsAsjdMgmaOD8R3dRl5OnUUInY3z8Q06ZRxaZzMpFmdJGqfRWwS9nGUjG7SUuUwZR1TrKJJBS/nxYVqziKPWoZwPY9GSlK+NUsTx1ToajU2KVNQm4Iw8O0oR31mtg9FsLEt5SfJxW3/mpdp4NkoJJ6jW6dnh6Go2G4/H8ng8m11dHR6cppWKVCvR/wHDcffSeAGLqQAAAABJRU5ErkJggg==",alt:"kofi",style:{height:"2rem"}})}),Object(F.jsx)("a",{href:"https://www.buymeacoffee.com/specy",target:"_blank",rel:"noreferrer",children:Object(F.jsx)("img",{src:Dn,alt:"buymeacoffee",style:{height:"3rem"}})})]})]})}var Pn=n.p+"static/media/rotate.e7c0f107.svg",In=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;Object(o.a)(this,n),(a=t.call(this,e)).handleResize=function(){var e;if("INPUT"===(null===(e=document.activeElement)||void 0===e?void 0:e.tagName)){if(a.pageHeight===window.innerHeight||0!==a.pageHeight)return;return a.setHeight(a.pageHeight)}a.pageHeight=window.innerHeight,a.resetHeight()},a.setHeight=function(e){document.body.style.minHeight=e+"px"},a.resetHeight=function(){document.body.style=""},a.handleBlur=function(){var e=document.activeElement;"INPUT"===e.tagName&&(null===e||void 0===e||e.blur()),a.resetHeight()},a.changePage=function(e){if("home"===e)return a.toggleHome(!0);a.state.homeData.visible&&a.toggleHome(!1),a.setState({selectedPage:e,homeVisible:!1}),Pe.pageView({page_title:e}),document.title=""===e?"Player":e},a.toggleHome=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=a.state.homeData;if(e)return a.setState({homeData:Object(i.a)(Object(i.a)({},t),{},{visible:!0,isInPosition:!1})});a.setState({homeData:Object(i.a)(Object(i.a)({},t),{},{isInPosition:!0})},(function(){setTimeout((function(){a.setState({homeData:Object(i.a)(Object(i.a)({},t),{},{visible:!1})})}),150)}))},a.setDontShowHome=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];localStorage.setItem(j+"_ShowHome",e);var t=a.state.homeData;a.setState({homeData:Object(i.a)(Object(i.a)({},t),{},{canShow:e})})},a.askForStorage=Object(s.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!navigator.storage||!navigator.storage.persist){e.next=6;break}return e.next=4,navigator.storage.persist();case 4:e.sent&&new Q("Success","Storage permission allowed").trigger();case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),new Q("Error","There was an error with setting up persistent storage").trigger();case 12:a.closeWelcomeScreen();case 13:case"end":return e.stop()}}),e,null,[[0,8]])}))),a.closeWelcomeScreen=function(){localStorage.setItem(j+"_Visited",!0),a.setState({hasVisited:!0})},a.hideMessage=function(){var e=a.state;e.floatingMessage.visible=!1,a.setState({floatingMessage:e.floatingMessage})},a.checkUpdate=Object(s.a)(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve(1e3);case 2:if(!a.updateChecked){e.next=4;break}return e.abrupt("return");case 4:if(t=localStorage.getItem(j+"_Version"),a.state.hasVisited){e.next=7;break}return e.abrupt("return",localStorage.setItem(j+"_Version",x));case 7:if(x!==t&&(new Q("Update V2.3",y,6e3).trigger(),localStorage.setItem(j+"_Version",x)),a.updateChecked=!0,a.state.hasVisited){e.next=11;break}return e.abrupt("return");case 11:if(!navigator.storage||!navigator.storage.persist){e.next=20;break}return e.next=14,navigator.storage.persisted();case 14:if(n=e.sent){e.next=19;break}return e.next=18,navigator.storage.persist();case 18:n=e.sent;case 19:console.log(n?"Storage Persisted":"Storage Not persisted");case 20:case"end":return e.stop()}}),e)}))),a.logEvent=function(e){(e=e.detail).timestamp=(new Date).getTime(),"object"===typeof e&&(a.setState({floatingMessage:{timestamp:e.timestamp,visible:!0,text:e.text,title:e.title}}),setTimeout((function(){a.state.floatingMessage.timestamp===e.timestamp&&a.setState({floatingMessage:{timestamp:0,visible:!1,text:"",title:""}})}),e.timeout))};var c=window.location.href.split("/");c=0===c.length?"":c=c[c.length-1],O.includes(c)||(c="");var l=localStorage.getItem(j+"_Visited"),u=localStorage.getItem(j+"_ShowHome");return u=null===u?"true":u,a.state={floatingMessage:{timestamp:0,visible:!1,text:"Text",title:"Title"},homeData:{canShow:"true"===u,visible:"true"===u,isInPosition:!1,hasPersistentStorage:Boolean(navigator.storage&&navigator.storage.persist)},selectedPage:c,hasVisited:"true"===l},a.updateChecked=!1,a.pageHeight=0,a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("logEvent",this.logEvent),window.addEventListener("resize",this.handleResize),window.addEventListener("blur",this.handleBlur),this.checkUpdate(),Pe.UIEvent("version",{version:x}),this.pageHeight=window.innerHeight,document.title=this.state.selectedPage}},{key:"componentWillUnmount",value:function(){window.removeEventListener("logEvent",this.logEvent),window.removeEventListener("resize",this.handleResize),window.removeEventListener("blur",this.handleBlur)}},{key:"componentDidCatch",value:function(){this.setState({selectedPage:"ErrorPage"})}},{key:"render",value:function(){var e=this.state,t=e.floatingMessage,n=e.hasVisited,a=e.homeData,r=e.selectedPage;return Object(F.jsxs)("div",{className:"index",children:[Object(F.jsx)(En,{title:t.title,visible:t.visible,onClick:this.hideMessage,text:t.text}),a.visible&&Object(F.jsx)(ln,{toggleHome:this.toggleHome,changePage:this.changePage,setDontShowHome:this.setDontShowHome,askForStorage:this.askForStorage,hasVisited:n,data:a,currentPage:r}),Object(F.jsxs)(Nn.a,{children:[Object(F.jsx)(An.a,{to:"/"+this.state.selectedPage}),"ErrorPage"===this.state.selectedPage?Object(F.jsx)(An.b,{exact:!0,path:"/ErrorPage",children:Object(F.jsx)($t,{changePage:this.changePage})}):Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(An.b,{exact:!0,path:"/ErrorPage",children:Object(F.jsx)($t,{changePage:this.changePage})}),Object(F.jsx)(An.b,{exact:!0,path:"/",children:Object(F.jsx)(vt,{changePage:this.changePage})}),Object(F.jsx)(An.b,{exact:!0,path:"/Composer",children:Object(F.jsx)(Xt,{changePage:this.changePage})}),Object(F.jsx)(An.b,{exact:!0,path:"/Donate",children:Object(F.jsx)(Tn,{changePage:this.changePage})}),Object(F.jsx)(An.b,{exact:!0,path:"/Changelog",children:Object(F.jsx)(en,{changePage:this.changePage})}),Object(F.jsx)(An.b,{exact:!0,path:"/Partners",children:Object(F.jsx)(rn,{changePage:this.changePage})}),Object(F.jsx)(An.b,{exact:!0,path:"/Help",children:Object(F.jsx)(mn,{changePage:this.changePage})}),Object(F.jsx)(An.b,{exact:!0,path:"/SheetVisualizer",children:Object(F.jsx)(pn,{changePage:this.changePage})}),Object(F.jsx)(An.b,{exact:!0,path:"/MidiSetup",children:Object(F.jsx)(Sn,{changePage:this.changePage})})]})]}),Object(F.jsxs)("div",{className:"rotate-screen",children:[Object(F.jsx)("img",{src:Pn,alt:"icon for the rotating screen"}),"For a better experience, add the website to the home screen, and rotate your device"]})]})}}]),n}(d.Component);g.a.render(Object(F.jsx)(h.a.StrictMode,{children:Object(F.jsx)(In,{})}),document.getElementById("root")),function(){if(V())return console.log("inTWA");var e=document.referrer.includes("android-app://");sessionStorage.setItem("isTwa",e)}(),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat(".","/service-worker.js");wn?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Cn(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Cn(t,e)}))}}()},99:function(e,t,n){}},[[213,1,2]]]);
//# sourceMappingURL=main.2ae954ae.chunk.js.map