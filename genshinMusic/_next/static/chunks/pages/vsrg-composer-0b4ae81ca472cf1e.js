(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6747],{37347:function(n){!function(){function p(n,a){document.addEventListener?n.addEventListener("scroll",a,!1):n.attachEvent("scroll",a)}function w(n){this.g=document.createElement("div"),this.g.setAttribute("aria-hidden","true"),this.g.appendChild(document.createTextNode(n)),this.h=document.createElement("span"),this.i=document.createElement("span"),this.m=document.createElement("span"),this.j=document.createElement("span"),this.l=-1,this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.h.appendChild(this.m),this.i.appendChild(this.j),this.g.appendChild(this.h),this.g.appendChild(this.i)}function x(n,a){n.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+a+";"}function B(n){var a=n.g.offsetWidth,o=a+100;return n.j.style.width=o+"px",n.i.scrollLeft=o,n.h.scrollLeft=n.h.scrollWidth+100,n.l!==a&&(n.l=a,!0)}function C(n,a){function b(){B(o)&&null!==o.g.parentNode&&a(o.l)}var o=n;p(n.h,b),p(n.i,b),B(n)}function D(n,a,o){a=a||{},o=o||window,this.family=n,this.style=a.style||"normal",this.weight=a.weight||"normal",this.stretch=a.stretch||"normal",this.context=o}var a=null,o=null,l=null,m=null;function M(n){return null===m&&(m=!!n.document.fonts),m}function N(n,a){var o=n.style,m=n.weight;if(null===l){var j=document.createElement("div");try{j.style.font="condensed 100px sans-serif"}catch(n){}l=""!==j.style.font}return[o,m,l?n.stretch:"","100px",a].join(" ")}D.prototype.load=function(n,l){var m=this,j=n||"BESbswy",S=0,T=l||3e3,_=(new Date).getTime();return new Promise(function(n,l){if(M(m.context)&&(H=m.context,null===o&&(o=!!(M(H)&&/Apple/.test(window.navigator.vendor))&&!!(H=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent))&&603>parseInt(H[1],10)),!o)){var H,P,O=new Promise(function(n,a){!function h(){(new Date).getTime()-_>=T?a(Error(""+T+"ms timeout exceeded")):m.context.document.fonts.load(N(m,'"'+m.family+'"'),j).then(function(a){1<=a.length?n():setTimeout(h,25)},a)}()});Promise.race([new Promise(function(n,a){S=setTimeout(function(){a(Error(""+T+"ms timeout exceeded"))},T)}),O]).then(function(){clearTimeout(S),n(m)},l)}else P=function(){function r(){var o;(o=-1!=O&&-1!=E||-1!=O&&-1!=z||-1!=E&&-1!=z)&&((o=O!=E&&O!=z&&E!=z)||(null===a&&(a=!!(o=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent))&&(536>parseInt(o[1],10)||536===parseInt(o[1],10)&&11>=parseInt(o[2],10))),o=a&&(O==R&&E==R&&z==R||O==A&&E==A&&z==A||O==V&&E==V&&z==V)),o=!o),o&&(null!==J.parentNode&&J.parentNode.removeChild(J),clearTimeout(S),n(m))}var o=new w(j),H=new w(j),P=new w(j),O=-1,E=-1,z=-1,R=-1,A=-1,V=-1,J=document.createElement("div");J.dir="ltr",x(o,N(m,"sans-serif")),x(H,N(m,"serif")),x(P,N(m,"monospace")),J.appendChild(o.g),J.appendChild(H.g),J.appendChild(P.g),m.context.document.body.appendChild(J),R=o.g.offsetWidth,A=H.g.offsetWidth,V=P.g.offsetWidth,function t(){if((new Date).getTime()-_>=T)null!==J.parentNode&&J.parentNode.removeChild(J),l(Error(""+T+"ms timeout exceeded"));else{var n=m.context.document.hidden;(!0===n||void 0===n)&&(O=o.g.offsetWidth,E=H.g.offsetWidth,z=P.g.offsetWidth,r()),S=setTimeout(t,50)}}(),C(o,function(n){O=n,r()}),x(o,N(m,'"'+m.family+'",sans-serif')),C(H,function(n){E=n,r()}),x(H,N(m,'"'+m.family+'",serif')),C(P,function(n){z=n,r()}),x(P,N(m,'"'+m.family+'",monospace'))},document.body?P():document.addEventListener?document.addEventListener("DOMContentLoaded",function b(){document.removeEventListener("DOMContentLoaded",b),P()}):document.attachEvent("onreadystatechange",function g(){("interactive"==document.readyState||"complete"==document.readyState)&&(document.detachEvent("onreadystatechange",g),P())})})},n.exports=D}()},40120:function(n,a,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/vsrg-composer",function(){return o(89143)}])},68929:function(n,a,o){"use strict";o.d(a,{A:function(){return ShortcutsTable},s:function(){return Key}});var l=o(91309),m=o(85893),j=o(76577),S=o.n(j);function Key(n){var a=n.children;return(0,m.jsx)("div",{className:"keyboard-key",children:a})}function ShortcutsTable(n){var a=n.shortcuts,o=n.className,j=n.style;return(0,m.jsx)("table",{className:"".concat(S()["keys-table"]," ").concat(o),style:j,children:(0,m.jsx)("tbody",{children:Array.from(a.entries()).map(function(n){var a=(0,l._)(n,2),o=a[0],j=a[1],S=j.name,T=j.description,_=j.holdable;return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)(Key,{children:o})}),(0,m.jsxs)("td",{children:[null!=T?T:S,_&&(0,m.jsx)("span",{style:{fontSize:"0.8rem"},children:" (Holdable)"})]})]},S)})})})}},3924:function(n,a,o){"use strict";o.d(a,{k:function(){return MultipleOptionSlider}});var l=o(91309),m=o(85893),j=o(73288),S=o(67294);function MultipleOptionSlider(n){var a=n.options,o=n.selected,T=n.onChange,_=(0,S.useRef)(null),H=a.find(function(n){return n.value===o}),P=(0,l._)((0,S.useState)({width:0,left:0}),2),O=P[0],E=P[1];return(0,S.useEffect)(function(){var n,l=null===(n=_.current)||void 0===n?void 0:n.querySelectorAll("button"),m=a.findIndex(function(n){return n.value===o});if(l&&!(m<0)){var j=l[m].getBoundingClientRect(),S=_.current.getBoundingClientRect();E({width:j.width,left:j.left-S.left})}},[_,a,o]),(0,m.jsxs)("div",{className:"multiple-option-slider",ref:_,children:[a.map(function(n){return(0,m.jsx)("button",{onClick:function(){return T(n.value)},className:n===H?"multiple-options-selected":"",children:(0,j.kC)(n.value)},n.value)}),(0,m.jsx)("div",{className:"multiple-option-slider-overlay",style:{width:"".concat(O.width,"px"),left:"".concat(O.left,"px"),backgroundColor:null==H?void 0:H.color}})]})}},87036:function(n,a,o){"use strict";o.d(a,{O:function(){return InstrumentSelect}});var l=o(72253),m=o(85893),j=o(1062),S=o(31611),T=o.n(S),_=[],H=[],P=!0,O=!1,E=void 0;try{for(var z,R=j.BX[Symbol.iterator]();!(P=(z=R.next()).done);P=!0){var A=z.value;A.startsWith("SFX")?H.push(A):_.push(A)}}catch(n){O=!0,E=n}finally{try{P||null==R.return||R.return()}finally{if(O)throw E}}function InstrumentSelect(n){var a=n.selected,o=n.onChange,j=n.style;return(0,m.jsx)("select",{className:T().select,style:(0,l._)({width:"100%",padding:"0.3rem"},j),onChange:function(n){o(n.target.value),n.target.blur()},value:a,children:0===H.length?(0,m.jsx)(m.Fragment,{children:_.map(function(n){return(0,m.jsx)("option",{value:n,children:n.replace("-"," ")},n)})}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("optgroup",{label:"Instruments",children:_.map(function(n){return(0,m.jsx)("option",{value:n,children:n.replace("-"," ")},n)})}),(0,m.jsx)("optgroup",{label:"SFX",children:H.map(function(n){return(0,m.jsx)("option",{value:n,children:n.replace("-"," ").replace("SFX_","")},n)})})]})})}},55342:function(n,a,o){"use strict";o.d(a,{x:function(){return PitchSelect}});var l=o(72253),m=o(85893),j=o(1062),S=o(31611),T=o.n(S);function PitchSelect(n){var a=n.selected,o=n.onChange,S=n.style,_=n.children,H=n.className;return(0,m.jsxs)("select",{className:"".concat(T().select," ").concat(null!=H?H:""),style:(0,l._)({width:"100%",padding:"0.3rem"},S),onChange:function(n){o(n.target.value),n.target.blur()},value:a,children:[_,j.T_.map(function(n){return(0,m.jsx)("option",{children:n},n)})]})}},55457:function(n,a,o){"use strict";o.d(a,{P:function(){return Select}});var l=o(72253),m=o(91309),j=o(85893),S=o(18212),T=o(31611),_=o.n(T),H=o(67294);function Select(n){var a=n.onChange,o=n.value,T=n.children,P=n.style,O=(0,m._)((0,S.F)(),1)[0],E=(0,H.useCallback)(function(n){a(n),n.target.blur()},[a]);return(0,j.jsx)("select",{onChange:E,value:o,className:_().select,style:(0,l._)({backgroundImage:"url(\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' height='24' viewBox='0 0 24 24' width='24' fill='".concat(O.getText("primary").hex().replace("#","%23"),"'><path d='M0 0h24v24H0z' fill='none'/><path d='M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z'/></svg>\")")},P),children:T})}},79301:function(n,a,o){"use strict";o.d(a,{k:function(){return HelpTooltip}});var l=o(85893),m=o(67294),j=o(30080);function HelpTooltip(n){var a=n.children,o=n.maxWidth,S=n.buttonStyle,T=n.parentStyle,_=n.width,H=(0,m.useRef)(null);return(0,l.jsxs)("div",{className:"help-tooltip",style:T,children:[(0,l.jsx)("button",{ref:H,className:"help-tooltip-button",style:S,"aria-label":"Help",onClick:function(){var n;return null===(n=H.current)||void 0===n?void 0:n.focus()},children:(0,l.jsx)(j.$x8,{style:{width:"100%",height:"100%"}})}),(0,l.jsx)("div",{className:"help-tooltip-content",style:{maxWidth:"".concat(void 0===o?20:o,"rem"),width:void 0!==_?"".concat(_,"rem"):"unset"},children:a})]})}},35763:function(n,a,o){"use strict";o.d(a,{h:function(){return Header}});var l=o(72253),m=o(14932),j=o(85893),S=new Map([["h1","2rem"],["h2","1.5rem"],["h3","1.25rem"],["h4","1.1rem"],["h5","1rem"],["h6","1rem"]]);function Header(n){var a,o=n.className,T=n.style,_=n.textSize,H=n.children,P=n.type,O=void 0===P?"h1":P,E=n.margin,z={className:o,style:(0,l._)({fontSize:_||(null!==(a=S.get(O))&&void 0!==a?a:"2rem"),margin:void 0===E?"0":E},T)};return"h1"===O?(0,j.jsx)("h1",(0,m._)((0,l._)({},z),{children:H})):"h2"===O?(0,j.jsx)("h2",(0,m._)((0,l._)({},z),{children:H})):"h3"===O?(0,j.jsx)("h3",(0,m._)((0,l._)({},z),{children:H})):"h4"===O?(0,j.jsx)("h4",(0,m._)((0,l._)({},z),{children:H})):"h5"===O?(0,j.jsx)("h5",(0,m._)((0,l._)({},z),{children:H})):(0,j.jsx)("h6",(0,m._)((0,l._)({},z),{children:H}))}},56425:function(n,a,o){"use strict";o.d(a,{s:function(){return Column}});var l=o(72253),m=o(85893),j=o(38399);function Column(n){var a=n.children,o=n.className,S=n.style,T=n.gap,_=n.flex1,H=n.justify,P=n.align,O=n.padding;return(0,m.jsx)("div",{className:"column ".concat(null!=o?o:""),style:(0,l._)({gap:T,flex:_?1:void 0,justifyContent:H?j.q[H]:void 0,alignItems:P?j.q[P]:void 0,padding:O},S),children:a})}},38399:function(n,a,o){"use strict";o.d(a,{q:function(){return l}});var l={start:"flex-start",end:"flex-end",center:"center",between:"space-between",around:"space-around",evenly:"space-evenly"}},94146:function(n,a,o){"use strict";o.d(a,{F:function(){return AppLink}});var l=o(72253),m=o(14932),j=o(47702),S=o(85893),T=o(41664),_=o.n(T);function AppLink(n){var a=n.href,o=n.children,T=n.style,H=(0,j._)(n,["href","children","style"]);return(0,S.jsx)(_(),(0,m._)((0,l._)({href:a,style:(0,l._)({display:"inline-block",textDecoration:"underline",color:"var(--accent)"},T)},H),{children:o}))}},12118:function(n,a,o){"use strict";o.d(a,{z:function(){return _}});var l=o(11010),m=o(48564),j=o(97582),S=o(42678),T=o(81883),_=function(){function AudioPlayer(n){(0,m._)(this,AudioPlayer),this.instruments=[],this.audioInstruments=[],this.basePitch="C",this.basePitch=n}var n=AudioPlayer.prototype;return n.setBasePitch=function(n){this.basePitch=n},n.destroy=function(){this.audioInstruments.forEach(function(n){T.n.disconnect(n.endNode),n.dispose()})},n.syncInstruments=function(n){return this.instruments=n,this.loadInstruments()},n.loadInstruments=function(){var n=this;return(0,l._)(function(){var a,o;return(0,j.Jh)(this,function(m){var _;return a=n.instruments,(o=n.audioInstruments).splice(a.length).forEach(function(n){T.n.disconnect(n.endNode),n.dispose()}),[2,Promise.all(a.map((_=(0,l._)(function(n,a){var l,m,_;return(0,j.Jh)(this,function(j){switch(j.label){case 0:if(void 0!==o[a])return[3,2];return l=new S.Yx(n.name),o[a]=l,[4,l.load(T.n.getAudioContext())];case 1:return j.sent(),T.n.connect(l.endNode,n.reverbOverride),l.changeVolume(n.volume),[2,l];case 2:if(o[a].name!==n.name)return[3,3];return o[a].changeVolume(n.volume),T.n.setReverbOfNode(o[a].endNode,n.reverbOverride),[2,o[a]];case 3:return m=o[a],T.n.disconnect(m.endNode),m.dispose(),_=new S.Yx(n.name),o[a]=_,[4,_.load(T.n.getAudioContext())];case 4:return j.sent(),T.n.connect(_.endNode,n.reverbOverride),_.changeVolume(n.volume),[2,_];case 5:return[2]}})}),function(n,a){return _.apply(this,arguments)})))]})})()},n.playNoteOfInstrument=function(n,a,o){var l=this.instruments[n];this.audioInstruments[n].play(a,null!=o?o:l.pitch||this.basePitch)},n.playNotesOfInstrument=function(n,a,o){var l=this;a.forEach(function(a){return l.playNoteOfInstrument(n,a,o)})},AudioPlayer}()},29053:function(n,a,o){"use strict";o.d(a,{v:function(){return j}});var l=o(48564),m=o(2267),j=function(){function ThrottledEventLoop(n,a){var o=this;(0,l._)(this,ThrottledEventLoop),this.nextTick=0,this.maxFpsInterval=0,this.deltaTime=0,this.raf=0,this.duration=0,this.previousTickTime=0,this.tick=function(){var n=Date.now();o.deltaTime=n-o.nextTick,o.deltaTime>=o.maxFpsInterval&&(o.nextTick=n-o.deltaTime%o.maxFpsInterval,o.callback(o.elapsed,n-o.previousTickTime),o.previousTickTime=n),o.elapsed=n-o.startTime,o.elapsed<o.duration&&(o.raf=setTimeout(o.tick,8))},this.callback=n,this.startTime=0,this.elapsed=0,this.maxFps=a,this.maxFpsInterval=1e3/a}var n=ThrottledEventLoop.prototype;return n.changeMaxFps=function(n){this.maxFps=n,this.maxFpsInterval=1e3/n},n.setCallback=function(n){this.callback=n},n.start=function(n){this.stop(),this.startTime=Date.now(),this.nextTick=Date.now(),this.previousTickTime=0,this.duration=null!=n?n:Number.MAX_SAFE_INTEGER,this.tick()},n.stop=function(){clearTimeout(this.raf)},(0,m._)(ThrottledEventLoop,[{key:"fps",get:function(){return this.maxFps}}]),ThrottledEventLoop}()},89143:function(n,a,o){"use strict";o.r(a),o.d(a,{default:function(){return VsrgcomposerPage}});var l=o(22678),m=o(11010),j=o(48564),S=o(18007),T=o(72253),_=o(14932),H=o(4586),P=o(53304),O=o(97582),E=o(85893),z=o(67294),R=o(91309),A=o(28796),V=o(86869),J=o(175),W=o(90337),$=o(66826),G=o(89413),et=o(5336),en=o(29179),er=o(79301),ei=o(51962),es=o(31047),ea=o(63805),eo=o.n(ea),el=o(75422),ec=o(4674),eu=o(60245),ed=o(41072),eh=o(18212),eg=o(26427),em=o(18208),ep=o(52091),ef=o(10398),ev=o(10681);function TrackModifier(n){var a=n.data,o=n.onChange,l=n.onVisibilityChange,m=n.theme,j=n.style,S=m.layer("menu_background",.2).desaturate(.5);return(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)("div",{className:"row-centered space-between track-modifier",style:(0,T._)({backgroundColor:S.hex()},j),children:[(0,E.jsx)("span",{className:"text-ellipsis",children:a.alias}),(0,E.jsxs)("div",{className:"row-centered",style:{justifyContent:"flex-end"},children:[(0,E.jsx)(A.J,{className:"flex-centered vsrg-track-modifier-button",onClick:function(){return l(!a.hidden)},children:a.hidden?(0,E.jsx)(ep.tgn,{}):(0,E.jsx)(ep.dSq,{})}),(0,E.jsx)(A.J,{className:"flex-centered vsrg-track-modifier-button",style:{marginLeft:"0.3rem"},onClick:function(){return o(a.set({muted:!a.muted}))},children:a.muted?(0,E.jsx)(ep.xZH,{}):(0,E.jsx)(ep.rxG,{})})]})]})})}var ex=o(22977),eb=o(49894),ey=o(38437),ek=o(68929),ej=o(56425),eS=o(94146),eC=o(35763);function VsrgComposerHelp(){var n=ex.z5.getVsrgKeybinds(6),a=(0,ey.Z)().IS_MOBILE,o=(0,R._)((0,eb.Kq)(ex.z5.getShortcutMap("vsrg_composer")),1)[0];return(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)(ej.s,{children:[(0,E.jsx)(eC.h,{type:"h2",children:"VSRG help"}),(0,E.jsxs)("p",{children:["To learn how to use this composer, visit the ",(0,E.jsx)(eS.F,{href:"/blog/how-to-use-vsrg-composer",children:"VSRG composer guide"}),"! ",(0,E.jsx)("br",{}),"There will be written a simple explanation of every function and setting in the composer."]}),!a&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(eC.h,{margin:"1rem 0",children:"VSRG Composer shortcuts"}),(0,E.jsxs)("p",{children:["The VSRG composer has some shortcuts you can use, if you want to change them, go to the ",(0,E.jsx)(eS.F,{href:"/keybinds",children:"keybinds page"})]}),(0,E.jsx)(ek.A,{shortcuts:o}),(0,E.jsxs)("div",{className:"row",style:{padding:"0.1rem",gap:"1rem",marginTop:"-0.1rem"},children:[(0,E.jsx)(ek.s,{children:n.join("/")}),(0,E.jsx)("div",{children:" Add hit object (syncs to the registered keybinds)"})]})]})]})})}var ew=o(37870),eT=o(31611),e_=o.n(eT),eH=o(1062),eN=(0,z.memo)(function(n){var a=n.onSave,o=n.onSongOpen,l=n.settings,m=n.handleSettingChange,j=n.hasChanges,S=n.onCreateSong,T=n.setAudioSong,_=n.audioSong,H=n.trackModifiers,P=n.onTrackModifierChange,O=(0,R._)((0,z.useState)(!1),2),et=O[0],en=O[1],es=(0,R._)((0,z.useState)(!1),2),ea=es[0],eg=es[1],em=(0,R._)((0,z.useState)("Settings"),2),ev=em[0],ex=em[1],eb=(0,R._)((0,eu.j)(),1)[0],ey=(0,R._)((0,ed.n)(),1)[0],ek=(0,R._)((0,eh.F)(),1)[0],ej=(0,ec.ZP)(function(n){en(!1),eo()()&&eg(!1)},{active:et&&ea,ignoreFocusable:!0}),eS=(0,z.useCallback)(function(n){"boolean"!=typeof n&&(n=void 0),eg(function(a){return void 0!==n?n:!a})},[]),eC=(0,z.useCallback)(function(n){if(n===ev&&et)return en(!1);en(!0),n&&(ex(n),el.Z.UIEvent("menu",{tab:n}))},[et,ev]),ew=ea?"menu menu-visible":"menu",eT=et&&ea?"side-menu menu-open":"side-menu";return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{className:"hamburger vsrg-hamburger",onClick:function(){return eg(!ea)},children:(0,E.jsx)(ei.Z,{children:(0,E.jsx)(ep.Fm7,{})})}),(0,E.jsxs)("div",{className:"menu-wrapper",ref:ej,children:[(0,E.jsxs)("div",{className:ew,children:[(0,E.jsx)($.s,{onClick:function(){return eS(!1)},className:"close-menu",ariaLabel:"Close menu",children:(0,E.jsx)(ep.aHS,{className:"icon"})}),(0,E.jsx)($.s,{onClick:a,className:"margin-top-auto ".concat(j?"not-saved":""),ariaLabel:"Save",children:(0,E.jsx)(ei.Z,{children:(0,E.jsx)(ep.TvB,{className:"icon"})})}),(0,E.jsx)($.s,{onClick:function(){return eC("Help")},isActive:et&&"Help"===ev,ariaLabel:"Help",children:(0,E.jsx)(ei.Z,{children:(0,E.jsx)(ep.g_g,{className:"icon"})})}),(0,E.jsx)($.s,{onClick:function(){return eC("Songs")},isActive:et&&"Songs"===ev,ariaLabel:"Song menu",children:(0,E.jsx)(ei.Z,{children:(0,E.jsx)(ep.HcQ,{className:"icon"})})}),(0,E.jsx)($.s,{onClick:function(){return eC("Settings")},isActive:et&&"Settings"===ev,ariaLabel:"Settings menu",children:(0,E.jsx)(ei.Z,{children:(0,E.jsx)(ep.p4t,{className:"icon"})})}),(0,E.jsx)($.s,{onClick:ef.I.open,ariaLabel:"Open home menu",style:{border:"solid 0.1rem var(--secondary)"},children:(0,E.jsx)(ei.Z,{children:(0,E.jsx)(ep.xng,{className:"icon"})})})]}),(0,E.jsxs)("div",{className:eT,children:[(0,E.jsx)(J.Z,{current:ev,id:"Help",children:(0,E.jsx)(VsrgComposerHelp,{})}),(0,E.jsxs)(J.Z,{current:ev,id:"Songs",children:[(0,E.jsx)("div",{className:"row",children:(0,E.jsx)(A.J,{onClick:S,children:"Create song"})}),(0,E.jsx)(W.G,{songs:ey,exclude:["composed","recorded"],style:{marginTop:"0.6rem"},SongComponent:SongRow,componentProps:{theme:ek,folders:eb,functions:{onClick:o,toggleMenu:eS}}})]}),(0,E.jsxs)(J.Z,{current:ev,id:"Settings",children:[(0,E.jsx)(G.A,{settings:l,onUpdate:m}),(0,E.jsxs)("div",{className:"column vsrg-select-song-wrapper",children:[(0,E.jsxs)("h1",{className:"".concat(e_()["settings-group-title"]," row-centered"),children:["Background Song",(0,E.jsx)(er.k,{buttonStyle:{width:"1.2rem",height:"1.2rem",marginLeft:"0.5rem"},children:"You can select one of your songs to be played on the background"})]}),null===_?(0,E.jsx)("span",{children:"No background song selected"}):(0,E.jsxs)("div",{className:"column vsrg-composer-selected-song",children:[(0,E.jsxs)("div",{className:"row",style:{borderBottom:"2px solid var(--secondary)",paddingBottom:"0.4rem",marginBottom:"0.4rem"},children:[(0,E.jsx)("span",{className:"song-name",style:{cursor:"default"},children:_.name}),(0,E.jsx)(V.v,{onClick:function(){return T(null)},ariaLabel:"Remove background song",tooltip:"Remove background song",style:{backgroundColor:"var(--red-bg)",margin:0},children:(0,E.jsx)(ep.aHS,{})})]}),(0,E.jsxs)("div",{className:"row-centered space-between",children:[(0,E.jsx)("span",{children:"Pitch"}),(0,E.jsx)("span",{children:_.pitch})]}),(0,E.jsxs)("div",{className:"row-centered space-between",children:[(0,E.jsx)("span",{children:"BPM"}),(0,E.jsx)("span",{children:_.bpm})]}),(0,E.jsx)("span",{style:{marginTop:"0.4rem"},children:"Instrument modifiers"}),H.map(function(n,a){return(0,E.jsx)(TrackModifier,{theme:ek,data:n,onChange:function(n){return P(n,a,!1)},onVisibilityChange:function(o){P(n.set({hidden:o}),a,!0)}},a)})]}),(0,E.jsx)(W.G,{songs:ey,exclude:["vsrg"],style:{marginTop:"0.6rem"},SongComponent:SelectSongRow,componentProps:{onClick:T}})]})]})]})]})]})},function(n,a){return n.settings===a.settings&&n.hasChanges===a.hasChanges&&n.audioSong===a.audioSong&&n.trackModifiers===a.trackModifiers});function SelectSongRow(n){var a=n.data,o=n.onClick;return(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)("div",{className:"song-row ".concat((0,es.h)(!0)),onClick:(0,m._)(function(){var n;return(0,O.Jh)(this,function(l){switch(l.label){case 0:return[4,em.v.getOneSerializedFromStorable(a)];case 1:if(!(n=l.sent()))return[2,ew.kg.error("Could not find song")];return o(n),[2]}})}),style:{cursor:"pointer"},children:[(0,E.jsx)("div",{className:"song-name",children:a.name}),(0,E.jsx)(es.u,{children:"Click to select as background song"})]})})}function SongRow(n){var a,o=n.data,l=n.functions,j=n.theme,S=n.folders,T=l.toggleMenu,_=l.onClick,H={backgroundColor:j.layer("primary",.15).toString()},P=(0,R._)((0,z.useState)(!1),2),A=P[0],V=P[1],J=(0,R._)((0,z.useState)(o.name),2),W=J[0],$=J[1];return((0,z.useEffect)(function(){$(o.name)},[o.name]),"vsrg"!==o.type)?(0,E.jsx)("div",{className:"row",children:"Invalid song"}):(0,E.jsxs)("div",{className:"song-row",children:[(0,E.jsxs)("div",{className:"song-name ".concat((0,es.h)(!0)),onClick:(0,m._)(function(){var n;return(0,O.Jh)(this,function(a){switch(a.label){case 0:if(A)return[2];return[4,em.v.fromStorableSong(o)];case 1:if(!(n=a.sent()))return[2,ew.kg.error("Could not find song")];return _(n),T(!1),[2]}})}),children:[A?(0,E.jsx)("input",{className:"song-name-input ".concat(A?"song-rename":""),disabled:!A,onChange:function(n){return $(n.target.value)},style:{width:"100%",color:"var(--primary-text)"},value:W}):(0,E.jsx)("div",{style:{marginLeft:"0.3rem"},children:W}),(0,E.jsx)(es.u,{children:A?"Song name":"Play song"})]}),(0,E.jsx)("div",{className:"song-buttons-wrapper",children:(0,E.jsxs)(en.Rk,{Icon:ep.LCi,style:H,ignoreClickOutside:A,tooltip:"More options",onClose:function(){return V(!1)},children:[(0,E.jsxs)(en.tc,{onClick:function(){A&&(ev.k.renameSong(o.id,W),V(!1)),V(!A)},children:[(0,E.jsx)(ep.tU3,{style:{marginRight:"0.4rem"},size:14}),(0,E.jsx)(en.Qr,{text:A?"Save":"Rename"})]}),(0,E.jsxs)(en.tc,{style:{padding:"0 0.4rem"},children:[(0,E.jsx)(ep.$nz,{style:{marginRight:"0.4rem"}}),(0,E.jsxs)("select",{className:"dropdown-select",value:o.folderId||"_None",onChange:(a=(0,m._)(function(n){var a,l;return(0,O.Jh)(this,function(m){switch(m.label){case 0:return a=n.target.value,[4,em.v.getOneSerializedFromStorable(o)];case 1:if(!(l=m.sent()))return[2,ew.kg.error("Could not find song")];return ev.k.addSongToFolder(l,"_None"!==a?a:null),[2]}})}),function(n){return a.apply(this,arguments)}),children:[(0,E.jsx)("option",{value:"_None",children:"None"}),S.map(function(n){return(0,E.jsx)("option",{value:n.id,children:n.name},n.id)})]})]}),(0,E.jsxs)(en.tc,{onClick:(0,m._)(function(){var n;return(0,O.Jh)(this,function(a){switch(a.label){case 0:return[4,em.v.getOneSerializedFromStorable(o)];case 1:if(!(n=a.sent()))return[2,ew.kg.error("Could not find song")];return eg.bV.downloadSong(n,"".concat(o.name,".").concat(eH.iC.toLowerCase(),"sheet")),[2]}})}),children:[(0,E.jsx)(ep.aBF,{style:{marginRight:"0.4rem"},size:14}),(0,E.jsx)(en.Qr,{text:"Download"})]}),(0,E.jsxs)(en.tc,{onClick:(0,m._)(function(){return(0,O.Jh)(this,function(n){switch(n.label){case 0:return[4,(0,et.jH)("Are you sure you want to delete this song?")];case 1:if(!n.sent())return[2];return ev.k.removeSong(o.id),[2]}})}),children:[(0,E.jsx)(ep.Xm5,{color:"#ed4557",style:{marginRight:"0.4rem"},size:14}),(0,E.jsx)(en.Qr,{text:"Delete"})]})]})})]})}var eP=o(55457),eO=o(3924),eE=[{value:"tap",color:"var(--accent)"},{value:"hold",color:"#8569a9"},{value:"delete",color:"var(--red)"}],ez=[1,2,4,8,16];function VsrgBottom(n){var a=n.onSnapPointChange,o=n.onHitObjectTypeChange,l=n.selectedSnapPoint,m=n.isPlaying,j=n.togglePlay,S=n.selectedHitObjectType,T=n.vsrg,_=n.onScalingChange,H=n.scaling,P=n.tempoChanger,O=n.onTempoChangerChange;return(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)("div",{className:"vsrg-bottom",children:[(0,E.jsx)(eO.k,{options:eE,selected:S,onChange:function(n){o(n)}}),(0,E.jsx)("div",{className:"vsrg-name text-ellipsis",children:T.name}),(0,E.jsx)("div",{className:"flex-centered",style:{flex:"1",padding:"0 1rem"},children:(0,E.jsx)("input",{type:"range",min:10,style:{width:"100%"},max:120,value:H,onPointerUp:function(n){var a;null===(a=n.target)||void 0===a||a.blur()},onChange:function(n){return _(parseInt(n.target.value))}})}),(0,E.jsxs)("div",{className:"flex-centered",style:{height:"100%"},children:[(0,E.jsx)(eP.P,{value:P,onChange:function(n){return O(Number(n.target.value))},style:{width:"5rem",height:"100%",borderRadius:"0.4rem",marginRight:"0.6rem"},children:eH.zr.map(function(n){return(0,E.jsxs)("option",{value:n,children:[100*n,"%"]},n)})}),(0,E.jsx)(eP.P,{value:l,onChange:function(n){a(parseInt(n.target.value))},style:{width:"6rem",height:"100%",borderRadius:"0.4rem"},children:ez.map(function(n){return(0,E.jsxs)("option",{value:n,children:["Snap: 1/",n]},n)})}),(0,E.jsx)(A.J,{className:"vsrg-play-button flex-centered",onClick:j,children:m?(0,E.jsx)(ep.Wh,{size:20}):(0,E.jsx)(ep.gmG,{size:20})})]})]})})}var eM=o(6767),eR=o.n(eM);function VsrgComposerKeyboard(n){var a=n.elements,o=n.perRow,l=n.onClick,m=n.selected;return(0,E.jsx)(E.Fragment,{children:(0,E.jsx)("div",{className:"vsrg-keyboard",style:{gridTemplateColumns:"repeat(".concat(o,", 1fr)"),gridTemplateRows:"repeat(".concat(Math.ceil(a.length/o),", 1fr)"),opacity:m?1:.5,pointerEvents:m?"all":"none",cursor:m?"pointer":"not-allowed"},children:a.map(function(n){return(0,E.jsx)("button",{onClick:function(){return l(n)},style:(null==m?void 0:m.includes(n))?{backgroundColor:"var(--accent)"}:{}},n)})})})}var eA=o(87036),eI=o(55342),eF=o(55651);function ColorPicker(n){var a=n.onChange,o=n.value,l=n.absolute,m=n.style,j=(0,R._)((0,z.useState)(eR()(o)),2),S=j[0],_=j[1];function handleChange(n){_(eR()(n))}return(0,z.useEffect)(function(){_(eR()(o))},[o]),(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)("div",{className:"color-picker",style:(0,T._)({position:void 0===l||l?"absolute":"unset"},m),children:[(0,E.jsx)(eF.gW,{onChange:handleChange,color:S.hex()}),(0,E.jsxs)("div",{className:"color-picker-row",children:[(0,E.jsxs)("div",{className:"color-picker-input",style:{backgroundColor:S.toString(),color:S.isDark()?eH.kx.text.light:eH.kx.text.dark},children:[(0,E.jsx)("div",{style:{fontFamily:"Arial"},children:"#"}),(0,E.jsx)(eF.ZE,{onChange:handleChange,color:S.hex(),style:{color:S.isDark()?eH.kx.text.light:eH.kx.text.dark}})]}),(0,E.jsx)("button",{className:"color-picker-check",onClick:function(){_(eR()(o)),null==a||a(o)},style:{backgroundColor:S.toString(),color:S.isDark()?eH.kx.text.light:eH.kx.text.dark},children:(0,E.jsx)(ep.aHS,{size:16})}),(0,E.jsx)("button",{className:"color-picker-check",onClick:function(){null==a||a(S.toString())},style:{backgroundColor:S.toString(),color:S.isDark()?eH.kx.text.light:eH.kx.text.dark},children:(0,E.jsx)(ep.l_A,{size:16})})]})]})})}var eL=new(function(){function VsrgComposerStore(){(0,j._)(this,VsrgComposerStore),this.listeners=new Map}var n=VsrgComposerStore.prototype;return n.addEventListener=function(n,a){this.listeners.has(n)||this.listeners.set(n,[]),this.listeners.get(n).push(a)},n.removeEventListener=function(n,a){var o=this.listeners.get(n);if(o){var l=o.findIndex(function(n){return n.id===a.id||n.callback===a.callback});-1!==l&&o.splice(l,1)}},n.emitEvent=function(n,a){var o,l;(0,H._)(null!==(o=this.listeners.get(n))&&void 0!==o?o:[]).concat((0,H._)(null!==(l=this.listeners.get("ALL"))&&void 0!==l?l:[])).forEach(function(o){return o.callback(n,a)})},VsrgComposerStore}());function VsrgTrackSettings(n){var a=n.track,o=n.onSave,l=n.onDelete,m=n.onChange,j=(0,R._)((0,z.useState)(!1),2),S=j[0],_=j[1];return a?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)("div",{className:"vsrg-floating-settings box-shadow",children:[(0,E.jsxs)("div",{className:"row-centered space-between",children:["Track name",(0,E.jsx)("input",{type:"text",maxLength:50,className:"input",style:{width:"7.4rem"},value:a.instrument.alias,onChange:function(n){a.instrument.set({alias:n.target.value}),m(a)},placeholder:a.instrument.name})]}),(0,E.jsxs)("div",{className:"row-centered space-between",style:{marginTop:"0.4rem"},children:["Instrument",(0,E.jsx)(eA.O,{style:{width:"8rem"},selected:a.instrument.name,onChange:function(n){a.instrument.set({name:n}),m(a)}})]}),(0,E.jsxs)("div",{className:"row-centered space-between",style:{marginTop:"0.4rem"},children:["Pitch",(0,E.jsx)(eI.x,{style:{width:"8rem"},selected:a.instrument.pitch,onChange:function(n){a.instrument.set({pitch:n}),m(a)},children:(0,E.jsx)("option",{value:"",children:"Use song pitch"})})]}),(0,E.jsxs)("div",{className:"row-centered",style:{marginTop:"1rem",alignItems:"center"},children:["Volume",(0,E.jsxs)("span",{style:(0,T._)({marginLeft:"0.4rem",width:"3rem"},a.instrument.volume>100&&{color:"hsl(0, ".concat(-40+a.instrument.volume,"%, 61%)"),marginLeft:"0.4rem"}),children:[a.instrument.volume,"%"]}),(0,E.jsx)(er.k,{buttonStyle:{width:"1.2rem",height:"1.2rem"},width:10,children:"If you hear distortion, reduce the volume"})]}),(0,E.jsx)("div",{className:"row-centered",children:(0,E.jsx)("input",{type:"range",style:{flex:"1"},min:0,max:125,value:a.instrument.volume,onChange:function(n){a.instrument.set({volume:parseInt(n.target.value)}),m(a)}})}),(0,E.jsx)("div",{className:"column",children:(0,E.jsxs)("div",{className:"row-centered space-between",children:["Color",(0,E.jsx)(A.J,{onClick:function(){return _(!0)},ariaLabel:"Change color",style:{backgroundColor:a.color,color:eR()(a.color).isDark()?"#fff":"#000"},children:"Change"})]})}),(0,E.jsxs)("div",{className:"row space-between",style:{marginTop:"0.4rem"},children:[(0,E.jsxs)(A.J,{className:"row-centered",style:{padding:"0.4rem",width:"fit-content"},onClick:l,children:[(0,E.jsx)(ep.Xm5,{color:"var(--red)",style:{marginRight:"0.3rem"}}),"Delete"]}),(0,E.jsx)(A.J,{onClick:o,style:{padding:"0.4rem",width:"fit-content"},children:"Ok"})]})]}),S&&(0,E.jsx)(ColorPicker,{style:{right:"0.8rem",top:"0.5rem"},value:a.color,onChange:function(n){m(a.set({color:n})),_(!1),eL.emitEvent("colorChange")}})]}):null}function VsrgTop(n){var a=n.vsrg,o=n.selectedTrack,l=n.children,m=n.onTrackAdd,j=n.onTrackChange,S=n.onTrackSelect,T=n.onTrackDelete,_=n.onNoteSelect,H=n.onBreakpointChange,P=n.onBreakpointSelect,O=n.lastCreatedHitObject,V=n.selectedHitObject,J=(0,R._)((0,eh.F)(),1)[0],W=(0,R._)((0,z.useState)([]),2),$=W[0],G=W[1],et=(0,R._)((0,z.useState)(!1),2),en=et[0],er=et[1],es=a.tracks[o];return(0,z.useEffect)(function(){G(Array("Sky"===eH.iC?15:21).fill(0).map(function(n,a){return a}))},[]),(0,E.jsxs)(E.Fragment,{children:[l,(0,E.jsxs)("div",{className:"vsrg-top-right ".concat(null!==O?"vsrg-top-right-disabled":""),children:[en&&(0,E.jsx)(VsrgTrackSettings,{track:es,onSave:function(){return er(!1)},onDelete:function(){return T(o)},onChange:function(n){return j(n,o)}}),(0,E.jsxs)("div",{className:"row-centered vsrg-breakpoints-buttons",style:{marginBottom:"0.4rem"},children:[(0,E.jsx)(A.J,{style:{marginLeft:0},onClick:function(){return P(-1)},children:(0,E.jsx)(ei.Z,{children:(0,E.jsx)(ep.qSR,{})})}),(0,E.jsx)(A.J,{onClick:function(){return H(!0)},children:(0,E.jsx)(ei.Z,{children:(0,E.jsx)(ep.iFH,{})})}),(0,E.jsx)(A.J,{onClick:function(){return H(!1)},children:(0,E.jsx)(ei.Z,{children:(0,E.jsx)(ep.wEH,{})})}),(0,E.jsx)(A.J,{onClick:function(){return P(1)},children:(0,E.jsx)(ei.Z,{children:(0,E.jsx)(ep.Nqc,{})})})]}),(0,E.jsxs)("div",{className:"vsrg-track-wrapper column",children:[a.tracks.map(function(n,a){return(0,E.jsx)(TrackSelector,{track:n,selected:a===o,theme:J,onSettingsClick:function(){return er(!en)},onTrackClick:function(){return S(a)}},a)}),(0,E.jsx)("div",{style:{width:"100%",height:"1.4rem"}}),(0,E.jsx)(A.J,{onClick:function(n){setTimeout(function(){var a;m(),null===(a=n.target)||void 0===a||a.scrollIntoView()},50)},ariaLabel:"Add new instrument",className:"flex-centered",style:{marginTop:"auto",padding:"0.3rem"},children:(0,E.jsx)(ep.wEH,{size:16,color:"var(--icon-color)"})})]}),(0,E.jsx)(VsrgComposerKeyboard,{elements:$,selected:null==V?void 0:V.notes,perRow:"Sky"===eH.iC?5:7,onClick:_})]})]})}function TrackSelector(n){var a=n.track,o=n.selected,l=n.theme,m=n.onSettingsClick,j=n.onTrackClick,S=(0,R._)((0,z.useState)({background:"var(--primary)",text:"var(--primary-text)"}),2),T=S[0],_=S[1],H=(0,R._)((0,z.useState)({background:"var(--primary)",text:"var(--primary-text)"}),2),P=H[0],O=H[1];return(0,z.useEffect)(function(){var n=l.get("primary").mix(new(eR())(a.color),.3);_({background:n.toString(),text:n.isDark()?"var(--text-light)":"var(--text-dark)"});var o=new(eR())(a.color);O({background:o.toString(),text:o.isDark()?"rgb(220 219 216)":"rgb(55 55 55)"})},[l,a.color]),(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)("div",{className:"vsrg-track row-centered",style:{backgroundColor:o?T.background:"var(--primary)",color:o?T.text:"var(--primary-text)"},onClick:j,children:[(0,E.jsx)("span",{className:"text-ellipsis",style:{color:o?T.text:"var(--text-color)",paddingLeft:"0.6rem",paddingRight:"0.2rem",flex:1},children:a.instrument.alias||a.instrument.name}),(0,E.jsx)(A.J,{onClick:function(){return o&&m()},style:{backgroundColor:P.background},className:"vsrg-track-left flex-centered",children:o&&(0,E.jsx)(ep.p4t,{color:P.text})})]})})}var eD=o(53722),eB=o(78810),eV=o(29053),eJ=o(29601),eW=o(57564),eK=o(43531),eZ=o(73288);eW.Xd.LINE_SCALE_MODE=eW.F4.NORMAL;var eU=function(){function VsrgCanvasCache(n){var a=n.app,o=n.colors,l=n.sizes,m=n.trackColors,S=n.isHorizontal,T=n.playbarOffset,_=this;(0,j._)(this,VsrgCanvasCache),this.isMobile=!1,this.destroy=function(){var n,a,o,l;null===(n=_.textures.snapPoints.small)||void 0===n||n.destroy(!0),null===(a=_.textures.snapPoints.large)||void 0===a||a.destroy(!0),null===(o=_.textures.snapPoints.empty)||void 0===o||o.destroy(!0),Object.values(_.textures.hitObjects).forEach(function(n){return null==n?void 0:n.destroy(!0)}),Object.values(_.textures.heldHitObjects).forEach(function(n){return null==n?void 0:n.destroy(!0)}),Object.values(_.textures.trails).forEach(function(n){return null==n?void 0:n.destroy(!0)}),Object.values(_.textures.selectionRings).forEach(function(n){return null==n?void 0:n.destroy(!0)}),Object.values(_.textures.timeline).forEach(function(n){return null==n?void 0:n.destroy(!0)}),null===(l=_.textures.buttons.time)||void 0===l||l.destroy(!0),_.app=null},this.textures={hitObjects:{},heldHitObjects:{},selectionRings:{},trails:{},buttons:{width:0,height:0,time:null},snapPoints:{size:0,small:null,large:null,empty:null},timeline:{breakpoint:null,currentTime:null,note:null,square:null,thumb:null},sizes:{hitObject:0,trail:0}},this.trackColors=m,this.colors=o,this.isHorizontal=S,this.playbarOffset=T,this.sizes=l,this.app=a,this.generate()}var n=VsrgCanvasCache.prototype;return n.generate=function(){var n=this.app;n&&(this.isMobile=eo()(),this.generateSnapPoints(n),this.generateTrackCache(n),this.generateTrails(n),this.generateSelectionRings(n),this.generateOthers(n))},n.getHitObjectCache=function(n){return this.textures.hitObjects[n]||this.textures.hitObjects["#FF0000"]},n.getHeldTrailCache=function(n){return this.textures.trails[n]||this.textures.trails["#FF0000"]},n.getHeldHitObjectCache=function(n){return this.textures.heldHitObjects[n]||this.textures.heldHitObjects["#FF0000"]},n.getSelectionRingsCache=function(n){return this.textures.selectionRings[n]||this.textures.selectionRings["#FF0000"]},n.generateOthers=function(n){var a=this.sizes,o=this.colors,l=this.isHorizontal,m=new eW.K3;m.beginFill(this.colors.background_plain[1]).drawRect(0,0,this.sizes.width,this.sizes.timelineSize).lineStyle(3,this.colors.secondary[1],1).moveTo(0,a.timelineSize).lineTo(this.sizes.width,a.timelineSize);var j=n.renderer.generateTexture(m,{resolution:1,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,this.sizes.width,this.sizes.timelineSize)});this.textures.timeline.square=j;var S=l?a.height/16:a.width/16,T=(0,eZ.uZ)(a.timelineSize/4,8,100),_=new eW.K3;_.beginFill(o.accent[1]).moveTo(0,0).lineTo(T,0).lineTo(T/2,T).lineTo(0,0).moveTo(0,0).lineTo(T,0).lineTo(T/2,-T).lineTo(0,0).endFill().lineStyle(3,o.accent[1],1).moveTo(T/2,0).lineTo(T/2,a.timelineSize).lineStyle(0).beginFill(o.accent[1]).moveTo(0,a.timelineSize).lineTo(T,a.timelineSize).lineTo(T/2,a.timelineSize).lineTo(0,a.timelineSize).moveTo(0,a.timelineSize).lineTo(T,a.timelineSize).lineTo(T/2,a.timelineSize-T).lineTo(0,a.timelineSize);var H=a.timelineSize/2,P=new eW.K3;P.lineStyle(this.isMobile?2:3,o.secondary[1],1).drawCircle(a.timelineSize/2+1,a.timelineSize/2,H/2);var O=n.renderer.generateTexture(P,{resolution:1,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,a.timelineSize,a.timelineSize)});this.textures.timeline.note=O;var E=new eW.K3;E.lineStyle(12,o.accent[1],1).moveTo(0,0).lineTo(0,a.timelineSize);var z=n.renderer.generateTexture(E,{resolution:1,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,12,a.timelineSize)});this.textures.timeline.currentTime=z;var R=n.renderer.generateTexture(_,{resolution:2,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,T,a.timelineSize)});this.textures.timeline.thumb=R;var A=new eW.K3;A.beginFill(o.accent[1]).moveTo(0,0).lineTo(T,0).lineTo(T/2,T).lineTo(0,0).moveTo(0,0).lineTo(T,0).lineTo(T/2,-T).lineTo(0,0);var V=n.renderer.generateTexture(A,{resolution:1,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,T,T)});this.textures.timeline.breakpoint=V;var J=new eW.K3;if(J.beginFill(o.background_10[1]),l){J.drawRoundedRect(S/2,S/2,a.width/2-S,a.height/2-S,16);var W=n.renderer.generateTexture(J,{resolution:1,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,a.width/2,a.height/2)});this.textures.buttons.width=a.width/2,this.textures.buttons.height=a.height/2,this.textures.buttons.time=W}else{J.drawRoundedRect(S/2,S/2,a.width/2-S,a.height/3-S,8);var $=n.renderer.generateTexture(J,{resolution:1,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,a.width/2,a.height/3)});this.textures.buttons.width=a.width/2,this.textures.buttons.height=a.height/3,this.textures.buttons.time=$}m.destroy(!0),_.destroy(!0),P.destroy(!0),E.destroy(!0),A.destroy(!0),J.destroy(!0)},n.generateTrails=function(n){var a=this,o=this.sizes,l=this.trackColors,m=(0,H._)(l).concat(["#FF0000"]),j=(0,eZ.uZ)(o.keyHeight/2*o.scaling,o.keyHeight/(this.isMobile?3:4),100),S=j/2;m.forEach(function(o){var l=new eW.K3;a.isHorizontal?l.beginFill(eR()(o).rgbNumber()).drawRect(0,S/2,j,j-S):l.beginFill(eR()(o).rgbNumber()).drawRect(S/2,0,j-S,j);var m=n.renderer.generateTexture(l,{resolution:1,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,j,j)});a.textures.trails[o]=m}),this.textures.sizes.trail=j},n.generateSelectionRings=function(n){var a=this,o=this.sizes,l=this.trackColors,m=(0,H._)(l).concat(["#FF0000"]),j=(0,eZ.uZ)(o.keyHeight/1.5*o.scaling,o.keyHeight/(this.isMobile?1.2:2),150);m.forEach(function(o){var l=new eW.K3;l.lineStyle(3,eR()(o).rgbNumber()).drawCircle(j/2,j/2,j/2-3);var m=n.renderer.generateTexture(l,{resolution:1,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,j,j)});a.textures.selectionRings[o]=m,l.destroy(!0)})},n.generateTrackCache=function(n){var a=this,o=this.colors,l=this.sizes,m=this.trackColors,j=(0,eZ.uZ)(l.keyHeight/1.8*l.scaling,l.keyHeight/(this.isMobile?2:3.5),100);(0,H._)(m).concat(["#FF0000"]).forEach(function(l){var m=new eW.K3,S=j/2;m.lineStyle(5,eR()(l).rgbNumber()).beginFill(o.background_10[1]).drawCircle(S,S,S-5);var T=n.renderer.generateTexture(m,{resolution:2,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,j,j)});a.textures.hitObjects[l]=T,m.destroy(!0);var _=new eW.K3,H=.7*j,P=(j-H)/2;_.width=H,_.height=H,_.lineStyle(5,eR()(l).rgbNumber()).beginFill(o.background_10[1]).drawRoundedRect(P,P,H,H,6);var O=n.renderer.generateTexture(_,{resolution:2,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,j,j)});a.textures.heldHitObjects[l]=O,_.destroy(!0)}),this.textures.sizes.hitObject=j},n.generateSnapPoints=function(n){var a=this.colors,o=this.sizes,l=this.isHorizontal,m=this.playbarOffset,j=new eW.K3,S=new eW.K3,T=new eW.K3;if(l){j.lineStyle(2,a.lineColor[1]).moveTo(0,0).lineTo(0,o.height);var _=n.renderer.generateTexture(j,{resolution:1,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,o.snapPointWidth,o.height)});S.lineStyle(4,a.secondary[1]).moveTo(0,0).lineTo(0,o.height);var H=n.renderer.generateTexture(S,{resolution:1,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,o.snapPointWidth,o.height)}),P=o.height/10;T.lineStyle(2,a.secondary[1]);for(var O=0;O<12;O++){var E=P*O-P;T.moveTo(m,E),T.lineTo(0,E+P)}var z=n.renderer.generateTexture(T,{resolution:1,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,m,o.height)});this.textures.snapPoints.size=o.snapPointWidth,this.textures.snapPoints.small=_,this.textures.snapPoints.large=H,this.textures.snapPoints.empty=z}else{j.lineStyle(2,a.lineColor[1]).moveTo(0,o.snapPointWidth).lineTo(o.width,o.snapPointWidth);var R=n.renderer.generateTexture(j,{resolution:1,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,o.width,o.snapPointWidth)});S.lineStyle(4,a.secondary[1]).moveTo(0,o.snapPointWidth).lineTo(o.width,o.snapPointWidth);var A=n.renderer.generateTexture(S,{resolution:1,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,o.width,o.snapPointWidth)}),V=o.width/20;T.lineStyle(2,a.secondary[1]);for(var J=0;J<22;J++){var W=V*J-V;T.moveTo(W,m),T.lineTo(W+V,0)}var $=n.renderer.generateTexture(T,{resolution:1,scaleMode:eK.aH$.LINEAR,region:new eK.AeJ(0,0,o.width,m)});this.textures.snapPoints.size=o.snapPointWidth,this.textures.snapPoints.large=A,this.textures.snapPoints.empty=$,this.textures.snapPoints.small=R}j.destroy(!0),S.destroy(!0),T.destroy(!0)},VsrgCanvasCache}(),eq=o(37347),eY=o.n(eq);function useFontFaceObserver(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=a.testString,l=a.timeout,m=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{showErrors:!1}).showErrors,j=(0,R._)((0,z.useState)(!1),2),S=j[0],T=j[1],_=JSON.stringify(n);return(0,z.useEffect)(function(){Promise.all(JSON.parse(_).map(function(n){var a=n.family,m=n.weight,j=n.style,S=n.stretch;return new(eY())(a,{weight:m,style:j,stretch:S}).load(o,l)})).then(function(){return T(!0)}).catch(function(){m&&console.error("An error occurred during font loading")})},[_,o,l,m]),S}var eX=new eK.pn8({fontFamily:'"Source Sans Pro", Helvetica, sans-serif',fontSize:30,fill:"#ffffff"}),e$=[{family:"Bonobo"}],eG=(0,z.memo)(function(n){var a=n.keys,o=n.sizes,l=n.colors,m=n.isHorizontal,j=n.onKeyDown,S=n.onKeyUp,T=(0,ey.Z)().PLAY_BAR_OFFSET,_=(0,R._)((0,z.useState)(eX),2),H=_[0],P=_[1],O=useFontFaceObserver(e$);(0,z.useEffect)(function(){P(new eK.pn8({fontFamily:O?'"Bonobo"':'"Source Sans Pro", Helvetica, sans-serif',fontSize:O?25:30,fill:l.lineColor[1]}))},[l,o,a,O]);var A=o.height/a.length,V=o.width/a.length;return(0,E.jsxs)(eB.W2,{x:0,y:o.timelineSize,children:[(0,E.jsx)(eB.TC,{draw:function(n){if(n.clear(),n.beginFill(l.background_plain[1]),m){n.drawRect(0,0,60,o.height),n.lineStyle(2,l.lineColor_10[1]);for(var j=0;j<a.length-1;j++)n.moveTo(0,A*(j+1)),n.lineTo(o.width,A*(j+1));n.lineStyle(2,l.secondary[1]),n.moveTo(59,0),n.lineTo(59,o.height)}else{n.drawRect(0,o.height-60,o.width,60),n.lineStyle(2,l.lineColor_10[1]);for(var S=0;S<a.length-1;S++)n.moveTo(V*(S+1),0),n.lineTo(V*(S+1),o.height);n.lineStyle(2,l.secondary[1]),n.moveTo(0,o.height-60),n.lineTo(o.width,o.height-60)}}}),(0,E.jsx)(eB.TC,{draw:function(n){if(n.clear(),n.lineStyle(6,l.accent[1]),m){n.moveTo(T+1,0),n.lineTo(T+1,o.height);for(var j=0;j<a.length;j++)n.drawCircle(T+1,A*(j+.5),4)}else{var S=o.height-T-1-o.timelineSize;n.moveTo(0,S),n.lineTo(o.width,S);for(var _=0;_<a.length;_++)n.drawCircle(V*(_+.5)+1,S,4)}}}),a.map(function(n,a){var l=new eK.AeJ(m?0:V*a,m?A*a:o.height-60,m?60:o.width,m?A:60);return(0,E.jsx)(eB.W2,{hitArea:l,eventMode:"static",pointerdown:function(){return j(a)},pointerup:function(){return S(a)},pointerupoutside:function(){return S(a)},children:(0,E.jsx)(eB.xv,{x:m?30:V*a+V/2,y:m?A*a+A/2:o.height-30,anchor:.5,text:"".concat(a+1),style:H})},n)})]})},function(n,a){return n.keys===a.keys&&n.sizes===a.sizes&&n.colors===a.colors&&n.isHorizontal===a.isHorizontal});function VsrgTrackRenderer(n){var a=n.track,o=n.sizes,l=n.keys,m=n.cache,j=n.isHorizontal,S=n.selectedHitObject,T=n.selectHitObject,_=n.trackIndex,H=n.timestamp,P=(0,ey.Z)().PLAY_BAR_OFFSET,O=o.scaling,R=o.height/l,A=o.width/l,V=H-P/O-m.textures.sizes.hitObject,J=H+(j?o.width:o.height)/O-P+m.textures.sizes.hitObject;return(0,E.jsx)(E.Fragment,{children:a.hitObjects.map(function(n){if(V>n.timestamp+n.holdDuration||n.timestamp>J)return null;var l=j?n.timestamp*O:A*n.index+A/2,H=j?R*n.index+R/2:-(n.timestamp*O-o.height);return n.isHeld?(0,E.jsxs)(eB.W2,{eventMode:"static",pointerdown:function(a){T(n,_,(0,eZ.Bq)(a.button))},children:[j?(0,E.jsx)(eB.jy,{texture:m.getHeldTrailCache(a.color),anchor:[0,.5],height:m.textures.sizes.trail,width:n.holdDuration*O,x:l,y:H}):(0,E.jsx)(eB.jy,{texture:m.getHeldTrailCache(a.color),anchor:eH.$n,width:m.textures.sizes.trail,height:n.holdDuration*O,x:l,y:H}),(0,E.jsx)(eB.jy,{texture:m.getHeldHitObjectCache(a.color),anchor:.5,x:l,angle:45,y:H}),(0,E.jsx)(eB.jy,{texture:m.getHeldHitObjectCache(a.color),anchor:.5,x:j?(n.timestamp+n.holdDuration)*O:l,y:j?H:H-n.holdDuration*O}),n===S&&(0,E.jsx)(eB.jy,{texture:m.getSelectionRingsCache(a.color),anchor:.5,x:l,y:H})]},n.renderId):(0,E.jsxs)(z.Fragment,{children:[n===S&&(0,E.jsx)(eB.jy,{texture:m.getSelectionRingsCache(a.color),anchor:.5,x:l,y:H}),(0,E.jsx)(eB.jy,{texture:m.getHitObjectCache(a.color),eventMode:"static",pointerdown:function(a){T(n,_,(0,eZ.Bq)(a.button))},anchor:.5,x:l,y:H})]},n.renderId)})})}var eQ=[{family:"Bonobo"}];function VsrgScrollableTrackRenderer(n){var a=n.vsrg,o=n.sizes,l=n.snapPoint,m=n.timestamp,j=n.snapPoints,S=n.colors,T=n.cache,_=n.onSnapPointSelect,H=n.preventClick,P=n.isHorizontal,O=n.selectedHitObject,A=n.selectHitObject,V=n.onAddTime,J=n.onRemoveTime,W=o.scaling,$=(0,ey.Z)().PLAY_BAR_OFFSET,G=m-($+T.textures.snapPoints.size)/W,et=m+((P?o.width:o.height)-$)/W,en=T.textures.snapPoints.size,er=(0,R._)((0,z.useState)(eX),2),ei=er[0],es=er[1],ea=useFontFaceObserver(eQ);function handleSnapPointClick(n){if(!H){var a=n.target;if(P){var l=n.globalY-o.timelineSize;_(a.x/W,Math.floor(l/o.keyHeight),(0,eZ.Bq)(n.button))}else _(Math.abs(Math.floor(a.y-o.height+en)/W),Math.floor(a.x/o.keyWidth),(0,eZ.Bq)(n.button))}}return(0,z.useEffect)(function(){es(new eK.pn8({fontFamily:ea?'"Bonobo"':'"Source Sans Pro", Helvetica, sans-serif',fontSize:ea?25:30,fill:S.lineColor[1]}))},[ea,S.lineColor]),(0,E.jsxs)(eB.W2,{x:P?-m*W+$:0,y:P?o.timelineSize:m*W-$,eventMode:"static",interactiveChildren:!0,children:[j.map(function(n,a){return G>n||n>et?null:(0,E.jsx)(eB.jy,{eventMode:"static",pointertap:handleSnapPointClick,x:P?n*W:0,y:P?0:-(n*W-o.height+en),texture:a%l?T.textures.snapPoints.small:T.textures.snapPoints.large},n)}),G<0&&(0,E.jsx)(eB.jy,{x:P?-$:0,y:P?0:o.height,texture:T.textures.snapPoints.empty}),a.tracks.map(function(n,l){return(0,E.jsx)(VsrgTrackRenderer,{track:n,cache:T,keys:a.keys,colors:S,sizes:o,timestamp:m,trackIndex:l,selectHitObject:A,selectedHitObject:O,isHorizontal:P},l)}),m>=a.duration-(P?o.width:o.height)/W&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)(eB.W2,{pointertap:V,eventMode:"static",x:P?a.duration*W:0,anchor:.5,y:P?0:-(a.duration*W-o.height+T.textures.buttons.height),children:[(0,E.jsx)(eB.jy,{texture:T.textures.buttons.time}),(0,E.jsx)(eB.xv,{x:T.textures.buttons.width/2,anchor:.5,y:T.textures.buttons.height/2,text:"Click to add time",style:ei})]}),(0,E.jsxs)(eB.W2,{pointertap:J,eventMode:"static",x:P?a.duration*W:o.width/2,anchor:.5,y:P?o.height/2:-(a.duration*W-o.height+T.textures.buttons.height),children:[(0,E.jsx)(eB.jy,{texture:T.textures.buttons.time}),(0,E.jsx)(eB.xv,{x:T.textures.buttons.width/2,anchor:.5,y:T.textures.buttons.height/2,text:"Click to remove time",style:ei})]})]})]})}var e0=(0,z.memo)(function(n){var a=n.cache,o=n.breakpoints,l=n.sizes,m=n.duration;return(0,E.jsx)(E.Fragment,{children:(0,E.jsx)(eB.W2,{children:o.map(function(n){return(0,E.jsx)(eB.jy,{texture:a.textures.timeline.breakpoint,x:n/m*l.width},n)})})})},function(n,a){return n.breakpoints===a.breakpoints&&n.cache===a.cache&&n.sizes===a.sizes&&n.duration===a.duration}),e1=new eK.AeJ(0,0,0,0);function VsrgTimelineRenderer(n){var a=n.sizes,o=n.timestamp,l=n.song,m=n.cache,j=n.hidden,S=n.notes,T=n.onTimelineClick,_=(0,ey.Z)().PLAY_BAR_OFFSET,H=(0,R._)((0,z.useState)(e1),2),P=H[0],O=H[1],A=(0,R._)((0,z.useState)(!1),2),V=A[0],J=A[1],W=o-(_+a.timelineSize)/a.scaling,$=o+(a.width-_+a.timelineSize)/a.scaling,G=(0,z.useCallback)(function(){return J(!1)},[]);(0,z.useEffect)(function(){O(new eK.AeJ(0,0,a.width,a.timelineSize))},[a]),(0,z.useEffect)(function(){var handleBlur=function(){J(!1)};return window.addEventListener("blur",handleBlur),function(){return window.removeEventListener("blur",handleBlur)}},[]);var et=(0,z.useCallback)(function(n,o){if(V||!0===o){var m=n.globalX/a.width*l.duration;T((0,eZ.uZ)(m,0,l.duration))}},[a,l.duration,T,V]),en=(0,z.useCallback)(function(n){J(!0),et(n,!0)},[et]);if(j)return null;var er=o/l.duration;return(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)(eB.W2,{x:0,y:0,eventMode:"static",pointermove:et,pointerdown:en,pointerup:G,pointerupoutside:G,hitArea:P,children:[(0,E.jsx)(eB.jy,{x:0,y:0,texture:m.textures.timeline.square}),(0,E.jsx)(eB.W2,{x:-o*a.scaling+_,y:0,children:S.map(function(n,o){return n.time<W||n.time>$?null:(0,E.jsx)(eB.jy,{x:n.time*a.scaling,anchor:eH.Xu,texture:m.textures.timeline.note},o)})}),(0,E.jsx)(e0,{breakpoints:l.breakpoints,cache:m,sizes:a,duration:l.duration}),(0,E.jsx)(eB.jy,{x:_-2,y:0,texture:m.textures.timeline.currentTime}),(0,E.jsx)(eB.jy,{y:0,x:er*a.width,texture:m.textures.timeline.thumb})]})})}var e2=o(73756),e3=function(n){(0,S._)(VsrgComposerCanvas,n);var a=(0,P._)(VsrgComposerCanvas);function VsrgComposerCanvas(n){var o;return(0,j._)(this,VsrgComposerCanvas),(o=a.call(this,n)).wrapperRef=(0,z.createRef)(),o.stageRef=(0,z.createRef)(),o.toDispose=[],o.throttledEventLoop=new eV.v(function(){},48),o.cumulativeScroll=0,o.handleEvent=function(n,a){"colorChange"===n&&o.generateCache(),"updateKeys"===n&&o.calculateSizes(),"updateOrientation"===n&&o.calculateSizes(),"snapPointChange"===n&&o.calculateSizes(),"tracksChange"===n&&o.generateCache(),"songLoad"===n&&o.calculateSizes(),"scaleChange"===n&&o.calculateSizes(),"maxFpsChange"===n&&o.throttledEventLoop.changeMaxFps(o.props.maxFps),"timestampChange"===n&&o.setTimestamp(a)},o.handleTick=function(n,a){if(o.props.isPlaying){var l=o.state.timestamp+a*o.props.tempoChanger;o.setTimestamp(l)}},o.handleBlur=function(){o.setState({isPressing:!1})},o.calculateSizes=function(){var n=(0,l._)(o).wrapperRef;if(!n.current)return console.warn("no wrapper");var a=n.current.getBoundingClientRect(),m=o.props.scaling,j=eo()()?20:40,S=a.height-j,T={el:a,rawWidth:a.width,rawHeight:a.height,width:a.width,height:S,keyHeight:S/eH.CB[o.props.vsrg.keys].length,keyWidth:a.width/eH.CB[o.props.vsrg.keys].length,snapPointWidth:6e4/o.props.vsrg.bpm/o.props.snapPoint*m/100,scaling:m/100,timelineSize:j},_=n.current.querySelector("canvas");_&&(_.style.width="".concat(T.width,"px"),_.style.height="".concat(T.height+j,"px")),o.setState({sizes:T},o.generateCache)},o.handleWheel=function(n){if(o.props.scrollSnap){if(o.cumulativeScroll+=n.deltaY,100>Math.abs(o.cumulativeScroll))return;var a=o.props.snapPoints,l=a.findIndex(function(n){return n>o.state.timestamp}),m=(l<0?a.length:l)-1+(o.cumulativeScroll<0?-1:1);if(o.cumulativeScroll=0,m<0||m>=a.length)return;var j=a[m];return o.setTimestamp(j)}var S=Math.min(Math.max(0,o.state.timestamp+n.deltaY/1.2),o.props.vsrg.duration);o.setState({timestamp:S},function(){var a=o.state,l=a.draggedHitObject,m=a.timestamp;o.props.onTimestampChange(o.state.timestamp),l&&!(m<=0)&&o.props.dragHitObject(l.timestamp+n.deltaY/1.2)})},o.setIsDragging=function(n){var a=o.state.sizes;n.clientY-a.el.top>a.timelineSize&&o.setState({isPressing:!0,previousPosition:o.props.isHorizontal?n.clientX:-n.clientY})},o.setIsNotDragging=function(n){if(o.state.isPressing){var a=o.state.draggedHitObject;o.setState({isPressing:!1,totalMovement:0,draggedHitObject:null},function(){if(a&&o.props.releaseHitObject(),setTimeout(function(){return o.setState({preventClick:!1})},200),o.props.scrollSnap){var n=o.props.snapPoints,l=n.findIndex(function(n){return n>o.state.timestamp});if(l&&!(l<0)){var m=n[l],j=n[l-1];if(void 0!==m&&void 0!==j){var S=(0,eZ.uy)(o.state.timestamp,j,m);o.setTimestamp(S)}}}})}},o.handleDrag=function(n){if(o.state.isPressing){var a=o.state,l=a.previousPosition,m=a.draggedHitObject,j=a.sizes,S=a.timestamp,T=o.props,_=T.isHorizontal,H=T.vsrg,P=_?n.clientX:-n.clientY,O=Math.floor((_?n.clientY-j.el.top-j.timelineSize:n.clientX-j.el.left)/(_?j.keyHeight:j.keyWidth)),E=(l-P)/j.scaling,z=o.state.totalMovement+Math.abs(E);if(null!==m){var R=m.timestamp-E;return o.setState({previousPosition:P},function(){return o.props.dragHitObject(Math.max(0,R),O)})}var A=Math.min(Math.max(0,S+E),H.duration);o.setState({previousPosition:P,preventClick:z>50,totalMovement:z,timestamp:A},function(){return o.props.onTimestampChange(o.state.timestamp)})}},o.generateCache=function(){var n=o.state,a=n.sizes,l=n.canvasColors;n.cache;var m=o.props.vsrg.tracks.map(function(n){return n.color});if(o.stageRef.current){o.stageRef.current.app.renderer.background.color=l.background[0];var j=new eU({app:o.stageRef.current.app,sizes:a,colors:l,trackColors:m,isHorizontal:o.props.isHorizontal,playbarOffset:e2.X.get().PLAY_BAR_OFFSET}),S=o.state.cache;o.setState({cache:j},function(){setTimeout(function(){null==S||S.destroy()},500)})}},o.selectHitObject=function(n,a,l){2!==l&&o.setState({draggedHitObject:n}),o.props.selectHitObject(n,a,l)},o.setTimestamp=function(n){o.setState({timestamp:n}),o.props.onTimestampChange(n)},o.handleThemeChange=function(n){var a=n.get("primary"),l=n.getText("primary"),m=l.darken(.5).desaturate(1),j=a.darken(.15),S=j.darken(.1),T=n.get("secondary"),_=n.get("accent");o.setState({canvasColors:{background_plain:[a.hex(),a.rgbNumber()],background:[j.hex(),j.rgbNumber()],background_10:[S.hex(),S.rgbNumber()],secondary:[T.hex(),T.rgbNumber()],lineColor:[l.hex(),l.rgbNumber()],lineColor_10:[m.hex(),m.rgbNumber()],accent:[_.hex(),_.rgbNumber()]}},o.generateCache)},o.state={canvasColors:{background_plain:["#000000",0],background:["#000000",0],background_10:["#000000",0],secondary:["#ffffff",16777215],lineColor:["#ffffff",16777215],lineColor_10:["#ffffff",16777215],accent:["#ffffff",16777215]},timestamp:0,sizes:{el:(0,T._)({},eH.n),rawWidth:0,rawHeight:0,width:0,height:0,snapPointWidth:0,keyHeight:0,keyWidth:0,timelineSize:0,scaling:0},draggedHitObject:null,isPressing:!1,totalMovement:0,previousPosition:0,preventClick:!1,cache:null},o.wrapperRef=(0,z.createRef)(),o.stageRef=(0,z.createRef)(),o}var o=VsrgComposerCanvas.prototype;return o.componentDidMount=function(){var n,a=this;this.toDispose.push((0,eh.B)(this.handleThemeChange)),window.addEventListener("resize",this.calculateSizes),this.toDispose.push(function(){return window.removeEventListener("resize",a.calculateSizes)}),eL.addEventListener("ALL",{callback:this.handleEvent,id:"vsrg-canvas-color-change"}),this.toDispose.push(function(){return eL.removeEventListener("ALL",{id:"vsrg-canvas-color-change"})}),this.calculateSizes(),this.throttledEventLoop.setCallback(this.handleTick),this.throttledEventLoop.changeMaxFps(this.props.maxFps),this.throttledEventLoop.start(),window.addEventListener("blur",this.handleBlur),null===(n=this.state.cache)||void 0===n||n.destroy(),this.toDispose.push(function(){return window.removeEventListener("blur",a.handleBlur)}),this.handleThemeChange(eJ.f6)},o.componentWillUnmount=function(){var n;this.toDispose.forEach(function(n){return n()}),null===(n=this.state.cache)||void 0===n||n.destroy(),this.throttledEventLoop.stop()},o.render=function(){var n,a=this.state,o=a.canvasColors,l=a.sizes,m=a.cache,j=a.timestamp,S=a.preventClick,T=this.props,_=T.vsrg,H=T.isHorizontal,P=T.audioSong,O=T.snapPoint,z=T.snapPoints,R=T.selectedHitObject;return(0,E.jsx)("div",{className:"vsrg-top-canvas-wrapper",ref:this.wrapperRef,children:this.wrapperRef.current&&(0,E.jsxs)(eB.Hf,{onMount:this.calculateSizes,ref:this.stageRef,raf:!1,width:l.rawWidth,height:l.rawHeight,onWheel:this.handleWheel,onPointerDown:this.setIsDragging,onPointerUp:this.setIsNotDragging,onPointerLeave:this.setIsNotDragging,onPointerMove:this.handleDrag,onContextMenu:function(n){return n.preventDefault()},options:{backgroundColor:o.background_plain[1],autoDensity:!1,resolution:(null===(n=window)||void 0===n?void 0:n.devicePixelRatio)||1},children:[m&&(0,E.jsx)(VsrgScrollableTrackRenderer,{vsrg:_,cache:m,selectedHitObject:R,snapPoint:O,snapPoints:z,timestamp:j,preventClick:S,sizes:l,colors:o,isHorizontal:H,onAddTime:this.props.onAddTime,onRemoveTime:this.props.onRemoveTime,selectHitObject:this.selectHitObject,onSnapPointSelect:this.props.onSnapPointSelect}),(0,E.jsx)(eG,{isHorizontal:H,keys:eH.CB[_.keys],sizes:l,colors:o,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp}),m&&(0,E.jsx)(VsrgTimelineRenderer,{hidden:!1,notes:this.props.renderableNotes,cache:m,timestamp:j,onTimelineClick:this.setTimestamp,isHorizontal:H,song:_,audioSong:P,sizes:l,colors:o})]})})},VsrgComposerCanvas}(z.Component),e5=o(37500),e4=o(12118),e6=o(45961),e8=o(73634),e7=o(51705),e9=o(62753),te=o(36443),tt=o(71094),tn=o(11163),tr=function(n){(0,S._)(VsrgComposer,n);var a=(0,P._)(VsrgComposer);function VsrgComposer(n){(0,j._)(this,VsrgComposer),(E=a.call(this,n)).lastTimestamp=0,E.changes=0,E.playbackTimestamp=0,E.mounted=!1,E.heldKeys=[],E.pressedDownHitObjects=[],E.unblock=function(){},E.cleanup=[],E.addTrack=function(){var n=E.state.vsrg;n.addTrack(),E.setState({vsrg:n},function(){return eL.emitEvent("tracksChange")})},E.handleShortcut=function(n){var a,o=n.shortcut,l=n.event,m=o.name;if("Space"===l.code){if(l.repeat&&"toggle_play"===m)return;(0,eZ.EB)(document.activeElement)&&(null===(a=document.activeElement)||void 0===a||a.blur())}var j=E.state,S=j.vsrg,T=j.selectedTrack,_=j.selectedHitObject,H=j.snapPointDuration,P=j.settings;if("set_tap_hand"===m&&E.setState({selectedType:"tap"}),"set_hold_hand"===m&&E.setState({selectedType:"hold"}),"set_delete_hand"===m&&E.setState({selectedType:"delete"}),"deselect"===m&&E.setState({selectedHitObject:null,lastCreatedHitObject:null}),"toggle_play"===m&&E.togglePlay(),"next_breakpoint"===m&&E.onBreakpointSelect(1),"previous_breakpoint"===m&&E.onBreakpointSelect(-1),"next_track"===m&&E.selectTrack(Math.min(E.state.vsrg.tracks.length-1,E.state.selectedTrack+1)),"previous_track"===m&&E.selectTrack(Math.max(0,E.state.selectedTrack-1)),"delete"===m){if(!_)return;S.removeHitObjectInTrackAtTimestamp(T,_.timestamp,_.index),E.setState({selectedHitObject:null,lastCreatedHitObject:null})}if("move_right"===m){if(!_)return;P.isVertical.value?_.index=(0,eZ.uZ)(_.index+1,0,S.keys):_.timestamp=_.timestamp+H,E.releaseHitObject()}if("move_down"===m){if(!_)return;P.isVertical.value?_.timestamp=_.timestamp-H:_.index=(0,eZ.uZ)(_.index+1,0,S.keys),E.releaseHitObject()}if("move_left"===m){if(!_)return;P.isVertical.value?_.index=(0,eZ.uZ)(_.index-1,0,S.keys):_.timestamp=_.timestamp-H,E.releaseHitObject()}if("move_up"===m){if(!_)return;P.isVertical.value?_.timestamp=_.timestamp+H:_.index=(0,eZ.uZ)(_.index-1,0,S.keys),E.releaseHitObject()}},E.updateSettings=function(n){e5.j.updateVsrgComposerSettings(void 0!==n?n:E.state.settings)},E.syncInstruments=function(){var n=E.state,a=n.vsrg;n.audioPlayer.syncInstruments(a.tracks.map(function(n){return n.instrument}))},E.syncAudioSongInstruments=function(){var n=E.state,a=n.audioSong,o=n.audioPlaybackPlayer;null!==a&&(o.syncInstruments(a.instruments),o.basePitch=a.pitch)},E.handleKeyboardDown=function(n){var a,o=n.event,l=n.letter,m=n.shift,j=E.state.vsrg;if(!m){var S=null===(a=eH.CB[j.keys])||void 0===a?void 0:a.indexOf(l);if(S>=0){if(o.repeat)return;E.startHitObjectTap(S)}}},E.handleKeyboardUp=function(n){var a,o=n.letter,l=E.state.vsrg,m=null===(a=eH.CB[l.keys])||void 0===a?void 0:a.indexOf(o);m>=0&&E.endHitObjectTap(m)},E.startHitObjectTap=function(n){var a=E.state,o=a.vsrg,l=a.selectedTrack,m=a.selectedType;E.heldKeys[n]=!0,E.changes++;var j=E.findClosestSnapPoint(E.lastTimestamp);if("delete"===m)return o.removeHitObjectInTrackAtTimestamp(l,j,n),E.setState({vsrg:o,selectedHitObject:null});var S=o.createHitObjectInTrack(l,j,n);E.pressedDownHitObjects[n]=S,E.setState({vsrg:o,selectedHitObject:S})},E.endHitObjectTap=function(n){var a=E.state,o=a.vsrg,l=a.selectedTrack,m=E.pressedDownHitObjects[n];if(E.heldKeys[n]&&m){var j=E.findClosestSnapPoint(m.timestamp+m.holdDuration);o.setHeldHitObjectTail(l,m,j-m.timestamp)}E.heldKeys[n]=!1,E.pressedDownHitObjects[n]=void 0},E.handleSettingChange=function(n){var a=E.state,o=a.settings,l=a.vsrg,m=n.data;o[n.key]=(0,_._)((0,T._)({},o[n.key]),{value:m.value}),"keys"===n.key&&l.changeKeys(m.value),"bpm"===n.key&&(l.set({bpm:m.value}),E.calculateSnapPoints()),"difficulty"===n.key&&l.set({difficulty:m.value}),E.setState({settings:(0,T._)({},o)},function(){E.updateSettings(),"keys"===n.key&&eL.emitEvent("updateKeys"),"isVertical"===n.key&&eL.emitEvent("updateOrientation"),"maxFps"===n.key&&eL.emitEvent("maxFpsChange")})};var o,S,P,E,z=(0,l._)(E);E.changePage=(o=(0,m._)(function(n){var a,o,l,m;return(0,O.Jh)(this,function(j){switch(j.label){case 0:if(o=(a=z.state).vsrg,l=a.settings,"Home"===n)return[2,ef.I.open()];if(!(0!==z.changes))return[3,5];if(!l.autosave.value)return[3,2];return[4,z.saveSong()];case 1:return j.sent(),[3,5];case 2:return[4,(0,et.jH)('You have unsaved changes to the song: "'.concat(o.name,'" do you want to save? UNSAVED CHANGES WILL BE LOST'),!1)];case 3:if(null===(m=j.sent()))return[2];if(!m)return[3,5];return[4,z.saveSong()];case 4:if(null===j.sent())return[2];j.label=5;case 5:return z.props.router.events.off("routeChangeStart",z.unblock),z.props.router.push((0,eZ.k8)(n)),[2]}})}),function(n){return o.apply(this,arguments)}),E.onSnapPointChange=function(n){var a=E.state.vsrg;a.set({snapPoint:n}),E.setState({snapPoint:n,vsrg:a},function(){E.calculateSnapPoints(),eL.emitEvent("snapPointChange")})},E.selectHitObject=function(n,a,o){var l=n.isHeld?"hold":"tap";if("delete"===E.state.selectedType||o===e9.u.Right){E.state.vsrg.removeHitObjectInTrack(a,n),E.setState({selectedHitObject:null,vsrg:E.state.vsrg});return}"hold"===E.state.selectedType&&o===e9.u.Left&&E.setState({selectedHitObject:n,lastCreatedHitObject:n,selectedType:l}),E.setState({selectedHitObject:n,selectedTrack:a,selectedType:l})},E.onSnapPointSelect=function(n,a,o){var l=E.state,m=l.vsrg,j=l.selectedType,S=l.lastCreatedHitObject,T=l.selectedTrack;if(l.selectedHitObject,E.changes++,n<0)return console.warn("Timestamp is less than 0");var _=m.getHitObjectsAt(n,a).find(function(n){return null!==n});if(o===e9.u.Unknown&&console.warn("unknown click type"),"tap"===j&&o===e9.u.Left){if(_)return E.setState({selectedHitObject:_});var H=m.createHitObjectInTrack(T,n,a);E.playHitObject(H,T),E.setState({selectedHitObject:H})}if("hold"===j&&o===e9.u.Left){if(null!==S)m.setHeldHitObjectTail(T,S,n-S.timestamp),E.setState({lastCreatedHitObject:null,selectedHitObject:null});else{if(_)return E.setState({selectedHitObject:_});var P=m.createHeldHitObject(T,n,a);E.setState({lastCreatedHitObject:P,selectedHitObject:P})}}("delete"===j||o===e9.u.Right)&&(m.removeHitObjectInTrackAtTimestamp(T,n,a),E.setState({selectedHitObject:null})),E.setState({vsrg:m})},E.selectTrack=function(n){E.setState({selectedTrack:n})},E.setAudioSong=function(n){var a=E.state.vsrg;if(E.changes++,null===n)return a.setAudioSong(null),E.setState({audioSong:null,renderableNotes:[]});var o=em.v.parseSong(n);if(o instanceof e8.M){a.setAudioSong(o),o.startPlayback(E.lastTimestamp),a.setDurationFromNotes(o.notes);var l=a.getRenderableNotes(o);E.setState({audioSong:o,renderableNotes:l},function(){E.syncAudioSongInstruments(),E.calculateSnapPoints()})}if(o instanceof e7.l){var m=o.toRecordedSong(0);a.setDurationFromNotes(m.notes),m.startPlayback(E.lastTimestamp),a.setAudioSong(o);var j=a.getRenderableNotes(m);E.setState({audioSong:m,renderableNotes:j},function(){E.syncAudioSongInstruments(),E.calculateSnapPoints()})}};var R=(0,l._)(E);E.askForSongUpdate=(0,m._)(function(){return(0,O.Jh)(this,function(n){switch(n.label){case 0:return[4,(0,et.jH)('You have unsaved changes to the song: "'.concat(R.state.vsrg.name,'" do you want to save now?'),!1)];case 1:return[2,n.sent()]}})});var A=(0,l._)(E);E.createNewSong=(0,m._)(function(){var n,a,o,l;return(0,O.Jh)(this,function(m){switch(m.label){case 0:if(!("Untitled"!==A.state.vsrg.name&&A.changes>0))return[3,3];return[4,A.askForSongUpdate()];case 1:if(null===(n=m.sent()))return[2];if(!n)return[3,3];return[4,A.saveSong()];case 2:m.sent(),m.label=3;case 3:return[4,(0,et.cJ)("Enter song name")];case 4:if(!(a=m.sent()))return[3,6];return(o=new eD.Cz(a)).set({bpm:A.state.settings.bpm.value,keys:A.state.settings.keys.value,pitch:A.state.settings.pitch.value,snapPoint:A.state.snapPoint}),o.addTrack(),[4,ev.k.addSong(o)];case 5:l=m.sent(),o.set({id:l}),A.setState({vsrg:o,renderableNotes:[]},function(){eL.emitEvent("songLoad"),A.calculateSnapPoints(),A.syncInstruments()}),m.label=6;case 6:return[2]}})}),E.calculateSnapPoints=function(){var n=E.state,a=n.vsrg,o=n.snapPoint,l=a.duration/Math.floor(6e4/a.bpm)*o,m=a.duration/l,j=Array(Math.floor(l)).fill(0).map(function(n,a){return a*m});E.setState({snapPoints:j,snapPointDuration:m})},E.dragHitObject=function(n,a){var o=E.state,l=o.selectedHitObject,m=o.vsrg,j=o.settings;null!==l&&(l.timestamp=n,void 0!==a&&a<j.keys.value&&(l.index=a),E.setState({vsrg:m,selectedHitObject:l}))},E.findClosestSnapPoint=function(n){return E.state.snapPoints.reduce(function(a,o){return Math.abs(o-n)<Math.abs(a-n)?o:a})},E.releaseHitObject=function(){var n=E.state,a=n.selectedHitObject,o=n.vsrg;null!==a&&(a.timestamp=E.findClosestSnapPoint(a.timestamp),o.getHitObjectsBetween(a.timestamp,a.timestamp+a.holdDuration,a.index).forEach(function(n,l){return n.forEach(function(n){return n!==a&&o.removeHitObjectInTrackAtTimestamp(l,n.timestamp,n.index)})}),E.changes++,E.setState({vsrg:o}))},E.onTrackChange=function(n,a){var o=E.state.vsrg;o.tracks[a]=n,E.setState({vsrg:o},E.syncInstruments)},E.onNoteSelect=function(n){var a=E.state,o=a.selectedHitObject,l=a.audioPlayer,m=a.selectedTrack;null==o||o.toggleNote(n),l.playNoteOfInstrument(m,n),E.setState({selectedHitObject:o})},E.togglePlay=function(){var n=E.state,a=n.isPlaying,o=n.vsrg,l=n.audioSong;if(o.startPlayback(E.lastTimestamp),E.lastTimestamp>=o.duration)return E.setState({isPlaying:!1});l&&l.startPlayback(E.lastTimestamp),E.setState({isPlaying:!a})},E.playHitObject=function(n,a){E.state.audioPlayer.playNotesOfInstrument(a,n.notes)},E.onTimestampChange=function(n){var a=E.state,o=a.vsrg,l=a.isPlaying,m=a.audioSong,j=a.audioPlaybackPlayer,S=a.snapPointDuration;if(E.lastTimestamp=n,l){if(E.lastTimestamp>=o.duration)return E.setState({isPlaying:!1});E.heldKeys.forEach(function(a,o){if(a){var l=E.pressedDownHitObjects[o];if(l){var m=n-l.timestamp;m>S&&(l.holdDuration=m,l.isHeld=!0)}}}),m&&m.tickPlayback(n).forEach(function(n){n.layer.toArray().forEach(function(a,l){0===a||o.trackModifiers[l].muted||j.playNoteOfInstrument(l,n.index)})}),o.tickPlayback(n).forEach(function(n,a){return n.forEach(function(n){return E.playHitObject(n,a)})})}};var V=(0,l._)(E);E.deleteTrack=(S=(0,m._)(function(n){var a;return(0,O.Jh)(this,function(o){switch(o.label){case 0:if(1===(a=V.state.vsrg).tracks.length)return[2,ew.kg.error("Cannot delete last track")];return[4,(0,et.jH)("Are you sure you want to remove this track? All notes will be deleted.")];case 1:if(!o.sent()||!V.mounted)return[2];return V.changes++,a.deleteTrack(n),V.setState({vsrg:a,selectedTrack:Math.max(0,n-1)},function(){return eL.emitEvent("tracksChange")}),[2]}})}),function(n){return S.apply(this,arguments)});var J=(0,l._)(E);E.onSongOpen=(P=(0,m._)(function(n){var a,o,l,j,S;return(0,O.Jh)(this,function(H){switch(H.label){case 0:if(o=(a=J.state).settings,l=a.vsrg,!(0!==J.changes))return[3,4];if(j=o.autosave.value&&"Untitled"!==l.name)return[3,2];return[4,(0,et.jH)('You have unsaved changes to the song: "'.concat(l.name,'" do you want to save? UNSAVED CHANGES WILL BE LOST'),!1)];case 1:if(null===(S=H.sent()))return[2];j=S,H.label=2;case 2:if(!j)return[3,4];return[4,J.saveSong()];case 3:if(null===H.sent())return[2];H.label=4;case 4:return o.bpm=(0,_._)((0,T._)({},o.bpm),{value:n.bpm}),o.keys=(0,_._)((0,T._)({},o.keys),{value:n.keys}),o.pitch=(0,_._)((0,T._)({},o.pitch),{value:n.pitch}),J.updateSettings(),J.changes++,J.setState({vsrg:n,snapPoint:n.snapPoint,selectedTrack:0,selectedHitObject:null,lastCreatedHitObject:null},(0,m._)(function(){var a;return(0,O.Jh)(this,function(o){switch(o.label){case 0:return eL.emitEvent("songLoad"),J.syncInstruments(),[4,ev.k.getSongById(n.audioSongId)];case 1:return a=o.sent(),J.setAudioSong(a),J.calculateSnapPoints(),[2]}})})),[2]}})}),function(n){return P.apply(this,arguments)}),E.addTime=function(){var n=E.state.vsrg;n.duration+=1e3,E.calculateSnapPoints(),E.changes++,E.setState({vsrg:n})},E.removeTime=function(){var n=E.state.vsrg;n.duration-=1e3,E.calculateSnapPoints(),E.changes++,E.setState({vsrg:n})},E.onScalingChange=function(n){E.setState({scaling:n},function(){return eL.emitEvent("scaleChange")})};var W=(0,l._)(E);E.saveSong=(0,m._)(function(){var n,a,o,l;return(0,O.Jh)(this,function(m){switch(m.label){case 0:if(!(null!==(n=W.state.vsrg).id))return[3,1];return o=n.name,[3,3];case 1:return[4,(0,et.cJ)("Enter song name")];case 2:o=m.sent(),m.label=3;case 3:if(null===(a=o))return[2,null];if(n.set({name:a}),null!==n.id)return[3,5];return[4,ev.k.addSong(n)];case 4:return l=m.sent(),n.set({id:l}),[3,6];case 5:ev.k.updateSong(n),m.label=6;case 6:return W.changes=0,W.setState({vsrg:n}),[2,n]}})}),E.onTrackModifierChange=function(n,a,o){var l=E.state,m=l.vsrg,j=l.audioSong;if(m.trackModifiers[a]=n,m.trackModifiers=(0,H._)(m.trackModifiers),E.changes++,o&&j){var S=m.getRenderableNotes(j);return E.setState({renderableNotes:S,vsrg:m})}E.setState({vsrg:m})},E.onTempoChangerChange=function(n){E.setState({tempoChanger:n})},E.selectType=function(n){E.setState({selectedType:n,lastCreatedHitObject:null})},E.onBreakpointChange=function(n){var a=E.state.vsrg,o=E.findClosestSnapPoint(E.lastTimestamp);a.setBreakpoint(o,!n),E.setState({vsrg:a})},E.onBreakpointSelect=function(n){var a=E.state,o=a.vsrg,l=a.isPlaying,m=a.audioSong,j=o.getClosestBreakpoint(E.lastTimestamp,n);l&&(null==m||m.startPlayback(j),o.startPlayback(j)),eL.emitEvent("timestampChange",j)};var $=e5.j.getDefaultVsrgComposerSettings();return E.state={vsrg:new eD.Cz("Untitled"),audioPlayer:new e4.z($.pitch.value),audioPlaybackPlayer:new e4.z($.pitch.value),selectedTrack:0,snapPoint:1,snapPoints:[0],snapPointDuration:0,selectedHitObject:null,scaling:60,selectedType:"tap",isPlaying:!1,lastCreatedHitObject:null,settings:$,audioSong:null,renderableNotes:[],tempoChanger:1},E.state.vsrg.addTrack("DunDun"),E.state.vsrg.set({bpm:$.bpm.value,keys:$.keys.value}),E.mounted=!1,E}var o=VsrgComposer.prototype;return o.componentDidMount=function(){var n=this,a=e5.j.getVsrgComposerSettings();this.setState({settings:a}),this.state.audioPlayer.setBasePitch(a.pitch.value),this.state.audioPlaybackPlayer.setBasePitch(a.pitch.value),this.mounted=!0;var o="vsrg-composer";this.calculateSnapPoints(),this.syncInstruments(),this.unblock=function(a){if(0!==n.changes)throw n.changePage(a),n.props.router.events.emit("routeChangeError"),"routeChange aborted.";n.props.router.events.off("routeChangeStart",n.unblock),n.props.router.push((0,eZ.k8)(a))},this.props.router.events.on("routeChangeStart",this.unblock);var l=(0,ex.JZ)("vsrg_composer","vsrg_composer",this.handleShortcut);this.cleanup.push(l),e6.w.listen(this.handleKeyboardDown,{id:o,type:"keydown"}),e6.w.listen(this.handleKeyboardUp,{id:o,type:"keyup"})},o.componentWillUnmount=function(){this.mounted=!1,e6.w.unregisterById("vsrg-composer"),this.props.router.events.off("routeChangeStart",this.unblock);var n=this.state,a=n.audioPlaybackPlayer,o=n.audioPlayer;a.destroy(),o.destroy(),this.cleanup.forEach(function(n){return n()})},o.render=function(){var n,a=this.state,o=a.settings,l=a.selectedTrack,m=a.vsrg,j=a.lastCreatedHitObject,S=a.snapPoints,T=a.isPlaying,_=a.snapPoint,H=a.selectedHitObject,P=a.selectedType,O=a.audioSong,z=a.scaling,R=a.renderableNotes,A=a.tempoChanger;return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(te.V,{text:"Vsrg Composer - ".concat(null!==(n=m.name)&&void 0!==n?n:"Unnamed"),description:"Create new VSRG songs using existing background songs and create your own beatmap for it."}),(0,E.jsx)(eN,{trackModifiers:m.trackModifiers,hasChanges:this.changes>0,settings:o,audioSong:O,onTrackModifierChange:this.onTrackModifierChange,onSongOpen:this.onSongOpen,onSave:this.saveSong,onCreateSong:this.createNewSong,setAudioSong:this.setAudioSong,handleSettingChange:this.handleSettingChange}),(0,E.jsxs)("div",{className:"vsrg-page appear-on-mount",children:[(0,E.jsx)(VsrgTop,{vsrg:m,onBreakpointSelect:this.onBreakpointSelect,onBreakpointChange:this.onBreakpointChange,selectedHitObject:H,isHorizontal:!o.isVertical.value,selectedTrack:l,lastCreatedHitObject:j,onTrackAdd:this.addTrack,onTrackChange:this.onTrackChange,onTrackDelete:this.deleteTrack,onTrackSelect:this.selectTrack,onNoteSelect:this.onNoteSelect,children:(0,E.jsx)(e3,{vsrg:m,renderableNotes:R,onTimestampChange:this.onTimestampChange,selectedHitObject:H,isHorizontal:!o.isVertical.value,tempoChanger:A,scrollSnap:o.scrollSnap.value,maxFps:o.maxFps.value,scaling:z,audioSong:O,snapPoint:_,snapPoints:S,isPlaying:T,onRemoveTime:this.removeTime,onAddTime:this.addTime,onKeyDown:this.startHitObjectTap,onKeyUp:this.endHitObjectTap,dragHitObject:this.dragHitObject,releaseHitObject:this.releaseHitObject,selectHitObject:this.selectHitObject,onSnapPointSelect:this.onSnapPointSelect})}),(0,E.jsx)(VsrgBottom,{vsrg:m,scaling:z,tempoChanger:A,onTempoChangerChange:this.onTempoChangerChange,onScalingChange:this.onScalingChange,isPlaying:T,togglePlay:this.togglePlay,selectedSnapPoint:_,onSnapPointChange:this.onSnapPointChange,selectedHitObjectType:P,onHitObjectTypeChange:this.selectType})]})]})},VsrgComposer}(z.Component);function VsrgcomposerPage(){var n=(0,tn.useRouter)();return(0,E.jsx)(tr,{router:n})}VsrgcomposerPage.getLayout=function(n){return(0,E.jsx)(tt.Z,{page:"Composer",children:n})}},76577:function(n){n.exports={"help-icon":"HelpTab_help-icon__LZT3K","help-icon-wrapper":"HelpTab_help-icon-wrapper__765O_","help-title":"HelpTab_help-title__B5SPa","help-margin-left":"HelpTab_help-margin-left__5ibwm","help-img":"HelpTab_help-img__kRbW_","keys-table":"HelpTab_keys-table__JU_J5"}},55651:function(n,a,o){"use strict";o.d(a,{L_:function(){return ne},ZE:function(){return Oe},gW:function(){return Z}});var l=o(67294);function u(){return(u=Object.assign||function(n){for(var a=1;a<arguments.length;a++){var o=arguments[a];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(n[l]=o[l])}return n}).apply(this,arguments)}function c(n,a){if(null==n)return{};var o,l,m={},j=Object.keys(n);for(l=0;l<j.length;l++)a.indexOf(o=j[l])>=0||(m[o]=n[o]);return m}function i(n){var a=(0,l.useRef)(n),o=(0,l.useRef)(function(n){a.current&&a.current(n)});return a.current=n,o.current}var s=function(n,a,o){return void 0===a&&(a=0),void 0===o&&(o=1),n>o?o:n<a?a:n},f=function(n){return"touches"in n},v=function(n){return n&&n.ownerDocument.defaultView||self},d=function(n,a,o){var l=n.getBoundingClientRect(),m=f(a)?function(n,a){for(var o=0;o<n.length;o++)if(n[o].identifier===a)return n[o];return n[0]}(a.touches,o):a;return{left:s((m.pageX-(l.left+v(n).pageXOffset))/l.width),top:s((m.pageY-(l.top+v(n).pageYOffset))/l.height)}},h=function(n){f(n)||n.preventDefault()},m=l.memo(function(n){var a=n.onMove,o=n.onKey,m=c(n,["onMove","onKey"]),j=(0,l.useRef)(null),S=i(a),T=i(o),_=(0,l.useRef)(null),H=(0,l.useRef)(!1),P=(0,l.useMemo)(function(){var e=function(n){h(n),(f(n)?n.touches.length>0:n.buttons>0)&&j.current?S(d(j.current,n,_.current)):t(!1)},r=function(){return t(!1)};function t(n){var a=H.current,o=v(j.current),l=n?o.addEventListener:o.removeEventListener;l(a?"touchmove":"mousemove",e),l(a?"touchend":"mouseup",r)}return[function(n){var a=n.nativeEvent,o=j.current;if(o&&(h(a),(!H.current||f(a))&&o)){if(f(a)){H.current=!0;var l=a.changedTouches||[];l.length&&(_.current=l[0].identifier)}o.focus(),S(d(o,a,_.current)),t(!0)}},function(n){var a=n.which||n.keyCode;a<37||a>40||(n.preventDefault(),T({left:39===a?.05:37===a?-.05:0,top:40===a?.05:38===a?-.05:0}))},t]},[T,S]),O=P[0],E=P[1],z=P[2];return(0,l.useEffect)(function(){return z},[z]),l.createElement("div",u({},m,{onTouchStart:O,onMouseDown:O,className:"react-colorful__interactive",ref:j,onKeyDown:E,tabIndex:0,role:"slider"}))}),g=function(n){return n.filter(Boolean).join(" ")},p=function(n){var a=n.color,o=n.left,m=n.top,j=g(["react-colorful__pointer",n.className]);return l.createElement("div",{className:j,style:{top:100*(void 0===m?.5:m)+"%",left:100*o+"%"}},l.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:a}}))},b=function(n,a,o){return void 0===a&&(a=0),void 0===o&&(o=Math.pow(10,a)),Math.round(o*n)/o},x=function(n){return L(C(n))},C=function(n){return"#"===n[0]&&(n=n.substring(1)),n.length<6?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:4===n.length?b(parseInt(n[3]+n[3],16)/255,2):1}:{r:parseInt(n.substring(0,2),16),g:parseInt(n.substring(2,4),16),b:parseInt(n.substring(4,6),16),a:8===n.length?b(parseInt(n.substring(6,8),16)/255,2):1}},w=function(n){return K(I(n))},y=function(n){var a=n.s,o=n.v,l=n.a,m=(200-a)*o/100;return{h:b(n.h),s:b(m>0&&m<200?a*o/100/(m<=100?m:200-m)*100:0),l:b(m/2),a:b(l,2)}},q=function(n){var a=y(n);return"hsl("+a.h+", "+a.s+"%, "+a.l+"%)"},k=function(n){var a=y(n);return"hsla("+a.h+", "+a.s+"%, "+a.l+"%, "+a.a+")"},I=function(n){var a=n.h,o=n.s,l=n.v,m=n.a;a=a/360*6,o/=100,l/=100;var j=Math.floor(a),S=l*(1-o),T=l*(1-(a-j)*o),_=l*(1-(1-a+j)*o),H=j%6;return{r:b(255*[l,T,S,S,_,l][H]),g:b(255*[_,l,l,T,S,S][H]),b:b(255*[S,S,_,l,l,T][H]),a:b(m,2)}},D=function(n){var a=n.toString(16);return a.length<2?"0"+a:a},K=function(n){var a=n.r,o=n.g,l=n.b,m=n.a,j=m<1?D(b(255*m)):"";return"#"+D(a)+D(o)+D(l)+j},L=function(n){var a=n.r,o=n.g,l=n.b,m=n.a,j=Math.max(a,o,l),S=j-Math.min(a,o,l),T=S?j===a?(o-l)/S:j===o?2+(l-a)/S:4+(a-o)/S:0;return{h:b(60*(T<0?T+6:T)),s:b(j?S/j*100:0),v:b(j/255*100),a:m}},j=l.memo(function(n){var a=n.hue,o=n.onChange,j=g(["react-colorful__hue",n.className]);return l.createElement("div",{className:j},l.createElement(m,{onMove:function(n){o({h:360*n.left})},onKey:function(n){o({h:s(a+360*n.left,0,360)})},"aria-label":"Hue","aria-valuenow":b(a),"aria-valuemax":"360","aria-valuemin":"0"},l.createElement(p,{className:"react-colorful__hue-pointer",left:a/360,color:q({h:a,s:100,v:100,a:1})})))}),S=l.memo(function(n){var a=n.hsva,o=n.onChange,j={backgroundColor:q({h:a.h,s:100,v:100,a:1})};return l.createElement("div",{className:"react-colorful__saturation",style:j},l.createElement(m,{onMove:function(n){o({s:100*n.left,v:100-100*n.top})},onKey:function(n){o({s:s(a.s+100*n.left,0,100),v:s(a.v-100*n.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+b(a.s)+"%, Brightness "+b(a.v)+"%"},l.createElement(p,{className:"react-colorful__saturation-pointer",top:1-a.v/100,left:a.s/100,color:q(a)})))}),F=function(n,a){if(n===a)return!0;for(var o in n)if(n[o]!==a[o])return!1;return!0},X=function(n,a){return n.toLowerCase()===a.toLowerCase()||F(C(n),C(a))};function Y(n,a,o){var m=i(o),j=(0,l.useState)(function(){return n.toHsva(a)}),S=j[0],T=j[1],_=(0,l.useRef)({color:a,hsva:S});return(0,l.useEffect)(function(){if(!n.equal(a,_.current.color)){var o=n.toHsva(a);_.current={hsva:o,color:a},T(o)}},[a,n]),(0,l.useEffect)(function(){var a;F(S,_.current.hsva)||n.equal(a=n.fromHsva(S),_.current.color)||(_.current={hsva:S,color:a},m(a))},[S,n,m]),[S,(0,l.useCallback)(function(n){T(function(a){return Object.assign({},a,n)})},[])]}var T,_="undefined"!=typeof window?l.useLayoutEffect:l.useEffect,H=new Map,Q=function(n){_(function(){var a=n.current?n.current.ownerDocument:document;if(void 0!==a&&!H.has(a)){var l=a.createElement("style");l.innerHTML='.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>\')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}',H.set(a,l);var m=T||o.nc;m&&l.setAttribute("nonce",m),a.head.appendChild(l)}},[])},U=function(n){var a=n.className,o=n.colorModel,m=n.color,T=void 0===m?o.defaultColor:m,_=n.onChange,H=c(n,["className","colorModel","color","onChange"]),P=(0,l.useRef)(null);Q(P);var O=Y(o,T,_),E=O[0],z=O[1],R=g(["react-colorful",a]);return l.createElement("div",u({},H,{ref:P,className:R}),l.createElement(S,{hsva:E,onChange:z}),l.createElement(j,{hue:E.h,onChange:z,className:"react-colorful__last-control"}))},P={defaultColor:"000",toHsva:x,fromHsva:function(n){return w({h:n.h,s:n.s,v:n.v,a:1})},equal:X},Z=function(n){return l.createElement(U,u({},n,{colorModel:P}))},ee=function(n){var a=n.className,o=n.hsva,j=n.onChange,S={backgroundImage:"linear-gradient(90deg, "+k(Object.assign({},o,{a:0}))+", "+k(Object.assign({},o,{a:1}))+")"},T=g(["react-colorful__alpha",a]),_=b(100*o.a);return l.createElement("div",{className:T},l.createElement("div",{className:"react-colorful__alpha-gradient",style:S}),l.createElement(m,{onMove:function(n){j({a:n.left})},onKey:function(n){j({a:s(o.a+n.left)})},"aria-label":"Alpha","aria-valuetext":_+"%","aria-valuenow":_,"aria-valuemin":"0","aria-valuemax":"100"},l.createElement(p,{className:"react-colorful__alpha-pointer",left:o.a,color:k(o)})))},re=function(n){var a=n.className,o=n.colorModel,m=n.color,T=void 0===m?o.defaultColor:m,_=n.onChange,H=c(n,["className","colorModel","color","onChange"]),P=(0,l.useRef)(null);Q(P);var O=Y(o,T,_),E=O[0],z=O[1],R=g(["react-colorful",a]);return l.createElement("div",u({},H,{ref:P,className:R}),l.createElement(S,{hsva:E,onChange:z}),l.createElement(j,{hue:E.h,onChange:z}),l.createElement(ee,{hsva:E,onChange:z,className:"react-colorful__last-control"}))},O={defaultColor:"0001",toHsva:x,fromHsva:w,equal:X},ne=function(n){return l.createElement(re,u({},n,{colorModel:O}))},E=/^#?([0-9A-F]{3,8})$/i,ke=function(n){var a=n.color,o=void 0===a?"":a,m=n.onChange,j=n.onBlur,S=n.escape,T=n.validate,_=n.format,H=n.process,P=c(n,["color","onChange","onBlur","escape","validate","format","process"]),O=(0,l.useState)(function(){return S(o)}),E=O[0],z=O[1],R=i(m),A=i(j),V=(0,l.useCallback)(function(n){var a=S(n.target.value);z(a),T(a)&&R(H?H(a):a)},[S,H,T,R]),J=(0,l.useCallback)(function(n){T(n.target.value)||z(S(o)),A(n)},[o,S,T,A]);return(0,l.useEffect)(function(){z(S(o))},[o,S]),l.createElement("input",u({},P,{value:_?_(E):E,spellCheck:"false",onChange:V,onBlur:J}))},Ie=function(n){return"#"+n},Oe=function(n){var a=n.prefixed,o=n.alpha,m=c(n,["prefixed","alpha"]),j=(0,l.useCallback)(function(n){return n.replace(/([^0-9A-F]+)/gi,"").substring(0,o?8:6)},[o]),S=(0,l.useCallback)(function(n){var a,l;return 3===(l=(a=E.exec(n))?a[1].length:0)||6===l||!!o&&4===l||!!o&&8===l},[o]);return l.createElement(ke,u({},m,{escape:j,format:a?Ie:void 0,process:Ie,validate:S}))}}},function(n){n.O(0,[9569,6441,4031,9774,2888,179],function(){return n(n.s=40120)}),_N_E=n.O()}]);