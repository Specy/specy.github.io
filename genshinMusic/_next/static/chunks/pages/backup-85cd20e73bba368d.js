(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4910],{65164:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/backup",function(){return t(2053)}])},3924:function(e,n,t){"use strict";t.d(n,{k:function(){return MultipleOptionSlider}});var r=t(91309),a=t(85893),s=t(73288),o=t(67294);function MultipleOptionSlider(e){var n=e.options,t=e.selected,l=e.onChange,i=(0,o.useRef)(null),c=n.find(function(e){return e.value===t}),u=(0,r._)((0,o.useState)({width:0,left:0}),2),d=u[0],h=u[1];return(0,o.useEffect)(function(){var e,r=null===(e=i.current)||void 0===e?void 0:e.querySelectorAll("button"),a=n.findIndex(function(e){return e.value===t});if(r&&!(a<0)){var s=r[a].getBoundingClientRect(),o=i.current.getBoundingClientRect();h({width:s.width,left:s.left-o.left})}},[i,n,t]),(0,a.jsxs)("div",{className:"multiple-option-slider",ref:i,children:[n.map(function(e){return(0,a.jsx)("button",{onClick:function(){return l(e.value)},className:e===c?"multiple-options-selected":"",children:(0,s.kC)(e.value)},e.value)}),(0,a.jsx)("div",{className:"multiple-option-slider-overlay",style:{width:"".concat(d.width,"px"),left:"".concat(d.left,"px"),backgroundColor:null==c?void 0:c.color}})]})}},97167:function(e,n,t){"use strict";t.d(n,{G:function(){return FilePicker}});var r=t(11010),a=t(97582),s=t(85893),o=t(67294);function FilePicker(e){var n,t=e.children,l=e.onPick,i=e.style,c=e.as,u=e.multiple,d=e.onError,h=(0,o.useRef)(null),f=(0,o.useCallback)((n=(0,r._)(function(e){var n,t,r,s;return(0,a.Jh)(this,function(a){switch(a.label){case 0:if(null===e.target.files)return[2];if(t=Array.from(null!==(n=e.target.files)&&void 0!==n?n:[]),"file"===c)return[2,l(t.map(function(e){return{data:e,file:e}}))];r=t.map(function(e){return new Promise(function(n,t){var r=new FileReader;try{r.addEventListener("loadend",function(){try{var a=r.result;n({data:"json"===c?JSON.parse(a):a,file:e})}catch(e){t(e)}},{once:!0}),("text"===c||"json"===c)&&r.readAsText(e),"buffer"===c&&r.readAsArrayBuffer(e)}catch(e){t(e)}})}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Promise.all(r)];case 2:return l(a.sent()),[3,4];case 3:return console.error(s=a.sent()),null==d||d(s,t),[3,4];case 4:return null!==h.current&&(h.current.value=""),[2]}})}),function(e){return n.apply(this,arguments)}),[c,l,d]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"file",style:{display:"none"},ref:h,onChange:f,multiple:void 0!==u&&u}),(0,s.jsx)("div",{onClick:function(){var e;return null===(e=h.current)||void 0===e?void 0:e.click()},style:void 0===i?{}:i,children:t})]})}},36443:function(e,n,t){"use strict";t.d(n,{V:function(){return PageMeta}});var r=t(85893),a=t(9008),s=t.n(a);function PageMeta(e){var n=e.text,t=e.description,a=e.image,o=e.children;return(0,r.jsxs)(s(),{children:[(0,r.jsx)("title",{children:n}),t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("meta",{name:"description",content:t}),(0,r.jsx)("meta",{property:"og:description",content:t})]}),a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("meta",{name:"image",content:a}),(0,r.jsx)("meta",{property:"og:image",content:a})]}),o]})}},77275:function(e,n,t){"use strict";t.d(n,{k:function(){return DefaultPage}});var r=t(72253),a=t(14932),s=t(85893),o=t(62926);function DefaultPage(e){var n=e.excludeMenu,t=e.children,l=e.className,i=e.style,c=e.menu,u=e.cropped,d=void 0===u||u?i:(0,a._)((0,r._)({},i),{padding:0});return(0,s.jsxs)("div",{className:"default-page "+(void 0===l?"":l),style:d,children:[(!(void 0!==n&&n)||!c)&&(0,s.jsx)(o.O,{}),c,(0,s.jsx)("main",{className:"default-content appear-on-mount",children:t})]})}},62926:function(e,n,t){"use strict";t.d(n,{O:function(){return SimpleMenu}});var r=t(11010),a=t(97582),s=t(85893),o=t(52091),l=t(66826),i=t(19807),c=t(10398),u=t(11163),d=t(41664),h=t.n(d),f=t(5336);function SimpleMenu(e){var n,t=e.children,d=e.className,g=(0,u.useRouter)();return(0,s.jsx)("div",{className:"menu-wrapper "+(void 0===d?"":d),children:(0,s.jsxs)("div",{className:"menu menu-visible",style:{justifyContent:"flex-end"},children:[i.U.hasNavigated&&(0,s.jsx)(l.s,{style:{marginBottom:"auto"},onClick:function(){g.back()},ariaLabel:"Go back",children:(0,s.jsx)(o.x_l,{className:"icon"})}),void 0===t?void 0:t,(0,s.jsx)(h(),{href:"https://discord.gg/Arsf65YYHq",target:"_blank",rel:"noreferrer",title:"Go to discord",onClick:(n=(0,r._)(function(e){return(0,a.Jh)(this,function(n){switch(n.label){case 0:return e.preventDefault(),[4,(0,f.jH)("You are leaving the app to go to discord, do you want to continue?")];case 1:if(!n.sent())return[2];return window.open("https://discord.gg/Arsf65YYHq","_blank"),[2]}})}),function(e){return n.apply(this,arguments)}),children:(0,s.jsx)(l.s,{ariaLabel:"Go to discord",children:(0,s.jsx)(o.j2d,{className:"icon"})})}),(0,s.jsx)(l.s,{onClick:c.I.open,ariaLabel:"Open home menu",style:{border:"solid 0.1rem var(--secondary)"},children:(0,s.jsx)(o.xng,{className:"icon"})})]})})}},41072:function(e,n,t){"use strict";t.d(n,{n:function(){return useSongs}});var r=t(91309),a=t(4586),s=t(67294),o=t(68949),l=t(10681);function useSongs(){var e=(0,r._)((0,s.useState)(l.k.songs),2),n=e[0],t=e[1];return(0,s.useEffect)(function(){var e,n;return e=function(e){t(e)},n=(0,o.N7)(l.k.songs,function(){e((0,a._)(l.k.songs))}),e((0,a._)(l.k.songs)),n},[]),[n]}},2053:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Backup}});var r=t(11010),a=t(75766),s=t(72253),o=t(14932),l=t(91309),i=t(4586),c=t(97582),u=t(85893),d=t(28796),h=t(77275),f=t(36443),g=t(52091),p=t(67294),m=t(18208),y=t(85609),v=t(95154),w=t(17159),k=t(5336),x=t(37870),b=t(26427),_=t(51854),j=t(1062),S=t(97167),N=t(73288),A=t(41072),D=t(49894),C=t(11275),T=t(10681),F=t(37500),L=t(41664),E=t.n(L),J=t(93778),P=t(3924),R=t(18212);function Backup(){var e=(0,l._)((0,R.F)(),1)[0],n={marginRight:"0.3rem",marginLeft:"-0.4rem"},t=(0,l._)((0,A.n)(),1)[0],L=(0,D.ih)(C.N.themes),O=(0,l._)((0,p.useState)("json"),2),M=O[0],B=O[1];function validateSongs(){return _validateSongs.apply(this,arguments)}function _validateSongs(){return(_validateSongs=(0,r._)(function(){var e,n,t,r,a,s,o,l;return(0,c.Jh)(this,function(c){switch(c.label){case 0:return x.kg.showPill("Validating songs..."),[4,m.v.getSongs()];case 1:e=c.sent(),n=[],t=!0,r=!1,a=void 0;try{for(s=e[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){l=o.value;try{m.v.parseSong(l)}catch(e){console.error(e),n.push(l),x.kg.error('Error validating song "'.concat(null==l?void 0:l.name,'"'))}}}catch(e){r=!0,a=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw a}}if(!(n.length>0))return[3,3];return[4,(0,k.cJ)("There were errors validating some songs. Do you want to continue downloading?")];case 2:if(!c.sent())return[2,null];c.label=3;case 3:return x.kg.hidePill(),[2,(0,i._)(e)]}})})).apply(this,arguments)}function validateFolders(){return _validateFolders.apply(this,arguments)}function _validateFolders(){return(_validateFolders=(0,r._)(function(){var e,n,t,r,a,s,o,l;return(0,c.Jh)(this,function(c){switch(c.label){case 0:return x.kg.showPill("Validating folders..."),e=[],[4,w.b.getFolders()];case 1:n=c.sent(),t=!0,r=!1,a=void 0;try{for(s=n[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){l=o.value;try{_.g.deserialize(l)}catch(n){console.error(n),e.push(l),x.kg.error('Error validating folder "'.concat(null==l?void 0:l.name,'"'))}}}catch(e){r=!0,a=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw a}}if(!(e.length>0))return[3,3];return[4,(0,k.cJ)("There were errors validating some folders. Do you want to continue downloading?")];case 2:if(!c.sent())return[2,null];c.label=3;case 3:return x.kg.hidePill(),[2,(0,i._)(n)]}})})).apply(this,arguments)}function validateThemes(){return _validateThemes.apply(this,arguments)}function _validateThemes(){return(_validateThemes=(0,r._)(function(){var e,n,t,r,a,s,o;return(0,c.Jh)(this,function(l){switch(l.label){case 0:return x.kg.showPill("Validating themes..."),[4,y.a.getThemes()];case 1:e=l.sent(),n=[],t=!0,r=!1,a=void 0;try{for(s=e[Symbol.iterator]();!(t=(o=s.next()).done);t=!0)o.value}catch(e){r=!0,a=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw a}}if(!(n.length>0))return[3,3];return[4,(0,k.cJ)("There were errors validating some themes. Do you want to continue downloading?")];case 2:if(!l.sent())return[2,null];l.label=3;case 3:return x.kg.hidePill(),[2,(0,i._)(e)]}})})).apply(this,arguments)}function _onFilePick(){return(_onFilePick=(0,r._)(function(e){var n,t,r,a,s,o,l,i,u;return(0,c.Jh)(this,function(c){switch(c.label){case 0:n=!0,t=!1,r=void 0,c.label=1;case 1:c.trys.push([1,8,9,10]),a=e[Symbol.iterator](),c.label=2;case 2:if(n=(s=a.next()).done)return[3,7];o=s.value,c.label=3;case 3:return c.trys.push([3,5,,6]),l=Array.isArray(o.data)?o.data:[o.data],[4,b.bV.importAndLog(l)];case 4:return c.sent(),[3,6];case 5:return console.error(c.sent()),x.kg.error('Error importing file "'.concat(null===(i=o.file)||void 0===i?void 0:i.name,'"')),[3,6];case 6:return n=!0,[3,2];case 7:return[3,10];case 8:return u=c.sent(),t=!0,r=u,[3,10];case 9:try{n||null==a.return||a.return()}finally{if(t)throw r}return[7];case 10:return[2]}})})).apply(this,arguments)}function _deleteAllSongsAndFolders(){return(_deleteAllSongsAndFolders=(0,r._)(function(){return(0,c.Jh)(this,function(e){switch(e.label){case 0:return[4,(0,k.cJ)("Write 'delete' if you want to delete all songs, press cancel to ignore")];case 1:if("delete"!==e.sent())return[2,x.kg.warn("Action cancelled")];return[4,(0,N.gw)(200)];case 2:return e.sent(),[4,(0,k.jH)("Are you REALLY sure you want to delete all songs?")];case 3:if(!e.sent())return[2,x.kg.warn("Action cancelled")];return[4,T.k._DANGEROUS_CLEAR_ALL_SONGS()];case 4:return e.sent(),[4,v.p._DANGEROUS_CLEAR_ALL_FOLDERS()];case 5:return e.sent(),x.kg.success("Deleted all songs"),[2]}})})).apply(this,arguments)}function _deleteAllThemes(){return(_deleteAllThemes=(0,r._)(function(){return(0,c.Jh)(this,function(e){switch(e.label){case 0:return[4,(0,k.cJ)("Write 'delete' if you want to delete all themes")];case 1:if("delete"!==e.sent())return[2,x.kg.warn("Action cancelled")];return[4,(0,N.gw)(200)];case 2:return e.sent(),[4,(0,k.jH)("Are you REALLY sure you want to delete all themes?")];case 3:if(!e.sent())return[2,x.kg.warn("Action cancelled")];return[4,C.N._DANGEROUS_CLEAR_ALL_THEMES()];case 4:return e.sent(),x.kg.success("Deleted all themes"),[2]}})})).apply(this,arguments)}function downloadFiles(e,n){return _downloadFiles.apply(this,arguments)}function _downloadFiles(){return(_downloadFiles=(0,r._)(function(e,n){var t,r;return(0,c.Jh)(this,function(s){switch(s.label){case 0:if("json"!==M)return[3,1];return b.bV.downloadFiles(e,n),[3,4];case 1:return s.trys.push([1,3,,4]),x.kg.showPill("Zipping files..."),[4,new Promise(function(t,r){var s,o=e.map(function(e){var n=b.bV.getUnknownFileExtensionAndName(e);if(!n)return["unknown".concat(Math.floor(1e3*Math.random()),".").concat(e.type),(0,J.TD)(JSON.stringify(e))];var t=n.name,r=n.extension,a=Array.isArray(e)?e:[e];return["".concat(t,".").concat(r),(0,J.TD)(JSON.stringify(a))]});(0,J.$R)((s={},(0,a._)(s,"".concat(n),(0,J.TD)(JSON.stringify(e))),(0,a._)(s,"individualFiles",Object.fromEntries(o)),s),function(e,a){if(e)return r(e);b.bV.downloadBlob(new Blob([a]),"".concat(n,".zip")),t(a)})})];case 2:return t=s.sent(),x.kg.hidePill(),[2,t];case 3:throw r=s.sent(),x.kg.hidePill(),r;case 4:return[2]}})})).apply(this,arguments)}return(0,p.useEffect)(function(){return function(){return x.kg.hidePill()}},[]),(0,u.jsxs)(h.k,{children:[(0,u.jsx)(f.V,{text:"Backup",description:"Manage the backups in the app, download or import songs, themes, or all of them"}),(0,u.jsx)("h1",{style:{fontSize:"1.8rem"},children:"Transfer from other domain"}),(0,u.jsxs)("div",{style:{gap:"1rem",paddingLeft:"1.5rem"},className:"row row-centered",children:[(0,u.jsx)("div",{children:"If you want to transfer your data from another domain of the app, click here"}),(0,u.jsx)(E(),{href:"/transfer",style:{marginLeft:"1rem"},children:(0,u.jsx)(d.J,{cssVar:"accent",style:{gap:"0.2rem"},children:"Transfer"})})]}),(0,u.jsxs)("div",{className:"row row-centered",style:{margin:"1rem 0",gap:"1rem",marginTop:"2rem"},children:[(0,u.jsx)("div",{style:{fontSize:"1.8rem"},children:"Backup as"}),(0,u.jsx)(P.k,{options:[{value:"zip",color:e.getValue("accent").toString()},{value:"json",color:e.getValue("accent").toString()}],selected:M,onChange:B})]}),(0,u.jsx)("div",{style:{paddingLeft:"1.5rem"},children:"Make sure you create a backup every now and then. Especially if you just finished a new song. The browser shouldn't delete your data, especially if you installed the app, but there is always a chance."}),(0,u.jsxs)("div",{className:"row",style:{marginTop:"1rem",gap:"0.5rem",paddingLeft:"1.5rem"},children:[(0,u.jsxs)(d.J,{tooltip:"Download all the data of the app, aka themes, songs, folders",className:"flex-centered",onClick:(0,r._)(function(){var e,n,t,r;return(0,c.Jh)(this,function(a){switch(a.label){case 0:return[4,validateSongs()];case 1:if(!(e=a.sent()))return[2];return[4,validateFolders()];case 2:if(!(n=a.sent()))return[2];return[4,validateThemes()];case 3:if(!(t=a.sent()))return[2];if(0===(r=(0,i._)(e).concat((0,i._)(n),(0,i._)(t))).length)return[2,x.kg.warn("There is nothing to backup")];a.label=4;case 4:return a.trys.push([4,6,,7]),[4,downloadFiles(r,"".concat(getDateString(),"-all.").concat(j.iC.toLowerCase(),"backup"))];case 5:return a.sent(),x.kg.success("Downloaded backup"),F.j.setLastBackupWarningTime(Date.now()),[3,7];case 6:return a.sent(),x.kg.error("Error downloading backup"),[3,7];case 7:return[2]}})}),children:[(0,u.jsx)(g.ZJh,{style:n}),"Download all backup"]}),(0,u.jsxs)(d.J,{tooltip:"Downloads a backup containing all songs and folders",className:"flex-centered",onClick:(0,r._)(function(){var e,n,t,r;return(0,c.Jh)(this,function(a){switch(a.label){case 0:return[4,validateSongs()];case 1:if(!(e=a.sent()))return[2];return[4,validateFolders()];case 2:if(!(n=a.sent()))return[2];if(0===(t=(0,i._)(e).concat((0,i._)(n))).length)return[2,x.kg.warn("There are no songs to backup")];a.label=3;case 3:return a.trys.push([3,5,,6]),[4,downloadFiles(t,"".concat(getDateString(),"-songs.").concat(j.iC.toLowerCase(),"backup"))];case 4:return a.sent(),x.kg.success("Downloaded songs backup"),F.j.setLastBackupWarningTime(Date.now()),[3,6];case 5:return r=a.sent(),x.kg.error("Error downloading backup"),console.error(r),[3,6];case 6:return[2]}})}),children:[(0,u.jsx)(g.ZJh,{style:n}),"Download song backup"]}),(0,u.jsxs)(d.J,{tooltip:"Downloads a backup of all the custom themes",className:"flex-centered",onClick:(0,r._)(function(){var e,n;return(0,c.Jh)(this,function(t){switch(t.label){case 0:return[4,validateThemes()];case 1:if(!(e=t.sent()))return[2];if(0===e.length)return[2,x.kg.warn("There are no themes to backup")];t.label=2;case 2:return t.trys.push([2,4,,5]),[4,downloadFiles(e,"".concat(getDateString(),"-themes.").concat(j.iC.toLowerCase(),"backup"))];case 3:return t.sent(),x.kg.success("Downloaded themes backup"),[3,5];case 4:return n=t.sent(),x.kg.error("Error downloading backup"),console.error(n),[3,5];case 5:return[2]}})}),children:[(0,u.jsx)(g.ZJh,{style:n}),"Download themes backup"]})]}),(0,u.jsx)("h1",{style:{fontSize:"1.8rem"},children:"Import a backup"}),(0,u.jsx)("div",{style:{paddingLeft:"1.5rem"},children:"If you have a backup, you can import it here, they will be added to your existing data. (if you already have the same song, a duplicate will be created)."}),(0,u.jsx)("div",{className:"flex-centered",children:(0,u.jsx)(S.G,{onPick:function(e){return _onFilePick.apply(this,arguments)},as:"json",onError:function(){return x.kg.error("There was an error reading the file")},children:(0,u.jsxs)(d.J,{className:"flex-centered",tooltip:"Here you can import any backup you have",style:{marginTop:"1rem",backgroundColor:"var(--accent)",color:"var(--accent-text)",padding:"0.8rem"},children:[(0,u.jsx)(g.Xur,{style:(0,o._)((0,s._)({},n),{fontSize:"1rem",marginRight:"0.5rem"})}),"Import backup"]})})}),(0,u.jsx)("div",{className:"column",style:{flex:"1",justifyContent:"center",padding:"1rem"},children:(0,u.jsxs)("div",{className:"column",style:{width:"fit-content"},children:[(0,u.jsxs)("span",{children:[t.length," ",1===t.length?"song":"songs"]}),(0,u.jsxs)("span",{children:[L.length," ",1===L.length?"theme":"themes"]})]})}),(0,u.jsx)("h1",{style:{fontSize:"1.8rem"},children:"Delete data"}),(0,u.jsx)("div",{style:{paddingLeft:"1.5rem"},children:"If you want, you can also delete all your data here, once deleted it can't be recovered. Don't worry you will be asked to confirm before anything is deleted."}),(0,u.jsxs)("div",{className:"row",style:{marginTop:"1rem",gap:"0.5rem",paddingLeft:"1.5rem"},children:[(0,u.jsxs)(d.J,{className:"flex-centered",tooltip:"Here you can delete all your songs and folders",tooltipPosition:"top",style:{backgroundColor:"var(--red-bg)",color:"var(--red-text)"},onClick:function(){return _deleteAllSongsAndFolders.apply(this,arguments)},children:[(0,u.jsx)(g.Xm5,{style:n}),"Delete songs and folders"]}),(0,u.jsxs)(d.J,{className:"flex-centered",tooltip:"Here you can delete all your themes",tooltipPosition:"top",style:{backgroundColor:"var(--red-bg)",color:"var(--red-text)"},onClick:function(){return _deleteAllThemes.apply(this,arguments)},children:[(0,u.jsx)(g.Xm5,{style:n}),"Delete themes"]})]})]})}function getDateString(){var e=new Date;return"".concat(e.getFullYear(),"-").concat(e.getMonth(),"-").concat(e.getDate())}}},function(e){e.O(0,[3778,9774,2888,179],function(){return e(e.s=65164)}),_N_E=e.O()}]);