(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4910],{65164:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/backup",function(){return n(85215)}])},42474:function(e,t,n){"use strict";n.d(t,{k:function(){return l}});var r=n(85893),a=n(39324),o=n(67294);function l(e){let{options:t,selected:n,onChange:l}=e,i=(0,o.useRef)(null),s=t.find(e=>e.value===n),[c,d]=(0,o.useState)({width:0,left:0});return(0,o.useEffect)(()=>{var e;let r=null===(e=i.current)||void 0===e?void 0:e.querySelectorAll("button"),a=t.findIndex(e=>e.value===n);if(!r||a<0)return;let o=r[a].getBoundingClientRect(),l=i.current.getBoundingClientRect();d({width:o.width,left:o.left-l.left})},[i,t,n]),(0,r.jsxs)("div",{className:"multiple-option-slider",ref:i,children:[t.map(e=>(0,r.jsx)("button",{onClick:()=>l(e.value),className:e===s?"multiple-options-selected":"",children:(0,a.kC)(e.value)},e.value)),(0,r.jsx)("div",{className:"multiple-option-slider-overlay",style:{width:"".concat(c.width,"px"),left:"".concat(c.left,"px"),backgroundColor:null==s?void 0:s.color}})]})}},87481:function(e,t,n){"use strict";n.d(t,{G:function(){return o}});var r=n(85893),a=n(67294);function o(e){let{children:t,onPick:n,style:o={},as:l,multiple:i=!1,onError:s}=e,c=(0,a.useRef)(null),d=(0,a.useCallback)(async e=>{var t;if(null===e.target.files)return;let r=Array.from(null!==(t=e.target.files)&&void 0!==t?t:[]);if("file"===l)return n(r.map(e=>({data:e,file:e})));let a=r.map(e=>new Promise((t,n)=>{let r=new FileReader;try{r.addEventListener("loadend",function(){try{let n=r.result;t({data:"json"===l?JSON.parse(n):n,file:e})}catch(e){n(e)}},{once:!0}),("text"===l||"json"===l)&&r.readAsText(e),"buffer"===l&&r.readAsArrayBuffer(e)}catch(e){n(e)}}));try{let e=await Promise.all(a);n(e)}catch(e){console.error(e),null==s||s(e,r)}null!==c.current&&(c.current.value="")},[l,n,s]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"file",style:{display:"none"},ref:c,onChange:d,multiple:i}),(0,r.jsx)("div",{onClick:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.click()},style:o,children:t})]})}},99962:function(e,t,n){"use strict";n.d(t,{V:function(){return s},q:function(){return c}});var r=n(85893),a=n(40456),o=n.n(a),l=n(69887),i=n(39324);function s(e){let{style:t,className:n,opacity:a,children:s}=e,{visible:c}=(0,l.X)();return(0,r.jsx)("div",{className:(0,i.cn)("".concat(o().menu," ").concat(n),[c,o()["menu-visible"]]),style:{opacity:a,...t},children:s})}let c=(0,n(67294).forwardRef)(function(e,t){let{children:n,className:a,style:i,current:s,open:c,setOpen:d,setCurrent:u,visible:f,setVisible:g}=e;return(0,r.jsx)(l.p.Provider,{value:{current:null!=s?s:"",setCurrent:null!=u?u:e=>{},open:null!=c&&c,setOpen:null!=d?d:()=>{},visible:null==f||f,setVisible:null!=g?g:()=>{}},children:(0,r.jsx)("div",{className:"".concat(o()["menu-wrapper"]," ").concat(a),ref:t,style:i,children:n})})})},23441:function(e,t,n){"use strict";n.d(t,{d:function(){return l}});var r=n(85893),a=n(9008),o=n.n(a);function l(e){let{text:t,description:n,image:a,children:l}=e;return(0,r.jsxs)(o(),{children:[(0,r.jsx)("title",{children:t}),n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("meta",{name:"description",content:n}),(0,r.jsx)("meta",{property:"og:description",content:n})]}),a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("meta",{name:"image",content:a}),(0,r.jsx)("meta",{property:"og:image",content:a})]}),l]})}},82860:function(e,t,n){"use strict";n.d(t,{s:function(){return o}});var r=n(85893),a=n(36180);function o(e){let{children:t,className:n,style:o,gap:l,flex1:i,justify:s,align:c,padding:d}=e;return(0,r.jsx)("div",{className:"column ".concat(null!=n?n:""),style:{gap:l,flex:i?1:void 0,justifyContent:s?a.q[s]:void 0,alignItems:c?a.q[c]:void 0,padding:d,...o},children:t})}},2816:function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var r=n(85893),a=n(420);function o(e){let{excludeMenu:t=!1,children:n,className:o="",style:l,menu:i,cropped:s=!0}=e,c=s?l:{...l,padding:0};return(0,r.jsxs)("div",{className:"default-page "+o,style:c,children:[(!t||!i)&&(0,r.jsx)(a.O,{}),i,(0,r.jsx)("main",{className:"default-content appear-on-mount",children:n})]})}},420:function(e,t,n){"use strict";n.d(t,{O:function(){return g}});var r=n(85893),a=n(78773),o=n(54135),l=n(9827),i=n(40569),s=n(11163),c=n(41664),d=n.n(c),u=n(31602),f=n(99962);function g(e){let{children:t,className:n,style:c}=e,g=(0,s.useRouter)();return(0,r.jsx)(f.q,{className:n,style:c,children:(0,r.jsxs)(f.V,{style:{justifyContent:"flex-end"},children:[l.b.hasNavigated&&(0,r.jsx)(o.j,{style:{marginBottom:"auto"},onClick:()=>{g.back()},ariaLabel:"Go back",children:(0,r.jsx)(a.x_l,{className:"icon"})}),t,(0,r.jsx)(d(),{href:"https://discord.gg/Arsf65YYHq",target:"_blank",rel:"noreferrer",title:"Go to discord",onClick:async e=>{e.preventDefault(),await (0,u.jH)("You are leaving the app to go to discord, do you want to continue?")&&window.open("https://discord.gg/Arsf65YYHq","_blank")},children:(0,r.jsx)(o.j,{ariaLabel:"Go to discord",children:(0,r.jsx)(a.j2d,{className:"icon"})})}),(0,r.jsx)(o.j,{onClick:i.I.open,ariaLabel:"Open home menu",style:{border:"solid 0.1rem var(--secondary)"},children:(0,r.jsx)(a.xng,{className:"icon"})})]})})}},24104:function(e,t,n){"use strict";n.d(t,{n:function(){return l}});var r=n(67294),a=n(68949),o=n(6340);function l(){let[e,t]=(0,r.useState)(o.k.songs);return(0,r.useEffect)(()=>(function(e){let t=(0,a.N7)(o.k.songs,()=>{e([...o.k.songs])});return e([...o.k.songs]),t})(e=>{t(e)}),[]),[e]}},85215:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return T}});var r=n(85893),a=n(48043),o=n(2816),l=n(23441),i=n(78773),s=n(67294),c=n(85565),d=n(35656),u=n(40398),f=n(26176),g=n(31602),h=n(53179),m=n(89867),p=n(16913),y=n(17544),w=n(87481),k=n(39324),x=n(24104),j=n(32362),v=n(19180),b=n(6340),N=n(80219),C=n(41664),L=n.n(C),A=n(93778),E=n(42474),D=n(92634),_=n(11090),S=n(82860);function T(){let[e]=(0,D.F)(),t={marginRight:"0.3rem",marginLeft:"-0.4rem"},[n]=(0,x.n)(),C=(0,j.ih)(v.N.themes),[T,R]=(0,s.useState)("json");async function J(){h.kg.showPill("Validating songs...");let e=await c.v.getSongs(),t=[];for(let n of e)try{c.v.parseSong(n)}catch(e){console.error(e),t.push(n),h.kg.error('Error validating song "'.concat(null==n?void 0:n.name,'"'))}return t.length>0&&!await (0,g.cJ)("There were errors validating some songs. Do you want to continue downloading?")?null:(h.kg.hidePill(),[...e])}async function O(){h.kg.showPill("Validating folders...");let e=[],t=await f.b.getFolders();for(let n of t)try{p.g.deserialize(n)}catch(t){console.error(t),e.push(n),h.kg.error('Error validating folder "'.concat(null==n?void 0:n.name,'"'))}return e.length>0&&!await (0,g.cJ)("There were errors validating some folders. Do you want to continue downloading?")?null:(h.kg.hidePill(),[...t])}async function V(){h.kg.showPill("Validating themes...");let e=await d.a.getThemes();for(let t of e);return h.kg.hidePill(),[...e]}async function F(e){for(let n of e)try{let e=Array.isArray(n.data)?n.data:[n.data];await m.bV.importAndLog(e)}catch(e){var t;console.error(e),h.kg.error('Error importing file "'.concat(null===(t=n.file)||void 0===t?void 0:t.name,'"'))}}async function X(){return"delete"!==await (0,g.cJ)("Write 'delete' if you want to delete all songs, press cancel to ignore")?h.kg.warn("Action cancelled"):(await (0,k.gw)(200),await (0,g.jH)("Are you REALLY sure you want to delete all songs?"))?void(await b.k._DANGEROUS_CLEAR_ALL_SONGS(),await u.p._DANGEROUS_CLEAR_ALL_FOLDERS(),h.kg.success("Deleted all songs")):h.kg.warn("Action cancelled")}async function B(){return"delete"!==await (0,g.cJ)("Write 'delete' if you want to delete all themes")?h.kg.warn("Action cancelled"):(await (0,k.gw)(200),await (0,g.jH)("Are you REALLY sure you want to delete all themes?"))?void(await v.N._DANGEROUS_CLEAR_ALL_THEMES(),h.kg.success("Deleted all themes")):h.kg.warn("Action cancelled")}async function G(e,t){if("json"===T)m.bV.downloadFiles(e,t);else try{h.kg.showPill("Zipping files...");let n=await new Promise((n,r)=>{let a=e.map(e=>{let t=m.bV.getUnknownFileExtensionAndName(e);if(!t)return["unknown".concat(Math.floor(1e3*Math.random()),".").concat(e.type),(0,A.TD)(JSON.stringify(e))];let{name:n,extension:r}=t,a=Array.isArray(e)?e:[e];return["".concat(n,".").concat(r),(0,A.TD)(JSON.stringify(a))]});(0,A.$R)({["".concat(t)]:(0,A.TD)(JSON.stringify(e)),individualFiles:Object.fromEntries(a)},(e,a)=>{if(e)return r(e);m.bV.downloadBlob(new Blob([a]),"".concat(t,".zip")),n(a)})});return h.kg.hidePill(),n}catch(e){throw h.kg.hidePill(),e}}return(0,s.useEffect)(()=>()=>h.kg.hidePill(),[]),(0,r.jsxs)(o.k,{children:[(0,r.jsx)(l.d,{text:"Backup",description:"Manage the backups in the app, download or import songs, themes, or all of them"}),(0,r.jsx)("h1",{style:{fontSize:"1.8rem"},children:"Transfer from other domain"}),(0,r.jsxs)(_.X,{align:"center",gap:"1rem",style:{paddingLeft:"1.5rem"},children:[(0,r.jsx)("div",{children:"If you want to transfer your data from another domain of the app, click here"}),(0,r.jsx)(L(),{href:"/transfer",style:{marginLeft:"1rem"},children:(0,r.jsx)(a.J,{cssVar:"accent",style:{gap:"0.2rem"},children:"Transfer"})})]}),(0,r.jsxs)(_.X,{align:"center",gap:"1rem",style:{margin:"1rem 0",marginTop:"2rem"},children:[(0,r.jsx)("div",{style:{fontSize:"1.8rem"},children:"Backup as"}),(0,r.jsx)(E.k,{options:[{value:"zip",color:e.getValue("accent").toString()},{value:"json",color:e.getValue("accent").toString()}],selected:T,onChange:R})]}),(0,r.jsx)("div",{style:{paddingLeft:"1.5rem"},children:"Make sure you create a backup every now and then. Especially if you just finished a new song. The browser shouldn't delete your data, especially if you installed the app, but there is always a chance."}),(0,r.jsxs)(_.X,{gap:"0.5rem",style:{marginTop:"1rem",paddingLeft:"1.5rem"},children:[(0,r.jsxs)(a.J,{tooltip:"Download all the data of the app, aka themes, songs, folders",className:"flex-centered",onClick:async()=>{let e=await J();if(!e)return;let t=await O();if(!t)return;let n=await V();if(!n)return;let r=[...e,...t,...n];if(0===r.length)return h.kg.warn("There is nothing to backup");try{await G(r,"".concat(P(),"-all.").concat(y.iC.toLowerCase(),"backup")),h.kg.success("Downloaded backup"),N.j.setLastBackupWarningTime(Date.now())}catch(e){h.kg.error("Error downloading backup")}},children:[(0,r.jsx)(i.ZJh,{style:t}),"Download all backup"]}),(0,r.jsxs)(a.J,{tooltip:"Downloads a backup containing all songs and folders",className:"flex-centered",onClick:async()=>{let e=await J();if(!e)return;let t=await O();if(!t)return;let n=[...e,...t];if(0===n.length)return h.kg.warn("There are no songs to backup");try{await G(n,"".concat(P(),"-songs.").concat(y.iC.toLowerCase(),"backup")),h.kg.success("Downloaded songs backup"),N.j.setLastBackupWarningTime(Date.now())}catch(e){h.kg.error("Error downloading backup"),console.error(e)}},children:[(0,r.jsx)(i.ZJh,{style:t}),"Download song backup"]}),(0,r.jsxs)(a.J,{tooltip:"Downloads a backup of all the custom themes",className:"flex-centered",onClick:async()=>{let e=await V();if(e){if(0===e.length)return h.kg.warn("There are no themes to backup");try{await G(e,"".concat(P(),"-themes.").concat(y.iC.toLowerCase(),"backup")),h.kg.success("Downloaded themes backup")}catch(e){h.kg.error("Error downloading backup"),console.error(e)}}},children:[(0,r.jsx)(i.ZJh,{style:t}),"Download themes backup"]})]}),(0,r.jsx)("h1",{style:{fontSize:"1.8rem"},children:"Import a backup"}),(0,r.jsx)("div",{style:{paddingLeft:"1.5rem"},children:"If you have a backup, you can import it here, they will be added to your existing data. (if you already have the same song, a duplicate will be created)."}),(0,r.jsx)(_.X,{align:"center",children:(0,r.jsx)(w.G,{onPick:F,as:"json",onError:()=>h.kg.error("There was an error reading the file"),children:(0,r.jsxs)(a.J,{className:"flex-centered",tooltip:"Here you can import any backup you have",style:{marginTop:"1rem",backgroundColor:"var(--accent)",color:"var(--accent-text)",padding:"0.8rem"},children:[(0,r.jsx)(i.Xur,{style:{...t,fontSize:"1rem",marginRight:"0.5rem"}}),"Import backup"]})})}),(0,r.jsx)(S.s,{justify:"center",padding:"1rem",style:{flex:"1"},children:(0,r.jsxs)(S.s,{style:{width:"fit-content"},children:[(0,r.jsxs)("span",{children:[n.length," ",1===n.length?"song":"songs"]}),(0,r.jsxs)("span",{children:[C.length," ",1===C.length?"theme":"themes"]})]})}),(0,r.jsx)("h1",{style:{fontSize:"1.8rem"},children:"Delete data"}),(0,r.jsx)("div",{style:{paddingLeft:"1.5rem"},children:"If you want, you can also delete all your data here, once deleted it can't be recovered. Don't worry you will be asked to confirm before anything is deleted."}),(0,r.jsxs)(_.X,{gap:"0.5rem",style:{marginTop:"1rem",paddingLeft:"1.5rem"},children:[(0,r.jsxs)(a.J,{className:"flex-centered",tooltip:"Here you can delete all your songs and folders",tooltipPosition:"top",style:{backgroundColor:"var(--red-bg)",color:"var(--red-text)"},onClick:X,children:[(0,r.jsx)(i.Xm5,{style:t}),"Delete songs and folders"]}),(0,r.jsxs)(a.J,{className:"flex-centered",tooltip:"Here you can delete all your themes",tooltipPosition:"top",style:{backgroundColor:"var(--red-bg)",color:"var(--red-text)"},onClick:B,children:[(0,r.jsx)(i.Xm5,{style:t}),"Delete themes"]})]})]})}function P(){let e=new Date;return"".concat(e.getFullYear(),"-").concat(e.getMonth(),"-").concat(e.getDate())}}},function(e){e.O(0,[3778,2888,9774,179],function(){return e(e.s=65164)}),_N_E=e.O()}]);