(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1483],{49691:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/zen-keyboard",function(){return t(52404)}])},64167:function(e,n,t){"use strict";t.d(n,{h:function(){return IconButton}});var a=t(72253),o=t(14932),i=t(85893),r=t(28796);function IconButton(e){var n,t,s,c,l;return(0,i.jsx)(r.J,(0,o._)((0,a._)({},e),{style:(0,a._)({width:null!==(n=e.size)&&void 0!==n?n:"2rem",height:null!==(t=e.size)&&void 0!==t?t:"2rem",minWidth:null!==(s=e.size)&&void 0!==s?s:"2rem",minHeight:null!==(c=e.size)&&void 0!==c?c:"2rem"},e.style),className:"icon-app-button flex-centered ".concat(null!==(l=e.className)&&void 0!==l?l:""),children:e.children}))}},36443:function(e,n,t){"use strict";t.d(n,{V:function(){return PageMeta}});var a=t(85893),o=t(9008),i=t.n(o);function PageMeta(e){var n=e.text,t=e.description,o=e.image,r=e.children;return(0,a.jsxs)(i(),{children:[(0,a.jsx)("title",{children:n}),t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("meta",{name:"description",content:t}),(0,a.jsx)("meta",{property:"og:description",content:t})]}),o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("meta",{name:"image",content:o}),(0,a.jsx)("meta",{property:"og:image",content:o})]}),r]})}},52404:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return ZenKeyboard}});var a=t(11010),o=t(72253),i=t(14932),r=t(91309),s=t(97582),c=t(85893),l=t(49894),u=t(48564),d=t(4586),m=t(1062),f=t(68949),ZenKeyboardStore=function ZenKeyboardStore(){var e=this;(0,u._)(this,ZenKeyboardStore),this.keyboard=[],this.setKeyboardLayout=function(n){var t;(t=e.keyboard).splice.apply(t,[0,e.keyboard.length].concat((0,d._)(n)))},this.animateNote=function(n,t){e.keyboard[n].triggerAnimation(t)},this.resetKeyboardLayout=function(){e.keyboard.forEach(function(e){return e.setState({status:"",delay:"Genshin"===m.iC?100:200})})},this.resetOutgoingAnimation=function(){e.keyboard.forEach(function(e){return e.setState({animationId:0})})},this.setNoteState=function(n,t){e.keyboard[n].setState(t)},(0,f.rC)(this)};(0,s.gn)([f.LO],ZenKeyboardStore.prototype,"keyboard",void 0);var h=new ZenKeyboardStore,g=t(96802),y=t(67294),v=t(29601),b=t(26576),x=t(41619),k=t.n(x),p=t(73288),_=[{transform:"rotateY(0deg) scale(0.8)"},{transform:"rotateY(180deg) scale(0.8)"},{transform:"rotateY(360deg) scale(1)"}];function ZenNote(e){var n,t,a,o=e.note,i=e.onClick,s=e.noteImage,u=e.noteText,d=e.instrumentName,f=e.keyPadding,h=(0,r._)((0,y.useState)(""),2),x=h[0],j=h[1],N=(0,r._)((0,y.useState)(0),2),C=N[0],S=N[1],Z=(0,r._)((0,y.useState)(m.kx.text.light),2),K=Z[0],P=Z[1],w=(0,y.useRef)(null),A=(0,y.useCallback)(function(e){(0,p.PF)(e),i(o)},[i,o]);(0,y.useEffect)(function(){return(0,l.VZ)(o.data,function(){if("Genshin"===m.iC)j("clicked"),S(function(e){return e+1}),setTimeout(function(){return j("")},100);else{var e=w.current;if(!e)return;e.animate(_,{duration:400})}})},[o,w]),(0,y.useEffect)(function(){return(0,l.VZ)(v.f6.state.data,function(){var e;P((e=v.f6.get("note_background"),"Genshin"!==m.iC?e.isDark()?m.kx.text.light:m.kx.text.dark:e.luminosity()>.65?m.kx.text.note:e.isDark()?m.kx.text.light:m.kx.text.dark))})},[]);var I="".concat((n=m.Al.note,"clicked"===x&&(n+=" click-event"),n)," ").concat("Genshin"===m.iC?"":k()["sky-zen-note"]),T=null===(t=m.as[d])||void 0===t?void 0:t.clickColor;return(0,c.jsxs)("button",{onPointerDown:A,onContextMenu:p.PF,className:"button-hitbox-bigger",style:{padding:"".concat(f,"rem")},children:["Genshin"===m.iC&&(0,c.jsx)("div",{style:T&&v.f6.isDefault("accent")?{borderColor:T}:{},className:m.Al.noteAnimation},C),(0,c.jsxs)("div",{ref:w,className:I,children:["Genshin"===m.iC&&(0,c.jsx)(b.Z,{className:"genshin-border",fill:"clicked"===x?"transparent":"toClickNext"===x||"toClickAndNext"===x?"#63aea7":"var(--note-border-fill)"}),s&&(0,c.jsx)(g.Z,{name:o.noteImage,color:v.f6.isDefault("accent")?null===(a=m.as[d])||void 0===a?void 0:a.fill:void 0,background:"clicked"===x?T&&v.f6.isDefault("accent")?T:"var(--accent)":"var(--note-background)"}),(0,c.jsx)("div",{className:m.Al.noteName,style:{color:K},children:u})]})]})}var j=t(22977),N="keyboard ".concat(k()["zen-keyboard"],"}"),C=new Map([[15,"".concat(N," keyboard-5")],[14,"".concat(N," keyboard-5")],[8,"".concat(N," keyboard-4")],[6,"".concat(N," keyboard-3")]]);function ZenKeypad(e){var n=e.onNoteClick,t=e.instrument,a=e.pitch,o=e.verticalOffset,i=e.scale,r=e.noteNameType,s=e.keySpacing,u=(0,l.ih)(h.keyboard);(0,y.useEffect)(function(){return(0,j.JP)("zen_keyboard",function(e){var a=e.shortcut;if(!e.event.repeat){var o=t.getNoteFromCode(a.name);null!==o&&n(o)}})},[n,t]);var d=C.get(u.length)||N;return(0,c.jsx)("div",{className:d,style:{transform:"scale(".concat(i/100,") translateY(").concat(o,"px)"),marginTop:"unset"},children:u.map(function(e,o){return(0,c.jsx)(ZenNote,{keyPadding:s,instrumentName:t.name,noteText:t.getNoteText(o,r,a),noteImage:e.noteImage,note:e,onClick:n},o)})})}var S=t(4674),Z=t(10398),K=t(52091),P=t(175),w=t(66826),A=t(89413),I=t(51962),T=t(64167),z=t(30080),E=t(37094),F=t(71054);function ZenKeyboardMenu(e){var n=e.settings,t=e.handleSettingChange,a=e.onVolumeChange,s=e.isMetronomePlaying,l=e.setIsMetronomePlaying,u=(0,r._)((0,y.useState)("Settings"),2),d=u[0],f=u[1],h=(0,r._)((0,y.useState)(!0),2),g=h[0],v=h[1],b=(0,r._)((0,y.useState)(!1),2),x=b[0],k=b[1],p=(0,S.ZP)(function(){k(!1)},{ignoreFocusable:!0,active:""!==d}),_=g&&x?"side-menu menu-open":"side-menu";return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(T.h,{toggled:s,onClick:function(){return l(!s)},className:"metronome-button",style:{position:"absolute",top:"0.5rem",right:"5.1rem",borderRadius:"1rem",border:"solid 0.1rem var(--secondary)"},ariaLabel:"Toggle metronome",children:(0,c.jsx)(F.eHT,{size:18})}),(0,c.jsx)("div",{style:{position:"absolute",top:"0.5rem",right:"2.8rem"},children:(0,c.jsx)(FloatingSelection,{value:n.pitch.value,items:m.T_,Icon:E.n5x,onChange:function(e){return t({key:"pitch",data:(0,i._)((0,o._)({},n.pitch),{value:e})})}})}),(0,c.jsx)("div",{style:{position:"absolute",top:"0.5rem",right:"0.5rem"},children:(0,c.jsx)(FloatingSelection,{value:n.instrument.value,items:m.BX,Icon:z.S0H,onChange:function(e){return t({key:"instrument",data:(0,i._)((0,o._)({},n.instrument),{value:e})})}})}),(0,c.jsxs)("div",{className:"menu-wrapper",ref:p,children:[(0,c.jsx)("div",{className:"hamburger-top",onClick:function(){return k(!x)},children:(0,c.jsx)(I.Z,{children:(0,c.jsx)(K.Fm7,{})})}),(0,c.jsxs)("div",{className:"menu ".concat(x?"menu-visible":""),style:{justifyContent:"flex-end"},children:[(0,c.jsx)(w.s,{ariaLabel:"Close menu",style:{marginBottom:"auto"},onClick:function(){return k(!x)},children:(0,c.jsx)(K.aHS,{className:"icon"})}),(0,c.jsx)(w.s,{onClick:function(){f("Settings"),v(!g)},isActive:"Settings"===d&&g,ariaLabel:"Open settings",children:(0,c.jsx)(K.p4t,{className:"icon"})}),(0,c.jsx)(w.s,{onClick:Z.I.open,ariaLabel:"Open home menu",style:{border:"solid 0.1rem var(--secondary)"},children:(0,c.jsx)(K.xng,{className:"icon"})})]}),(0,c.jsx)("div",{className:_,children:(0,c.jsx)(P.Z,{title:"Settings",current:d,id:"Settings",children:(0,c.jsx)(A.A,{settings:n,onUpdate:t,changeVolume:a})})})]})]})}function FloatingSelection(e){var n=e.items,t=e.onChange,a=e.value,o=e.Icon,i=(0,r._)((0,y.useState)(!1),2),s=i[0],l=i[1],u=(0,S.ZP)(function(){return l(!1)},{active:s});return(0,c.jsxs)("div",{className:"column",ref:u,style:{alignItems:"flex-end",gap:"0.5rem"},children:[(0,c.jsx)(T.h,{onClick:function(){return l(!s)},style:{zIndex:2,borderRadius:"1rem",border:"solid 0.1rem var(--secondary)"},toggled:s,children:(0,c.jsx)(o,{size:18})}),s&&(0,c.jsx)("div",{className:k()["floating-selection-card"],style:{maxHeight:"75vh"},children:n.map(function(e){return(0,c.jsx)("button",{className:"".concat(k()["floating-selection-card-item"]),style:a===e?{backgroundColor:"var(--accent)",color:"var(--accent-text)"}:{},onClick:function(){t(e),l(!1)},children:e},e)})})]})}var M=t(22850),L=t(42678),V=t(94015),O=t(81883),Y=t(37500),B=t(37870),D=t(36443),G=t(71094),H=t(69437);function ZenKeyboard(){var e,n=(0,r._)((0,y.useState)(M.$h.data),2),t=n[0],l=n[1],u=(0,r._)((0,y.useState)(new L.Yx),2),d=u[0],m=u[1],f=(0,r._)((0,y.useState)(!1),2),g=f[0],v=f[1];(0,y.useEffect)(function(){var e=Y.j.getZenKeyboardSettings();return V.A.bpm=e.metronomeBpm.value,m(new L.Yx(e.instrument.value)),l(e),O.n.setReverb(e.reverb.value),function(){return B.kg.hidePill()}},[]);var b=(0,y.useCallback)(function(e){Y.j.updateZenKeyboardSettings(e)},[]);(0,y.useEffect)(function(){h.setKeyboardLayout(d.notes)},[d]);var x=(e=(0,a._)(function(e){var n;return(0,s.Jh)(this,function(a){return n=e.data,t[e.key]=(0,i._)((0,o._)({},t[e.key]),{value:n.value}),"instrument"===e.key&&m(new L.Yx(n.value)),"reverb"===e.key&&O.n.setReverb(n.value),"metronomeBpm"===e.key&&(V.A.bpm=n.value),"metronomeBeats"===e.key&&(V.A.beats=n.value),"metronomeVolume"===e.key&&V.A.changeVolume(n.value),l((0,o._)({},t)),b(t),[2]})}),function(n){return e.apply(this,arguments)});(0,y.useEffect)(function(){function _load(){return(_load=(0,a._)(function(){return(0,s.Jh)(this,function(e){switch(e.label){case 0:return B.kg.showPill("Loading instrument: ".concat(d.name,"...")),[4,d.load(O.n.getAudioContext())];case 1:return e.sent(),B.kg.hidePill(),O.n.connect(d.endNode,null),[2]}})})).apply(this,arguments)}return!function(){_load.apply(this,arguments)}(),function(){O.n.disconnect(d.endNode)}},[d]);var k=(0,y.useCallback)(function(e){d.play(e.index,t.pitch.value),h.animateNote(e.index),H.mP.broadcastNoteClick(e.midiNote)},[d,t.pitch.value]);(0,y.useEffect)(function(){g?V.A.start():V.A.stop()},[g]);var p=(0,y.useCallback)(function(e){d.changeVolume(e.value)},[d]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(D.V,{text:"Zen Keyboard",description:"The simplest keyboard in the app, focus only on playing manually with all the features of the player, instrument and pitch selection, animations and metronome"}),(0,c.jsx)(ZenKeyboardMenu,{settings:t,isMetronomePlaying:g,setIsMetronomePlaying:v,onVolumeChange:p,handleSettingChange:x}),(0,c.jsx)("div",{className:"flex-centered",children:(0,c.jsx)(ZenKeypad,{instrument:d,onNoteClick:k,noteNameType:t.noteNameType.value,pitch:t.pitch.value,scale:t.keyboardSize.value,keySpacing:t.keyboardSpacing.value,verticalOffset:t.keyboardYPosition.value})})]})}ZenKeyboard.getLayout=function(e){return(0,c.jsx)(G.Z,{page:"Main",children:e})}},41619:function(e){e.exports={"zen-keyboard":"ZenKeyboard_zen-keyboard__FqTg8","sky-zen-note":"ZenKeyboard_sky-zen-note__W3j5Y","floating-selection-card":"ZenKeyboard_floating-selection-card__l6T_n",fadeIn:"ZenKeyboard_fadeIn__pOeEw","floating-selection-card-item":"ZenKeyboard_floating-selection-card-item__AeTlS"}}},function(e){e.O(0,[8127,509,4031,1160,9774,2888,179],function(){return e(e.s=49691)}),_N_E=e.O()}]);