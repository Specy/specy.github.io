(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[910],{5164:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/backup",function(){return t(4972)}])},1446:function(e,n,t){"use strict";t.d(n,{G:function(){return i}});var r=t(1010),a=t(7582),s=t(5893),o=t(7294);function i(e){var n,t=e.children,i=e.onPick,l=e.style,c=e.as,u=e.multiple,d=e.onError,f=(0,o.useRef)(null),h=(0,o.useCallback)((n=(0,r._)(function(e){var n,t,r,s,o;return(0,a.Jh)(this,function(a){switch(a.label){case 0:if(null===e.target.files)return[2];if(t=Array.from(null!==(n=e.target.files)&&void 0!==n?n:[]),"file"===c)return[2,i(t.map(function(e){return{data:e,file:e}}))];r=t.map(function(e){return new Promise(function(n,t){var r=new FileReader;try{r.addEventListener("loadend",function(){try{var a=r.result;n({data:"json"===c?JSON.parse(a):a,file:e})}catch(e){t(e)}},{once:!0}),("text"===c||"json"===c)&&r.readAsText(e),"buffer"===c&&r.readAsArrayBuffer(e)}catch(e){t(e)}})}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Promise.all(r)];case 2:return i(a.sent()),[3,4];case 3:return console.error(s=a.sent()),null===(o=d)||void 0===o||o(s,t),[3,4];case 4:return null!==f.current&&(f.current.value=""),[2]}})}),function(e){return n.apply(this,arguments)}),[c,i,d]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"file",style:{display:"none"},ref:f,onChange:h,multiple:void 0!==u&&u}),(0,s.jsx)("div",{onClick:function(){var e;return null===(e=f.current)||void 0===e?void 0:e.click()},style:void 0===l?{}:l,children:t})]})}},6390:function(e,n,t){"use strict";t.d(n,{k:function(){return i}});var r=t(2253),a=t(4932),s=t(5893),o=t(369);function i(e){var n=e.excludeMenu,t=e.children,i=e.className,l=e.style,c=e.menu,u=e.cropped,d=void 0===u||u?l:(0,a._)((0,r._)({},l),{padding:0});return(0,s.jsxs)("div",{className:"default-page "+(void 0===i?"":i),style:d,children:[(!(void 0!==n&&n)||!c)&&(0,s.jsx)(o.O,{}),c,(0,s.jsx)("div",{className:"default-content appear-on-mount",children:t})]})}},369:function(e,n,t){"use strict";t.d(n,{O:function(){return p}});var r=t(1010),a=t(7582),s=t(5893),o=t(9583),i=t(7671),l=t(9255),c=t(2809),u=t(1163),d=t(1664),f=t.n(d),h=t(750);function p(e){var n,t=e.children,d=e.className,p=(0,u.useRouter)();return(0,s.jsx)("div",{className:"menu-wrapper "+(void 0===d?"":d),children:(0,s.jsxs)("div",{className:"menu menu-visible",style:{justifyContent:"flex-end"},children:[l.U.hasNavigated&&(0,s.jsx)(i.s,{style:{marginBottom:"auto"},onClick:function(){p.back()},ariaLabel:"Go back",children:(0,s.jsx)(o.x_l,{className:"icon"})}),void 0===t?void 0:t,(0,s.jsx)(f(),{href:"https://discord.gg/Arsf65YYHq",target:"_blank",rel:"noreferrer",title:"Go to discord",onClick:(n=(0,r._)(function(e){return(0,a.Jh)(this,function(n){switch(n.label){case 0:return e.preventDefault(),[4,(0,h.jH)("You are leaving the app to go to discord, do you want to continue?")];case 1:if(!n.sent())return[2];return window.open("https://discord.gg/Arsf65YYHq","_blank"),[2]}})}),function(e){return n.apply(this,arguments)}),children:(0,s.jsx)(i.s,{ariaLabel:"Go to discord",children:(0,s.jsx)(o.j2d,{className:"icon"})})}),(0,s.jsx)(i.s,{onClick:c.I.open,ariaLabel:"Open home menu",children:(0,s.jsx)(o.xng,{className:"icon"})})]})})}},4995:function(e,n,t){"use strict";t.d(n,{D:function(){return o}});var r=t(5893),a=t(9008),s=t.n(a);function o(e){var n=e.text,t=e.description;return(0,r.jsxs)(s(),{children:[(0,r.jsx)("title",{children:n}),t&&(0,r.jsx)("meta",{name:"description",content:t})]})}},3187:function(e,n,t){"use strict";t.d(n,{k:function(){return i}});var r=t(1309),a=t(5893),s=t(6743),o=t(7294);function i(e){var n=e.options,t=e.selected,i=e.onChange,l=(0,o.useRef)(null),c=n.find(function(e){return e.value===t}),u=(0,r._)((0,o.useState)({width:0,left:0}),2),d=u[0],f=u[1];return(0,o.useEffect)(function(){var e,r=null===(e=l.current)||void 0===e?void 0:e.querySelectorAll("button"),a=n.findIndex(function(e){return e.value===t});if(r&&!(a<0)){var s=r[a].getBoundingClientRect(),o=l.current.getBoundingClientRect();f({width:s.width,left:s.left-o.left})}},[l,n,t]),(0,a.jsxs)("div",{className:"multiple-option-slider",ref:l,children:[n.map(function(e){return(0,a.jsx)("button",{onClick:function(){return i(e.value)},className:e===c?"multiple-options-selected":"",children:(0,s.kC)(e.value)},e.value)}),(0,a.jsx)("div",{className:"multiple-option-slider-overlay",style:{width:"".concat(d.width,"px"),left:"".concat(d.left,"px"),backgroundColor:null==c?void 0:c.color}})]})}},7008:function(e,n,t){"use strict";t.d(n,{n:function(){return l}});var r=t(1309),a=t(4586),s=t(7294),o=t(8949),i=t(2650);function l(){var e=(0,r._)((0,s.useState)(i.k.songs),2),n=e[0],t=e[1];return(0,s.useEffect)(function(){var e,n;return e=function(e){t(e)},n=(0,o.N7)(i.k.songs,function(){e((0,a._)(i.k.songs))}),e((0,a._)(i.k.songs)),n},[]),[n]}},4972:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return B}});var r=t(1010),a=t(5766),s=t(2253),o=t(4932),i=t(1309),l=t(4586),c=t(7582),u=t(5893),d=t(8461),f=t(6390),h=t(4995),p=t(9583),g=t(7294),m=t(1182),y=t(2585),v=t(8434),w=t(5272),k=t(750),b=t(4339),x=t(2132),j=t(766),_=t(2169),N=t(1446),C=t(6743),D=t(7008),L=t(3707),E=t(5352),J=t(2650),A=t(5684),S=t(1664),T=t.n(S),P=t(3778),R=t(3187),O=t(5055);function B(){var e=(0,i._)((0,O.F)(),1)[0],n={marginRight:"0.3rem",marginLeft:"-0.4rem"},t=(0,i._)((0,D.n)(),1)[0],S=(0,L.ih)(E.N.themes),B=(0,i._)((0,g.useState)("json"),2),F=B[0],G=B[1];function H(){return z.apply(this,arguments)}function z(){return(z=(0,r._)(function(){var e,n,t,r,a,s,o,i,u;return(0,c.Jh)(this,function(c){switch(c.label){case 0:return b.kg.showPill("Validating songs..."),[4,m.v.getSongs()];case 1:e=c.sent(),n=[],t=!0,r=!1,a=void 0;try{for(s=e[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){i=o.value;try{m.v.parseSong(i)}catch(e){console.error(e),n.push(i),b.kg.error('Error validating song "'.concat(null===(u=i)||void 0===u?void 0:u.name,'"'))}}}catch(e){r=!0,a=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw a}}if(!(n.length>0))return[3,3];return[4,(0,k.cJ)("There were errors validating some songs. Do you want to continue downloading?")];case 2:if(!c.sent())return[2,null];c.label=3;case 3:return b.kg.hidePill(),[2,(0,l._)(e)]}})})).apply(this,arguments)}function Y(){return I.apply(this,arguments)}function I(){return(I=(0,r._)(function(){var e,n,t,r,a,s,o,i,u;return(0,c.Jh)(this,function(c){switch(c.label){case 0:return b.kg.showPill("Validating folders..."),e=[],[4,w.b.getFolders()];case 1:n=c.sent(),t=!0,r=!1,a=void 0;try{for(s=n[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){i=o.value;try{j.g.deserialize(i)}catch(n){console.error(n),e.push(i),b.kg.error('Error validating folder "'.concat(null===(u=i)||void 0===u?void 0:u.name,'"'))}}}catch(e){r=!0,a=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw a}}if(!(e.length>0))return[3,3];return[4,(0,k.cJ)("There were errors validating some folders. Do you want to continue downloading?")];case 2:if(!c.sent())return[2,null];c.label=3;case 3:return b.kg.hidePill(),[2,(0,l._)(n)]}})})).apply(this,arguments)}function M(){return U.apply(this,arguments)}function U(){return(U=(0,r._)(function(){var e,n,t,r,a,s,o;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return b.kg.showPill("Validating themes..."),[4,y.a.getThemes()];case 1:e=i.sent(),n=[],t=!0,r=!1,a=void 0;try{for(s=e[Symbol.iterator]();!(t=(o=s.next()).done);t=!0)o.value}catch(e){r=!0,a=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw a}}if(!(n.length>0))return[3,3];return[4,(0,k.cJ)("There were errors validating some themes. Do you want to continue downloading?")];case 2:if(!i.sent())return[2,null];i.label=3;case 3:return b.kg.hidePill(),[2,(0,l._)(e)]}})})).apply(this,arguments)}function X(){return(X=(0,r._)(function(e){var n,t,r,a,s,o,i,l,u;return(0,c.Jh)(this,function(c){switch(c.label){case 0:n=!0,t=!1,r=void 0,c.label=1;case 1:c.trys.push([1,8,9,10]),a=e[Symbol.iterator](),c.label=2;case 2:if(n=(s=a.next()).done)return[3,7];o=s.value,c.label=3;case 3:return c.trys.push([3,5,,6]),i=Array.isArray(o.data)?o.data:[o.data],[4,x.bV.importAndLog(i)];case 4:return c.sent(),[3,6];case 5:return console.error(c.sent()),b.kg.error('Error importing file "'.concat(null===(l=o.file)||void 0===l?void 0:l.name,'"')),[3,6];case 6:return n=!0,[3,2];case 7:return[3,10];case 8:return u=c.sent(),t=!0,r=u,[3,10];case 9:try{n||null==a.return||a.return()}finally{if(t)throw r}return[7];case 10:return[2]}})})).apply(this,arguments)}function W(){return(W=(0,r._)(function(){return(0,c.Jh)(this,function(e){switch(e.label){case 0:return[4,(0,k.cJ)("Write 'delete' if you want to delete all songs, press cancel to ignore")];case 1:if("delete"!==e.sent())return[2,b.kg.warn("Action cancelled")];return[4,(0,C.gw)(200)];case 2:return e.sent(),[4,(0,k.jH)("Are you REALLY sure you want to delete all songs?")];case 3:if(!e.sent())return[2,b.kg.warn("Action cancelled")];return[4,J.k._DANGEROUS_CLEAR_ALL_SONGS()];case 4:return e.sent(),[4,v.p._DANGEROUS_CLEAR_ALL_FOLDERS()];case 5:return e.sent(),b.kg.success("Deleted all songs"),[2]}})})).apply(this,arguments)}function Z(){return(Z=(0,r._)(function(){return(0,c.Jh)(this,function(e){switch(e.label){case 0:return[4,(0,k.cJ)("Write 'delete' if you want to delete all themes")];case 1:if("delete"!==e.sent())return[2,b.kg.warn("Action cancelled")];return[4,(0,C.gw)(200)];case 2:return e.sent(),[4,(0,k.jH)("Are you REALLY sure you want to delete all themes?")];case 3:if(!e.sent())return[2,b.kg.warn("Action cancelled")];return[4,E.N._DANGEROUS_CLEAR_ALL_THEMES()];case 4:return e.sent(),b.kg.success("Deleted all themes"),[2]}})})).apply(this,arguments)}function q(e,n){return $.apply(this,arguments)}function $(){return($=(0,r._)(function(e,n){var t,r;return(0,c.Jh)(this,function(s){switch(s.label){case 0:if("json"!==F)return[3,1];return x.bV.downloadFiles(e,n),[3,4];case 1:return s.trys.push([1,3,,4]),b.kg.showPill("Zipping files..."),[4,new Promise(function(t,r){var s,o=e.map(function(e){var n=x.bV.getUnknownFileExtensionAndName(e);if(!n)return["unknown".concat(Math.floor(1e3*Math.random()),".").concat(e.type),(0,P.TD)(JSON.stringify(e))];var t=n.name,r=n.extension,a=Array.isArray(e)?e:[e];return["".concat(t,".").concat(r),(0,P.TD)(JSON.stringify(a))]});(0,P.$R)((s={},(0,a._)(s,"".concat(n),(0,P.TD)(JSON.stringify(e))),(0,a._)(s,"individualFiles",Object.fromEntries(o)),s),function(e,a){if(e)return r(e);x.bV.downloadBlob(new Blob([a]),"".concat(n,".zip")),t(a)})})];case 2:return t=s.sent(),b.kg.hidePill(),[2,t];case 3:throw r=s.sent(),b.kg.hidePill(),r;case 4:return[2]}})})).apply(this,arguments)}return(0,g.useEffect)(function(){return function(){return b.kg.hidePill()}},[]),(0,u.jsxs)(f.k,{children:[(0,u.jsx)(h.D,{text:"Backup",description:"Manage the backups in the app, download or import songs, themes, or all of them"}),(0,u.jsx)("h1",{style:{fontSize:"1.8rem"},children:"Transfer from other domain"}),(0,u.jsxs)("div",{style:{gap:"1rem",paddingLeft:"1.5rem"},className:"row row-centered",children:[(0,u.jsx)("div",{children:"If you want to transfer your data from another domain of the app, click here"}),(0,u.jsx)(T(),{href:"transfer",style:{marginLeft:"1rem"},children:(0,u.jsx)(d.J,{cssVar:"accent",style:{gap:"0.2rem"},children:"Transfer"})})]}),(0,u.jsxs)("div",{className:"row row-centered",style:{margin:"1rem 0",gap:"1rem",marginTop:"2rem"},children:[(0,u.jsx)("div",{style:{fontSize:"1.8rem"},children:"Backup as"}),(0,u.jsx)(R.k,{options:[{value:"zip",color:e.getValue("accent").toString()},{value:"json",color:e.getValue("accent").toString()}],selected:F,onChange:G})]}),(0,u.jsx)("div",{style:{paddingLeft:"1.5rem"},children:"Make sure you create a backup every now and then. Especially if you just finished a new song. The browser shouldn't delete your data, especially if you installed the app, but there is always a chance."}),(0,u.jsxs)("div",{className:"row",style:{marginTop:"1rem",gap:"0.5rem",paddingLeft:"1.5rem"},children:[(0,u.jsxs)(d.J,{tooltip:"Download all the data of the app, aka themes, songs, folders",className:"flex-centered",onClick:(0,r._)(function(){var e,n,t,r;return(0,c.Jh)(this,function(a){switch(a.label){case 0:return[4,H()];case 1:if(!(e=a.sent()))return[2];return[4,Y()];case 2:if(!(n=a.sent()))return[2];return[4,M()];case 3:if(!(t=a.sent()))return[2];if(0===(r=(0,l._)(e).concat((0,l._)(n),(0,l._)(t))).length)return[2,b.kg.warn("There is nothing to backup")];a.label=4;case 4:return a.trys.push([4,6,,7]),[4,q(r,"".concat(V(),"-all.").concat(_.iC.toLowerCase(),"backup"))];case 5:return a.sent(),b.kg.success("Downloaded backup"),A.j.setLastBackupWarningTime(Date.now()),[3,7];case 6:return a.sent(),b.kg.error("Error downloading backup"),[3,7];case 7:return[2]}})}),children:[(0,u.jsx)(p.ZJh,{style:n}),"Download all backup"]}),(0,u.jsxs)(d.J,{tooltip:"Downloads a backup containing all songs and folders",className:"flex-centered",onClick:(0,r._)(function(){var e,n,t,r;return(0,c.Jh)(this,function(a){switch(a.label){case 0:return[4,H()];case 1:if(!(e=a.sent()))return[2];return[4,Y()];case 2:if(!(n=a.sent()))return[2];if(0===(t=(0,l._)(e).concat((0,l._)(n))).length)return[2,b.kg.warn("There are no songs to backup")];a.label=3;case 3:return a.trys.push([3,5,,6]),[4,q(t,"".concat(V(),"-songs.").concat(_.iC.toLowerCase(),"backup"))];case 4:return a.sent(),b.kg.success("Downloaded songs backup"),A.j.setLastBackupWarningTime(Date.now()),[3,6];case 5:return r=a.sent(),b.kg.error("Error downloading backup"),console.error(r),[3,6];case 6:return[2]}})}),children:[(0,u.jsx)(p.ZJh,{style:n}),"Download song backup"]}),(0,u.jsxs)(d.J,{tooltip:"Downloads a backup of all the custom themes",className:"flex-centered",onClick:(0,r._)(function(){var e,n;return(0,c.Jh)(this,function(t){switch(t.label){case 0:return[4,M()];case 1:if(!(e=t.sent()))return[2];if(0===e.length)return[2,b.kg.warn("There are no themes to backup")];t.label=2;case 2:return t.trys.push([2,4,,5]),[4,q(e,"".concat(V(),"-themes.").concat(_.iC.toLowerCase(),"backup"))];case 3:return t.sent(),b.kg.success("Downloaded themes backup"),[3,5];case 4:return n=t.sent(),b.kg.error("Error downloading backup"),console.error(n),[3,5];case 5:return[2]}})}),children:[(0,u.jsx)(p.ZJh,{style:n}),"Download themes backup"]})]}),(0,u.jsx)("h1",{style:{fontSize:"1.8rem"},children:"Import a backup"}),(0,u.jsx)("div",{style:{paddingLeft:"1.5rem"},children:"If you have a backup, you can import it here, they will be added to your existing data. (if you already have the same song, a duplicate will be created)."}),(0,u.jsx)("div",{className:"flex-centered",children:(0,u.jsx)(N.G,{onPick:function(e){return X.apply(this,arguments)},as:"json",onError:function(){return b.kg.error("There was an error reading the file")},children:(0,u.jsxs)(d.J,{className:"flex-centered",tooltip:"Here you can import any backup you have",style:{marginTop:"1rem",backgroundColor:"var(--accent)",color:"var(--accent-text)",padding:"0.8rem"},children:[(0,u.jsx)(p.Xur,{style:(0,o._)((0,s._)({},n),{fontSize:"1rem",marginRight:"0.5rem"})}),"Import backup"]})})}),(0,u.jsx)("div",{className:"column",style:{flex:"1",justifyContent:"center",padding:"1rem"},children:(0,u.jsxs)("div",{className:"column",style:{width:"fit-content"},children:[(0,u.jsxs)("span",{children:[t.length," ",1===t.length?"song":"songs"]}),(0,u.jsxs)("span",{children:[S.length," ",1===S.length?"theme":"themes"]})]})}),(0,u.jsx)("h1",{style:{fontSize:"1.8rem"},children:"Delete data"}),(0,u.jsx)("div",{style:{paddingLeft:"1.5rem"},children:"If you want, you can also delete all your data here, once deleted it can't be recovered. Don't worry you will be asked to confirm before anything is deleted."}),(0,u.jsxs)("div",{className:"row",style:{marginTop:"1rem",gap:"0.5rem",paddingLeft:"1.5rem"},children:[(0,u.jsxs)(d.J,{className:"flex-centered",tooltip:"Here you can delete all your songs and folders",tooltipPosition:"top",style:{backgroundColor:"var(--red-bg)",color:"var(--red-text)"},onClick:function(){return W.apply(this,arguments)},children:[(0,u.jsx)(p.Xm5,{style:n}),"Delete songs and folders"]}),(0,u.jsxs)(d.J,{className:"flex-centered",tooltip:"Here you can delete all your themes",tooltipPosition:"top",style:{backgroundColor:"var(--red-bg)",color:"var(--red-text)"},onClick:function(){return Z.apply(this,arguments)},children:[(0,u.jsx)(p.Xm5,{style:n}),"Delete themes"]})]})]})}function V(){var e=new Date;return"".concat(e.getFullYear(),"-").concat(e.getMonth(),"-").concat(e.getDate())}}},function(e){e.O(0,[778,774,888,179],function(){return e(e.s=5164)}),_N_E=e.O()}]);