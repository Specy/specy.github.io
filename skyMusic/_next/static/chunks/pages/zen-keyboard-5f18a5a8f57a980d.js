(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[483],{9691:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/zen-keyboard",function(){return n(3110)}])},3337:function(e,t,n){"use strict";n.d(t,{h:function(){return s}});var a=n(2253),i=n(4932),r=n(5893),o=n(8461);function s(e){var t,n,s,c,u;return(0,r.jsx)(o.J,(0,i._)((0,a._)({},e),{style:(0,a._)({width:null!==(t=e.size)&&void 0!==t?t:"2rem",height:null!==(n=e.size)&&void 0!==n?n:"2rem",minWidth:null!==(s=e.size)&&void 0!==s?s:"2rem",minHeight:null!==(c=e.size)&&void 0!==c?c:"2rem"},e.style),className:"icon-app-button flex-centered ".concat(null!==(u=e.className)&&void 0!==u?u:""),children:e.children}))}},3544:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var a=n(1309),i=n(5893),r=n(5055),o=n(7114),s=n.n(o);function c(e){var t=e.checked,n=e.onChange,o=e.styleOuter,c=(0,a._)((0,r.F)(),1)[0];return(0,i.jsx)("button",{className:s()["switch-wrapper"],onClick:function(){return n(!t)},style:o||{},"aria-label":t?"Switch to off":"Switch to on",children:(0,i.jsx)("div",{className:"".concat(s()["switch-inner"]," ").concat(t?s()["switch-inner-on"]:""),style:{backgroundColor:(t?c.get("accent"):c.layer("primary",.4)).toString()}})})}},6880:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var a=n(2253),i=n(1309),r=n(5893),o=n(5829),s=n(7294),c=n(8949);function u(e){var t,n,u,l=e.children,d=e.page,h=e.style,m=(0,i._)((n=(t=(0,i._)((0,s.useState)(o.f6),2))[0],u=t[1],(0,s.useEffect)(function(){return(0,c.N7)(o.f6.state.other,function(){u((0,a._)({},o.f6))})},[]),[n,u]),1)[0];return(0,r.jsx)("div",{className:"app bg-image",style:(0,a._)({backgroundImage:"url(".concat(m.getOther("backgroundImage"+d),")")},h),children:l})}},781:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var a=n(5893);function i(e){var t=e.title,n=e.current,i=e.children,r=e.id;return(0,a.jsxs)("div",{className:n===r?"menu-panel menu-panel-visible":"menu-panel",children:[t&&(0,a.jsx)("div",{className:"menu-title",children:t}),(0,a.jsx)("div",{className:"panel-content-wrapper",children:i})]})}},4995:function(e,t,n){"use strict";n.d(t,{D:function(){return o}});var a=n(5893),i=n(9008),r=n.n(i);function o(e){var t=e.text,n=e.description;return(0,a.jsxs)(r(),{children:[(0,a.jsx)("title",{children:t}),n&&(0,a.jsx)("meta",{name:"description",content:n})]})}},1866:function(e,t,n){"use strict";n.d(t,{A:function(){return x}});var a=n(1309),i=n(5893),r=n(7294),o=n(2253),s=n(4932),c=n(3544),u=n(7600),l=n.n(u);function d(e){var t=e.data,n=e.volume,a=e.onVolumeChange,r=e.onVolumeComplete,c=e.onInstrumentPick,u=e.objectKey,d=e.instrument,h=e.theme,m=[],v=[],g=!0,f=!1,p=void 0;try{for(var y,x=t.options[Symbol.iterator]();!(g=(y=x.next()).done);g=!0){var b=y.value;b.startsWith("SFX")?v.push(b):m.push(b)}}catch(e){f=!0,p=e}finally{try{g||null==x.return||x.return()}finally{if(f)throw p}}return(0,i.jsxs)("div",{className:l()["instrument-picker"],children:[(0,i.jsx)("select",{value:d,style:{textAlign:"left",paddingLeft:"0.4rem",backgroundImage:"url(\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' height='24' viewBox='0 0 24 24' width='24' fill='".concat(h.getText("primary").hex().replace("#","%23"),"'><path d='M0 0h24v24H0z' fill='none'/><path d='M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z'/></svg>\")")},className:l().select,onChange:function(e){c({key:u,data:(0,s._)((0,o._)({},t),{value:e.target.value})})},children:0===v.length?(0,i.jsx)(i.Fragment,{children:m.map(function(e){return(0,i.jsx)("option",{value:e,children:e.replace("-"," ")},e)})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("optgroup",{label:"Instruments",children:m.map(function(e){return(0,i.jsx)("option",{value:e,children:e.replace("-"," ")},e)})}),(0,i.jsx)("optgroup",{label:"SFX",children:v.map(function(e){return(0,i.jsx)("option",{value:e,children:e.replace("-"," ").replace("SFX_","")},e)})})]})}),(0,i.jsx)("input",{type:"range",min:1,max:100,value:n,onChange:function(e){a(Number(e.target.value))},onPointerUp:function(){r({key:u,value:n})}})]})}var h=n(9583);function m(e){var t=e.data,n=e.value,a=e.onChange,r=e.onComplete,c=e.objectKey,u=function(e){if("number"===t.type){var a=Number(n)+(t.increment||0)*e;!t.threshold||a<t.threshold[0]||a>t.threshold[1]||r({key:c,data:(0,s._)((0,o._)({},t),{value:a})})}};return(0,i.jsxs)("div",{className:l()["settings-input"],children:["number"===t.type&&(0,i.jsx)("button",{onClick:function(){return u(-1)},className:l()["settings-input-button"],style:{marginRight:"0.15rem"},"aria-label":"Decrement",children:(0,i.jsx)(h.iFH,{})}),(0,i.jsx)("input",{type:t.type,value:n,placeholder:t.placeholder||"",onBlur:function(){t.value!==n&&r({key:c,data:(0,s._)((0,o._)({},t),{value:n})})},onChange:function(e){var n=e.target;if("number"===t.type){var i=Number(n.value);if(n.value="",!t.threshold||i<t.threshold[0]||i>t.threshold[1])return;a(i)}else a(n.value)},"aria-label":t.name}),"number"===t.type&&(0,i.jsx)("button",{onClick:function(){return u(1)},className:l()["settings-input-button"],style:{marginLeft:"0.15rem"},"aria-label":"Increment",children:(0,i.jsx)(h.wEH,{})})]})}function v(e){var t=e.data,n=e.value,a=e.onChange,r=e.objectKey;return(0,i.jsx)("input",{type:"range",min:t.threshold[0],max:t.threshold[1],step:t.step,value:n,onChange:function(e){a({key:r,data:(0,s._)((0,o._)({},t),{value:Number(e.target.value)})})}})}function g(e){var t=e.value,n=e.onChange,a=e.data,r=e.objectKey,c=e.children,u=e.theme,l=e.type;return(0,i.jsx)("select",{value:t,onChange:function(e){n({key:r,data:(0,s._)((0,o._)({},a),{value:"number"==typeof l?parseInt(e.target.value):e.target.value})}),e.target.blur()},style:{backgroundImage:"url(\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' height='24' viewBox='0 0 24 24' width='24' fill='".concat(u.getText("primary").hex().replace("#","%23"),"'><path d='M0 0h24v24H0z' fill='none'/><path d='M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z'/></svg>\")")},children:c})}var f=n(5055),p=n(1014),y=(0,r.memo)(function(e){var t=e.data,n=e.update,u=e.objKey,h=e.changeVolume,y=(0,a._)((0,r.useState)(t.value),2),x=y[0],b=y[1],k=(0,a._)((0,r.useState)("instrument"===t.type?t.volume:0),2),_=k[0],j=k[1],N=(0,a._)((0,f.F)(),1)[0],C=t.type;return(0,r.useEffect)(function(){b(t.value)},[t.value]),(0,i.jsxs)("div",{className:l()["settings-row"],style:{backgroundColor:N.layer("menu_background",.15).toString()},children:[(0,i.jsxs)("div",{className:(0,p.h)(t.tooltip),style:{flex:"1"},children:[t.name,t.tooltip&&(0,i.jsx)(p.u,{style:{width:"12rem"},children:t.tooltip})]}),"select"===C&&(0,i.jsx)(g,{theme:N,type:t.options[0],onChange:n,value:t.value,objectKey:u,data:t,children:t.options.map(function(e){return(0,i.jsx)("option",{value:e,children:e},e)})}),("number"===C||"text"===C)&&(0,i.jsx)(m,{data:t,value:x,onChange:b,onComplete:n,objectKey:u}),"checkbox"===C&&(0,i.jsx)(c.Z,{checked:x,onChange:function(e){"checkbox"===C&&n({key:u,data:(0,s._)((0,o._)({},t),{value:e})})}}),"slider"===C&&(0,i.jsx)(v,{objectKey:u,data:t,value:x,onChange:n}),"instrument"===C&&h&&(0,i.jsx)(d,{theme:N,volume:_,onInstrumentPick:n,onVolumeChange:j,onVolumeComplete:h,instrument:t.value,data:t,objectKey:u})]})},function(e,t){return e.data.value===t.data.value&&e.data.volume===t.data.volume&&e.update===t.update});function x(e){var t=e.settings,n=e.changeVolume,o=e.onUpdate,s=new Map;return Object.entries(t).forEach(function(e){var t=(0,a._)(e,2),n=t[0],i=t[1];s.has(i.category)||s.set(i.category,{category:i.category,settings:{}}),s.get(i.category).settings[n]=i}),(0,i.jsx)(i.Fragment,{children:Array.from(s.values()).map(function(e){return(0,i.jsx)(r.Fragment,{children:(0,i.jsxs)("div",{className:"column",children:[(0,i.jsx)("h1",{className:l()["settings-group-title"],children:e.category}),Object.entries(e.settings).map(function(e){var t=(0,a._)(e,2),r=t[0],s=t[1];return(0,i.jsx)(y,{objKey:r,data:s,changeVolume:n,update:o},r)})]})},e.category)})})}},9218:function(e,t,n){"use strict";var a=n(5893),i=n(7294);t.Z=(0,i.memo)(function(e){var t=e.children;return(0,a.jsx)(a.Fragment,{children:t})},function(e,t){var n,a,i,r;return(null===(n=t.children)||void 0===n?void 0:n.key)!==null||(null===(a=e.children)||void 0===a?void 0:a.key)!==null?(null===(i=e.children)||void 0===i?void 0:i.key)===(null===(r=t.children)||void 0===r?void 0:r.key):void 0!==e.children})},3110:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Y}});var a=n(1010),i=n(2253),r=n(4932),o=n(1309),s=n(7582),c=n(5893),u=n(3337),l=n(3707),d=n(8564),h=n(4586),m=n(2169),v=n(8949),g=function e(){var t=this;(0,d._)(this,e),this.keyboard=[],this.setKeyboardLayout=function(e){var n;(n=t.keyboard).splice.apply(n,[0,t.keyboard.length].concat((0,h._)(e)))},this.animateNote=function(e,n){t.keyboard[e].triggerAnimation(n)},this.resetKeyboardLayout=function(){t.keyboard.forEach(function(e){return e.setState({status:"",delay:"Genshin"===m.iC?100:200})})},this.resetOutgoingAnimation=function(){t.keyboard.forEach(function(e){return e.setState({animationId:0})})},this.setNoteState=function(e,n){t.keyboard[e].setState(n)},(0,v.rC)(this)};(0,s.gn)([v.LO],g.prototype,"keyboard",void 0);var f=new g,p=n(2114),y=n(7294),x=n(5829),b=n(8376),k=n(427),_=n.n(k),j=[{transform:"rotateY(0deg) scale(0.8)"},{transform:"rotateY(180deg) scale(0.8)"},{transform:"rotateY(360deg) scale(1)"}];function N(e){var t,n,a,i=e.note,r=e.onClick,s=e.noteImage,u=e.noteText,d=e.instrumentName,h=e.keyPadding,v=(0,o._)((0,y.useState)(""),2),g=v[0],f=v[1],k=(0,o._)((0,y.useState)(0),2),N=k[0],C=k[1],w=(0,o._)((0,y.useState)(m.kx.text.light),2),S=w[0],Z=w[1],A=(0,y.useRef)(null),E=(0,y.useCallback)(function(e){e.preventDefault(),r(i)},[r,i]);(0,y.useEffect)(function(){return(0,l.VZ)(i.data,function(){if("Genshin"===m.iC)f("clicked"),C(function(e){return e+1}),setTimeout(function(){return f("")},100);else{var e=A.current;if(!e)return;e.animate(j,{duration:400})}})},[i,A]),(0,y.useEffect)(function(){return(0,l.VZ)(x.f6.state.data,function(){var e;Z((e=x.f6.get("note_background"),"Genshin"!==m.iC?e.isDark()?m.kx.text.light:m.kx.text.dark:e.luminosity()>.65?m.kx.text.note:e.isDark()?m.kx.text.light:m.kx.text.dark))})},[]);var K="".concat((t=m.Al.note,"clicked"===g&&(t+=" click-event"),t)," ").concat("Genshin"===m.iC?"":_()["sky-zen-note"]),z=null===(n=m.as[d])||void 0===n?void 0:n.clickColor;return(0,c.jsxs)("button",{onPointerDown:E,className:"button-hitbox-bigger",style:{padding:"".concat(h,"rem")},children:["Genshin"===m.iC&&(0,c.jsx)("div",{style:z&&x.f6.isDefault("accent")?{borderColor:z}:{},className:m.Al.noteAnimation},N),(0,c.jsxs)("div",{ref:A,className:K,children:["Genshin"===m.iC&&(0,c.jsx)(b.Z,{className:"genshin-border",fill:"clicked"===g?"transparent":"toClickNext"===g||"toClickAndNext"===g?"#63aea7":"var(--note-border-fill)"}),s&&(0,c.jsx)(p.Z,{name:i.noteImage,color:x.f6.isDefault("accent")?null===(a=m.as[d])||void 0===a?void 0:a.fill:void 0,background:"clicked"===g?z&&x.f6.isDefault("accent")?z:"var(--accent)":"var(--note-background)"}),(0,c.jsx)("div",{className:m.Al.noteName,style:{color:S},children:u})]})]})}var C=n(9714),w="keyboard ".concat(_()["zen-keyboard"],"}"),S=new Map([[15,"".concat(w," keyboard-5")],[14,"".concat(w," keyboard-5")],[8,"".concat(w," keyboard-4")],[6,"".concat(w," keyboard-3")]]);function Z(e){var t=e.onNoteClick,n=e.instrument,a=e.pitch,i=e.verticalOffset,r=e.scale,o=e.noteNameType,s=e.keySpacing,u=(0,l.ih)(f.keyboard);(0,y.useEffect)(function(){return(0,C.JP)("zen_keyboard",function(e){var a=e.shortcut;if(!e.event.repeat){var i=n.getNoteFromCode(a.name);null!==i&&t(i)}})},[t,n]);var d=S.get(u.length)||w;return(0,c.jsx)("div",{className:d,style:{transform:"scale(".concat(r/100,") translateY(").concat(i,"px)"),marginTop:"unset"},children:u.map(function(e,i){return(0,c.jsx)(N,{keyPadding:s,instrumentName:n.name,noteText:n.getNoteText(i,o,a),noteImage:e.noteImage,note:e,onClick:t},i)})})}var A=n(7053),E=n(2809),K=n(9583),z=n(781),I=n(7671),P=n(1866),V=n(9218);function F(e){var t=e.settings,n=e.handleSettingChange,a=e.onVolumeChange,i=function(){h(!d)},r=(0,o._)((0,y.useState)("Settings"),2),s=r[0],u=r[1],l=(0,o._)((0,y.useState)(!0),2),d=l[0],h=l[1],m=(0,o._)((0,y.useState)(!1),2),v=m[0],g=m[1],f=(0,A.ZP)(function(){g(!1)},{ignoreFocusable:!0,active:""!==s}),p=d&&v?"side-menu menu-open":"side-menu";return(0,c.jsxs)("div",{className:"menu-wrapper",ref:f,children:[(0,c.jsx)("div",{className:"hamburger-top",onClick:function(){return g(!v)},children:(0,c.jsx)(V.Z,{children:(0,c.jsx)(K.Fm7,{})})}),(0,c.jsxs)("div",{className:"menu ".concat(v?"menu-visible":""),style:{justifyContent:"flex-end"},children:[(0,c.jsx)(I.s,{ariaLabel:"Close menu",style:{marginBottom:"auto"},onClick:function(){return g(!v)},children:(0,c.jsx)(K.aHS,{className:"icon"})}),(0,c.jsx)(I.s,{onClick:function(){u("Settings"),i()},isActive:"Settings"===s&&d,ariaLabel:"Open settings",children:(0,c.jsx)(K.p4t,{className:"icon"})}),(0,c.jsx)(I.s,{onClick:E.I.open,ariaLabel:"Open home menu",children:(0,c.jsx)(K.xng,{className:"icon"})})]}),(0,c.jsx)("div",{className:p,children:(0,c.jsx)(z.Z,{title:"Settings",current:s,id:"Settings",children:(0,c.jsx)(P.A,{settings:t,onUpdate:n,changeVolume:a})})})]})}var T=n(1841),L=n(5839),O=n(657),D=n(7557),M=n(5684),B=n(4339),H=n(9731),G=n(4995),X=n(6880);function Y(){var e,t=(0,o._)((0,y.useState)(T.$h.data),2),n=t[0],l=t[1],d=(0,o._)((0,y.useState)(new L.ZP),2),h=d[0],m=d[1],v=(0,o._)((0,y.useState)(!1),2),g=v[0],p=v[1];(0,y.useEffect)(function(){var e=M.j.getZenKeyboardSettings();return O.A.bpm=e.metronomeBpm.value,m(new L.ZP(e.instrument.value)),l(e),D.n.setReverb(e.caveMode.value),function(){return B.kg.hidePill()}},[]);var x=(0,y.useCallback)(function(e){M.j.updateZenKeyboardSettings(e)},[]);(0,y.useEffect)(function(){f.setKeyboardLayout(h.notes)},[h]);var b=(e=(0,a._)(function(e){var t;return(0,s.Jh)(this,function(a){return t=e.data,n[e.key]=(0,r._)((0,i._)({},n[e.key]),{value:t.value}),"instrument"===e.key&&m(new L.ZP(t.value)),"caveMode"===e.key&&D.n.setReverb(t.value),"metronomeBpm"===e.key&&(O.A.bpm=t.value),"metronomeBeats"===e.key&&(O.A.beats=t.value),"metronomeVolume"===e.key&&O.A.changeVolume(t.value),l((0,i._)({},n)),x(n),[2]})}),function(t){return e.apply(this,arguments)});(0,y.useEffect)(function(){function e(){return(e=(0,a._)(function(){return(0,s.Jh)(this,function(e){switch(e.label){case 0:return B.kg.showPill("Loading instrument: ".concat(h.name,"...")),[4,h.load(D.n.getAudioContext())];case 1:return e.sent(),B.kg.hidePill(),D.n.connect(h.endNode),[2]}})})).apply(this,arguments)}return function(){e.apply(this,arguments)}(),function(){D.n.disconnect(h.endNode)}},[h]),(0,y.useEffect)(function(){g?O.A.start():O.A.stop()},[g]);var k=(0,y.useCallback)(function(e){h.changeVolume(e.value)},[h]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(G.D,{text:"Zen Keyboard",description:"The simplest keyboard in the app, focus only on playing manually with all the features of the player, instrument and pitch selection, animations and metronome"}),(0,c.jsx)(F,{settings:n,onVolumeChange:k,handleSettingChange:b}),(0,c.jsx)("div",{className:"flex-centered",children:(0,c.jsx)(Z,{instrument:h,onNoteClick:function(e){h.play(e.index,n.pitch.value),f.animateNote(e.index)},noteNameType:n.noteNameType.value,pitch:n.pitch.value,scale:n.keyboardSize.value,keySpacing:n.keyboardSpacing.value,verticalOffset:n.keyboardYPosition.value})}),(0,c.jsx)(u.h,{toggled:g,onClick:function(){return p(!g)},className:"metronome-button",style:{position:"absolute",bottom:"0.8rem",right:"0.8rem"},ariaLabel:"Toggle metronome",children:(0,c.jsx)(H.eHT,{size:22})})]})}Y.getLayout=function(e){return(0,c.jsx)(X.Z,{page:"Main",children:e})}},7114:function(e){e.exports={"switch-wrapper":"Switch_switch-wrapper__sXQsI","switch-inner":"Switch_switch-inner__vcK6i","switch-inner-on":"Switch_switch-inner-on__BXwhZ"}},7600:function(e){e.exports={"instrument-picker":"Settings_instrument-picker__W7kvG",select:"Settings_select__Io3_h","settings-group-title":"Settings_settings-group-title__JR_FV","settings-row":"Settings_settings-row__N_hAE",invalid:"Settings_invalid__H_Utp","settings-input":"Settings_settings-input__keTYI","settings-input-button":"Settings_settings-input-button__CV1P1"}},427:function(e){e.exports={"zen-keyboard":"ZenKeyboard_zen-keyboard__8iqeZ","sky-zen-note":"ZenKeyboard_sky-zen-note__sNfl9"}}},function(e){e.O(0,[980,208,774,888,179],function(){return e(e.s=9691)}),_N_E=e.O()}]);